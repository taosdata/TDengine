testCases:
    - scenarioId: "A1"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a1 
                sliding(1h) 
                from db1.readings 
                stream_options(fill_history_first) 
                into db1.res_a1 
                as select _tcurrent_ts ts, avg(fuel_consumption)
                        from db1.readings 
                        where _c0 >= _tprev_ts and _c0 < _tcurrent_ts;

    - scenarioId: "A2"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a2 
               sliding(1m) 
               from db1.readings 
               stream_options(fill_history_first) 
               into db1.res_a2 
               as 
                  select _tcurrent_ts ts, count(*), avg(fuel_consumption) 
                      from (  
                            select fuel_consumption, last(grade) cur_grade 
                            from db1.readings 
                            where _c0 >= _tprev_ts and _c0 <= _tcurrent_ts partition by tbname) 
                      where cur_grade > 70;

    - scenarioId: "A3"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a3 
            sliding(1m) 
            from db1.readings 
            stream_options(fill_history_first) 
            into db1.res_a3 
            as 
              select _tcurrent_ts cur_ts, count(*), avg(avg_fuel) 
                  from (
                        select last(elevation) last_elev, avg(fuel_consumption) avg_fuel 
                        from db1.readings 
                          where _c0 >= _tprev_ts and _c0 < _tcurrent_ts 
                          partition by tbname 
                      ) 
                  where last_elev > 1000;

    - scenarioId: "A4"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a4 
            sliding(10m) 
            from db1.readings 
            stream_options(fill_history_first) 
            into db1.res_a4 
            as 
              select _tcurrent_ts, sum(load) 
                from (
                      select last(current_load) load 
                        from db2.diagnostics 
                        where _c0 >= _tprev_ts and _c0 <= _tcurrent_ts 
                        partition by tbname
                     )

    - scenarioId: "A5"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a5 
            sliding(10m) 
            from db1.readings 
            stream_options(fill_history_first) 
            into db1.res_a5 (ts, last_heading primary key, num) 
            as 
              select _tcurrent_ts, last_heading, count(*) 
                from (
                      select case when last(heading) < 45 or last(heading) >= 315   then 0 
                                  when last(heading) >= 45 and last(heading) < 135  then 90 
                                  when last(heading) >= 135 and last(heading) < 225 then 180 
                                  else 270 end last_heading 
                          from db1.readings 
                          where _c0 >= _tprev_ts and _c0 <= _tcurrent_ts 
                          partition by tbname
                     ) 
                partition by last_heading;

    - scenarioId: "A6"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a6 
            sliding(1h) 
            from db1.readings 
            stream_options(fill_history_first) 
            into db1.res_a6 
            as 
              select _tcurrent_ts, count(*), avg(last_velocity) 
                  from (
                         select _tprev_ts ts, last(current_load) load, load_capacity, name 
                           from db2.diagnostics 
                           where _c0 >= _tprev_ts and _c0 <= _tcurrent_ts 
                           partition by tbname) a 
                           join (
                                 select _tprev_ts ts, last(velocity) last_velocity, name 
                                    from db1.readings where _c0 >= _tprev_ts and _c0 <= _tcurrent_ts 
                                    partition by tbname
                                ) b 
                           on a.ts = b.ts and a.load < 0.1 * a.load_capacity and a.name = b.name;

    - scenarioId: "A7"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db1.stm_a7
            interval(1d) 
            sliding(1d) 
            from db1.readings 
            stream_options(fill_history_first) 
            into db1.res_a7 
            as 
              select _twstart, avg(fuel_consumption) 
                from db1.readings 
                where _c0 >= _twstart and _c0 < _twend;

    - scenarioId: "A8"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db2.stm_a8
            interval(1d) 
            sliding(1d) 
            from db2.diagnostics 
            stream_options(fill_history_first) 
            into db2.res_a8 
            as 
              select _twstart, sum(tduration)/3600000 
                 from (
                        select _wduration tduration, count(*) 
                          from db2.diagnostics 
                          where _c0 >= _twstart and _c0 < _twend 
                          partition by tbname 
                          event_window start with status > 0 end with status = 0
                      )

    - scenarioId: "A9"
      classfication: "Summary"
      description: ""
      sql: |
        create stream db2.stm_a9 
            interval(1d) 
            sliding(1d) 
            from db2.diagnostics 
            stream_options(fill_history_first) 
            into db2.res_a9
            as 
              select _twstart, count(*) 
                from (
                       select sum(tduration) sduration 
                       from (
                              select tbname name, _wduration tduration, count(*) 
                                from db2.diagnostics 
                                where _c0 >= _twstart and _c0 < _twend 
                                partition by tbname 
                                event_window start with status > 0 end with status = 0
                            ) 
                       partition by name
                     ) 
                where sduration > 12 * 3600000; 


    - scenarioId: "F6"
      classfication: "Fleet"
      description: ""
      sql: |
        create stream db2.stm_f6 
            sliding(1h) 
            from db2.diagnostics partition by fleet 
            stream_options(fill_history_first) 
            into db2.res_f6 
            as 
              select _tcurrent_ts, sum(cur_load)/sum(load_capacity) 
                from (
                        select fleet, last(current_load) cur_load, load_capacity 
                        from db2.diagnostics 
                          where fleet = %%1 and _c0 >= _tprev_ts and _c0 <= _tcurrent_ts 
                          partition by tbname 
                      )

    - scenarioId: "F7"
      classfication: "Fleet"
      description: ""
      sql: |
        create stream db2.stm_f7 
            sliding(1h) 
            from db2.diagnostics partition by fleet 
            stream_options(fill_history_first) 
            into db2.res_f7 
            as 
              select _tcurrent_ts, sum(breakdown)/count(*) 
                from (
                       select fleet, case when last(status) > 0 then 1 else 0 end breakdown 
                       from db2.diagnostics 
                          where fleet = %%1 and _c0 >= _tprev_ts and _c0 <= _tcurrent_ts 
                          partition by tbname
                     )

    - scenarioId: "T1"
      classfication: "Vehicle"
      description: ""
      sql: |
        create stream stm_t1 
            interval(1h) 
            sliding(1h) 
            from db1.readings partition by tbname 
            stream_options(fill_history_first) 
            into db1.res_t1 
            as 
              select _twstart ts, avg(fuel_consumption) avg_fuel 
                from %%tbname 
                where _c0 >= _twstart and _c0 < _twend;

    - scenarioId: "T2"
      classfication: "Vehicle"
      description: ""
      sql: |
        create stream stm_t2 
            interval(1h) 
            sliding(1h) 
            from db1.readings partition by tbname 
            stream_options(fill_history_first) 
            into db1.res_t2 
            as 
              select _twstart ts, sum(stime) stop_time 
                from (
                      select _wduration stime, count(*) 
                        from %%tbname 
                        where _c0 >= _twstart and _c0 < _twend 
                        event_window start with velocity = 0 end with velocity > 0
                     )

    - scenarioId: "T3"
      classfication: "Vehicle"
      description: ""
      sql: |
        create stream stm_t3 
            state_window (
                case when grade <= 30 then 0 
                     when grade <= 70 then 1 
                     else 2 end ) 
            from db1.readings partition by tbname 
            stream_options(fill_history_first) 
            into db1.res_t3 
            as 
              select _twstart ts, avg(fuel_consumption), avg(velocity) 
                from  %%tbname 
                where _c0 >= _twstart and _c0 <= _twend;