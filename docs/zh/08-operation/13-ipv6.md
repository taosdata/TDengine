---
sidebar_label: ipv6 配置
title: ipv6 配置 
toc_max_heading_level: 4
---

### 概述

  TDengine 3.3.7版本起，我们正式全面支持 IPv6 网络环境。此功能允许用户在现代网络基础设施中部署和连接 TDengine，消除了对 IPv4 的依赖，以满足日益增长的 IPv6 网络需求。 本文档将详细介绍如何在 TDengine 的服务器端和客户端启用及使用 IPv6 功能。

### 支持范围
- 支持版本：TDengine Server 和 Client 版本 >= 3.3.7.0
- 支持组件：
  - taosd： TDengine 数据库服务端
  - taos： TDengine 命令行客户端 (CLI)
  - 各种连接器： 如 JDBC, Go, Python, C#, Rust 等（需使用支持 IPv6 的版本）
 - 网络环境： 纯 IPv6 环境或 IPv4/IPv6 双栈环境均支持。

 ### 服务器端 (taosd) 配置
  启用 IPv6 支持需要在 TDengine 服务端的配置文件 "taos.cfg" 中进行设置。
  1. 定位配置文件：默认路径通常为 "/etc/taos/taos.cfg"。
  2. 修改配置参数：找到并修改以下关键参数：
```
  //设置 TDengine 服务端在指定网络接口上监听 IPv6 地址值为该网络接口对应的 IPv6 地址，或 "::" 表示监听所有可用 IPv6 接口。
  例如： serverIPv6   ::
  firstEp  ipv6_address1:port
  secondEp ipv_address2:port
  fqdn     ipv6_address1
  enableIPv6 1
```
  3. 重启服务：修改配置后，需要重启 TDengine 服务以使配置生效。
 ```
  sudo systemctl restart taosd
  ```
 **重要说明**
  - 强烈建议使用 FQDN来配置 "firstEP" 和 "secondEP"，而不是直接使用 IP 地址。这样可以通过 DNS 解析自动选择 IIPv6 地址，提供更好的灵活性和兼容性。
 - 默认端口 6030 同样适用于 IPv6 连接。

### 客户端连接方式

客户端可以通过以下两种方式连接到支持 IPv6 的 TDengine 服务端：
1. 使用 FQDN（推荐）：在客户端的 "taos.cfg" 或连接字符串中，使用服务端的域名。只要该域名的 AAAA记录 指向正确的 IPv6 地址，客户端即可自动通过 IPv6 建立连接。示例
taos -h your_server_fqdn -P 6030
1. 直接使用 IPv6 地址：在连接时直接指定服务端的 IPv6 地址。请注意，在命令行或连接字符串中使用 IPv6 地址时，必须用中括号。
   taos -h [2001:db8::1] -P 6030
2. 验证连接
成功连接后，您可以在 TDengine 的日志里看到所有的连接都通过 ipv6 进行

### 注意事项与故障排除
- 网络基础设施： 确保您的服务器、客户端以及之间的路由器、防火墙等网络设备均已正确配置 IPv6，并允许在 "6030"（默认）端口上进行通信。
- DNS 配置： 如果使用 FQDN，请确保 DNS 服务器正确配置了该域名的 AAAA 记录（指向 IPv6 地址）而非 A 记录（指向 IPv4 地址）。
- 双栈环境优先级： 在同时支持 IPv4 和 IPv6 的双栈主机上，需要显式设置为FQDN是ipv6  
- 连接器版本： 请确保您使用的所有 TDengine 客户端连接器（如 JDBC, Go, Python 等）均为 3.3.7.0 或更高版本，以完全兼容 IPv6。
