---
title: 3.4.0.0 版本说明
sidebar_label: 3.4.0.0
description: 3.4.0.0 版本说明
---

## 特性

  1. 特性：Adapter 支持连接器类型版本信息
  2. 特性：C WebSocket 支持 TLS 扩展参数
  3. 特性：添加 taosAdapter 实例注册和查询
  4. 特性：支持解析 JSON 格式入库
  5. 特性：添加 Rust 连接器性能测试工具
  6. 特性：taosX 高可用，支持 Kafka 负载均衡
  7. 特性：TDgpt 支持 dtw、dtw_path、tlcc 等行相关性分析函数
  8. 特性：数据传输支持 SASL 机制与资源管控 [企业版]
  9. 特性：数据存储支持全量透明加密 [企业版]
 10. 特性：支持多因素认证及多种登录安全策略 [企业版]
 11. 特性：支持基于 RBAC 的权限架构 [企业版]
 12. 特性：支持分级审计与权限管控 [企业版]
 13. 特性：支持 SM4_ENCRYPT、SM4_DECRYPT、AES_ENCRYPT、AES_DECRYPT、MD5、SHA、SHA1、SHA2、MASK_FULL、MASK_PARTIAL、MASK_NONE、FROM_BASE64、TO_BASE64 函数
 14. 特性：流计算事件窗口触发支持子事件窗口
 15. 特性：Explorer 支持 OAuth 2.0/OIDC SSO
 16. 特性：taosAdapter 自定义 SQL 拦截规则
 17. 特性：添加身份鉴别函数

## 优化

  1. 优化：虚拟表支持的最大列数提升至 32767 列
  2. 优化：禁止在非聚合查询中对聚合函数进行排序
  3. 优化：状态窗口支持通过 zeroth_state 指定“零状态”，处于该状态的窗口将跳过计算与输出
  4. 优化：优化因日志文件目录无写权限导致 taosc 初始化失败时的错误信息
  5. 优化：流计算支持 interp 和 percentile 函数
  6. 优化：降低流计算触发数据与计算数据读取的资源消耗
  7. 优化：禁止在超级表的 state_window、count_window 与 event_window 中使用重复时间戳
  8. 优化：改进 taosmqtt 的退出处理逻辑，实现更优雅的停机和资源释放
  9. 优化：设定全局时区以降低并发查询与写入对时间转换相关的锁竞争
 10. 优化：窗口查询无需强制包含聚合函数，支持仅包含 _wstart、tbname 等伪列
 11. 优化：Linux 的 tar 安装包支持非 root 用户安装 TDengine TSDB，并可自定义安装路径
 12. 优化：修改标签列后，支持通过执行 RELOAD TOPIC 命令使数据订阅无需重建即生效
 13. 优化：支持在审计日志中记录查询、删除等操作
 14. 优化：show connections 命令新增客户端版本号字段
 15. 优化：TDgpt 的 ins_anodes_full 表新增状态及说明字段，实时反馈模型和算法状态
 16. 优化：增加 WIN_OPTIMIZE_BATCH 和 WIN_OPTIMIZE_SINGLE 两个 Hints 参数，用于提升虚拟表状态窗口的查询性能
 17. 优化：支持加密算法管理 [企业版]
 18. 优化：新增集群间通信的时钟检查机制
 19. 优化：新增 stmt2 对虚拟表查询的支持
 20. 优化：compact 命令支持 force 选项
 21. 优化：提升虚拟超级表聚合函数与选择函数的查询性能
 22. 优化：新增用户登录失败策略的支持能力
 23. 优化：优化 OPC-DA 采集和重连
 24. 优化：执行计划支持显示标签索引
 25. 优化：show vgroups 命令新增 is_ready 列
 26. 优化: stmt2 写入时新增布尔类型校验
 27. 优化：调整 stmt2 的日志，便于问题定位
 28. 优化：流计算的事件窗口仅在满足 true_for 条件时生成窗口开启通知
 29. 优化：优化 RPC 通信过程中读写锁的使用逻辑
 30. 优化：标签值无变化时更新子表标签操作立刻返回，避免频繁更新数据订阅的子表集合

## 修复

  1. 修复：流计算触发数据重算时未使用最新的 WAL 版本号，导致计算结果错误的问题
  2. 修复: order by abs (col) 中 col 出现在结果集而非表中时报错的问题
  3. 修复: TAG 列类型为 JSON 时，show create table 及 SELECT distinct tbname, json_tag_name 查询结果不符合预期的问题
  4. 修复：创建流语句解析输出表 tag 名时，误将反引号 (`) 纳入列名，与手动创建的表列名不匹配，导致报 “Out table tag type mismatch” 错误的问题
  5. 修复：嵌套查询的子查询在逆序排序、无排序、非时间主键排序时查询结果错误
  6. 修复：数据订阅与 tdb 修改操作同时执行引发的并发问题
  7. 修复：OPCUA 修改任务时，下载点位数据失效
  8. 修复：Grafana 12.x 支持导入告警面板
  9. 修复：系统表 ins_vgroups 的 cache_load 字段超过 int32 最大值时显示为负值的错误
 10. 修复：修复查询内存管控时潜在的 crash 隐患
 11. 修复：流计算使用 FILL_HISTORY 计算历史数据失败的问题
 12. 修复：流计算读取数据报错导致后续计算任务持续等待的问题
 13. 修复: JOIN 语法中子表时间主键为常量时无需再排序
 14. 修复：Kafka 提取或拆分配置中 depth 错误
 15. 修复：修复流计算结果表已存在时的 schema 与 tag 同步失败问题
 16. 修复：订阅 rawdata 数据失败问题
 17. 修复：Explorer 默认上报监控信息
 18. 修复: STMT2 写入自动建表时，表名过长导致 crash 的问题
 19. 修复: 查询虚拟超级表时触发 "Invalid value in client" 错误的问题
 20. 修复：KingHistorian 实时订阅不能订阅到数据
 21. 修复：使用 insert into stable语法写入数据时 tbname 处理逻辑存在错误的问题
 22. 修复：流计算通过 WebSocket 发送事件通知时存在概率性失败的问题
 23. 修复：部分 req_id 在其他组件中找不到的问题
 24. 修复：node.js 连接器默认不设置 timezone
 25. 修复：Explorer 登录错误
 26. 修复：修改全局变量时事务无法结束的问题
 27. 修复：OPC-UA 点位数多时数据写入延迟明显
 28. 修复：多个虚拟表的列使用同一原始表列导致的逻辑错误
 29. 修复: stmt 查询返回后回调函数未被调用导致 taosAdapter 崩溃的问题
 30. 修复：taosX 单条消息超过 100k 可能导致 SQL 超长
 31. 修复: insert into select 语句写入数据时，数据被写入错误的 dnode 且触发 “Vnode is closed” 错误的问题
 32. 修复: 流计算子查询中的关联查询包含 tag==%% n 条件会导致 coredump 的问题
 33. 修复：列拆分结果显示与预期不符
 34. 修复：C WebSocket taos_stmt2_get_fields 接口类型错误
 35. 修复：流计算中使用异常检测功能时调用了错误数据源
 36. 修复：通过 stmt2 执行查询语句时，若 dbname 和 tbname 均为`？`，导致查询进程卡住的问题
 37. 修复：InluxDB 无 tag 数据无法正常入库
 38. 修复: schemaless 写入场景下，并发修改内部表结构产生错误
 39. 修复: state window 结合 partition by 查询时返回结果错误的问题
 40. 修复：嵌套查询中外层 cols 函数执行出错的问题
 41. 修复：AVEVA Historian 数据写入任务配置页面异常
 42. 修复：虚拟表引用子表同名但不同类型数据列时查询会 crash 的问题
 43. 修复: 从 3.3.6.32-3.3.6.36 升级至 3.3.8.6-3.3.8.10 时出现的数据加载异常问题
 44. 修复: 开启缓存时，值为 NULL 的 decimal 类型数据落盘过程中偶发 crash 的问题
 45. 修复：客户端无法感知其他客户端对表结构的修改问题
 46. 修复：PI/PI Backfill 数据源包含句号时失败问题
 47. 修复：PI 创建任务报错 Not found model in DSN
 48. 修复：taosgen 导入特殊 csv 格式异常退出
 49. 修复: 流计算触发建表时因未携带写入数据导致 crash 的问题
