system sh/stop_dnodes.sh

system sh/deploy.sh -n dnode1 -i 1
system sh/cfg.sh -n dnode1 -c walLevel -v 1
system sh/cfg.sh -n dnode1 -c maxtablespervnode -v 4
system sh/exec.sh -n dnode1 -s start

sleep 100
sql connect

sql drop database if exists cdb
sql create database if not exists cdb 
sql use cdb
sql create table stb1 (ts timestamp, c1 int, c2 float, c3 bigint, c4 smallint, c5 tinyint, c6 double, c7 bool, c8 binary(10), c9 nchar(9)) TAGS(t1 int, t2 binary(10), t3 double)

sql create table tb1 using stb1 tags(1,'1',1.0)
sql create table tb2 using stb1 tags(2,'2',2.0)
sql create table tb3 using stb1 tags(3,'3',3.0)
sql create table tb4 using stb1 tags(4,'4',4.0)
sql create table tb5 using stb1 tags(5,'5',5.0)
sql create table tb6 using stb1 tags(6,'6',6.0)

sql insert into tb1 values ('2021-05-05 18:19:00',1,1.0,1,1,1,1.0,true ,'1','1')
sql insert into tb1 values ('2021-05-05 18:19:01',2,2.0,2,2,2,2.0,true ,'2','2')
sql insert into tb1 values ('2021-05-05 18:19:02',3,3.0,3,3,3,3.0,false,'3','3')
sql insert into tb1 values ('2021-05-05 18:19:03',4,4.0,4,4,4,4.0,false,'4','4')
sql insert into tb1 values ('2021-05-05 18:19:04',11,11.0,11,11,11,11.0,true ,'11','11')
sql insert into tb1 values ('2021-05-05 18:19:05',12,12.0,12,12,12,12.0,true ,'12','12')
sql insert into tb1 values ('2021-05-05 18:19:06',13,13.0,13,13,13,13.0,false,'13','13')
sql insert into tb1 values ('2021-05-05 18:19:07',14,14.0,14,14,14,14.0,false,'14','14')
sql insert into tb2 values ('2021-05-05 18:19:08',21,21.0,21,21,21,21.0,true ,'21','21')
sql insert into tb2 values ('2021-05-05 18:19:09',22,22.0,22,22,22,22.0,true ,'22','22')
sql insert into tb2 values ('2021-05-05 18:19:10',23,23.0,23,23,23,23.0,false,'23','23')
sql insert into tb2 values ('2021-05-05 18:19:11',24,24.0,24,24,24,24.0,false,'24','24')
sql insert into tb3 values ('2021-05-05 18:19:12',31,31.0,31,31,31,31.0,true ,'31','31')
sql insert into tb3 values ('2021-05-05 18:19:13',32,32.0,32,32,32,32.0,true ,'32','32')
sql insert into tb3 values ('2021-05-05 18:19:14',33,33.0,33,33,33,33.0,false,'33','33')
sql insert into tb3 values ('2021-05-05 18:19:15',34,34.0,34,34,34,34.0,false,'34','34')
sql insert into tb4 values ('2021-05-05 18:19:16',41,41.0,41,41,41,41.0,true ,'41','41')
sql insert into tb4 values ('2021-05-05 18:19:17',42,42.0,42,42,42,42.0,true ,'42','42')
sql insert into tb4 values ('2021-05-05 18:19:18',43,43.0,43,43,43,43.0,false,'43','43')
sql insert into tb4 values ('2021-05-05 18:19:19',44,44.0,44,44,44,44.0,false,'44','44')
sql insert into tb5 values ('2021-05-05 18:19:20',51,51.0,51,51,51,51.0,true ,'51','51')
sql insert into tb5 values ('2021-05-05 18:19:21',52,52.0,52,52,52,52.0,true ,'52','52')
sql insert into tb5 values ('2021-05-05 18:19:22',53,53.0,53,53,53,53.0,false,'53','53')
sql insert into tb5 values ('2021-05-05 18:19:23',54,54.0,54,54,54,54.0,false,'54','54')  
sql insert into tb6 values ('2021-05-05 18:19:24',61,61.0,61,61,61,61.0,true ,'61','61')
sql insert into tb6 values ('2021-05-05 18:19:25',62,62.0,62,62,62,62.0,true ,'62','62')
sql insert into tb6 values ('2021-05-05 18:19:26',63,63.0,63,63,63,63.0,false,'63','63')
sql insert into tb6 values ('2021-05-05 18:19:27',64,64.0,64,64,64,64.0,false,'64','64')
sql insert into tb6 values ('2021-05-05 18:19:28',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)

sql create table stb2 (ts timestamp, u1 int unsigned, u2 bigint unsigned, u3 smallint unsigned, u4 tinyint unsigned, ts2 timestamp) TAGS(t1 int unsigned, t2 bigint unsigned, t3 timestamp)

sql create table tb2_1 using stb2 tags(1,1,'2021-05-05 18:38:38')
sql create table tb2_2 using stb2 tags(2,2,'2021-05-05 18:58:58')

sql insert into tb2_1 values ('2021-05-05 18:19:00',1,2,3,4,'2021-05-05 18:28:01')
sql insert into tb2_1 values ('2021-05-05 18:19:01',5,6,7,8,'2021-05-05 18:28:02')
sql insert into tb2_1 values ('2021-05-05 18:19:02',2,2,3,4,'2021-05-05 18:28:03')
sql insert into tb2_1 values ('2021-05-05 18:19:03',5,6,7,8,'2021-05-05 18:28:04')
sql insert into tb2_1 values ('2021-05-05 18:19:04',3,2,3,4,'2021-05-05 18:28:05')
sql insert into tb2_1 values ('2021-05-05 18:19:05',5,6,7,8,'2021-05-05 18:28:06')
sql insert into tb2_1 values ('2021-05-05 18:19:06',4,2,3,4,'2021-05-05 18:28:07')
sql insert into tb2_1 values ('2021-05-05 18:19:07',5,6,7,8,'2021-05-05 18:28:08')
sql insert into tb2_1 values ('2021-05-05 18:19:08',5,2,3,4,'2021-05-05 18:28:09')
sql insert into tb2_1 values ('2021-05-05 18:19:09',5,6,7,8,'2021-05-05 18:28:10')
sql insert into tb2_1 values ('2021-05-05 18:19:10',6,2,3,4,'2021-05-05 18:28:11')
sql insert into tb2_2 values ('2021-05-05 18:19:11',5,6,7,8,'2021-05-05 18:28:12')
sql insert into tb2_2 values ('2021-05-05 18:19:12',7,2,3,4,'2021-05-05 18:28:13')
sql insert into tb2_2 values ('2021-05-05 18:19:13',5,6,7,8,'2021-05-05 18:28:14')
sql insert into tb2_2 values ('2021-05-05 18:19:14',8,2,3,4,'2021-05-05 18:28:15')
sql insert into tb2_2 values ('2021-05-05 18:19:15',5,6,7,8,'2021-05-05 18:28:16')

sleep 100

print "column test"
sql select * from stb1
if $rows != 29 then
  return -1
endi
sql select * from stb1 where c1 > 0
if $rows != 28 then
  return -1
endi

sql_error select * from stb1 where c8 > 0
sql_error select * from stb1 where c2 in (0,1);
sql_error select * from stb1 where c6 in (0,2,3,1);
sql_error select * from stb1 where c7 in (0,2,3,1);
sql_error select * from stb1 where c8 in (true);
sql_error select * from stb1 where c8 in (1,2);
sql_error select * from stb1 where t3 in (3);
sql_error select * from stb1 where t2 in (3.0);
sql_error select ts,c1,c7 from stb1 where c7 > false
sql_error select * from stb1 where c1 > NULL;
sql_error select * from stb1 where c1 = NULL;
sql_error select * from stb1 where c1 LIKE '%1';

sql select * from stb1 where c2 > 3.0 or c2 < 60;
if $rows != 28 then
  return -1
endi
sql select * from stb1 where c2 > 3.0 or c2 < 60 and c2 > 50;
if $rows != 25 then
  return -1
endi
sql select * from stb1 where (c2 > 3.0 or c2 < 60) and c2 > 50;
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c2 > 3.0 or c2 < 60) and c2 > 50 and (c2 != 53 and c2 != 63);
if $rows != 6 then
  return -1
endi

sql select * from stb1 where (c2 > 3.0 or c2 < 60) and c2 > 50 and (c2 != 53 or c2 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c3 > 3.0 or c3 < 60) and c3 > 50 and (c3 != 53 or c3 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c4 > 3.0 or c4 < 60) and c4 > 50 and (c4 != 53 or c4 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c5 > 3.0 or c5 < 60) and c5 > 50 and (c5 != 53 or c5 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c6 > 3.0 or c6 < 60) and c6 > 50 and (c6 != 53 or c6 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where c8 = '51';
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi

sql select * from stb1 where c8 != '51';
if $rows != 27 then
  return -1
endi

sql select * from stb1 where c8 = '51' and c8 != '51';
if $rows != 0 then
  return -1
endi

sql select * from stb1 where c8 = '51' or c8 != '51';
if $rows != 28 then
  return -1
endi

sql select * from stb1 where c9 = '51';
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi

sql select * from stb1 where c9 != '51';
if $rows != 27 then
  return -1
endi

sql select * from stb1 where c9 = '51' and c9 != '51';
if $rows != 0 then
  return -1
endi

sql select * from stb1 where c9 = '51' or c9 != '51';
if $rows != 28 then
  return -1
endi

sql select ts,c1,c7 from stb1 where c7 = false
if $rows != 14 then
  return -1
endi
if $data00 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data01 != 3 then
  return -1
endi
if $data02 != 0 then
  return -1
endi
if $data10 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data11 != 4 then
  return -1
endi
if $data12 != 0 then
  return -1
endi
if $data20 != @21-05-05 18:19:06.000@ then
  return -1
endi
if $data21 != 13 then
  return -1
endi
if $data22 != 0 then
  return -1
endi
if $data30 != @21-05-05 18:19:07.000@ then
  return -1
endi
if $data31 != 14 then
  return -1
endi
if $data32 != 0 then
  return -1
endi


sql select ts,c1,c7 from stb1 where c7 = true
if $rows != 14 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
if $data02 != 1 then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data11 != 2 then
  return -1
endi
if $data12 != 1 then
  return -1
endi
if $data20 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data21 != 11 then
  return -1
endi
if $data22 != 1 then
  return -1
endi
if $data30 != @21-05-05 18:19:05.000@ then
  return -1
endi
if $data31 != 12 then
  return -1
endi
if $data32 != 1 then
  return -1
endi


sql select * from stb1 where c8 = '51' or c8 = '4'
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data01 != 4 then
  return -1
endi
if $data10 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data11 != 51 then
  return -1
endi


sql select * from stb1 where c1 > 50 and c1 > 53
if $rows != 5 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 < 52
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 < 51
if $rows != 28 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 < 51
if $rows != 25 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 and c1 < 51
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 > 51 and c1 > 54
if $rows != 4 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 > 51 or c1 > 54
if $rows != 5 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 < 51 or c1 > 54
if $rows != 4 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 < 51 and c1 > 54
if $rows != 5 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 > 51 and c1 < 54
if $rows != 7 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 and c1 < 51 and c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 < 51 or c1 > 54
if $rows != 25 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 and c1 < 51 or c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 < 51 and c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 > 51 and c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 < 51 or c1 > 54
if $rows != 28 then
  return -1
endi

sql select * from stb1 where (c1 > 50 and c1 > 53) and c1 < 52
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 and c1 < 52)
if $rows != 0 then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) or c1 < 51
if $rows != 28 then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51)
if $rows != 28 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) or c1 < 51
if $rows != 25 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51)
if $rows != 5 then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) and c1 < 51
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51)
if $rows != 8 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) and (c1 < 51 and c1 > 54)
if $rows != 0 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53 and c1 < 51) and c1 > 54
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 and c1 < 51) and c1 > 54
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 and c1 < 51 or c1 > 54)
if $rows != 4 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) or (c1 < 51 and c1 > 54)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51 and c1 > 54)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) and (c1 < 51 and c1 > 54)
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51 and c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 and c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51) and c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) or (c1 < 51 or c1 > 54)
if $rows != 25 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51 or c1 > 54)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53 or c1 < 51) or c1 > 54
if $rows != 25 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51) or c1 > 54
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) and (c1 < 51 or c1 > 54)
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51 or c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 and c1 < 51) or c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51) or c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) or (c1 < 51 and c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51 and c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51) and c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c1 > 62 or (c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) or (c1 < 51 or c1 > 54)
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51 or c1 > 54)
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 or c1 < 51) or c1 > 54
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51) or c1 > 54
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select ts,c1 from stb1 where (c1 > 60 or c1 < 10 or (c1 > 20 and c1 < 30)) and ts > '2021-05-05 18:19:00.000' and ts < '2021-05-05 18:19:25.000' and c1 != 21 and c1 != 22
if $rows != 6 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi
if $data30 != @21-05-05 18:19:10.000@ then
  return -1
endi
if $data31 != 23 then
  return -1
endi
if $data40 != @21-05-05 18:19:11.000@ then
  return -1
endi
if $data41 != 24 then
  return -1
endi
if $data50 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data51 != 61 then
  return -1
endi


sql select * from stb1 where (c1 > 40 or c1 < 20) and (c2 < 53 or c2 >= 63) and c3 > 1 and c3 < 5
if $rows != 3 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi

sql select * from stb1 where (c1 > 52 or c1 < 10) and (c2 > 1 and c2 < 61)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi
if $data30 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data31 != 53 then
  return -1
endi
if $data40 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data41 != 54 then
  return -1
endi

sql select * from stb1 where (c3 > 52 or c3 < 10) and (c4 > 1 and c4 < 61) and (c5 = 2 or c6 = 3.0 or c6 = 4.0 or c6 = 53);
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi
if $data30 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data31 != 53 then
  return -1
endi

sql select * from stb1 where c1 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c2 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c3 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c4 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c5 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c6 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c7 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c8 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c9 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi

sql select * from stb1 where c1 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c2 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c3 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c4 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c5 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c6 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c7 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c8 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c9 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c1 > 63 or c1 is null;
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:27.000@ then
  return -1
endi
if $data01 != 64 then
  return -1
endi
if $data10 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data11 != NULL then
  return -1
endi
sql select * from stb1 where c1 is null and c2 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c1 is null and c2 is null and c3 is not null;
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 is null and c2 is null and ts > '2021-05-05 18:19:00.000' and ts < '2021-05-05 18:19:28.000';
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 = 3 or c1 = 5 or c1 >= 44 and c1 <= 52;
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:19.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:21.000@ then
  return -1
endi

sql select * from stb1 where c8 LIKE '%1';
if $rows != 7 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:08.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:12.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:16.000@ then
  return -1
endi
if $data50 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data60 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c9 LIKE '%1';
if $rows != 7 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:08.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:12.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:16.000@ then
  return -1
endi
if $data50 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data60 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c8 LIKE '%1' or c9 like '_2') and (c5 > 50 or c6 > 30) and ( c8 like '3_' or c9 like '4_') and (c4 <= 31 or c4 >= 42);
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:12.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:17.000@ then
  return -1
endi

sql select * from stb1 where c1 in (1,3);
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi

sql select * from stb1 where c3 in (11,22);
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:09.000@ then
  return -1
endi

sql select * from stb1 where c4 in (3,33);
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:14.000@ then
  return -1
endi

sql select * from stb1 where c5 in (3,33) and c8 in ('22','55');
if $rows != 0 then
  return -1
endi

sql select * from stb1 where c5 in (3,33) and c8 in ('33','54');
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:14.000@ then
  return -1
endi

sql select * from stb1 where c5 in (3,33) or c8 in ('22','54');
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:09.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:14.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi

sql select * from stb1 where (c9 in ('3','1','2','4','5') or c9 in ('33','11','22','44','55')) and c9 in ('1','3','11','13');
if $rows != 3 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:04.000@ then
  return -1
endi

sql select * from stb2 where (u1 in (1) or u2 in (5,6)) and (u3 in (3,6) or u4 in (7,8)) and ts2 in ('2021-05-05 18:28:02.000','2021-05-05 18:28:15.000','2021-05-05 18:28:01.000');
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi

sql select * from stb2 where u2 in (2) and u3 in (1,2,3) and u4 in (1,2,4,5) and u1 > 3 and u1 < 6 and u1 != 4;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:08.000@ then
  return -1
endi

print "ts test"
sql_error select ts,c1,c7 from stb1 where ts != '2021-05-05 18:19:27'
sql_error select ts,c1,c7 from stb1 where ts > '2021-05-05 18:19:03.000' or ts < '2021-05-05 18:19:02.000';
sql_error select ts,c1,c7 from stb1 where ts > '2021-05-05 18:19:03.000' and ts > '2021-05-05 18:19:20.000' and ts != '2021-05-05 18:19:22.000';

print "tbname test"

print "tag test"
sql select * from stb1 where t1 in (1,2) and t1 in (2,3);
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:08.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:09.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:10.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:11.000@ then
  return -1
endi

sql select * from stb2 where t1 in (1,2) and t2 in (2) and t3 in ('2021-05-05 18:58:57.000');
if $rows != 0 then
  return -1
endi

print "join test"




print "column&ts test"
sql_error select count(*) from stb1 where ts > 0 or c1 > 0;

print "column&tbname test"
sql_error select count(*) from stb1 where tbname like 'tb%' or c1 > 0;


print "column&tag test"
sql_error select * from stb1 where t1 > 0 or c1 > 0
sql_error select * from stb1 where c1 > 0 or t1 > 0
sql_error select * from stb1 where t1 > 0 or c1 > 0 or t1 > 1
sql_error select * from stb1 where c1 > 0 or t1 > 0 or c1 > 1
sql_error select * from stb1 where t1 > 0 and c1 > 0 or t1 > 1
sql_error select * from stb1 where c1 > 0 or t1 > 0 and c1 > 1
sql_error select * from stb1 where c1 > 0 or t1 > 0 and c1 > 1
sql_error select * from stb1 where t1 > 0 or t1 > 0 and c1 > 1
sql_error select * from stb1 where (c1 > 0 and t1 > 0 ) or (t1 > 1 and c1 > 3)
sql_error select * from stb1 where (c1 > 0 and t1 > 0 ) or t1 > 1


sql select * from stb1 where c1 < 63 and t1 > 5
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
sql select * from stb1 where t1 > 3 and t1 < 5 and c1 != 42 and c1 != 44;
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:16.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:18.000@ then
  return -1
endi
sql select * from stb1 where t1 > 1 and c1 > 21 and t1 < 3 and c1 < 24 and t1 != 3 and c1 != 23;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:09.000@ then
  return -1
endi
sql select * from stb1 where c1 > 1 and (t1 > 3 or t1 < 2) and (c2 > 2 and c2 < 62 and t1 != 4) and (t1 > 2 and t1 < 6) and c7 = true and c8 like '%2';
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:21.000@ then
  return -1
endi


print "column&join test"

print "ts&tbname test"
sql_error select count(*) from stb1 where ts > 0 or tbname like 'tb%';

print "ts&tag test"
sql_error select count(*) from stb1 where ts > 0 or t1 > 0;

sql select * from stb2 where t1!=1 and t2=2 and t3 in ('2021-05-05 18:58:58.000') and ts < '2021-05-05 18:19:13.000';
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:11.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:12.000@ then
  return -1
endi
print "ts&join test"

print "tbname&tag test"

print "tbname&join test"

print "tag&join test"





print "column&ts&tbname test"
sql_error select count(*) from stb1 where tbname like 'tb%' or c1 > 0 or ts > 0;

print "column&ts&tag test"
sql_error select count(*) from stb1 where t1 > 0 or c1 > 0 or ts > 0;
sql_error select count(*) from stb1 where c1 > 0 or t1 > 0 or ts > 0;

sql select * from stb1 where (t1 > 0 or t1 > 2 ) and ts > '2021-05-05 18:19:10.000' and (c1 > 1 or c1 > 3) and (c6 > 40 or c6 < 30) and (c8 like '%3' or c8 like '_4') and (c9 like '1%' or c9 like '6%' or (c9 like '%3' and c9 != '23')) and ts > '2021-05-05 18:19:22.000' and ts <= '2021-05-05 18:19:26.000';
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:26.000@ then
  return -1
endi
sql select * from stb1 where ts > '2021-05-05 18:19:00.000' and c1 > 2 and t1 != 1 and c2 >= 23 and t2 >= 3 and c3 < 63 and c7 = false and t3 > 3 and t3 < 6 and c8 like '4%' and ts < '2021-05-05 18:19:19.000' and c2 > 40 and c3 != 42;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:18.000@ then
  return -1
endi
print "column&ts&join test"

print "column&tbname&tag test"
sql_error select count(*) from stb1 where c1 > 0 or tbname in ('tb1') or t1 > 0;

print "column&tbname&join test"
print "column&tag&join test"
print "ts&tbname&tag test"
sql_error select count(*) from stb1 where ts > 0 or tbname in ('tb1') or t1 > 0;

print "ts&tbname&join test"
print "ts&tag&join test"
print "tbname&tag&join test"




print "column&ts&tbname&tag test"
sql_error select * from stb1 where (tbname like 'tb%' or ts > '2021-05-05 18:19:01.000') and (t1 > 5 or t1 < 4) and c1 > 0;
sql_error select * from stb1 where (ts > '2021-05-05 18:19:01.000') and (ts > '2021-05-05 18:19:02.000' or t1 > 3) and (t1 > 5 or t1 < 4) and c1 > 0;
sql_error select ts,c1,c7 from stb1 where ts > '2021-05-05 18:19:03.000' or ts > '2021-05-05 18:19:20.000' and col > 0 and t1 > 0;


print "column&ts&tbname&join test"
print "column&ts&tag&join test"
print "column&tbname&tag&join test"
print "ts&tbname&tag&join test"


print "column&ts&tbname&tag&join test"

#system sh/exec.sh -n dnode1 -s stop -x SIGINT
