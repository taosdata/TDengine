system sh/stop_dnodes.sh
system sh/deploy.sh -n dnode1 -i 1
system sh/exec.sh -n dnode1 -s start
sql connect

print =============== create database
sql create database test

print =============== create super table and child table
sql use test

sql CREATE STABLE st (ts timestamp, a int, b int, c int) TAGS (ta varchar(12));

sql insert into t1 using st tags('1') values('2025-03-06 11:17:29.202', 1, 1, 1) ('2025-03-07 11:17:30.361', 2, 2, 2)
sql insert into t2 using st tags('2') values('2025-03-06 11:17:29.202', 4, 4, 4) ('2025-03-07 11:17:30.361', 9, 9, 9)

sql select ts, count(*) from (select _wstart ts, timetruncate(ts, 1d, 1) dt, max(a)/10 from st partition by tbname interval(1s) order by dt) partition by ts order by ts;

print $rows $data00 $data01
print $rows $data10 $data11

if $rows != 2 then
  return -1
endi

if $data00 != @25-03-06 11:17:29.000@ then
  print expect 25-03-06 11:17:29.000, actual $data00
  return -1
endi

if $data01 != 2 then
  print expect 2, actual $data01
  return -1
endi

if $data10 != @25-03-07 11:17:30.000@ then
  print expect  25-03-07 11:17:30.000, actual $data10
  return -1
endi

if $data11 != 2 then
  print expect 2, actual $data11
  return -1
endi

system sh/exec.sh -n dnode1 -s stop -x SIGINT