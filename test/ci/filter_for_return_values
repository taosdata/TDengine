match callExpr(
  isExpansionInMainFile(),
  hasParent(anyOf(
    compoundStmt(),
    doStmt(hasCondition(expr().bind("cond")))
  )),
  unless(hasType(voidType())),
  unless(hasAncestor(functionDecl(anyOf(
    hasName("tDestroyTSmaWrapper"),
    hasName("tFreeTSmaWrapper")
  )))),
  unless(anyOf(
    #log and print functions
    callee(functionDecl(matchesName(".*(Log|Print|Debug|Trace|Warn|Error|Info|Fatal).*"))),
    # memory functions
    callee(functionDecl(matchesName(".*memcpy.*"))),
    callee(functionDecl(matchesName(".*strcpy.*"))),
    callee(functionDecl(matchesName(".*strcat.*"))),
    callee(functionDecl(matchesName(".*strncpy.*"))),
    callee(functionDecl(matchesName(".*memset.*"))),
    callee(functionDecl(matchesName(".*memmove.*"))),
    # string functions
    callee(functionDecl(matchesName(".*sprintf.*"))),
    callee(functionDecl(matchesName(".*snprintf.*"))),
    callee(functionDecl(matchesName(".*scanf.*"))),
    callee(functionDecl(matchesName(".*sscanf.*"))),
    callee(functionDecl(matchesName(".*printf.*"))),
    callee(functionDecl(matchesName(".*printRow.*"))),
    callee(functionDecl(matchesName(".*puts.*"))),
    callee(functionDecl(matchesName(".*sleep.*"))),
    callee(functionDecl(matchesName(".*printResult.*"))),
    callee(functionDecl(matchesName(".*getchar.*"))),
    callee(functionDecl(matchesName(".*taos_print_row.*"))),
    callee(functionDecl(matchesName(".*fprintf.*"))),
    callee(functionDecl(matchesName(".*taosMemoryFreeClear.*"))),
    callee(functionDecl(matchesName(".*taosMemoryFree.*"))),
    callee(functionDecl(matchesName(".*taosArrayDestroy.*"))),
    callee(functionDecl(matchesName(".*taosArrayDestroyEx.*"))),
    callee(functionDecl(matchesName(".*.*setThreadName.*"))),
    callee(functionDecl(matchesName(".*pthread_setname_np.*")))
  ))
)