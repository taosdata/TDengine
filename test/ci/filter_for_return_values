match callExpr(
  hasParent(anyOf(
    compoundStmt(),
    doStmt(hasCondition(expr().bind("cond")))
  )),
  unless(hasType(voidType())),
  unless(hasAncestor(functionDecl(anyOf(
    hasName("tDestroyTSmaWrapper"),
    hasName("tFreeTSmaWrapper")
  )))),
  unless(anyOf(
    callee(functionDecl(hasName("memcpy"))),
    callee(functionDecl(hasName("strcpy"))),
    callee(functionDecl(hasName("strcat"))),
    callee(functionDecl(hasName("strncpy"))),
    callee(functionDecl(hasName("memset"))),
    callee(functionDecl(hasName("memmove"))),
    callee(functionDecl(hasName("sprintf"))),
    callee(functionDecl(hasName("snprintf"))),
    callee(functionDecl(hasName("scanf"))),
    callee(functionDecl(hasName("sscanf"))),
    callee(functionDecl(hasName("printf"))),
    callee(functionDecl(hasName("printRow"))),
    callee(functionDecl(hasName("puts"))),
    callee(functionDecl(hasName("sleep"))),
    callee(functionDecl(hasName("printResult"))),
    callee(functionDecl(hasName("getchar"))),
    callee(functionDecl(hasName("taos_print_row"))),
    callee(functionDecl(hasName("fprintf"))),
    callee(functionDecl(hasName("taosMemoryFreeClear"))),
    callee(functionDecl(hasName("taosMemoryFree"))),
    callee(functionDecl(hasName("taosArrayDestroy"))),
    callee(functionDecl(hasName("taosArrayDestroyEx"))),
    callee(functionDecl(hasName("TAOS_CHECK_RETURN")))
  ))
)