
taos> set max_binary_display_width 300;
taos> explain verbose true select * from test_vtable_select.vtb_virtual_ntb_full;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Projection (columns=16 width=299 input_order=asc )                                                                                                                                                                                                                                                        |
       Output: columns=16 width=299                                                                                                                                                                                                                                                                           |
       Output: Ignore Group Id: true                                                                                                                                                                                                                                                                          |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                                |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select count(*) from test_vtable_select.vtb_virtual_ntb_full where _c0 >= "2020-01-01 00:00:00" and _c0 < "2020-01-02 00:00:00";
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Aggregate (functions=1 width=8 input_order=asc )                                                                                                                                                                                                                                                          |
       Output: columns=1 width=8 blocking=1                                                                                                                                                                                                                                                                   |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Virtual Table Scan on vtb_virtual_ntb_full (columns=1 width=8)                                                                                                                                                                                                                                         |
          Output: columns=1 width=8                                                                                                                                                                                                                                                                           |
          Filter: ((`test_vtable_select`.`vtb_virtual_ntb_full`.`_c0` >= 1577808000000) AND (`test_vtable_select`.`vtb_virtual_ntb_full`.`_c0` < 1577894400000))                                                                                                                                              |
       -> Data Exchange 1:1 (width=299)                                                                                                                                                                                                                                                                       |
             Output: columns=16 width=299                                                                                                                                                                                                                                                                     |
          -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                          |
                Output: columns=16 width=299                                                                                                                                                                                                                                                                  |
                Time Range: [1577808000000, 1577894399999]                                                                                                                                                                                                                                                    |

taos> explain verbose true select * from test_vtable_select.vtb_virtual_ntb_full where _c0 >= "2020-01-01 00:00:00" and _c0 < "2020-01-02 00:00:00" partition by tbname;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Partition on Column tbname (width=299)                                                                                                                                                                                                                                                                    |
       Output: columns=16 width=299                                                                                                                                                                                                                                                                           |
       Partition Key: partitions=1                                                                                                                                                                                                                                                                            |
    -> Virtual Table Scan on vtb_virtual_ntb_full (columns=16 pseudo_columns=1 width=571)                                                                                                                                                                                                                     |
          Output: columns=17 width=571                                                                                                                                                                                                                                                                        |
          Filter: ((`test_vtable_select`.`vtb_virtual_ntb_full`.`_c0` >= 1577808000000) AND (`test_vtable_select`.`vtb_virtual_ntb_full`.`_c0` < 1577894400000))                                                                                                                                              |
       -> Data Exchange 1:1 (width=299)                                                                                                                                                                                                                                                                       |
             Output: columns=16 width=299                                                                                                                                                                                                                                                                     |
          -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                          |
                Output: columns=16 width=299                                                                                                                                                                                                                                                                  |
                Time Range: [1577808000000, 1577894399999]                                                                                                                                                                                                                                                    |
       -> Data Exchange 1:1 (width=272)                                                                                                                                                                                                                                                                       |
             Output: columns=1 width=272                                                                                                                                                                                                                                                                      |
          -> Tag Scan on vtb_virtual_ntb_full (pseudo_columns=1 width=272)                                                                                                                                                                                                                                    |
                Output: columns=1 width=272                                                                                                                                                                                                                                                                   |

taos> explain verbose true select count(*) from test_vtable_select.vtb_virtual_ntb_full;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Aggregate (functions=1 width=8 input_order=asc )                                                                                                                                                                                                                                                          |
       Output: columns=1 width=8 blocking=1                                                                                                                                                                                                                                                                   |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=no)                                                                                                                                                                                                  |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select first(*) from test_vtable_select.vtb_virtual_ntb_full;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Aggregate (functions=16 width=299 input_order=asc )                                                                                                                                                                                                                                                       |
       Output: columns=16 width=299 blocking=1                                                                                                                                                                                                                                                                |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                                |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select last(*) from test_vtable_select.vtb_virtual_ntb_full;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Aggregate (functions=16 width=299 input_order=desc )                                                                                                                                                                                                                                                      |
       Output: columns=16 width=299 blocking=1                                                                                                                                                                                                                                                                |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|0 desc|1] mode=ts_order data_load=data)                                                                                                                                                                                                |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select avg(u_tinyint_col), avg(u_smallint_col), avg(u_int_col) from test_vtable_select.vtb_virtual_ntb_full;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Aggregate (functions=3 width=24 input_order=asc )                                                                                                                                                                                                                                                         |
       Output: columns=3 width=24 blocking=1                                                                                                                                                                                                                                                                  |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=4 width=15 order=[asc|1 desc|0] mode=ts_order data_load=sma)                                                                                                                                                                                                   |
          Output: columns=4 width=15                                                                                                                                                                                                                                                                          |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select * from test_vtable_select.vtb_virtual_ntb_full partition by tbname;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Partition on Column tbname (width=299)                                                                                                                                                                                                                                                                    |
       Output: columns=16 width=299                                                                                                                                                                                                                                                                           |
       Partition Key: partitions=1                                                                                                                                                                                                                                                                            |
    -> Virtual Table Scan on vtb_virtual_ntb_full (columns=16 pseudo_columns=1 width=571)                                                                                                                                                                                                                     |
          Output: columns=17 width=571                                                                                                                                                                                                                                                                        |
       -> Data Exchange 1:1 (width=299)                                                                                                                                                                                                                                                                       |
             Output: columns=16 width=299                                                                                                                                                                                                                                                                     |
          -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                          |
                Output: columns=16 width=299                                                                                                                                                                                                                                                                  |
                Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                       |
       -> Data Exchange 1:1 (width=272)                                                                                                                                                                                                                                                                       |
             Output: columns=1 width=272                                                                                                                                                                                                                                                                      |
          -> Tag Scan on vtb_virtual_ntb_full (pseudo_columns=1 width=272)                                                                                                                                                                                                                                    |
                Output: columns=1 width=272                                                                                                                                                                                                                                                                   |

taos> explain verbose true select * from test_vtable_select.vtb_virtual_ntb_full partition by u_tinyint_col;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Partition on Column u_tinyint_col (width=299)                                                                                                                                                                                                                                                             |
       Output: columns=16 width=299                                                                                                                                                                                                                                                                           |
       Partition Key: partitions=1                                                                                                                                                                                                                                                                            |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                                |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select avg(u_tinyint_col), avg(u_smallint_col), avg(u_int_col) from test_vtable_select.vtb_virtual_ntb_full interval(1s);
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Interval on Column ts (functions=3 width=24 input_order=asc output_order=asc )                                                                                                                                                                                                                            |
       Output: columns=3 width=24                                                                                                                                                                                                                                                                             |
       Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                                |
       Time Window: interval=1s offset=0a sliding=1s                                                                                                                                                                                                                                                          |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=4 width=15 order=[asc|1 desc|0] mode=ts_order data_load=sma)                                                                                                                                                                                                   |
          Output: columns=4 width=15                                                                                                                                                                                                                                                                          |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select avg(u_tinyint_col), avg(u_smallint_col), avg(u_int_col) from test_vtable_select.vtb_virtual_ntb_full state_window(bool_col);
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> StateWindow on Column bool_col (functions=3 width=24)                                                                                                                                                                                                                                                     |
       Output: columns=3 width=24                                                                                                                                                                                                                                                                             |
       Output: columns=3 width=24                                                                                                                                                                                                                                                                             |
    -> Table Scan on vtb_org_normal_0 (columns=5 width=16 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                                  |
          Output: columns=5 width=16                                                                                                                                                                                                                                                                          |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select _wstart, _wend, first(*), last(*), count(*) from test_vtable_select.vtb_virtual_ntb_full event_window start with u_tinyint_col > 50 end with u_tinyint_col > 200;
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Event (functions=35 width=622)                                                                                                                                                                                                                                                                            |
       Start Cond: (`test_vtable_select`.`vtb_virtual_ntb_full`.`u_tinyint_col` > 50)                                                                                                                                                                                                                         |
       End Cond: (`test_vtable_select`.`vtb_virtual_ntb_full`.`u_tinyint_col` > 200)                                                                                                                                                                                                                          |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                                |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select _wstart, _wend, first(*), last(*), count(*) from test_vtable_select.vtb_virtual_ntb_full session(ts, 1a);
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Session (functions=35 width=622)                                                                                                                                                                                                                                                                          |
       Output: columns=35 width=622                                                                                                                                                                                                                                                                           |
       Window: gap=1                                                                                                                                                                                                                                                                                          |
    -> Table Scan on vtb_org_normal_0 (columns=16 width=299 order=[asc|1 desc|0] mode=ts_order data_load=data)                                                                                                                                                                                                |
          Output: columns=16 width=299                                                                                                                                                                                                                                                                        |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

taos> explain verbose true select cols(last(u_tinyint_col), u_tinyint_col as `u_tinyint_col`,  _c0 as `ts`), cols(last(u_smallint_col), u_smallint_col as `u_smallint_col`, _c0 as `ts`), cols(last(u_int_col), u_int_col as `u_int_col`, _c0 as `ts`) from test_vtable_select.vtb_virtual_ntb_full
                                                                                                                                                  QUERY_PLAN                                                                                                                                                  |
===============================================================================================================================================================================================================================================================================================================
 -> Aggregate (functions=9 width=38 input_order=desc )                                                                                                                                                                                                                                                        |
       Output: columns=6 width=31 blocking=1                                                                                                                                                                                                                                                                  |
       Merge ResBlocks: True                                                                                                                                                                                                                                                                                  |
    -> Table Scan on vtb_org_normal_0 (columns=4 width=15 order=[asc|0 desc|1] mode=ts_order data_load=data)                                                                                                                                                                                                  |
          Output: columns=4 width=15                                                                                                                                                                                                                                                                          |
          Time Range: [-9223372036854775808, 9223372036854775807]                                                                                                                                                                                                                                             |

