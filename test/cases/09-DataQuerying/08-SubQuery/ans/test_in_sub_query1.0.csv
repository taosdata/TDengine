
taos> use db1;
Database changed.

taos> select 1 IN (select f1 from tb1) from tb1 order by 1;
 1 in (select f1 from tb1) |
============================
 true                      |

taos> select 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 in (select f1 from tb1 limit 0) |
====================================
 false                             |

taos> select 1 IN (select null from tb1) from tb1 order by 1;
 1 in (select null from tb1) |
==============================
 NULL                        |

taos> select tags 1 IN (select f1 from tb1) from tb1 order by 1;
 1 in (select f1 from tb1) |
============================
 true                      |

taos> select tags 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 in (select f1 from tb1 limit 0) |
====================================
 false                             |

taos> select tags 1 IN (select null from tb1) from tb1 order by 1;
 1 in (select null from tb1) |
==============================
 NULL                        |

taos> select distinct 1 IN (select f1 from tb1) from tb1 order by 1;
 1 in (select f1 from tb1) |
============================
 true                      |

taos> select distinct 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 in (select f1 from tb1 limit 0) |
====================================
 false                             |

taos> select distinct 1 IN (select null from tb1) from tb1 order by 1;
 1 in (select null from tb1) |
==============================
 NULL                        |

taos> select 1 IN (select f1 from tb1), 1 IN (select f1 from tb1) from tb1 order by 1;
 1 in (select f1 from tb1) | 1 in (select f1 from tb1) |
========================================================
 true                      | true                      |

taos> select 1 IN (select f1 from tb1 limit 0), 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 in (select f1 from tb1 limit 0) | 1 in (select f1 from tb1 limit 0) |
========================================================================
 false                             | false                             |

taos> select 1 IN (select null from tb1), 1 IN (select null from tb1) from tb1 order by 1;
 1 in (select null from tb1) | 1 in (select null from tb1) |
============================================================
 NULL                        | NULL                        |

taos> select 1 IN (select f1 from tb1), * from tb1 order by ts, f1;
 1 in (select f1 from tb1) |           ts            |     f1      |     f2      |
==================================================================================
 true                      | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 1 IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 1 in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
==========================================================================================
 false                             | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 1 IN (select null from tb1), * from tb1 order by ts, f1;
 1 in (select null from tb1) |           ts            |     f1      |     f2      |
====================================================================================
 NULL                        | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when 1 IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 1 in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
================================================================================
                                                     1 |                     1 |

taos> select case when 1 IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 1 in (select f1 from tb1 limit 0) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     1 |

taos> select case when 1 IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 1 in (select null from tb1) then 1 else 2 end |        sum(f1)        |
==================================================================================
                                                       2 |                     1 |

taos> select case when f1 = 1 then 1 else 1 IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 1 in (select f1 from tb1) end |        sum(f1)        |
=====================================================================================
                                                          1 |                     1 |

taos> select case when f1 = 1 then 1 else 1 IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 1 in (select f1 from tb1 limit 0) e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 1 IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 1 in (select null from tb1) end |        sum(f1)        |
=======================================================================================
                                                            1 |                     1 |

taos> select _wstart, 1 IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 1 in (select f1 from tb1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 | true                      |                         1 |

taos> select _wstart, 1 IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | 1 in (select f1 from tb1 limit 0) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | false                             |                         1 |

taos> select _wstart, 1 IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 1 in (select null from tb1) |          avg(f1)          |
====================================================================================
 2025-12-01 00:00:00.000 | NULL                        |                         1 |

taos> select case 1 IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 1 in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       1 |                         1 |

taos> select case 1 IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 1 in (select f1 from tb1 limit 0) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |                         1 |

taos> select case 1 IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 1 in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
========================================================================================
                                                         2 |                         1 |

taos> select sum(case when 1 IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 1 in (select f1 from tb1) then 1 else 2 end) |
=============================================================
                                                          1 |

taos> select sum(case when 1 IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 1 in (select f1 from tb1 limit 0) then 1 else 2 en |
===================================================================
                                                                2 |

taos> select sum(case when 1 IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 1 in (select null from tb1) then 1 else 2 end) |
===============================================================
                                                            2 |

taos> select f1, 1 IN (select f1 from tb1) from tb1 group by f1;
     f1      | 1 in (select f1 from tb1) |
==========================================
           1 | true                      |

taos> select f1, 1 IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | 1 in (select f1 from tb1 limit 0) |
==================================================
           1 | false                             |

taos> select f1, 1 IN (select null from tb1) from tb1 group by f1;
     f1      | 1 in (select null from tb1) |
============================================
           1 | NULL                        |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 1 IN (select f1 from tb1) order by b.f1;
     f1      | (select f1 from tb1) + 1  |
==========================================
           1 |                         2 |

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and 1 IN (select f1 from tb1 limit 0) order by b.f1;

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 1 IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 1 IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 1 IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 1 IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where 1 IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where 1 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where 1 IN (select null from tb1) order by f1;

taos> select f1, 1 IN (select f1 from tb1) from tb1 where f1 > 0 and 1 IN (select f1 from tb1) order by f1;
     f1      | 1 in (select f1 from tb1) |
==========================================
           1 | true                      |

taos> select f1, 1 IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and 1 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, 1 IN (select null from tb1) from tb1 where f1 > 0 and 1 IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or 1 IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 1 IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 1 IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(1 IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(1 IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(1 IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(1 IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(1 IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(1 IN (select null from tb1)) order by 1;

taos> select true from tb1 union select 1 IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select 1 IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 1 IN (select f1 from tb1) a from tb1 union all select 1 IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select 1 IN (select f1 from tb1 limit 0) a from tb1 union all select 1 IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select 1 IN (select null from tb1) a from tb1 union all select 1 IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 'a' IN (select f1 from tb1) from tb1 order by 1;
 'a' in (select f1 from tb1) |
==============================
 false                       |

taos> select 'a' IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' in (select f1 from tb1 limit 0) |
======================================
 false                               |

taos> select 'a' IN (select null from tb1) from tb1 order by 1;
 'a' in (select null from tb1) |
================================
 NULL                          |

taos> select tags 'a' IN (select f1 from tb1) from tb1 order by 1;
 'a' in (select f1 from tb1) |
==============================
 false                       |

taos> select tags 'a' IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' in (select f1 from tb1 limit 0) |
======================================
 false                               |

taos> select tags 'a' IN (select null from tb1) from tb1 order by 1;
 'a' in (select null from tb1) |
================================
 NULL                          |

taos> select distinct 'a' IN (select f1 from tb1) from tb1 order by 1;
 'a' in (select f1 from tb1) |
==============================
 false                       |

taos> select distinct 'a' IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' in (select f1 from tb1 limit 0) |
======================================
 false                               |

taos> select distinct 'a' IN (select null from tb1) from tb1 order by 1;
 'a' in (select null from tb1) |
================================
 NULL                          |

taos> select 'a' IN (select f1 from tb1), 'a' IN (select f1 from tb1) from tb1 order by 1;
 'a' in (select f1 from tb1) | 'a' in (select f1 from tb1) |
============================================================
 false                       | false                       |

taos> select 'a' IN (select f1 from tb1 limit 0), 'a' IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' in (select f1 from tb1 limit 0) | 'a' in (select f1 from tb1 limit 0) |
============================================================================
 false                               | false                               |

taos> select 'a' IN (select null from tb1), 'a' IN (select null from tb1) from tb1 order by 1;
 'a' in (select null from tb1) | 'a' in (select null from tb1) |
================================================================
 NULL                          | NULL                          |

taos> select 'a' IN (select f1 from tb1), * from tb1 order by ts, f1;
 'a' in (select f1 from tb1) |           ts            |     f1      |     f2      |
====================================================================================
 false                       | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 'a' IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 'a' in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
============================================================================================
 false                               | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 'a' IN (select null from tb1), * from tb1 order by ts, f1;
 'a' in (select null from tb1) |           ts            |     f1      |     f2      |
======================================================================================
 NULL                          | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when 'a' IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 'a' in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
==================================================================================
                                                       2 |                     1 |

taos> select case when 'a' IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 'a' in (select f1 from tb1 limit 0) then 1 else 2 end |        sum(f1)        |
==========================================================================================
                                                               2 |                     1 |

taos> select case when 'a' IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 'a' in (select null from tb1) then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         2 |                     1 |

taos> select case when f1 = 1 then 1 else 'a' IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 'a' in (select f1 from tb1) end |        sum(f1)        |
=======================================================================================
                                                            1 |                     1 |

taos> select case when f1 = 1 then 1 else 'a' IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 'a' in (select f1 from tb1 limit 0) |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 'a' IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 'a' in (select null from tb1) end |        sum(f1)        |
=========================================================================================
                                                              1 |                     1 |

taos> select _wstart, 'a' IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 'a' in (select f1 from tb1) |          avg(f1)          |
====================================================================================
 2025-12-01 00:00:00.000 | false                       |                         1 |

taos> select _wstart, 'a' IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | 'a' in (select f1 from tb1 limit 0) |          avg(f1)          |
============================================================================================
 2025-12-01 00:00:00.000 | false                               |                         1 |

taos> select _wstart, 'a' IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 'a' in (select null from tb1) |          avg(f1)          |
======================================================================================
 2025-12-01 00:00:00.000 | NULL                          |                         1 |

taos> select case 'a' IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 'a' in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
========================================================================================
                                                         2 |                         1 |

taos> select case 'a' IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 'a' in (select f1 from tb1 limit 0) when 1 then 1 else 2 en |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case 'a' IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 'a' in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
==========================================================================================
                                                           2 |                         1 |

taos> select sum(case when 'a' IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 'a' in (select f1 from tb1) then 1 else 2 end) |
===============================================================
                                                            2 |

taos> select sum(case when 'a' IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 'a' in (select f1 from tb1 limit 0) then 1 else 2  |
===================================================================
                                                                2 |

taos> select sum(case when 'a' IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 'a' in (select null from tb1) then 1 else 2 end) |
=================================================================
                                                              2 |

taos> select f1, 'a' IN (select f1 from tb1) from tb1 group by f1;
     f1      | 'a' in (select f1 from tb1) |
============================================
           1 | false                       |

taos> select f1, 'a' IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | 'a' in (select f1 from tb1 limit 0) |
====================================================
           1 | false                               |

taos> select f1, 'a' IN (select null from tb1) from tb1 group by f1;
     f1      | 'a' in (select null from tb1) |
==============================================
           1 | NULL                          |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 'a' IN (select f1 from tb1) order by b.f1;

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and 'a' IN (select f1 from tb1 limit 0) order by b.f1;

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 'a' IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 'a' IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 'a' IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 'a' IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where 'a' IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where 'a' IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where 'a' IN (select null from tb1) order by f1;

taos> select f1, 'a' IN (select f1 from tb1) from tb1 where f1 > 0 and 'a' IN (select f1 from tb1) order by f1;

taos> select f1, 'a' IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and 'a' IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, 'a' IN (select null from tb1) from tb1 where f1 > 0 and 'a' IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or 'a' IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 'a' IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 'a' IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having('a' IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having('a' IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having('a' IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having('a' IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having('a' IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having('a' IN (select null from tb1)) order by 1;

taos> select true from tb1 union select 'a' IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select 'a' IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select 'a' IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 'a' IN (select f1 from tb1) a from tb1 union all select 'a' IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select 'a' IN (select f1 from tb1 limit 0) a from tb1 union all select 'a' IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select 'a' IN (select null from tb1) a from tb1 union all select 'a' IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select f1 IN (select f1 from tb1) from tb1 order by 1;
 f1 in (select f1 from tb1) |
=============================
 true                       |

taos> select f1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 in (select f1 from tb1 limit 0) |
=====================================
 false                              |

taos> select f1 IN (select null from tb1) from tb1 order by 1;
 f1 in (select null from tb1) |
===============================
 NULL                         |

taos> select tags f1 IN (select f1 from tb1) from tb1 order by 1;
 f1 in (select f1 from tb1) |
=============================
 true                       |

taos> select tags f1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 in (select f1 from tb1 limit 0) |
=====================================
 false                              |

taos> select tags f1 IN (select null from tb1) from tb1 order by 1;
 f1 in (select null from tb1) |
===============================
 NULL                         |

taos> select distinct f1 IN (select f1 from tb1) from tb1 order by 1;
 f1 in (select f1 from tb1) |
=============================
 true                       |

taos> select distinct f1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 in (select f1 from tb1 limit 0) |
=====================================
 false                              |

taos> select distinct f1 IN (select null from tb1) from tb1 order by 1;
 f1 in (select null from tb1) |
===============================
 NULL                         |

taos> select f1 IN (select f1 from tb1), f1 IN (select f1 from tb1) from tb1 order by 1;
 f1 in (select f1 from tb1) | f1 in (select f1 from tb1) |
==========================================================
 true                       | true                       |

taos> select f1 IN (select f1 from tb1 limit 0), f1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 in (select f1 from tb1 limit 0) | f1 in (select f1 from tb1 limit 0) |
==========================================================================
 false                              | false                              |

taos> select f1 IN (select null from tb1), f1 IN (select null from tb1) from tb1 order by 1;
 f1 in (select null from tb1) | f1 in (select null from tb1) |
==============================================================
 NULL                         | NULL                         |

taos> select f1 IN (select f1 from tb1), * from tb1 order by ts, f1;
 f1 in (select f1 from tb1) |           ts            |     f1      |     f2      |
===================================================================================
 true                       | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 f1 in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
===========================================================================================
 false                              | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 IN (select null from tb1), * from tb1 order by ts, f1;
 f1 in (select null from tb1) |           ts            |     f1      |     f2      |
=====================================================================================
 NULL                         | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when f1 IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=================================================================================
                                                      1 |                     1 |

taos> select case when f1 IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 in (select f1 from tb1 limit 0) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              2 |                     1 |

taos> select case when f1 IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 in (select null from tb1) then 1 else 2 end |        sum(f1)        |
===================================================================================
                                                        2 |                     1 |

taos> select case when f1 = 1 then 1 else f1 IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 in (select f1 from tb1) end |        sum(f1)        |
======================================================================================
                                                           1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 in (select f1 from tb1 limit 0)  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 in (select null from tb1) end |        sum(f1)        |
========================================================================================
                                                             1 |                     1 |

taos> select _wstart, f1 IN (select f1 from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 IN (select null from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 in (select f1 from tb1) then 1 else 2 end) |
==============================================================
                                                           1 |

taos> select sum(case when f1 IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 in (select f1 from tb1 limit 0) then 1 else 2 e |
===================================================================
                                                                2 |

taos> select sum(case when f1 IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 in (select null from tb1) then 1 else 2 end) |
================================================================
                                                             2 |

taos> select f1, f1 IN (select f1 from tb1) from tb1 group by f1;
     f1      | f1 in (select f1 from tb1) |
===========================================
           1 | true                       |

taos> select f1, f1 IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | f1 in (select f1 from tb1 limit 0) |
===================================================
           1 | false                              |

taos> select f1, f1 IN (select null from tb1) from tb1 group by f1;
     f1      | f1 in (select null from tb1) |
=============================================
           1 | NULL                         |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 IN (select f1 from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 IN (select f1 from tb1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 IN (select null from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 IN (select f1 from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 IN (select f1 from tb1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 IN (select null from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from tb1 where f1 IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where f1 IN (select null from tb1) order by f1;

taos> select f1, f1 IN (select f1 from tb1) from tb1 where f1 > 0 and f1 IN (select f1 from tb1) order by f1;
     f1      | f1 in (select f1 from tb1) |
===========================================
           1 | true                       |

taos> select f1, f1 IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and f1 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, f1 IN (select null from tb1) from tb1 where f1 > 0 and f1 IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or f1 IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(f1 IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(f1 IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(f1 IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(f1 IN (select null from tb1)) order by 1;

taos> select true from tb1 union select f1 IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select f1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select f1 IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 IN (select f1 from tb1) a from tb1 union all select f1 IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select f1 IN (select f1 from tb1 limit 0) a from tb1 union all select f1 IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select f1 IN (select null from tb1) a from tb1 union all select f1 IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select NULL IN (select f1 from tb1) from tb1 order by 1;
 null in (select f1 from tb1) |
===============================
 NULL                         |

taos> select NULL IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null in (select f1 from tb1 limit 0) |
=======================================
 false                                |

taos> select NULL IN (select null from tb1) from tb1 order by 1;
 null in (select null from tb1) |
=================================
 NULL                           |

taos> select tags NULL IN (select f1 from tb1) from tb1 order by 1;
 null in (select f1 from tb1) |
===============================
 NULL                         |

taos> select tags NULL IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null in (select f1 from tb1 limit 0) |
=======================================
 false                                |

taos> select tags NULL IN (select null from tb1) from tb1 order by 1;
 null in (select null from tb1) |
=================================
 NULL                           |

taos> select distinct NULL IN (select f1 from tb1) from tb1 order by 1;
 null in (select f1 from tb1) |
===============================
 NULL                         |

taos> select distinct NULL IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null in (select f1 from tb1 limit 0) |
=======================================
 false                                |

taos> select distinct NULL IN (select null from tb1) from tb1 order by 1;
 null in (select null from tb1) |
=================================
 NULL                           |

taos> select NULL IN (select f1 from tb1), NULL IN (select f1 from tb1) from tb1 order by 1;
 null in (select f1 from tb1) | null in (select f1 from tb1) |
==============================================================
 NULL                         | NULL                         |

taos> select NULL IN (select f1 from tb1 limit 0), NULL IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null in (select f1 from tb1 limit 0) | null in (select f1 from tb1 limit 0) |
==============================================================================
 false                                | false                                |

taos> select NULL IN (select null from tb1), NULL IN (select null from tb1) from tb1 order by 1;
 null in (select null from tb1) | null in (select null from tb1) |
==================================================================
 NULL                           | NULL                           |

taos> select NULL IN (select f1 from tb1), * from tb1 order by ts, f1;
 null in (select f1 from tb1) |           ts            |     f1      |     f2      |
=====================================================================================
 NULL                         | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select NULL IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 null in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
=============================================================================================
 false                                | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select NULL IN (select null from tb1), * from tb1 order by ts, f1;
 null in (select null from tb1) |           ts            |     f1      |     f2      |
=======================================================================================
 NULL                           | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when NULL IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when null in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
===================================================================================
                                                        2 |                     1 |

taos> select case when NULL IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when null in (select f1 from tb1 limit 0) then 1 else 2 end |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when NULL IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when null in (select null from tb1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     1 |

taos> select case when f1 = 1 then 1 else NULL IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else null in (select f1 from tb1) end |        sum(f1)        |
========================================================================================
                                                             1 |                     1 |

taos> select case when f1 = 1 then 1 else NULL IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else null in (select f1 from tb1 limit 0 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else NULL IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else null in (select null from tb1) end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select _wstart, NULL IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | null in (select f1 from tb1) |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.000 | NULL                         |                         1 |

taos> select _wstart, NULL IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | null in (select f1 from tb1 limit 0) |          avg(f1)          |
=============================================================================================
 2025-12-01 00:00:00.000 | false                                |                         1 |

taos> select _wstart, NULL IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | null in (select null from tb1) |          avg(f1)          |
=======================================================================================
 2025-12-01 00:00:00.000 | NULL                           |                         1 |

taos> select case NULL IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case null in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=========================================================================================
                                                          2 |                         1 |

taos> select case NULL IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case null in (select f1 from tb1 limit 0) when 1 then 1 else 2 e |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case NULL IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case null in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
===========================================================================================
                                                            2 |                         1 |

taos> select sum(case when NULL IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when null in (select f1 from tb1) then 1 else 2 end) |
================================================================
                                                             2 |

taos> select sum(case when NULL IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when null in (select f1 from tb1 limit 0) then 1 else 2 |
===================================================================
                                                                2 |

taos> select sum(case when NULL IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when null in (select null from tb1) then 1 else 2 end) |
==================================================================
                                                               2 |

taos> select f1, NULL IN (select f1 from tb1) from tb1 group by f1;
     f1      | null in (select f1 from tb1) |
=============================================
           1 | NULL                         |

taos> select f1, NULL IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | null in (select f1 from tb1 limit 0) |
=====================================================
           1 | false                                |

taos> select f1, NULL IN (select null from tb1) from tb1 group by f1;
     f1      | null in (select null from tb1) |
===============================================
           1 | NULL                           |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and NULL IN (select f1 from tb1) order by b.f1;

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and NULL IN (select f1 from tb1 limit 0) order by b.f1;

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and NULL IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and NULL IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and NULL IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and NULL IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where NULL IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where NULL IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where NULL IN (select null from tb1) order by f1;

taos> select f1, NULL IN (select f1 from tb1) from tb1 where f1 > 0 and NULL IN (select f1 from tb1) order by f1;

taos> select f1, NULL IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and NULL IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, NULL IN (select null from tb1) from tb1 where f1 > 0 and NULL IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or NULL IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or NULL IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or NULL IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(NULL IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(NULL IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(NULL IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(NULL IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(NULL IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(NULL IN (select null from tb1)) order by 1;

taos> select true from tb1 union select NULL IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select true from tb1 union select NULL IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select NULL IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select NULL IN (select f1 from tb1) a from tb1 union all select NULL IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select NULL IN (select f1 from tb1 limit 0) a from tb1 union all select NULL IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select NULL IN (select null from tb1) a from tb1 union all select NULL IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 123.45 IN (select f1 from tb1) from tb1 order by 1;
 123.45 in (select f1 from tb1) |
=================================
 false                          |

taos> select 123.45 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 in (select f1 from tb1 limit 0) |
=========================================
 false                                  |

taos> select 123.45 IN (select null from tb1) from tb1 order by 1;
 123.45 in (select null from tb1) |
===================================
 NULL                             |

taos> select tags 123.45 IN (select f1 from tb1) from tb1 order by 1;
 123.45 in (select f1 from tb1) |
=================================
 false                          |

taos> select tags 123.45 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 in (select f1 from tb1 limit 0) |
=========================================
 false                                  |

taos> select tags 123.45 IN (select null from tb1) from tb1 order by 1;
 123.45 in (select null from tb1) |
===================================
 NULL                             |

taos> select distinct 123.45 IN (select f1 from tb1) from tb1 order by 1;
 123.45 in (select f1 from tb1) |
=================================
 false                          |

taos> select distinct 123.45 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 in (select f1 from tb1 limit 0) |
=========================================
 false                                  |

taos> select distinct 123.45 IN (select null from tb1) from tb1 order by 1;
 123.45 in (select null from tb1) |
===================================
 NULL                             |

taos> select 123.45 IN (select f1 from tb1), 123.45 IN (select f1 from tb1) from tb1 order by 1;
 123.45 in (select f1 from tb1) | 123.45 in (select f1 from tb1) |
==================================================================
 false                          | false                          |

taos> select 123.45 IN (select f1 from tb1 limit 0), 123.45 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 in (select f1 from tb1 limit 0) | 123.45 in (select f1 from tb1 limit 0) |
==================================================================================
 false                                  | false                                  |

taos> select 123.45 IN (select null from tb1), 123.45 IN (select null from tb1) from tb1 order by 1;
 123.45 in (select null from tb1) | 123.45 in (select null from tb1) |
======================================================================
 NULL                             | NULL                             |

taos> select 123.45 IN (select f1 from tb1), * from tb1 order by ts, f1;
 123.45 in (select f1 from tb1) |           ts            |     f1      |     f2      |
=======================================================================================
 false                          | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 123.45 IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 123.45 in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
===============================================================================================
 false                                  | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 123.45 IN (select null from tb1), * from tb1 order by ts, f1;
 123.45 in (select null from tb1) |           ts            |     f1      |     f2      |
=========================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when 123.45 IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 123.45 in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     1 |

taos> select case when 123.45 IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 123.45 in (select f1 from tb1 limit 0) then 1 else 2 e |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when 123.45 IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 123.45 in (select null from tb1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     1 |

taos> select case when f1 = 1 then 1 else 123.45 IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 123.45 in (select f1 from tb1) end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when f1 = 1 then 1 else 123.45 IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 123.45 in (select f1 from tb1 limit |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 123.45 IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 123.45 in (select null from tb1) en |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, 123.45 IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 123.45 in (select f1 from tb1) |          avg(f1)          |
=======================================================================================
 2025-12-01 00:00:00.000 | false                          |                         1 |

taos> select _wstart, 123.45 IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | 123.45 in (select f1 from tb1 limit 0) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 | false                                  |                         1 |

taos> select _wstart, 123.45 IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 123.45 in (select null from tb1) |          avg(f1)          |
=========================================================================================
 2025-12-01 00:00:00.000 | NULL                             |                         1 |

taos> select case 123.45 IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 123.45 in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
===========================================================================================
                                                            2 |                         1 |

taos> select case 123.45 IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 123.45 in (select f1 from tb1 limit 0) when 1 then 1 else 2 |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case 123.45 IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 123.45 in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=============================================================================================
                                                              2 |                         1 |

taos> select sum(case when 123.45 IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 123.45 in (select f1 from tb1) then 1 else 2 end) |
==================================================================
                                                               2 |

taos> select sum(case when 123.45 IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 123.45 in (select f1 from tb1 limit 0) then 1 else |
===================================================================
                                                                2 |

taos> select sum(case when 123.45 IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 123.45 in (select null from tb1) then 1 else 2 end |
===================================================================
                                                                2 |

taos> select f1, 123.45 IN (select f1 from tb1) from tb1 group by f1;
     f1      | 123.45 in (select f1 from tb1) |
===============================================
           1 | false                          |

taos> select f1, 123.45 IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | 123.45 in (select f1 from tb1 limit 0) |
=======================================================
           1 | false                                  |

taos> select f1, 123.45 IN (select null from tb1) from tb1 group by f1;
     f1      | 123.45 in (select null from tb1) |
=================================================
           1 | NULL                             |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 123.45 IN (select f1 from tb1) order by b.f1;

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and 123.45 IN (select f1 from tb1 limit 0) order by b.f1;

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 123.45 IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 123.45 IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 123.45 IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 123.45 IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where 123.45 IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where 123.45 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where 123.45 IN (select null from tb1) order by f1;

taos> select f1, 123.45 IN (select f1 from tb1) from tb1 where f1 > 0 and 123.45 IN (select f1 from tb1) order by f1;

taos> select f1, 123.45 IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and 123.45 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, 123.45 IN (select null from tb1) from tb1 where f1 > 0 and 123.45 IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or 123.45 IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 123.45 IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 123.45 IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(123.45 IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(123.45 IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(123.45 IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(123.45 IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(123.45 IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(123.45 IN (select null from tb1)) order by 1;

taos> select true from tb1 union select 123.45 IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select 123.45 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select 123.45 IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 123.45 IN (select f1 from tb1) a from tb1 union all select 123.45 IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select 123.45 IN (select f1 from tb1 limit 0) a from tb1 union all select 123.45 IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select 123.45 IN (select null from tb1) a from tb1 union all select 123.45 IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select abs(-2) IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) in (select f1 from tb1) |
==================================
 false                           |

taos> select abs(-2) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) in (select f1 from tb1 limit 0) |
==========================================
 false                                   |

taos> select abs(-2) IN (select null from tb1) from tb1 order by 1;
 abs(-2) in (select null from tb1) |
====================================
 NULL                              |

taos> select tags abs(-2) IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) in (select f1 from tb1) |
==================================
 false                           |

taos> select tags abs(-2) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) in (select f1 from tb1 limit 0) |
==========================================
 false                                   |

taos> select tags abs(-2) IN (select null from tb1) from tb1 order by 1;
 abs(-2) in (select null from tb1) |
====================================
 NULL                              |

taos> select distinct abs(-2) IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) in (select f1 from tb1) |
==================================
 false                           |

taos> select distinct abs(-2) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) in (select f1 from tb1 limit 0) |
==========================================
 false                                   |

taos> select distinct abs(-2) IN (select null from tb1) from tb1 order by 1;
 abs(-2) in (select null from tb1) |
====================================
 NULL                              |

taos> select abs(-2) IN (select f1 from tb1), abs(-2) IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) in (select f1 from tb1) | abs(-2) in (select f1 from tb1) |
====================================================================
 false                           | false                           |

taos> select abs(-2) IN (select f1 from tb1 limit 0), abs(-2) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) in (select f1 from tb1 limit 0) | abs(-2) in (select f1 from tb1 limit 0) |
====================================================================================
 false                                   | false                                   |

taos> select abs(-2) IN (select null from tb1), abs(-2) IN (select null from tb1) from tb1 order by 1;
 abs(-2) in (select null from tb1) | abs(-2) in (select null from tb1) |
========================================================================
 NULL                              | NULL                              |

taos> select abs(-2) IN (select f1 from tb1), * from tb1 order by ts, f1;
 abs(-2) in (select f1 from tb1) |           ts            |     f1      |     f2      |
========================================================================================
 false                           | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select abs(-2) IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 abs(-2) in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
================================================================================================
 false                                   | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select abs(-2) IN (select null from tb1), * from tb1 order by ts, f1;
 abs(-2) in (select null from tb1) |           ts            |     f1      |     f2      |
==========================================================================================
 NULL                              | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when abs(-2) IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when abs(-2) in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           2 |                     1 |

taos> select case when abs(-2) IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when abs(-2) in (select f1 from tb1 limit 0) then 1 else 2  |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when abs(-2) IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when abs(-2) in (select null from tb1) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     1 |

taos> select case when f1 = 1 then 1 else abs(-2) IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else abs(-2) in (select f1 from tb1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else abs(-2) IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else abs(-2) in (select f1 from tb1 limi |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else abs(-2) IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else abs(-2) in (select null from tb1) e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, abs(-2) IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | abs(-2) in (select f1 from tb1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | false                           |                         1 |

taos> select _wstart, abs(-2) IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | abs(-2) in (select f1 from tb1 limit 0) |          avg(f1)          |
================================================================================================
 2025-12-01 00:00:00.000 | false                                   |                         1 |

taos> select _wstart, abs(-2) IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | abs(-2) in (select null from tb1) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | NULL                              |                         1 |

taos> select case abs(-2) IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case abs(-2) in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             2 |                         1 |

taos> select case abs(-2) IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case abs(-2) in (select f1 from tb1 limit 0) when 1 then 1 else  |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case abs(-2) IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case abs(-2) in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |                         1 |

taos> select sum(case when abs(-2) IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when abs(-2) in (select f1 from tb1) then 1 else 2 end) |
===================================================================
                                                                2 |

taos> select sum(case when abs(-2) IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when abs(-2) in (select f1 from tb1 limit 0) then 1 els |
===================================================================
                                                                2 |

taos> select sum(case when abs(-2) IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when abs(-2) in (select null from tb1) then 1 else 2 en |
===================================================================
                                                                2 |

taos> select f1, abs(-2) IN (select f1 from tb1) from tb1 group by f1;
     f1      | abs(-2) in (select f1 from tb1) |
================================================
           1 | false                           |

taos> select f1, abs(-2) IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | abs(-2) in (select f1 from tb1 limit 0) |
========================================================
           1 | false                                   |

taos> select f1, abs(-2) IN (select null from tb1) from tb1 group by f1;
     f1      | abs(-2) in (select null from tb1) |
==================================================
           1 | NULL                              |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and abs(-2) IN (select f1 from tb1) order by b.f1;

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and abs(-2) IN (select f1 from tb1 limit 0) order by b.f1;

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and abs(-2) IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and abs(-2) IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and abs(-2) IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and abs(-2) IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where abs(-2) IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where abs(-2) IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where abs(-2) IN (select null from tb1) order by f1;

taos> select f1, abs(-2) IN (select f1 from tb1) from tb1 where f1 > 0 and abs(-2) IN (select f1 from tb1) order by f1;

taos> select f1, abs(-2) IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and abs(-2) IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, abs(-2) IN (select null from tb1) from tb1 where f1 > 0 and abs(-2) IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or abs(-2) IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or abs(-2) IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or abs(-2) IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(abs(-2) IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(abs(-2) IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(abs(-2) IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(abs(-2) IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(abs(-2) IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(abs(-2) IN (select null from tb1)) order by 1;

taos> select true from tb1 union select abs(-2) IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select abs(-2) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select abs(-2) IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select abs(-2) IN (select f1 from tb1) a from tb1 union all select abs(-2) IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select abs(-2) IN (select f1 from tb1 limit 0) a from tb1 union all select abs(-2) IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select abs(-2) IN (select null from tb1) a from tb1 union all select abs(-2) IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select f1 + 1 IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1) |
=================================
 false                          |

taos> select f1 + 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1 limit 0) |
=========================================
 false                                  |

taos> select f1 + 1 IN (select null from tb1) from tb1 order by 1;
 f1 + 1 in (select null from tb1) |
===================================
 NULL                             |

taos> select tags f1 + 1 IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1) |
=================================
 false                          |

taos> select tags f1 + 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1 limit 0) |
=========================================
 false                                  |

taos> select tags f1 + 1 IN (select null from tb1) from tb1 order by 1;
 f1 + 1 in (select null from tb1) |
===================================
 NULL                             |

taos> select distinct f1 + 1 IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1) |
=================================
 false                          |

taos> select distinct f1 + 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1 limit 0) |
=========================================
 false                                  |

taos> select distinct f1 + 1 IN (select null from tb1) from tb1 order by 1;
 f1 + 1 in (select null from tb1) |
===================================
 NULL                             |

taos> select f1 + 1 IN (select f1 from tb1), f1 + 1 IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1) | f1 + 1 in (select f1 from tb1) |
==================================================================
 false                          | false                          |

taos> select f1 + 1 IN (select f1 from tb1 limit 0), f1 + 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 in (select f1 from tb1 limit 0) | f1 + 1 in (select f1 from tb1 limit 0) |
==================================================================================
 false                                  | false                                  |

taos> select f1 + 1 IN (select null from tb1), f1 + 1 IN (select null from tb1) from tb1 order by 1;
 f1 + 1 in (select null from tb1) | f1 + 1 in (select null from tb1) |
======================================================================
 NULL                             | NULL                             |

taos> select f1 + 1 IN (select f1 from tb1), * from tb1 order by ts, f1;
 f1 + 1 in (select f1 from tb1) |           ts            |     f1      |     f2      |
=======================================================================================
 false                          | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 + 1 IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 f1 + 1 in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
===============================================================================================
 false                                  | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 + 1 IN (select null from tb1), * from tb1 order by ts, f1;
 f1 + 1 in (select null from tb1) |           ts            |     f1      |     f2      |
=========================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when f1 + 1 IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 + 1 in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     1 |

taos> select case when f1 + 1 IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 + 1 in (select f1 from tb1 limit 0) then 1 else 2 e |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when f1 + 1 IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 + 1 in (select null from tb1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     1 |

taos> select case when f1 = 1 then 1 else f1 + 1 IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 in (select f1 from tb1) end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 + 1 IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 in (select f1 from tb1 limit |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 + 1 IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 in (select null from tb1) en |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, f1 + 1 IN (select f1 from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 IN (select null from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 + 1 IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 + 1 in (select f1 from tb1) then 1 else 2 end) |
==================================================================
                                                               2 |

taos> select sum(case when f1 + 1 IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 + 1 in (select f1 from tb1 limit 0) then 1 else |
===================================================================
                                                                2 |

taos> select sum(case when f1 + 1 IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 + 1 in (select null from tb1) then 1 else 2 end |
===================================================================
                                                                2 |

taos> select f1, f1 + 1 IN (select f1 from tb1) from tb1 group by f1;
     f1      | f1 + 1 in (select f1 from tb1) |
===============================================
           1 | false                          |

taos> select f1, f1 + 1 IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | f1 + 1 in (select f1 from tb1 limit 0) |
=======================================================
           1 | false                                  |

taos> select f1, f1 + 1 IN (select null from tb1) from tb1 group by f1;
     f1      | f1 + 1 in (select null from tb1) |
=================================================
           1 | NULL                             |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 + 1 IN (select f1 from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 + 1 IN (select f1 from tb1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 + 1 IN (select null from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 + 1 IN (select f1 from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 + 1 IN (select f1 from tb1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 + 1 IN (select null from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from tb1 where f1 + 1 IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where f1 + 1 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1 from tb1 where f1 + 1 IN (select null from tb1) order by f1;

taos> select f1, f1 + 1 IN (select f1 from tb1) from tb1 where f1 > 0 and f1 + 1 IN (select f1 from tb1) order by f1;

taos> select f1, f1 + 1 IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and f1 + 1 IN (select f1 from tb1 limit 0) order by f1;

taos> select f1, f1 + 1 IN (select null from tb1) from tb1 where f1 > 0 and f1 + 1 IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or f1 + 1 IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 + 1 IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 + 1 IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 + 1 IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(f1 + 1 IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(f1 + 1 IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(f1 + 1 IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(f1 + 1 IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(f1 + 1 IN (select null from tb1)) order by 1;

taos> select true from tb1 union select f1 + 1 IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select f1 + 1 IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select f1 + 1 IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 + 1 IN (select f1 from tb1) a from tb1 union all select f1 + 1 IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select f1 + 1 IN (select f1 from tb1 limit 0) a from tb1 union all select f1 + 1 IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select f1 + 1 IN (select null from tb1) a from tb1 union all select f1 + 1 IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select sum(f1) IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) in (select f1 from tb1) |
==================================
 true                            |

taos> select sum(f1) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) in (select f1 from tb1 limit 0) |
==========================================
 false                                   |

taos> select sum(f1) IN (select null from tb1) from tb1 order by 1;
 sum(f1) in (select null from tb1) |
====================================
 NULL                              |

taos> select tags sum(f1) IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) in (select f1 from tb1) |
==================================
 true                            |

taos> select tags sum(f1) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) in (select f1 from tb1 limit 0) |
==========================================
 false                                   |

taos> select tags sum(f1) IN (select null from tb1) from tb1 order by 1;
 sum(f1) in (select null from tb1) |
====================================
 NULL                              |

taos> select distinct sum(f1) IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) in (select f1 from tb1) |
==================================
 true                            |

taos> select distinct sum(f1) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) in (select f1 from tb1 limit 0) |
==========================================
 false                                   |

taos> select distinct sum(f1) IN (select null from tb1) from tb1 order by 1;
 sum(f1) in (select null from tb1) |
====================================
 NULL                              |

taos> select sum(f1) IN (select f1 from tb1), sum(f1) IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) in (select f1 from tb1) | sum(f1) in (select f1 from tb1) |
====================================================================
 true                            | true                            |

taos> select sum(f1) IN (select f1 from tb1 limit 0), sum(f1) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) in (select f1 from tb1 limit 0) | sum(f1) in (select f1 from tb1 limit 0) |
====================================================================================
 false                                   | false                                   |

taos> select sum(f1) IN (select null from tb1), sum(f1) IN (select null from tb1) from tb1 order by 1;
 sum(f1) in (select null from tb1) | sum(f1) in (select null from tb1) |
========================================================================
 NULL                              | NULL                              |

taos> select sum(f1) IN (select f1 from tb1), * from tb1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) IN (select null from tb1), * from tb1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select case when sum(f1) IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when sum(f1) in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           1 |                     1 |

taos> select case when sum(f1) IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when sum(f1) in (select f1 from tb1 limit 0) then 1 else 2  |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when sum(f1) IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when sum(f1) in (select null from tb1) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     1 |

taos> select case when f1 = 1 then 1 else sum(f1) IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else sum(f1) in (select f1 from tb1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else sum(f1) IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else sum(f1) in (select f1 from tb1 limi |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else sum(f1) IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else sum(f1) in (select null from tb1) e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, sum(f1) IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | sum(f1) in (select f1 from tb1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | true                            |                         1 |

taos> select _wstart, sum(f1) IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | sum(f1) in (select f1 from tb1 limit 0) |          avg(f1)          |
================================================================================================
 2025-12-01 00:00:00.000 | false                                   |                         1 |

taos> select _wstart, sum(f1) IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | sum(f1) in (select null from tb1) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | NULL                              |                         1 |

taos> select case sum(f1) IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case sum(f1) in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             1 |                         1 |

taos> select case sum(f1) IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case sum(f1) in (select f1 from tb1 limit 0) when 1 then 1 else  |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case sum(f1) IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case sum(f1) in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |                         1 |

taos> select sum(case when sum(f1) IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select f1, sum(f1) IN (select f1 from tb1) from tb1 group by f1;
     f1      | sum(f1) in (select f1 from tb1) |
================================================
           1 | true                            |

taos> select f1, sum(f1) IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | sum(f1) in (select f1 from tb1 limit 0) |
========================================================
           1 | false                                   |

taos> select f1, sum(f1) IN (select null from tb1) from tb1 group by f1;
     f1      | sum(f1) in (select null from tb1) |
==================================================
           1 | NULL                              |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and sum(f1) IN (select f1 from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and sum(f1) IN (select f1 from tb1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and sum(f1) IN (select null from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and sum(f1) IN (select f1 from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and sum(f1) IN (select f1 from tb1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and sum(f1) IN (select null from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from tb1 where sum(f1) IN (select f1 from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where sum(f1) IN (select f1 from tb1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where sum(f1) IN (select null from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) IN (select f1 from tb1) from tb1 where f1 > 0 and sum(f1) IN (select f1 from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and sum(f1) IN (select f1 from tb1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) IN (select null from tb1) from tb1 where f1 > 0 and sum(f1) IN (select null from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where f1 > 0 or sum(f1) IN (select f1 from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where f1 > 0 or sum(f1) IN (select f1 from tb1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where f1 > 0 or sum(f1) IN (select null from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 partition by f1 having(sum(f1) IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(sum(f1) IN (select f1 from tb1 limit 0)) order by f1;

taos> select f1 from tb1 partition by f1 having(sum(f1) IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(sum(f1) IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(sum(f1) IN (select f1 from tb1 limit 0)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(sum(f1) IN (select null from tb1)) order by 1;

taos> select true from tb1 union select sum(f1) IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select sum(f1) IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select sum(f1) IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select sum(f1) IN (select f1 from tb1) a from tb1 union all select sum(f1) IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select sum(f1) IN (select f1 from tb1 limit 0) a from tb1 union all select sum(f1) IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select sum(f1) IN (select null from tb1) a from tb1 union all select sum(f1) IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 1 not in (select f1 from tb1) |
================================
 false                         |

taos> select 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 not in (select f1 from tb1 limit 0) |
========================================
 true                                  |

taos> select 1 NOT IN (select null from tb1) from tb1 order by 1;
 1 not in (select null from tb1) |
==================================
 NULL                            |

taos> select tags 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 1 not in (select f1 from tb1) |
================================
 false                         |

taos> select tags 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 not in (select f1 from tb1 limit 0) |
========================================
 true                                  |

taos> select tags 1 NOT IN (select null from tb1) from tb1 order by 1;
 1 not in (select null from tb1) |
==================================
 NULL                            |

taos> select distinct 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 1 not in (select f1 from tb1) |
================================
 false                         |

taos> select distinct 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 not in (select f1 from tb1 limit 0) |
========================================
 true                                  |

taos> select distinct 1 NOT IN (select null from tb1) from tb1 order by 1;
 1 not in (select null from tb1) |
==================================
 NULL                            |

taos> select 1 NOT IN (select f1 from tb1), 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 1 not in (select f1 from tb1) | 1 not in (select f1 from tb1) |
================================================================
 false                         | false                         |

taos> select 1 NOT IN (select f1 from tb1 limit 0), 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 1 not in (select f1 from tb1 limit 0) | 1 not in (select f1 from tb1 limit 0) |
================================================================================
 true                                  | true                                  |

taos> select 1 NOT IN (select null from tb1), 1 NOT IN (select null from tb1) from tb1 order by 1;
 1 not in (select null from tb1) | 1 not in (select null from tb1) |
====================================================================
 NULL                            | NULL                            |

taos> select 1 NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 1 not in (select f1 from tb1) |           ts            |     f1      |     f2      |
======================================================================================
 false                         | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 1 NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 1 not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
==============================================================================================
 true                                  | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 1 NOT IN (select null from tb1), * from tb1 order by ts, f1;
 1 not in (select null from tb1) |           ts            |     f1      |     f2      |
========================================================================================
 NULL                            | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when 1 NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 1 not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         2 |                     1 |

taos> select case when 1 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 1 not in (select f1 from tb1 limit 0) then 1 else 2 en |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when 1 NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 1 not in (select null from tb1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           2 |                     1 |

taos> select case when f1 = 1 then 1 else 1 NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 1 not in (select f1 from tb1) end |        sum(f1)        |
=========================================================================================
                                                              1 |                     1 |

taos> select case when f1 = 1 then 1 else 1 NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 1 not in (select f1 from tb1 limit  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 1 NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 1 not in (select null from tb1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, 1 NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 1 not in (select f1 from tb1) |          avg(f1)          |
======================================================================================
 2025-12-01 00:00:00.000 | false                         |                         1 |

taos> select _wstart, 1 NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | 1 not in (select f1 from tb1 limit 0) |          avg(f1)          |
==============================================================================================
 2025-12-01 00:00:00.000 | true                                  |                         1 |

taos> select _wstart, 1 NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 1 not in (select null from tb1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | NULL                            |                         1 |

taos> select case 1 NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 1 not in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
==========================================================================================
                                                           2 |                         1 |

taos> select case 1 NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 1 not in (select f1 from tb1 limit 0) when 1 then 1 else 2  |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case 1 NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 1 not in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             2 |                         1 |

taos> select sum(case when 1 NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 1 not in (select f1 from tb1) then 1 else 2 end) |
=================================================================
                                                              2 |

taos> select sum(case when 1 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 1 not in (select f1 from tb1 limit 0) then 1 else  |
===================================================================
                                                                1 |

taos> select sum(case when 1 NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 1 not in (select null from tb1) then 1 else 2 end) |
===================================================================
                                                                2 |

taos> select f1, 1 NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | 1 not in (select f1 from tb1) |
==============================================
           1 | false                         |

taos> select f1, 1 NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | 1 not in (select f1 from tb1 limit 0) |
======================================================
           1 | true                                  |

taos> select f1, 1 NOT IN (select null from tb1) from tb1 group by f1;
     f1      | 1 not in (select null from tb1) |
================================================
           1 | NULL                            |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 1 NOT IN (select f1 from tb1) order by b.f1;

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and 1 NOT IN (select f1 from tb1 limit 0) order by b.f1;
     f1      | (select f1 from tb1 limit 0) + 1 |
=================================================
           1 | NULL                             |

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 1 NOT IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 1 NOT IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 1 NOT IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 1 NOT IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where 1 NOT IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where 1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where 1 NOT IN (select null from tb1) order by f1;

taos> select f1, 1 NOT IN (select f1 from tb1) from tb1 where f1 > 0 and 1 NOT IN (select f1 from tb1) order by f1;

taos> select f1, 1 NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and 1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | 1 not in (select f1 from tb1 limit 0) |
======================================================
           1 | true                                  |

taos> select f1, 1 NOT IN (select null from tb1) from tb1 where f1 > 0 and 1 NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or 1 NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 1 NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(1 NOT IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(1 NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(1 NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(1 NOT IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(1 NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(1 NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select 1 NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 1 NOT IN (select f1 from tb1) a from tb1 union all select 1 NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select 1 NOT IN (select f1 from tb1 limit 0) a from tb1 union all select 1 NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select 1 NOT IN (select null from tb1) a from tb1 union all select 1 NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 'a' NOT IN (select f1 from tb1) from tb1 order by 1;
 'a' not in (select f1 from tb1) |
==================================
 true                            |

taos> select 'a' NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' not in (select f1 from tb1 limit 0) |
==========================================
 true                                    |

taos> select 'a' NOT IN (select null from tb1) from tb1 order by 1;
 'a' not in (select null from tb1) |
====================================
 NULL                              |

taos> select tags 'a' NOT IN (select f1 from tb1) from tb1 order by 1;
 'a' not in (select f1 from tb1) |
==================================
 true                            |

taos> select tags 'a' NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' not in (select f1 from tb1 limit 0) |
==========================================
 true                                    |

taos> select tags 'a' NOT IN (select null from tb1) from tb1 order by 1;
 'a' not in (select null from tb1) |
====================================
 NULL                              |

taos> select distinct 'a' NOT IN (select f1 from tb1) from tb1 order by 1;
 'a' not in (select f1 from tb1) |
==================================
 true                            |

taos> select distinct 'a' NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' not in (select f1 from tb1 limit 0) |
==========================================
 true                                    |

taos> select distinct 'a' NOT IN (select null from tb1) from tb1 order by 1;
 'a' not in (select null from tb1) |
====================================
 NULL                              |

taos> select 'a' NOT IN (select f1 from tb1), 'a' NOT IN (select f1 from tb1) from tb1 order by 1;
 'a' not in (select f1 from tb1) | 'a' not in (select f1 from tb1) |
====================================================================
 true                            | true                            |

taos> select 'a' NOT IN (select f1 from tb1 limit 0), 'a' NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 'a' not in (select f1 from tb1 limit 0) | 'a' not in (select f1 from tb1 limit 0) |
====================================================================================
 true                                    | true                                    |

taos> select 'a' NOT IN (select null from tb1), 'a' NOT IN (select null from tb1) from tb1 order by 1;
 'a' not in (select null from tb1) | 'a' not in (select null from tb1) |
========================================================================
 NULL                              | NULL                              |

taos> select 'a' NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 'a' not in (select f1 from tb1) |           ts            |     f1      |     f2      |
========================================================================================
 true                            | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 'a' NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 'a' not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
================================================================================================
 true                                    | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 'a' NOT IN (select null from tb1), * from tb1 order by ts, f1;
 'a' not in (select null from tb1) |           ts            |     f1      |     f2      |
==========================================================================================
 NULL                              | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when 'a' NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 'a' not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           1 |                     1 |

taos> select case when 'a' NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 'a' not in (select f1 from tb1 limit 0) then 1 else 2  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when 'a' NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 'a' not in (select null from tb1) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     1 |

taos> select case when f1 = 1 then 1 else 'a' NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 'a' not in (select f1 from tb1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 'a' NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 'a' not in (select f1 from tb1 limi |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 'a' NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 'a' not in (select null from tb1) e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, 'a' NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 'a' not in (select f1 from tb1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | true                            |                         1 |

taos> select _wstart, 'a' NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | 'a' not in (select f1 from tb1 limit 0) |          avg(f1)          |
================================================================================================
 2025-12-01 00:00:00.000 | true                                    |                         1 |

taos> select _wstart, 'a' NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 'a' not in (select null from tb1) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | NULL                              |                         1 |

taos> select case 'a' NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 'a' not in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             1 |                         1 |

taos> select case 'a' NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 'a' not in (select f1 from tb1 limit 0) when 1 then 1 else  |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case 'a' NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 'a' not in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |                         1 |

taos> select sum(case when 'a' NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 'a' not in (select f1 from tb1) then 1 else 2 end) |
===================================================================
                                                                1 |

taos> select sum(case when 'a' NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 'a' not in (select f1 from tb1 limit 0) then 1 els |
===================================================================
                                                                1 |

taos> select sum(case when 'a' NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 'a' not in (select null from tb1) then 1 else 2 en |
===================================================================
                                                                2 |

taos> select f1, 'a' NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | 'a' not in (select f1 from tb1) |
================================================
           1 | true                            |

taos> select f1, 'a' NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | 'a' not in (select f1 from tb1 limit 0) |
========================================================
           1 | true                                    |

taos> select f1, 'a' NOT IN (select null from tb1) from tb1 group by f1;
     f1      | 'a' not in (select null from tb1) |
==================================================
           1 | NULL                              |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 'a' NOT IN (select f1 from tb1) order by b.f1;
     f1      | (select f1 from tb1) + 1  |
==========================================
           1 |                         2 |

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and 'a' NOT IN (select f1 from tb1 limit 0) order by b.f1;
     f1      | (select f1 from tb1 limit 0) + 1 |
=================================================
           1 | NULL                             |

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 'a' NOT IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 'a' NOT IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 'a' NOT IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 'a' NOT IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where 'a' NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where 'a' NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where 'a' NOT IN (select null from tb1) order by f1;

taos> select f1, 'a' NOT IN (select f1 from tb1) from tb1 where f1 > 0 and 'a' NOT IN (select f1 from tb1) order by f1;
     f1      | 'a' not in (select f1 from tb1) |
================================================
           1 | true                            |

taos> select f1, 'a' NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and 'a' NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | 'a' not in (select f1 from tb1 limit 0) |
========================================================
           1 | true                                    |

taos> select f1, 'a' NOT IN (select null from tb1) from tb1 where f1 > 0 and 'a' NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or 'a' NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 'a' NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 'a' NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having('a' NOT IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having('a' NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having('a' NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having('a' NOT IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having('a' NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having('a' NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select 'a' NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select 'a' NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select 'a' NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 'a' NOT IN (select f1 from tb1) a from tb1 union all select 'a' NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select 'a' NOT IN (select f1 from tb1 limit 0) a from tb1 union all select 'a' NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select 'a' NOT IN (select null from tb1) a from tb1 union all select 'a' NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select f1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 not in (select f1 from tb1) |
=================================
 false                          |

taos> select f1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 not in (select f1 from tb1 limit 0) |
=========================================
 true                                   |

taos> select f1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 not in (select null from tb1) |
===================================
 NULL                             |

taos> select tags f1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 not in (select f1 from tb1) |
=================================
 false                          |

taos> select tags f1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 not in (select f1 from tb1 limit 0) |
=========================================
 true                                   |

taos> select tags f1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 not in (select null from tb1) |
===================================
 NULL                             |

taos> select distinct f1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 not in (select f1 from tb1) |
=================================
 false                          |

taos> select distinct f1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 not in (select f1 from tb1 limit 0) |
=========================================
 true                                   |

taos> select distinct f1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 not in (select null from tb1) |
===================================
 NULL                             |

taos> select f1 NOT IN (select f1 from tb1), f1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 not in (select f1 from tb1) | f1 not in (select f1 from tb1) |
==================================================================
 false                          | false                          |

taos> select f1 NOT IN (select f1 from tb1 limit 0), f1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 not in (select f1 from tb1 limit 0) | f1 not in (select f1 from tb1 limit 0) |
==================================================================================
 true                                   | true                                   |

taos> select f1 NOT IN (select null from tb1), f1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 not in (select null from tb1) | f1 not in (select null from tb1) |
======================================================================
 NULL                             | NULL                             |

taos> select f1 NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 f1 not in (select f1 from tb1) |           ts            |     f1      |     f2      |
=======================================================================================
 false                          | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 f1 not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
===============================================================================================
 true                                   | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 NOT IN (select null from tb1), * from tb1 order by ts, f1;
 f1 not in (select null from tb1) |           ts            |     f1      |     f2      |
=========================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when f1 NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     1 |

taos> select case when f1 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 not in (select f1 from tb1 limit 0) then 1 else 2 e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 not in (select null from tb1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     1 |

taos> select case when f1 = 1 then 1 else f1 NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 not in (select f1 from tb1) end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 not in (select f1 from tb1 limit |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 not in (select null from tb1) en |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, f1 NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 not in (select f1 from tb1) then 1 else 2 end) |
==================================================================
                                                               2 |

taos> select sum(case when f1 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 not in (select f1 from tb1 limit 0) then 1 else |
===================================================================
                                                                1 |

taos> select sum(case when f1 NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 not in (select null from tb1) then 1 else 2 end |
===================================================================
                                                                2 |

taos> select f1, f1 NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | f1 not in (select f1 from tb1) |
===============================================
           1 | false                          |

taos> select f1, f1 NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | f1 not in (select f1 from tb1 limit 0) |
=======================================================
           1 | true                                   |

taos> select f1, f1 NOT IN (select null from tb1) from tb1 group by f1;
     f1      | f1 not in (select null from tb1) |
=================================================
           1 | NULL                             |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 NOT IN (select f1 from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 NOT IN (select f1 from tb1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 NOT IN (select null from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 NOT IN (select f1 from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 NOT IN (select f1 from tb1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 NOT IN (select null from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from tb1 where f1 NOT IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where f1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 NOT IN (select null from tb1) order by f1;

taos> select f1, f1 NOT IN (select f1 from tb1) from tb1 where f1 > 0 and f1 NOT IN (select f1 from tb1) order by f1;

taos> select f1, f1 NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and f1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | f1 not in (select f1 from tb1 limit 0) |
=======================================================
           1 | true                                   |

taos> select f1, f1 NOT IN (select null from tb1) from tb1 where f1 > 0 and f1 NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or f1 NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 NOT IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(f1 NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(f1 NOT IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(f1 NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(f1 NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select f1 NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select f1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select f1 NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 NOT IN (select f1 from tb1) a from tb1 union all select f1 NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select f1 NOT IN (select f1 from tb1 limit 0) a from tb1 union all select f1 NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select f1 NOT IN (select null from tb1) a from tb1 union all select f1 NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select NULL NOT IN (select f1 from tb1) from tb1 order by 1;
 null not in (select f1 from tb1) |
===================================
 NULL                             |

taos> select NULL NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null not in (select f1 from tb1 limit 0) |
===========================================
 true                                     |

taos> select NULL NOT IN (select null from tb1) from tb1 order by 1;
 null not in (select null from tb1) |
=====================================
 NULL                               |

taos> select tags NULL NOT IN (select f1 from tb1) from tb1 order by 1;
 null not in (select f1 from tb1) |
===================================
 NULL                             |

taos> select tags NULL NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null not in (select f1 from tb1 limit 0) |
===========================================
 true                                     |

taos> select tags NULL NOT IN (select null from tb1) from tb1 order by 1;
 null not in (select null from tb1) |
=====================================
 NULL                               |

taos> select distinct NULL NOT IN (select f1 from tb1) from tb1 order by 1;
 null not in (select f1 from tb1) |
===================================
 NULL                             |

taos> select distinct NULL NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null not in (select f1 from tb1 limit 0) |
===========================================
 true                                     |

taos> select distinct NULL NOT IN (select null from tb1) from tb1 order by 1;
 null not in (select null from tb1) |
=====================================
 NULL                               |

taos> select NULL NOT IN (select f1 from tb1), NULL NOT IN (select f1 from tb1) from tb1 order by 1;
 null not in (select f1 from tb1) | null not in (select f1 from tb1) |
======================================================================
 NULL                             | NULL                             |

taos> select NULL NOT IN (select f1 from tb1 limit 0), NULL NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 null not in (select f1 from tb1 limit 0) | null not in (select f1 from tb1 limit 0) |
======================================================================================
 true                                     | true                                     |

taos> select NULL NOT IN (select null from tb1), NULL NOT IN (select null from tb1) from tb1 order by 1;
 null not in (select null from tb1) | null not in (select null from tb1) |
==========================================================================
 NULL                               | NULL                               |

taos> select NULL NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 null not in (select f1 from tb1) |           ts            |     f1      |     f2      |
=========================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select NULL NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 null not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
=================================================================================================
 true                                     | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select NULL NOT IN (select null from tb1), * from tb1 order by ts, f1;
 null not in (select null from tb1) |           ts            |     f1      |     f2      |
===========================================================================================
 NULL                               | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when NULL NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when null not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     1 |

taos> select case when NULL NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when null not in (select f1 from tb1 limit 0) then 1 else 2 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when NULL NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when null not in (select null from tb1) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              2 |                     1 |

taos> select case when f1 = 1 then 1 else NULL NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else null not in (select f1 from tb1) en |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else NULL NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else null not in (select f1 from tb1 lim |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else NULL NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else null not in (select null from tb1)  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, NULL NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | null not in (select f1 from tb1) |          avg(f1)          |
=========================================================================================
 2025-12-01 00:00:00.000 | NULL                             |                         1 |

taos> select _wstart, NULL NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | null not in (select f1 from tb1 limit 0) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 | true                                     |                         1 |

taos> select _wstart, NULL NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | null not in (select null from tb1) |          avg(f1)          |
===========================================================================================
 2025-12-01 00:00:00.000 | NULL                               |                         1 |

taos> select case NULL NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case null not in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=============================================================================================
                                                              2 |                         1 |

taos> select case NULL NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case null not in (select f1 from tb1 limit 0) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case NULL NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case null not in (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select sum(case when NULL NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when null not in (select f1 from tb1) then 1 else 2 end |
===================================================================
                                                                2 |

taos> select sum(case when NULL NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when null not in (select f1 from tb1 limit 0) then 1 el |
===================================================================
                                                                1 |

taos> select sum(case when NULL NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when null not in (select null from tb1) then 1 else 2 e |
===================================================================
                                                                2 |

taos> select f1, NULL NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | null not in (select f1 from tb1) |
=================================================
           1 | NULL                             |

taos> select f1, NULL NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | null not in (select f1 from tb1 limit 0) |
=========================================================
           1 | true                                     |

taos> select f1, NULL NOT IN (select null from tb1) from tb1 group by f1;
     f1      | null not in (select null from tb1) |
===================================================
           1 | NULL                               |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and NULL NOT IN (select f1 from tb1) order by b.f1;

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and NULL NOT IN (select f1 from tb1 limit 0) order by b.f1;
     f1      | (select f1 from tb1 limit 0) + 1 |
=================================================
           1 | NULL                             |

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and NULL NOT IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and NULL NOT IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and NULL NOT IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and NULL NOT IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where NULL NOT IN (select f1 from tb1) order by f1;

taos> select f1 from tb1 where NULL NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where NULL NOT IN (select null from tb1) order by f1;

taos> select f1, NULL NOT IN (select f1 from tb1) from tb1 where f1 > 0 and NULL NOT IN (select f1 from tb1) order by f1;

taos> select f1, NULL NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and NULL NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | null not in (select f1 from tb1 limit 0) |
=========================================================
           1 | true                                     |

taos> select f1, NULL NOT IN (select null from tb1) from tb1 where f1 > 0 and NULL NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or NULL NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or NULL NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or NULL NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(NULL NOT IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(NULL NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(NULL NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(NULL NOT IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(NULL NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(NULL NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select NULL NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select true from tb1 union select NULL NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select NULL NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select NULL NOT IN (select f1 from tb1) a from tb1 union all select NULL NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select NULL NOT IN (select f1 from tb1 limit 0) a from tb1 union all select NULL NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select NULL NOT IN (select null from tb1) a from tb1 union all select NULL NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 123.45 NOT IN (select f1 from tb1) from tb1 order by 1;
 123.45 not in (select f1 from tb1) |
=====================================
 true                               |

taos> select 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 not in (select f1 from tb1 limit 0) |
=============================================
 true                                       |

taos> select 123.45 NOT IN (select null from tb1) from tb1 order by 1;
 123.45 not in (select null from tb1) |
=======================================
 NULL                                 |

taos> select tags 123.45 NOT IN (select f1 from tb1) from tb1 order by 1;
 123.45 not in (select f1 from tb1) |
=====================================
 true                               |

taos> select tags 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 not in (select f1 from tb1 limit 0) |
=============================================
 true                                       |

taos> select tags 123.45 NOT IN (select null from tb1) from tb1 order by 1;
 123.45 not in (select null from tb1) |
=======================================
 NULL                                 |

taos> select distinct 123.45 NOT IN (select f1 from tb1) from tb1 order by 1;
 123.45 not in (select f1 from tb1) |
=====================================
 true                               |

taos> select distinct 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 not in (select f1 from tb1 limit 0) |
=============================================
 true                                       |

taos> select distinct 123.45 NOT IN (select null from tb1) from tb1 order by 1;
 123.45 not in (select null from tb1) |
=======================================
 NULL                                 |

taos> select 123.45 NOT IN (select f1 from tb1), 123.45 NOT IN (select f1 from tb1) from tb1 order by 1;
 123.45 not in (select f1 from tb1) | 123.45 not in (select f1 from tb1) |
==========================================================================
 true                               | true                               |

taos> select 123.45 NOT IN (select f1 from tb1 limit 0), 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 123.45 not in (select f1 from tb1 limit 0) | 123.45 not in (select f1 from tb1 limit 0) |
==========================================================================================
 true                                       | true                                       |

taos> select 123.45 NOT IN (select null from tb1), 123.45 NOT IN (select null from tb1) from tb1 order by 1;
 123.45 not in (select null from tb1) | 123.45 not in (select null from tb1) |
==============================================================================
 NULL                                 | NULL                                 |

taos> select 123.45 NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 123.45 not in (select f1 from tb1) |           ts            |     f1      |     f2      |
===========================================================================================
 true                               | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 123.45 NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 123.45 not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
===================================================================================================
 true                                       | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select 123.45 NOT IN (select null from tb1), * from tb1 order by ts, f1;
 123.45 not in (select null from tb1) |           ts            |     f1      |     f2      |
=============================================================================================
 NULL                                 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when 123.45 NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 123.45 not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              1 |                     1 |

taos> select case when 123.45 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 123.45 not in (select f1 from tb1 limit 0) then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when 123.45 NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when 123.45 not in (select null from tb1) then 1 else 2 end |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when f1 = 1 then 1 else 123.45 NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 123.45 not in (select f1 from tb1)  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 123.45 NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 123.45 not in (select f1 from tb1 l |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else 123.45 NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else 123.45 not in (select null from tb1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, 123.45 NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 123.45 not in (select f1 from tb1) |          avg(f1)          |
===========================================================================================
 2025-12-01 00:00:00.000 | true                               |                         1 |

taos> select _wstart, 123.45 NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | 123.45 not in (select f1 from tb1 limit 0) |          avg(f1)          |
===================================================================================================
 2025-12-01 00:00:00.000 | true                                       |                         1 |

taos> select _wstart, 123.45 NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | 123.45 not in (select null from tb1) |          avg(f1)          |
=============================================================================================
 2025-12-01 00:00:00.000 | NULL                                 |                         1 |

taos> select case 123.45 NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 123.45 not in (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case 123.45 NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 123.45 not in (select f1 from tb1 limit 0) when 1 then 1 el |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case 123.45 NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case 123.45 not in (select null from tb1) when 1 then 1 else 2 e |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select sum(case when 123.45 NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 123.45 not in (select f1 from tb1) then 1 else 2 e |
===================================================================
                                                                1 |

taos> select sum(case when 123.45 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 123.45 not in (select f1 from tb1 limit 0) then 1  |
===================================================================
                                                                1 |

taos> select sum(case when 123.45 NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when 123.45 not in (select null from tb1) then 1 else 2 |
===================================================================
                                                                2 |

taos> select f1, 123.45 NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | 123.45 not in (select f1 from tb1) |
===================================================
           1 | true                               |

taos> select f1, 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | 123.45 not in (select f1 from tb1 limit 0) |
===========================================================
           1 | true                                       |

taos> select f1, 123.45 NOT IN (select null from tb1) from tb1 group by f1;
     f1      | 123.45 not in (select null from tb1) |
=====================================================
           1 | NULL                                 |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from tb1) order by b.f1;
     f1      | (select f1 from tb1) + 1  |
==========================================
           1 |                         2 |

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from tb1 limit 0) order by b.f1;
     f1      | (select f1 from tb1 limit 0) + 1 |
=================================================
           1 | NULL                             |

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and 123.45 NOT IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and 123.45 NOT IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where 123.45 NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where 123.45 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where 123.45 NOT IN (select null from tb1) order by f1;

taos> select f1, 123.45 NOT IN (select f1 from tb1) from tb1 where f1 > 0 and 123.45 NOT IN (select f1 from tb1) order by f1;
     f1      | 123.45 not in (select f1 from tb1) |
===================================================
           1 | true                               |

taos> select f1, 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and 123.45 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | 123.45 not in (select f1 from tb1 limit 0) |
===========================================================
           1 | true                                       |

taos> select f1, 123.45 NOT IN (select null from tb1) from tb1 where f1 > 0 and 123.45 NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or 123.45 NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 123.45 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or 123.45 NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(123.45 NOT IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(123.45 NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(123.45 NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(123.45 NOT IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(123.45 NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(123.45 NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select 123.45 NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select 123.45 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select 123.45 NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 123.45 NOT IN (select f1 from tb1) a from tb1 union all select 123.45 NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select 123.45 NOT IN (select f1 from tb1 limit 0) a from tb1 union all select 123.45 NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select 123.45 NOT IN (select null from tb1) a from tb1 union all select 123.45 NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select abs(-2) NOT IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1) |
======================================
 true                                |

taos> select abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1 limit 0) |
==============================================
 true                                        |

taos> select abs(-2) NOT IN (select null from tb1) from tb1 order by 1;
 abs(-2) not in (select null from tb1) |
========================================
 NULL                                  |

taos> select tags abs(-2) NOT IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1) |
======================================
 true                                |

taos> select tags abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1 limit 0) |
==============================================
 true                                        |

taos> select tags abs(-2) NOT IN (select null from tb1) from tb1 order by 1;
 abs(-2) not in (select null from tb1) |
========================================
 NULL                                  |

taos> select distinct abs(-2) NOT IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1) |
======================================
 true                                |

taos> select distinct abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1 limit 0) |
==============================================
 true                                        |

taos> select distinct abs(-2) NOT IN (select null from tb1) from tb1 order by 1;
 abs(-2) not in (select null from tb1) |
========================================
 NULL                                  |

taos> select abs(-2) NOT IN (select f1 from tb1), abs(-2) NOT IN (select f1 from tb1) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1) | abs(-2) not in (select f1 from tb1) |
============================================================================
 true                                | true                                |

taos> select abs(-2) NOT IN (select f1 from tb1 limit 0), abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 abs(-2) not in (select f1 from tb1 limit 0) | abs(-2) not in (select f1 from tb1 limit 0) |
============================================================================================
 true                                        | true                                        |

taos> select abs(-2) NOT IN (select null from tb1), abs(-2) NOT IN (select null from tb1) from tb1 order by 1;
 abs(-2) not in (select null from tb1) | abs(-2) not in (select null from tb1) |
================================================================================
 NULL                                  | NULL                                  |

taos> select abs(-2) NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 abs(-2) not in (select f1 from tb1) |           ts            |     f1      |     f2      |
============================================================================================
 true                                | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select abs(-2) NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 abs(-2) not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
====================================================================================================
 true                                        | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select abs(-2) NOT IN (select null from tb1), * from tb1 order by ts, f1;
 abs(-2) not in (select null from tb1) |           ts            |     f1      |     f2      |
==============================================================================================
 NULL                                  | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when abs(-2) NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when abs(-2) not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when abs(-2) NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when abs(-2) not in (select f1 from tb1 limit 0) then 1 els |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when abs(-2) NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when abs(-2) not in (select null from tb1) then 1 else 2 en |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when f1 = 1 then 1 else abs(-2) NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else abs(-2) not in (select f1 from tb1) |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else abs(-2) NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else abs(-2) not in (select f1 from tb1  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else abs(-2) NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else abs(-2) not in (select null from tb |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, abs(-2) NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | abs(-2) not in (select f1 from tb1) |          avg(f1)          |
============================================================================================
 2025-12-01 00:00:00.000 | true                                |                         1 |

taos> select _wstart, abs(-2) NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | abs(-2) not in (select f1 from tb1 limit 0) |          avg(f1)          |
====================================================================================================
 2025-12-01 00:00:00.000 | true                                        |                         1 |

taos> select _wstart, abs(-2) NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | abs(-2) not in (select null from tb1) |          avg(f1)          |
==============================================================================================
 2025-12-01 00:00:00.000 | NULL                                  |                         1 |

taos> select case abs(-2) NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case abs(-2) not in (select f1 from tb1) when 1 then 1 else 2 en |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case abs(-2) NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case abs(-2) not in (select f1 from tb1 limit 0) when 1 then 1 e |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case abs(-2) NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case abs(-2) not in (select null from tb1) when 1 then 1 else 2  |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select sum(case when abs(-2) NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when abs(-2) not in (select f1 from tb1) then 1 else 2  |
===================================================================
                                                                1 |

taos> select sum(case when abs(-2) NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when abs(-2) not in (select f1 from tb1 limit 0) then 1 |
===================================================================
                                                                1 |

taos> select sum(case when abs(-2) NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when abs(-2) not in (select null from tb1) then 1 else  |
===================================================================
                                                                2 |

taos> select f1, abs(-2) NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | abs(-2) not in (select f1 from tb1) |
====================================================
           1 | true                                |

taos> select f1, abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | abs(-2) not in (select f1 from tb1 limit 0) |
============================================================
           1 | true                                        |

taos> select f1, abs(-2) NOT IN (select null from tb1) from tb1 group by f1;
     f1      | abs(-2) not in (select null from tb1) |
======================================================
           1 | NULL                                  |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from tb1) order by b.f1;
     f1      | (select f1 from tb1) + 1  |
==========================================
           1 |                         2 |

taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from tb1 limit 0) order by b.f1;
     f1      | (select f1 from tb1 limit 0) + 1 |
=================================================
           1 | NULL                             |

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and abs(-2) NOT IN (select null from tb1) order by b.f1;

taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from tb1 limit 0);
 (select f1 from tb1 limit 0) + 1 | avg((select f1 from tb1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and abs(-2) NOT IN (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select f1 from tb1 where abs(-2) NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where abs(-2) NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where abs(-2) NOT IN (select null from tb1) order by f1;

taos> select f1, abs(-2) NOT IN (select f1 from tb1) from tb1 where f1 > 0 and abs(-2) NOT IN (select f1 from tb1) order by f1;
     f1      | abs(-2) not in (select f1 from tb1) |
====================================================
           1 | true                                |

taos> select f1, abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and abs(-2) NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | abs(-2) not in (select f1 from tb1 limit 0) |
============================================================
           1 | true                                        |

taos> select f1, abs(-2) NOT IN (select null from tb1) from tb1 where f1 > 0 and abs(-2) NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or abs(-2) NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or abs(-2) NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or abs(-2) NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(abs(-2) NOT IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(abs(-2) NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(abs(-2) NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(abs(-2) NOT IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(abs(-2) NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(abs(-2) NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select abs(-2) NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select abs(-2) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select abs(-2) NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select abs(-2) NOT IN (select f1 from tb1) a from tb1 union all select abs(-2) NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select abs(-2) NOT IN (select f1 from tb1 limit 0) a from tb1 union all select abs(-2) NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select abs(-2) NOT IN (select null from tb1) a from tb1 union all select abs(-2) NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select f1 + 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1) |
=====================================
 true                               |

taos> select f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1 limit 0) |
=============================================
 true                                       |

taos> select f1 + 1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 + 1 not in (select null from tb1) |
=======================================
 NULL                                 |

taos> select tags f1 + 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1) |
=====================================
 true                               |

taos> select tags f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1 limit 0) |
=============================================
 true                                       |

taos> select tags f1 + 1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 + 1 not in (select null from tb1) |
=======================================
 NULL                                 |

taos> select distinct f1 + 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1) |
=====================================
 true                               |

taos> select distinct f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1 limit 0) |
=============================================
 true                                       |

taos> select distinct f1 + 1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 + 1 not in (select null from tb1) |
=======================================
 NULL                                 |

taos> select f1 + 1 NOT IN (select f1 from tb1), f1 + 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1) | f1 + 1 not in (select f1 from tb1) |
==========================================================================
 true                               | true                               |

taos> select f1 + 1 NOT IN (select f1 from tb1 limit 0), f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 f1 + 1 not in (select f1 from tb1 limit 0) | f1 + 1 not in (select f1 from tb1 limit 0) |
==========================================================================================
 true                                       | true                                       |

taos> select f1 + 1 NOT IN (select null from tb1), f1 + 1 NOT IN (select null from tb1) from tb1 order by 1;
 f1 + 1 not in (select null from tb1) | f1 + 1 not in (select null from tb1) |
==============================================================================
 NULL                                 | NULL                                 |

taos> select f1 + 1 NOT IN (select f1 from tb1), * from tb1 order by ts, f1;
 f1 + 1 not in (select f1 from tb1) |           ts            |     f1      |     f2      |
===========================================================================================
 true                               | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 + 1 NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;
 f1 + 1 not in (select f1 from tb1 limit 0) |           ts            |     f1      |     f2      |
===================================================================================================
 true                                       | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select f1 + 1 NOT IN (select null from tb1), * from tb1 order by ts, f1;
 f1 + 1 not in (select null from tb1) |           ts            |     f1      |     f2      |
=============================================================================================
 NULL                                 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select case when f1 + 1 NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 + 1 not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              1 |                     1 |

taos> select case when f1 + 1 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 + 1 not in (select f1 from tb1 limit 0) then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 + 1 NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when f1 + 1 not in (select null from tb1) then 1 else 2 end |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when f1 = 1 then 1 else f1 + 1 NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 not in (select f1 from tb1)  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 + 1 NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 not in (select f1 from tb1 l |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else f1 + 1 NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 not in (select null from tb1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, f1 + 1 NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 + 1 NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 + 1 not in (select f1 from tb1) then 1 else 2 e |
===================================================================
                                                                1 |

taos> select sum(case when f1 + 1 NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 + 1 not in (select f1 from tb1 limit 0) then 1  |
===================================================================
                                                                1 |

taos> select sum(case when f1 + 1 NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when f1 + 1 not in (select null from tb1) then 1 else 2 |
===================================================================
                                                                2 |

taos> select f1, f1 + 1 NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | f1 + 1 not in (select f1 from tb1) |
===================================================
           1 | true                               |

taos> select f1, f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | f1 + 1 not in (select f1 from tb1 limit 0) |
===========================================================
           1 | true                                       |

taos> select f1, f1 + 1 NOT IN (select null from tb1) from tb1 group by f1;
     f1      | f1 + 1 not in (select null from tb1) |
=====================================================
           1 | NULL                                 |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from tb1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and f1 + 1 NOT IN (select null from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from tb1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and f1 + 1 NOT IN (select null from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from tb1 where f1 + 1 NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 + 1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 + 1 NOT IN (select null from tb1) order by f1;

taos> select f1, f1 + 1 NOT IN (select f1 from tb1) from tb1 where f1 > 0 and f1 + 1 NOT IN (select f1 from tb1) order by f1;
     f1      | f1 + 1 not in (select f1 from tb1) |
===================================================
           1 | true                               |

taos> select f1, f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and f1 + 1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      | f1 + 1 not in (select f1 from tb1 limit 0) |
===========================================================
           1 | true                                       |

taos> select f1, f1 + 1 NOT IN (select null from tb1) from tb1 where f1 > 0 and f1 + 1 NOT IN (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 > 0 or f1 + 1 NOT IN (select f1 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 + 1 NOT IN (select f1 from tb1 limit 0) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 > 0 or f1 + 1 NOT IN (select null from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 + 1 NOT IN (select f1 from tb1)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 + 1 NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(f1 + 1 NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(f1 + 1 NOT IN (select f1 from tb1)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(f1 + 1 NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(f1 + 1 NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select f1 + 1 NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select f1 + 1 NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select f1 + 1 NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 + 1 NOT IN (select f1 from tb1) a from tb1 union all select f1 + 1 NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select f1 + 1 NOT IN (select f1 from tb1 limit 0) a from tb1 union all select f1 + 1 NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select f1 + 1 NOT IN (select null from tb1) a from tb1 union all select f1 + 1 NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select sum(f1) NOT IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1) |
======================================
 false                               |

taos> select sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1 limit 0) |
==============================================
 true                                        |

taos> select sum(f1) NOT IN (select null from tb1) from tb1 order by 1;
 sum(f1) not in (select null from tb1) |
========================================
 NULL                                  |

taos> select tags sum(f1) NOT IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1) |
======================================
 false                               |

taos> select tags sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1 limit 0) |
==============================================
 true                                        |

taos> select tags sum(f1) NOT IN (select null from tb1) from tb1 order by 1;
 sum(f1) not in (select null from tb1) |
========================================
 NULL                                  |

taos> select distinct sum(f1) NOT IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1) |
======================================
 false                               |

taos> select distinct sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1 limit 0) |
==============================================
 true                                        |

taos> select distinct sum(f1) NOT IN (select null from tb1) from tb1 order by 1;
 sum(f1) not in (select null from tb1) |
========================================
 NULL                                  |

taos> select sum(f1) NOT IN (select f1 from tb1), sum(f1) NOT IN (select f1 from tb1) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1) | sum(f1) not in (select f1 from tb1) |
============================================================================
 false                               | false                               |

taos> select sum(f1) NOT IN (select f1 from tb1 limit 0), sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 sum(f1) not in (select f1 from tb1 limit 0) | sum(f1) not in (select f1 from tb1 limit 0) |
============================================================================================
 true                                        | true                                        |

taos> select sum(f1) NOT IN (select null from tb1), sum(f1) NOT IN (select null from tb1) from tb1 order by 1;
 sum(f1) not in (select null from tb1) | sum(f1) not in (select null from tb1) |
================================================================================
 NULL                                  | NULL                                  |

taos> select sum(f1) NOT IN (select f1 from tb1), * from tb1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) NOT IN (select f1 from tb1 limit 0), * from tb1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) NOT IN (select null from tb1), * from tb1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select case when sum(f1) NOT IN (select f1 from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when sum(f1) not in (select f1 from tb1) then 1 else 2 end |        sum(f1)        |
==========================================================================================
                                                               2 |                     1 |

taos> select case when sum(f1) NOT IN (select f1 from tb1 limit 0) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when sum(f1) not in (select f1 from tb1 limit 0) then 1 els |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when sum(f1) NOT IN (select null from tb1) then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when sum(f1) not in (select null from tb1) then 1 else 2 en |        sum(f1)        |
===========================================================================================
                                                                2 |                     1 |

taos> select case when f1 = 1 then 1 else sum(f1) NOT IN (select f1 from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else sum(f1) not in (select f1 from tb1) |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else sum(f1) NOT IN (select f1 from tb1 limit 0) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else sum(f1) not in (select f1 from tb1  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else sum(f1) NOT IN (select null from tb1) end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else sum(f1) not in (select null from tb |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select _wstart, sum(f1) NOT IN (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | sum(f1) not in (select f1 from tb1) |          avg(f1)          |
============================================================================================
 2025-12-01 00:00:00.000 | false                               |                         1 |

taos> select _wstart, sum(f1) NOT IN (select f1 from tb1 limit 0), avg(f1) from tb1 interval(1d);
         _wstart         | sum(f1) not in (select f1 from tb1 limit 0) |          avg(f1)          |
====================================================================================================
 2025-12-01 00:00:00.000 | true                                        |                         1 |

taos> select _wstart, sum(f1) NOT IN (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | sum(f1) not in (select null from tb1) |          avg(f1)          |
==============================================================================================
 2025-12-01 00:00:00.000 | NULL                                  |                         1 |

taos> select case sum(f1) NOT IN (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case sum(f1) not in (select f1 from tb1) when 1 then 1 else 2 en |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case sum(f1) NOT IN (select f1 from tb1 limit 0) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case sum(f1) not in (select f1 from tb1 limit 0) when 1 then 1 e |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case sum(f1) NOT IN (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case sum(f1) not in (select null from tb1) when 1 then 1 else 2  |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select sum(case when sum(f1) NOT IN (select f1 from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) NOT IN (select f1 from tb1 limit 0) then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) NOT IN (select null from tb1) then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select f1, sum(f1) NOT IN (select f1 from tb1) from tb1 group by f1;
     f1      | sum(f1) not in (select f1 from tb1) |
====================================================
           1 | false                               |

taos> select f1, sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 group by f1;
     f1      | sum(f1) not in (select f1 from tb1 limit 0) |
============================================================
           1 | true                                        |

taos> select f1, sum(f1) NOT IN (select null from tb1) from tb1 group by f1;
     f1      | sum(f1) not in (select null from tb1) |
======================================================
           1 | NULL                                  |

taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from tb1 limit 0) + 1 from tb1 a join tb1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from tb1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and sum(f1) NOT IN (select null from tb1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from tb1 limit 0) + 1, avg((select f1 from tb1 limit 0) + 2) from tb1 a left join tb1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from tb1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and sum(f1) NOT IN (select null from tb1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from tb1 where sum(f1) NOT IN (select f1 from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where sum(f1) NOT IN (select f1 from tb1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where sum(f1) NOT IN (select null from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) NOT IN (select f1 from tb1) from tb1 where f1 > 0 and sum(f1) NOT IN (select f1 from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 where f1 > 0 and sum(f1) NOT IN (select f1 from tb1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) NOT IN (select null from tb1) from tb1 where f1 > 0 and sum(f1) NOT IN (select null from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where f1 > 0 or sum(f1) NOT IN (select f1 from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where f1 > 0 or sum(f1) NOT IN (select f1 from tb1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 where f1 > 0 or sum(f1) NOT IN (select null from tb1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from tb1 partition by f1 having(sum(f1) NOT IN (select f1 from tb1)) order by f1;

taos> select f1 from tb1 partition by f1 having(sum(f1) NOT IN (select f1 from tb1 limit 0)) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 partition by f1 having(sum(f1) NOT IN (select null from tb1)) order by f1;

taos> select sum(f1) from tb1 group by f1 having(sum(f1) NOT IN (select f1 from tb1)) order by 1;

taos> select sum(f1) from tb1 group by f1 having(sum(f1) NOT IN (select f1 from tb1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |

taos> select sum(f1) from tb1 group by f1 having(sum(f1) NOT IN (select null from tb1)) order by 1;

taos> select true from tb1 union select sum(f1) NOT IN (select f1 from tb1) from tb1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from tb1 union select sum(f1) NOT IN (select f1 from tb1 limit 0) from tb1 order by 1;
 true  |
========
 true  |

taos> select true from tb1 union select sum(f1) NOT IN (select null from tb1) from tb1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select sum(f1) NOT IN (select f1 from tb1) a from tb1 union all select sum(f1) NOT IN (select f1 from tb1) b from tb1 order by a;
   a   |
========
 false |
 false |

taos> select sum(f1) NOT IN (select f1 from tb1 limit 0) a from tb1 union all select sum(f1) NOT IN (select f1 from tb1 limit 0) b from tb1 order by a;
   a   |
========
 true  |
 true  |

taos> select sum(f1) NOT IN (select null from tb1) a from tb1 union all select sum(f1) NOT IN (select null from tb1) b from tb1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 1 IN (select f1 from st1) from st1 order by 1;
 1 in (select f1 from st1) |
============================
 true                      |
 true                      |
 true                      |
 true                      |
 true                      |
 true                      |

taos> select 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 1 in (select f1 from st1 limit 0) |
====================================
 false                             |
 false                             |
 false                             |
 false                             |
 false                             |
 false                             |

taos> select 1 IN (select null from st1) from st1 order by 1;
 1 in (select null from st1) |
==============================
 NULL                        |
 NULL                        |
 NULL                        |
 NULL                        |
 NULL                        |
 NULL                        |

taos> select tags 1 IN (select f1 from st1) from st1 order by 1;
 1 in (select f1 from st1) |
============================
 true                      |
 true                      |
 true                      |

taos> select tags 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 1 in (select f1 from st1 limit 0) |
====================================
 false                             |
 false                             |
 false                             |

taos> select tags 1 IN (select null from st1) from st1 order by 1;
 1 in (select null from st1) |
==============================
 NULL                        |
 NULL                        |
 NULL                        |

taos> select distinct 1 IN (select f1 from st1) from st1 order by 1;
 1 in (select f1 from st1) |
============================
 true                      |

taos> select distinct 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 1 in (select f1 from st1 limit 0) |
====================================
 false                             |

taos> select distinct 1 IN (select null from st1) from st1 order by 1;
 1 in (select null from st1) |
==============================
 NULL                        |

taos> select 1 IN (select f1 from st1), 1 IN (select f1 from st1) from st1 order by 1;
 1 in (select f1 from st1) | 1 in (select f1 from st1) |
========================================================
 true                      | true                      |
 true                      | true                      |
 true                      | true                      |
 true                      | true                      |
 true                      | true                      |
 true                      | true                      |

taos> select 1 IN (select f1 from st1 limit 0), 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 1 in (select f1 from st1 limit 0) | 1 in (select f1 from st1 limit 0) |
========================================================================
 false                             | false                             |
 false                             | false                             |
 false                             | false                             |
 false                             | false                             |
 false                             | false                             |
 false                             | false                             |

taos> select 1 IN (select null from st1), 1 IN (select null from st1) from st1 order by 1;
 1 in (select null from st1) | 1 in (select null from st1) |
============================================================
 NULL                        | NULL                        |
 NULL                        | NULL                        |
 NULL                        | NULL                        |
 NULL                        | NULL                        |
 NULL                        | NULL                        |
 NULL                        | NULL                        |

taos> select 1 IN (select f1 from st1), * from st1 order by ts, f1;
 1 in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
================================================================================================
 true                      | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                      | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                      | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                      | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                      | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                      | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 1 IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 1 in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
========================================================================================================
 false                             | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                             | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                             | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                             | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                             | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                             | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 1 IN (select null from st1), * from st1 order by ts, f1;
 1 in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
==================================================================================================
 NULL                        | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                        | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                        | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                        | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                        | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                        | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when 1 IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 1 in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
================================================================================
                                                     1 |                     5 |
                                                     1 |                     1 |
                                                     1 |                     3 |
                                                     1 |                     6 |
                                                     1 |                     2 |
                                                     1 |                     4 |

taos> select case when 1 IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 1 in (select f1 from st1 limit 0) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     5 |
                                                             2 |                     1 |
                                                             2 |                     3 |
                                                             2 |                     6 |
                                                             2 |                     2 |
                                                             2 |                     4 |

taos> select case when 1 IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 1 in (select null from st1) then 1 else 2 end |        sum(f1)        |
==================================================================================
                                                       2 |                     5 |
                                                       2 |                     1 |
                                                       2 |                     3 |
                                                       2 |                     6 |
                                                       2 |                     2 |
                                                       2 |                     4 |

taos> select case when f1 = 1 then 1 else 1 IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 1 in (select f1 from st1) end |        sum(f1)        |
=====================================================================================
                                                          1 |                     5 |
                                                          1 |                     1 |
                                                          1 |                     3 |
                                                          1 |                     6 |
                                                          1 |                     2 |
                                                          1 |                     4 |

taos> select case when f1 = 1 then 1 else 1 IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 1 in (select f1 from st1 limit 0) e |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else 1 IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 1 in (select null from st1) end |        sum(f1)        |
=======================================================================================
 NULL                                                         |                     5 |
                                                            1 |                     1 |
 NULL                                                         |                     3 |
 NULL                                                         |                     6 |
 NULL                                                         |                     2 |
 NULL                                                         |                     4 |

taos> select _wstart, 1 IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | 1 in (select f1 from st1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 | true                      |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                      |                         4 |
 2025-12-03 00:00:00.000 | true                      |                         6 |

taos> select _wstart, 1 IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | 1 in (select f1 from st1 limit 0) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | false                             |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                             |                         4 |
 2025-12-03 00:00:00.000 | false                             |                         6 |

taos> select _wstart, 1 IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | 1 in (select null from st1) |          avg(f1)          |
====================================================================================
 2025-12-01 00:00:00.000 | NULL                        |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                        |                         4 |
 2025-12-03 00:00:00.000 | NULL                        |                         6 |

taos> select case 1 IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 1 in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       1 |          2.33333333333333 |
                                                       1 |                         4 |
                                                       1 |                         6 |

taos> select case 1 IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 1 in (select f1 from st1 limit 0) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |          2.33333333333333 |
                                                               2 |                         4 |
                                                               2 |                         6 |

taos> select case 1 IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 1 in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
========================================================================================
                                                         2 |          2.33333333333333 |
                                                         2 |                         4 |
                                                         2 |                         6 |

taos> select sum(case when 1 IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 1 IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 1 IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, 1 IN (select f1 from st1) from st1 group by f1;
     f1      | 1 in (select f1 from st1) |
==========================================
           5 | true                      |
           1 | true                      |
           3 | true                      |
           6 | true                      |
           2 | true                      |
           4 | true                      |

taos> select f1, 1 IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | 1 in (select f1 from st1 limit 0) |
==================================================
           5 | false                             |
           1 | false                             |
           3 | false                             |
           6 | false                             |
           2 | false                             |
           4 | false                             |

taos> select f1, 1 IN (select null from st1) from st1 group by f1;
     f1      | 1 in (select null from st1) |
============================================
           5 | NULL                        |
           1 | NULL                        |
           3 | NULL                        |
           6 | NULL                        |
           2 | NULL                        |
           4 | NULL                        |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 1 IN (select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and 1 IN (select f1 from st1 limit 0) order by b.f1;

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 1 IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 1 IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and 1 IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 1 IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where 1 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where 1 IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where 1 IN (select null from st1) order by f1;

taos> select f1, 1 IN (select f1 from st1) from st1 where f1 > 0 and 1 IN (select f1 from st1) order by f1;
     f1      | 1 in (select f1 from st1) |
==========================================
           1 | true                      |
           2 | true                      |
           3 | true                      |
           4 | true                      |
           5 | true                      |
           6 | true                      |

taos> select f1, 1 IN (select f1 from st1 limit 0) from st1 where f1 > 0 and 1 IN (select f1 from st1 limit 0) order by f1;

taos> select f1, 1 IN (select null from st1) from st1 where f1 > 0 and 1 IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or 1 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 1 IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 1 IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(1 IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(1 IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(1 IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(1 IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(1 IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(1 IN (select null from st1)) order by 1;

taos> select true from st1 union select 1 IN (select f1 from st1) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select 1 IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 1 IN (select f1 from st1) a from st1 union all select 1 IN (select f1 from st1) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select 1 IN (select f1 from st1 limit 0) a from st1 union all select 1 IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select 1 IN (select null from st1) a from st1 union all select 1 IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select 'a' IN (select f1 from st1) from st1 order by 1;
 'a' in (select f1 from st1) |
==============================
 false                       |
 false                       |
 false                       |
 false                       |
 false                       |
 false                       |

taos> select 'a' IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' in (select f1 from st1 limit 0) |
======================================
 false                               |
 false                               |
 false                               |
 false                               |
 false                               |
 false                               |

taos> select 'a' IN (select null from st1) from st1 order by 1;
 'a' in (select null from st1) |
================================
 NULL                          |
 NULL                          |
 NULL                          |
 NULL                          |
 NULL                          |
 NULL                          |

taos> select tags 'a' IN (select f1 from st1) from st1 order by 1;
 'a' in (select f1 from st1) |
==============================
 false                       |
 false                       |
 false                       |

taos> select tags 'a' IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' in (select f1 from st1 limit 0) |
======================================
 false                               |
 false                               |
 false                               |

taos> select tags 'a' IN (select null from st1) from st1 order by 1;
 'a' in (select null from st1) |
================================
 NULL                          |
 NULL                          |
 NULL                          |

taos> select distinct 'a' IN (select f1 from st1) from st1 order by 1;
 'a' in (select f1 from st1) |
==============================
 false                       |

taos> select distinct 'a' IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' in (select f1 from st1 limit 0) |
======================================
 false                               |

taos> select distinct 'a' IN (select null from st1) from st1 order by 1;
 'a' in (select null from st1) |
================================
 NULL                          |

taos> select 'a' IN (select f1 from st1), 'a' IN (select f1 from st1) from st1 order by 1;
 'a' in (select f1 from st1) | 'a' in (select f1 from st1) |
============================================================
 false                       | false                       |
 false                       | false                       |
 false                       | false                       |
 false                       | false                       |
 false                       | false                       |
 false                       | false                       |

taos> select 'a' IN (select f1 from st1 limit 0), 'a' IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' in (select f1 from st1 limit 0) | 'a' in (select f1 from st1 limit 0) |
============================================================================
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |

taos> select 'a' IN (select null from st1), 'a' IN (select null from st1) from st1 order by 1;
 'a' in (select null from st1) | 'a' in (select null from st1) |
================================================================
 NULL                          | NULL                          |
 NULL                          | NULL                          |
 NULL                          | NULL                          |
 NULL                          | NULL                          |
 NULL                          | NULL                          |
 NULL                          | NULL                          |

taos> select 'a' IN (select f1 from st1), * from st1 order by ts, f1;
 'a' in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
==================================================================================================
 false                       | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                       | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                       | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                       | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                       | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                       | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 'a' IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 'a' in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
==========================================================================================================
 false                               | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                               | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                               | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                               | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                               | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                               | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 'a' IN (select null from st1), * from st1 order by ts, f1;
 'a' in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
====================================================================================================
 NULL                          | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                          | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                          | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                          | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                          | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                          | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when 'a' IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 'a' in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
==================================================================================
                                                       2 |                     5 |
                                                       2 |                     1 |
                                                       2 |                     3 |
                                                       2 |                     6 |
                                                       2 |                     2 |
                                                       2 |                     4 |

taos> select case when 'a' IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 'a' in (select f1 from st1 limit 0) then 1 else 2 end |        sum(f1)        |
==========================================================================================
                                                               2 |                     5 |
                                                               2 |                     1 |
                                                               2 |                     3 |
                                                               2 |                     6 |
                                                               2 |                     2 |
                                                               2 |                     4 |

taos> select case when 'a' IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 'a' in (select null from st1) then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         2 |                     5 |
                                                         2 |                     1 |
                                                         2 |                     3 |
                                                         2 |                     6 |
                                                         2 |                     2 |
                                                         2 |                     4 |

taos> select case when f1 = 1 then 1 else 'a' IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 'a' in (select f1 from st1) end |        sum(f1)        |
=======================================================================================
                                                            0 |                     5 |
                                                            1 |                     1 |
                                                            0 |                     3 |
                                                            0 |                     6 |
                                                            0 |                     2 |
                                                            0 |                     4 |

taos> select case when f1 = 1 then 1 else 'a' IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 'a' in (select f1 from st1 limit 0) |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else 'a' IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 'a' in (select null from st1) end |        sum(f1)        |
=========================================================================================
 NULL                                                           |                     5 |
                                                              1 |                     1 |
 NULL                                                           |                     3 |
 NULL                                                           |                     6 |
 NULL                                                           |                     2 |
 NULL                                                           |                     4 |

taos> select _wstart, 'a' IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | 'a' in (select f1 from st1) |          avg(f1)          |
====================================================================================
 2025-12-01 00:00:00.000 | false                       |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                       |                         4 |
 2025-12-03 00:00:00.000 | false                       |                         6 |

taos> select _wstart, 'a' IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | 'a' in (select f1 from st1 limit 0) |          avg(f1)          |
============================================================================================
 2025-12-01 00:00:00.000 | false                               |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                               |                         4 |
 2025-12-03 00:00:00.000 | false                               |                         6 |

taos> select _wstart, 'a' IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | 'a' in (select null from st1) |          avg(f1)          |
======================================================================================
 2025-12-01 00:00:00.000 | NULL                          |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                          |                         4 |
 2025-12-03 00:00:00.000 | NULL                          |                         6 |

taos> select case 'a' IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 'a' in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
========================================================================================
                                                         2 |          2.33333333333333 |
                                                         2 |                         4 |
                                                         2 |                         6 |

taos> select case 'a' IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 'a' in (select f1 from st1 limit 0) when 1 then 1 else 2 en |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select case 'a' IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 'a' in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
==========================================================================================
                                                           2 |          2.33333333333333 |
                                                           2 |                         4 |
                                                           2 |                         6 |

taos> select sum(case when 'a' IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 'a' IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 'a' IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, 'a' IN (select f1 from st1) from st1 group by f1;
     f1      | 'a' in (select f1 from st1) |
============================================
           5 | false                       |
           1 | false                       |
           3 | false                       |
           6 | false                       |
           2 | false                       |
           4 | false                       |

taos> select f1, 'a' IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | 'a' in (select f1 from st1 limit 0) |
====================================================
           5 | false                               |
           1 | false                               |
           3 | false                               |
           6 | false                               |
           2 | false                               |
           4 | false                               |

taos> select f1, 'a' IN (select null from st1) from st1 group by f1;
     f1      | 'a' in (select null from st1) |
==============================================
           5 | NULL                          |
           1 | NULL                          |
           3 | NULL                          |
           6 | NULL                          |
           2 | NULL                          |
           4 | NULL                          |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 'a' IN (select f1 from st1) order by b.f1;

taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and 'a' IN (select f1 from st1 limit 0) order by b.f1;

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 'a' IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 'a' IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and 'a' IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 'a' IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where 'a' IN (select f1 from st1) order by f1;

taos> select f1 from st1 where 'a' IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where 'a' IN (select null from st1) order by f1;

taos> select f1, 'a' IN (select f1 from st1) from st1 where f1 > 0 and 'a' IN (select f1 from st1) order by f1;

taos> select f1, 'a' IN (select f1 from st1 limit 0) from st1 where f1 > 0 and 'a' IN (select f1 from st1 limit 0) order by f1;

taos> select f1, 'a' IN (select null from st1) from st1 where f1 > 0 and 'a' IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or 'a' IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 'a' IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 'a' IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having('a' IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having('a' IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having('a' IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having('a' IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having('a' IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having('a' IN (select null from st1)) order by 1;

taos> select true from st1 union select 'a' IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select 'a' IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select 'a' IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 'a' IN (select f1 from st1) a from st1 union all select 'a' IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select 'a' IN (select f1 from st1 limit 0) a from st1 union all select 'a' IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select 'a' IN (select null from st1) a from st1 union all select 'a' IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select f1 IN (select f1 from st1) from st1 order by 1;
 f1 in (select f1 from st1) |
=============================
 true                       |
 true                       |
 true                       |
 true                       |
 true                       |
 true                       |

taos> select f1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 in (select f1 from st1 limit 0) |
=====================================
 false                              |
 false                              |
 false                              |
 false                              |
 false                              |
 false                              |

taos> select f1 IN (select null from st1) from st1 order by 1;
 f1 in (select null from st1) |
===============================
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |

taos> select tags f1 IN (select f1 from st1) from st1 order by 1;
 f1 in (select f1 from st1) |
=============================
 true                       |
 true                       |
 true                       |
 true                       |
 true                       |
 true                       |

taos> select tags f1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 in (select f1 from st1 limit 0) |
=====================================
 false                              |
 false                              |
 false                              |
 false                              |
 false                              |
 false                              |

taos> select tags f1 IN (select null from st1) from st1 order by 1;
 f1 in (select null from st1) |
===============================
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |

taos> select distinct f1 IN (select f1 from st1) from st1 order by 1;
 f1 in (select f1 from st1) |
=============================
 true                       |

taos> select distinct f1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 in (select f1 from st1 limit 0) |
=====================================
 false                              |

taos> select distinct f1 IN (select null from st1) from st1 order by 1;
 f1 in (select null from st1) |
===============================
 NULL                         |

taos> select f1 IN (select f1 from st1), f1 IN (select f1 from st1) from st1 order by 1;
 f1 in (select f1 from st1) | f1 in (select f1 from st1) |
==========================================================
 true                       | true                       |
 true                       | true                       |
 true                       | true                       |
 true                       | true                       |
 true                       | true                       |
 true                       | true                       |

taos> select f1 IN (select f1 from st1 limit 0), f1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 in (select f1 from st1 limit 0) | f1 in (select f1 from st1 limit 0) |
==========================================================================
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |

taos> select f1 IN (select null from st1), f1 IN (select null from st1) from st1 order by 1;
 f1 in (select null from st1) | f1 in (select null from st1) |
==============================================================
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |

taos> select f1 IN (select f1 from st1), * from st1 order by ts, f1;
 f1 in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=================================================================================================
 true                       | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                       | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                       | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                       | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                       | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                       | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 f1 in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
=========================================================================================================
 false                              | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                              | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                              | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                              | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                              | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                              | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 IN (select null from st1), * from st1 order by ts, f1;
 f1 in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
===================================================================================================
 NULL                         | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                         | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                         | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                         | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                         | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                         | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when f1 IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=================================================================================
                                                      1 |                     5 |
                                                      1 |                     1 |
                                                      1 |                     3 |
                                                      1 |                     6 |
                                                      1 |                     2 |
                                                      1 |                     4 |

taos> select case when f1 IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 in (select f1 from st1 limit 0) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              2 |                     5 |
                                                              2 |                     1 |
                                                              2 |                     3 |
                                                              2 |                     6 |
                                                              2 |                     2 |
                                                              2 |                     4 |

taos> select case when f1 IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 in (select null from st1) then 1 else 2 end |        sum(f1)        |
===================================================================================
                                                        2 |                     5 |
                                                        2 |                     1 |
                                                        2 |                     3 |
                                                        2 |                     6 |
                                                        2 |                     2 |
                                                        2 |                     4 |

taos> select case when f1 = 1 then 1 else f1 IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 in (select f1 from st1) end |        sum(f1)        |
======================================================================================
                                                           1 |                     5 |
                                                           1 |                     1 |
                                                           1 |                     3 |
                                                           1 |                     6 |
                                                           1 |                     2 |
                                                           1 |                     4 |

taos> select case when f1 = 1 then 1 else f1 IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 in (select f1 from st1 limit 0)  |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else f1 IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 in (select null from st1) end |        sum(f1)        |
========================================================================================
 NULL                                                          |                     5 |
                                                             1 |                     1 |
 NULL                                                          |                     3 |
 NULL                                                          |                     6 |
 NULL                                                          |                     2 |
 NULL                                                          |                     4 |

taos> select _wstart, f1 IN (select f1 from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 IN (select null from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, f1 IN (select f1 from st1) from st1 group by f1;
     f1      | f1 in (select f1 from st1) |
===========================================
           5 | true                       |
           1 | true                       |
           3 | true                       |
           6 | true                       |
           2 | true                       |
           4 | true                       |

taos> select f1, f1 IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | f1 in (select f1 from st1 limit 0) |
===================================================
           5 | false                              |
           1 | false                              |
           3 | false                              |
           6 | false                              |
           2 | false                              |
           4 | false                              |

taos> select f1, f1 IN (select null from st1) from st1 group by f1;
     f1      | f1 in (select null from st1) |
=============================================
           5 | NULL                         |
           1 | NULL                         |
           3 | NULL                         |
           6 | NULL                         |
           2 | NULL                         |
           4 | NULL                         |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 IN (select f1 from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and f1 IN (select f1 from st1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 IN (select null from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 IN (select f1 from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 IN (select f1 from st1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 IN (select null from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from st1 where f1 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where f1 IN (select null from st1) order by f1;

taos> select f1, f1 IN (select f1 from st1) from st1 where f1 > 0 and f1 IN (select f1 from st1) order by f1;
     f1      | f1 in (select f1 from st1) |
===========================================
           1 | true                       |
           2 | true                       |
           3 | true                       |
           4 | true                       |
           5 | true                       |
           6 | true                       |

taos> select f1, f1 IN (select f1 from st1 limit 0) from st1 where f1 > 0 and f1 IN (select f1 from st1 limit 0) order by f1;

taos> select f1, f1 IN (select null from st1) from st1 where f1 > 0 and f1 IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or f1 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(f1 IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(f1 IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(f1 IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(f1 IN (select null from st1)) order by 1;

taos> select true from st1 union select f1 IN (select f1 from st1) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select f1 IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select f1 IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 IN (select f1 from st1) a from st1 union all select f1 IN (select f1 from st1) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select f1 IN (select f1 from st1 limit 0) a from st1 union all select f1 IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select f1 IN (select null from st1) a from st1 union all select f1 IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select NULL IN (select f1 from st1) from st1 order by 1;
 null in (select f1 from st1) |
===============================
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |
 NULL                         |

taos> select NULL IN (select f1 from st1 limit 0) from st1 order by 1;
 null in (select f1 from st1 limit 0) |
=======================================
 false                                |
 false                                |
 false                                |
 false                                |
 false                                |
 false                                |

taos> select NULL IN (select null from st1) from st1 order by 1;
 null in (select null from st1) |
=================================
 NULL                           |
 NULL                           |
 NULL                           |
 NULL                           |
 NULL                           |
 NULL                           |

taos> select tags NULL IN (select f1 from st1) from st1 order by 1;
 null in (select f1 from st1) |
===============================
 NULL                         |
 NULL                         |
 NULL                         |

taos> select tags NULL IN (select f1 from st1 limit 0) from st1 order by 1;
 null in (select f1 from st1 limit 0) |
=======================================
 false                                |
 false                                |
 false                                |

taos> select tags NULL IN (select null from st1) from st1 order by 1;
 null in (select null from st1) |
=================================
 NULL                           |
 NULL                           |
 NULL                           |

taos> select distinct NULL IN (select f1 from st1) from st1 order by 1;
 null in (select f1 from st1) |
===============================
 NULL                         |

taos> select distinct NULL IN (select f1 from st1 limit 0) from st1 order by 1;
 null in (select f1 from st1 limit 0) |
=======================================
 false                                |

taos> select distinct NULL IN (select null from st1) from st1 order by 1;
 null in (select null from st1) |
=================================
 NULL                           |

taos> select NULL IN (select f1 from st1), NULL IN (select f1 from st1) from st1 order by 1;
 null in (select f1 from st1) | null in (select f1 from st1) |
==============================================================
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |
 NULL                         | NULL                         |

taos> select NULL IN (select f1 from st1 limit 0), NULL IN (select f1 from st1 limit 0) from st1 order by 1;
 null in (select f1 from st1 limit 0) | null in (select f1 from st1 limit 0) |
==============================================================================
 false                                | false                                |
 false                                | false                                |
 false                                | false                                |
 false                                | false                                |
 false                                | false                                |
 false                                | false                                |

taos> select NULL IN (select null from st1), NULL IN (select null from st1) from st1 order by 1;
 null in (select null from st1) | null in (select null from st1) |
==================================================================
 NULL                           | NULL                           |
 NULL                           | NULL                           |
 NULL                           | NULL                           |
 NULL                           | NULL                           |
 NULL                           | NULL                           |
 NULL                           | NULL                           |

taos> select NULL IN (select f1 from st1), * from st1 order by ts, f1;
 null in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
===================================================================================================
 NULL                         | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                         | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                         | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                         | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                         | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                         | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select NULL IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 null in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
===========================================================================================================
 false                                | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                                | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                                | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                                | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                                | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                                | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select NULL IN (select null from st1), * from st1 order by ts, f1;
 null in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
=====================================================================================================
 NULL                           | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                           | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                           | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                           | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                           | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                           | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when NULL IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when null in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
===================================================================================
                                                        2 |                     5 |
                                                        2 |                     1 |
                                                        2 |                     3 |
                                                        2 |                     6 |
                                                        2 |                     2 |
                                                        2 |                     4 |

taos> select case when NULL IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when null in (select f1 from st1 limit 0) then 1 else 2 end |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when NULL IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when null in (select null from st1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     5 |
                                                          2 |                     1 |
                                                          2 |                     3 |
                                                          2 |                     6 |
                                                          2 |                     2 |
                                                          2 |                     4 |

taos> select case when f1 = 1 then 1 else NULL IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else null in (select f1 from st1) end |        sum(f1)        |
========================================================================================
 NULL                                                          |                     5 |
                                                             1 |                     1 |
 NULL                                                          |                     3 |
 NULL                                                          |                     6 |
 NULL                                                          |                     2 |
 NULL                                                          |                     4 |

taos> select case when f1 = 1 then 1 else NULL IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else null in (select f1 from st1 limit 0 |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else NULL IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else null in (select null from st1) end |        sum(f1)        |
==========================================================================================
 NULL                                                            |                     5 |
                                                               1 |                     1 |
 NULL                                                            |                     3 |
 NULL                                                            |                     6 |
 NULL                                                            |                     2 |
 NULL                                                            |                     4 |

taos> select _wstart, NULL IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | null in (select f1 from st1) |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.000 | NULL                         |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                         |                         4 |
 2025-12-03 00:00:00.000 | NULL                         |                         6 |

taos> select _wstart, NULL IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | null in (select f1 from st1 limit 0) |          avg(f1)          |
=============================================================================================
 2025-12-01 00:00:00.000 | false                                |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                                |                         4 |
 2025-12-03 00:00:00.000 | false                                |                         6 |

taos> select _wstart, NULL IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | null in (select null from st1) |          avg(f1)          |
=======================================================================================
 2025-12-01 00:00:00.000 | NULL                           |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                           |                         4 |
 2025-12-03 00:00:00.000 | NULL                           |                         6 |

taos> select case NULL IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case null in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
=========================================================================================
                                                          2 |          2.33333333333333 |
                                                          2 |                         4 |
                                                          2 |                         6 |

taos> select case NULL IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case null in (select f1 from st1 limit 0) when 1 then 1 else 2 e |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select case NULL IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case null in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
===========================================================================================
                                                            2 |          2.33333333333333 |
                                                            2 |                         4 |
                                                            2 |                         6 |

taos> select sum(case when NULL IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when NULL IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when NULL IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, NULL IN (select f1 from st1) from st1 group by f1;
     f1      | null in (select f1 from st1) |
=============================================
           5 | NULL                         |
           1 | NULL                         |
           3 | NULL                         |
           6 | NULL                         |
           2 | NULL                         |
           4 | NULL                         |

taos> select f1, NULL IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | null in (select f1 from st1 limit 0) |
=====================================================
           5 | false                                |
           1 | false                                |
           3 | false                                |
           6 | false                                |
           2 | false                                |
           4 | false                                |

taos> select f1, NULL IN (select null from st1) from st1 group by f1;
     f1      | null in (select null from st1) |
===============================================
           5 | NULL                           |
           1 | NULL                           |
           3 | NULL                           |
           6 | NULL                           |
           2 | NULL                           |
           4 | NULL                           |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and NULL IN (select f1 from st1) order by b.f1;

taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and NULL IN (select f1 from st1 limit 0) order by b.f1;

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and NULL IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and NULL IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and NULL IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and NULL IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where NULL IN (select f1 from st1) order by f1;

taos> select f1 from st1 where NULL IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where NULL IN (select null from st1) order by f1;

taos> select f1, NULL IN (select f1 from st1) from st1 where f1 > 0 and NULL IN (select f1 from st1) order by f1;

taos> select f1, NULL IN (select f1 from st1 limit 0) from st1 where f1 > 0 and NULL IN (select f1 from st1 limit 0) order by f1;

taos> select f1, NULL IN (select null from st1) from st1 where f1 > 0 and NULL IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or NULL IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or NULL IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or NULL IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(NULL IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(NULL IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(NULL IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(NULL IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(NULL IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(NULL IN (select null from st1)) order by 1;

taos> select true from st1 union select NULL IN (select f1 from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select true from st1 union select NULL IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select NULL IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select NULL IN (select f1 from st1) a from st1 union all select NULL IN (select f1 from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select NULL IN (select f1 from st1 limit 0) a from st1 union all select NULL IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select NULL IN (select null from st1) a from st1 union all select NULL IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select 123.45 IN (select f1 from st1) from st1 order by 1;
 123.45 in (select f1 from st1) |
=================================
 false                          |
 false                          |
 false                          |
 false                          |
 false                          |
 false                          |

taos> select 123.45 IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 in (select f1 from st1 limit 0) |
=========================================
 false                                  |
 false                                  |
 false                                  |
 false                                  |
 false                                  |
 false                                  |

taos> select 123.45 IN (select null from st1) from st1 order by 1;
 123.45 in (select null from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |

taos> select tags 123.45 IN (select f1 from st1) from st1 order by 1;
 123.45 in (select f1 from st1) |
=================================
 false                          |
 false                          |
 false                          |

taos> select tags 123.45 IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 in (select f1 from st1 limit 0) |
=========================================
 false                                  |
 false                                  |
 false                                  |

taos> select tags 123.45 IN (select null from st1) from st1 order by 1;
 123.45 in (select null from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |

taos> select distinct 123.45 IN (select f1 from st1) from st1 order by 1;
 123.45 in (select f1 from st1) |
=================================
 false                          |

taos> select distinct 123.45 IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 in (select f1 from st1 limit 0) |
=========================================
 false                                  |

taos> select distinct 123.45 IN (select null from st1) from st1 order by 1;
 123.45 in (select null from st1) |
===================================
 NULL                             |

taos> select 123.45 IN (select f1 from st1), 123.45 IN (select f1 from st1) from st1 order by 1;
 123.45 in (select f1 from st1) | 123.45 in (select f1 from st1) |
==================================================================
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |

taos> select 123.45 IN (select f1 from st1 limit 0), 123.45 IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 in (select f1 from st1 limit 0) | 123.45 in (select f1 from st1 limit 0) |
==================================================================================
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |

taos> select 123.45 IN (select null from st1), 123.45 IN (select null from st1) from st1 order by 1;
 123.45 in (select null from st1) | 123.45 in (select null from st1) |
======================================================================
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |

taos> select 123.45 IN (select f1 from st1), * from st1 order by ts, f1;
 123.45 in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=====================================================================================================
 false                          | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                          | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                          | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                          | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                          | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                          | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 123.45 IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 123.45 in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
=============================================================================================================
 false                                  | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                                  | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                                  | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                                  | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                                  | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                                  | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 123.45 IN (select null from st1), * from st1 order by ts, f1;
 123.45 in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                             | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                             | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                             | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                             | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                             | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when 123.45 IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 123.45 in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     5 |
                                                          2 |                     1 |
                                                          2 |                     3 |
                                                          2 |                     6 |
                                                          2 |                     2 |
                                                          2 |                     4 |

taos> select case when 123.45 IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 123.45 in (select f1 from st1 limit 0) then 1 else 2 e |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when 123.45 IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 123.45 in (select null from st1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     5 |
                                                            2 |                     1 |
                                                            2 |                     3 |
                                                            2 |                     6 |
                                                            2 |                     2 |
                                                            2 |                     4 |

taos> select case when f1 = 1 then 1 else 123.45 IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 123.45 in (select f1 from st1) end |        sum(f1)        |
==========================================================================================
                                                               0 |                     5 |
                                                               1 |                     1 |
                                                               0 |                     3 |
                                                               0 |                     6 |
                                                               0 |                     2 |
                                                               0 |                     4 |

taos> select case when f1 = 1 then 1 else 123.45 IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 123.45 in (select f1 from st1 limit |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else 123.45 IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 123.45 in (select null from st1) en |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, 123.45 IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | 123.45 in (select f1 from st1) |          avg(f1)          |
=======================================================================================
 2025-12-01 00:00:00.000 | false                          |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                          |                         4 |
 2025-12-03 00:00:00.000 | false                          |                         6 |

taos> select _wstart, 123.45 IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | 123.45 in (select f1 from st1 limit 0) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 | false                                  |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                                  |                         4 |
 2025-12-03 00:00:00.000 | false                                  |                         6 |

taos> select _wstart, 123.45 IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | 123.45 in (select null from st1) |          avg(f1)          |
=========================================================================================
 2025-12-01 00:00:00.000 | NULL                             |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                             |                         4 |
 2025-12-03 00:00:00.000 | NULL                             |                         6 |

taos> select case 123.45 IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 123.45 in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
===========================================================================================
                                                            2 |          2.33333333333333 |
                                                            2 |                         4 |
                                                            2 |                         6 |

taos> select case 123.45 IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 123.45 in (select f1 from st1 limit 0) when 1 then 1 else 2 |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select case 123.45 IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 123.45 in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
=============================================================================================
                                                              2 |          2.33333333333333 |
                                                              2 |                         4 |
                                                              2 |                         6 |

taos> select sum(case when 123.45 IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 123.45 IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 123.45 IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, 123.45 IN (select f1 from st1) from st1 group by f1;
     f1      | 123.45 in (select f1 from st1) |
===============================================
           5 | false                          |
           1 | false                          |
           3 | false                          |
           6 | false                          |
           2 | false                          |
           4 | false                          |

taos> select f1, 123.45 IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | 123.45 in (select f1 from st1 limit 0) |
=======================================================
           5 | false                                  |
           1 | false                                  |
           3 | false                                  |
           6 | false                                  |
           2 | false                                  |
           4 | false                                  |

taos> select f1, 123.45 IN (select null from st1) from st1 group by f1;
     f1      | 123.45 in (select null from st1) |
=================================================
           5 | NULL                             |
           1 | NULL                             |
           3 | NULL                             |
           6 | NULL                             |
           2 | NULL                             |
           4 | NULL                             |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 123.45 IN (select f1 from st1) order by b.f1;

taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and 123.45 IN (select f1 from st1 limit 0) order by b.f1;

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 123.45 IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 123.45 IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and 123.45 IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 123.45 IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where 123.45 IN (select f1 from st1) order by f1;

taos> select f1 from st1 where 123.45 IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where 123.45 IN (select null from st1) order by f1;

taos> select f1, 123.45 IN (select f1 from st1) from st1 where f1 > 0 and 123.45 IN (select f1 from st1) order by f1;

taos> select f1, 123.45 IN (select f1 from st1 limit 0) from st1 where f1 > 0 and 123.45 IN (select f1 from st1 limit 0) order by f1;

taos> select f1, 123.45 IN (select null from st1) from st1 where f1 > 0 and 123.45 IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or 123.45 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 123.45 IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 123.45 IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(123.45 IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(123.45 IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(123.45 IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(123.45 IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(123.45 IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(123.45 IN (select null from st1)) order by 1;

taos> select true from st1 union select 123.45 IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select 123.45 IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select 123.45 IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 123.45 IN (select f1 from st1) a from st1 union all select 123.45 IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select 123.45 IN (select f1 from st1 limit 0) a from st1 union all select 123.45 IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select 123.45 IN (select null from st1) a from st1 union all select 123.45 IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select abs(-2) IN (select f1 from st1) from st1 order by 1;
 abs(-2) in (select f1 from st1) |
==================================
 true                            |
 true                            |
 true                            |
 true                            |
 true                            |
 true                            |

taos> select abs(-2) IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) in (select f1 from st1 limit 0) |
==========================================
 false                                   |
 false                                   |
 false                                   |
 false                                   |
 false                                   |
 false                                   |

taos> select abs(-2) IN (select null from st1) from st1 order by 1;
 abs(-2) in (select null from st1) |
====================================
 NULL                              |
 NULL                              |
 NULL                              |
 NULL                              |
 NULL                              |
 NULL                              |

taos> select tags abs(-2) IN (select f1 from st1) from st1 order by 1;
 abs(-2) in (select f1 from st1) |
==================================
 true                            |
 true                            |
 true                            |

taos> select tags abs(-2) IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) in (select f1 from st1 limit 0) |
==========================================
 false                                   |
 false                                   |
 false                                   |

taos> select tags abs(-2) IN (select null from st1) from st1 order by 1;
 abs(-2) in (select null from st1) |
====================================
 NULL                              |
 NULL                              |
 NULL                              |

taos> select distinct abs(-2) IN (select f1 from st1) from st1 order by 1;
 abs(-2) in (select f1 from st1) |
==================================
 true                            |

taos> select distinct abs(-2) IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) in (select f1 from st1 limit 0) |
==========================================
 false                                   |

taos> select distinct abs(-2) IN (select null from st1) from st1 order by 1;
 abs(-2) in (select null from st1) |
====================================
 NULL                              |

taos> select abs(-2) IN (select f1 from st1), abs(-2) IN (select f1 from st1) from st1 order by 1;
 abs(-2) in (select f1 from st1) | abs(-2) in (select f1 from st1) |
====================================================================
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |

taos> select abs(-2) IN (select f1 from st1 limit 0), abs(-2) IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) in (select f1 from st1 limit 0) | abs(-2) in (select f1 from st1 limit 0) |
====================================================================================
 false                                   | false                                   |
 false                                   | false                                   |
 false                                   | false                                   |
 false                                   | false                                   |
 false                                   | false                                   |
 false                                   | false                                   |

taos> select abs(-2) IN (select null from st1), abs(-2) IN (select null from st1) from st1 order by 1;
 abs(-2) in (select null from st1) | abs(-2) in (select null from st1) |
========================================================================
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |

taos> select abs(-2) IN (select f1 from st1), * from st1 order by ts, f1;
 abs(-2) in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
======================================================================================================
 true                            | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                            | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                            | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                            | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                            | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                            | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select abs(-2) IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 abs(-2) in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
==============================================================================================================
 false                                   | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                                   | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                                   | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                                   | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                                   | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                                   | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select abs(-2) IN (select null from st1), * from st1 order by ts, f1;
 abs(-2) in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
========================================================================================================
 NULL                              | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                              | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                              | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                              | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                              | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                              | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when abs(-2) IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when abs(-2) in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           1 |                     5 |
                                                           1 |                     1 |
                                                           1 |                     3 |
                                                           1 |                     6 |
                                                           1 |                     2 |
                                                           1 |                     4 |

taos> select case when abs(-2) IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when abs(-2) in (select f1 from st1 limit 0) then 1 else 2  |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when abs(-2) IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when abs(-2) in (select null from st1) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     5 |
                                                             2 |                     1 |
                                                             2 |                     3 |
                                                             2 |                     6 |
                                                             2 |                     2 |
                                                             2 |                     4 |

taos> select case when f1 = 1 then 1 else abs(-2) IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else abs(-2) in (select f1 from st1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else abs(-2) IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else abs(-2) in (select f1 from st1 limi |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else abs(-2) IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else abs(-2) in (select null from st1) e |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, abs(-2) IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | abs(-2) in (select f1 from st1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | true                            |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                            |                         4 |
 2025-12-03 00:00:00.000 | true                            |                         6 |

taos> select _wstart, abs(-2) IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | abs(-2) in (select f1 from st1 limit 0) |          avg(f1)          |
================================================================================================
 2025-12-01 00:00:00.000 | false                                   |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                                   |                         4 |
 2025-12-03 00:00:00.000 | false                                   |                         6 |

taos> select _wstart, abs(-2) IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | abs(-2) in (select null from st1) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | NULL                              |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                              |                         4 |
 2025-12-03 00:00:00.000 | NULL                              |                         6 |

taos> select case abs(-2) IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case abs(-2) in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             1 |          2.33333333333333 |
                                                             1 |                         4 |
                                                             1 |                         6 |

taos> select case abs(-2) IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case abs(-2) in (select f1 from st1 limit 0) when 1 then 1 else  |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select case abs(-2) IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case abs(-2) in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |          2.33333333333333 |
                                                               2 |                         4 |
                                                               2 |                         6 |

taos> select sum(case when abs(-2) IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when abs(-2) IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when abs(-2) IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, abs(-2) IN (select f1 from st1) from st1 group by f1;
     f1      | abs(-2) in (select f1 from st1) |
================================================
           5 | true                            |
           1 | true                            |
           3 | true                            |
           6 | true                            |
           2 | true                            |
           4 | true                            |

taos> select f1, abs(-2) IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | abs(-2) in (select f1 from st1 limit 0) |
========================================================
           5 | false                                   |
           1 | false                                   |
           3 | false                                   |
           6 | false                                   |
           2 | false                                   |
           4 | false                                   |

taos> select f1, abs(-2) IN (select null from st1) from st1 group by f1;
     f1      | abs(-2) in (select null from st1) |
==================================================
           5 | NULL                              |
           1 | NULL                              |
           3 | NULL                              |
           6 | NULL                              |
           2 | NULL                              |
           4 | NULL                              |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and abs(-2) IN (select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and abs(-2) IN (select f1 from st1 limit 0) order by b.f1;

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and abs(-2) IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and abs(-2) IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and abs(-2) IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and abs(-2) IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where abs(-2) IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where abs(-2) IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where abs(-2) IN (select null from st1) order by f1;

taos> select f1, abs(-2) IN (select f1 from st1) from st1 where f1 > 0 and abs(-2) IN (select f1 from st1) order by f1;
     f1      | abs(-2) in (select f1 from st1) |
================================================
           1 | true                            |
           2 | true                            |
           3 | true                            |
           4 | true                            |
           5 | true                            |
           6 | true                            |

taos> select f1, abs(-2) IN (select f1 from st1 limit 0) from st1 where f1 > 0 and abs(-2) IN (select f1 from st1 limit 0) order by f1;

taos> select f1, abs(-2) IN (select null from st1) from st1 where f1 > 0 and abs(-2) IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or abs(-2) IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or abs(-2) IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or abs(-2) IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(abs(-2) IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(abs(-2) IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(abs(-2) IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(abs(-2) IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(abs(-2) IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(abs(-2) IN (select null from st1)) order by 1;

taos> select true from st1 union select abs(-2) IN (select f1 from st1) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select abs(-2) IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select abs(-2) IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select abs(-2) IN (select f1 from st1) a from st1 union all select abs(-2) IN (select f1 from st1) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select abs(-2) IN (select f1 from st1 limit 0) a from st1 union all select abs(-2) IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select abs(-2) IN (select null from st1) a from st1 union all select abs(-2) IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select f1 + 1 IN (select f1 from st1) from st1 order by 1;
 f1 + 1 in (select f1 from st1) |
=================================
 false                          |
 true                           |
 true                           |
 true                           |
 true                           |
 true                           |

taos> select f1 + 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 in (select f1 from st1 limit 0) |
=========================================
 false                                  |
 false                                  |
 false                                  |
 false                                  |
 false                                  |
 false                                  |

taos> select f1 + 1 IN (select null from st1) from st1 order by 1;
 f1 + 1 in (select null from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |

taos> select tags f1 + 1 IN (select f1 from st1) from st1 order by 1;
 f1 + 1 in (select f1 from st1) |
=================================
 false                          |
 true                           |
 true                           |
 true                           |
 true                           |
 true                           |

taos> select tags f1 + 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 in (select f1 from st1 limit 0) |
=========================================
 false                                  |
 false                                  |
 false                                  |
 false                                  |
 false                                  |
 false                                  |

taos> select tags f1 + 1 IN (select null from st1) from st1 order by 1;
 f1 + 1 in (select null from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |

taos> select distinct f1 + 1 IN (select f1 from st1) from st1 order by 1;
 f1 + 1 in (select f1 from st1) |
=================================
 false                          |
 true                           |

taos> select distinct f1 + 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 in (select f1 from st1 limit 0) |
=========================================
 false                                  |

taos> select distinct f1 + 1 IN (select null from st1) from st1 order by 1;
 f1 + 1 in (select null from st1) |
===================================
 NULL                             |

taos> select f1 + 1 IN (select f1 from st1), f1 + 1 IN (select f1 from st1) from st1 order by 1;
 f1 + 1 in (select f1 from st1) | f1 + 1 in (select f1 from st1) |
==================================================================
 false                          | false                          |
 true                           | true                           |
 true                           | true                           |
 true                           | true                           |
 true                           | true                           |
 true                           | true                           |

taos> select f1 + 1 IN (select f1 from st1 limit 0), f1 + 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 in (select f1 from st1 limit 0) | f1 + 1 in (select f1 from st1 limit 0) |
==================================================================================
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |
 false                                  | false                                  |

taos> select f1 + 1 IN (select null from st1), f1 + 1 IN (select null from st1) from st1 order by 1;
 f1 + 1 in (select null from st1) | f1 + 1 in (select null from st1) |
======================================================================
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |

taos> select f1 + 1 IN (select f1 from st1), * from st1 order by ts, f1;
 f1 + 1 in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=====================================================================================================
 true                           | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                           | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                           | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                           | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                           | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                          | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 + 1 IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 f1 + 1 in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
=============================================================================================================
 false                                  | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                                  | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                                  | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                                  | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                                  | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                                  | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 + 1 IN (select null from st1), * from st1 order by ts, f1;
 f1 + 1 in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                             | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                             | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                             | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                             | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                             | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when f1 + 1 IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 + 1 in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     5 |
                                                          1 |                     1 |
                                                          1 |                     3 |
                                                          2 |                     6 |
                                                          1 |                     2 |
                                                          1 |                     4 |

taos> select case when f1 + 1 IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 + 1 in (select f1 from st1 limit 0) then 1 else 2 e |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when f1 + 1 IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 + 1 in (select null from st1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     5 |
                                                            2 |                     1 |
                                                            2 |                     3 |
                                                            2 |                     6 |
                                                            2 |                     2 |
                                                            2 |                     4 |

taos> select case when f1 = 1 then 1 else f1 + 1 IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 in (select f1 from st1) end |        sum(f1)        |
==========================================================================================
                                                               1 |                     5 |
                                                               1 |                     1 |
                                                               1 |                     3 |
                                                               0 |                     6 |
                                                               1 |                     2 |
                                                               1 |                     4 |

taos> select case when f1 = 1 then 1 else f1 + 1 IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 in (select f1 from st1 limit |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else f1 + 1 IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 in (select null from st1) en |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, f1 + 1 IN (select f1 from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 IN (select null from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 + 1 IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 + 1 IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 + 1 IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, f1 + 1 IN (select f1 from st1) from st1 group by f1;
     f1      | f1 + 1 in (select f1 from st1) |
===============================================
           5 | true                           |
           1 | true                           |
           3 | true                           |
           6 | false                          |
           2 | true                           |
           4 | true                           |

taos> select f1, f1 + 1 IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | f1 + 1 in (select f1 from st1 limit 0) |
=======================================================
           5 | false                                  |
           1 | false                                  |
           3 | false                                  |
           6 | false                                  |
           2 | false                                  |
           4 | false                                  |

taos> select f1, f1 + 1 IN (select null from st1) from st1 group by f1;
     f1      | f1 + 1 in (select null from st1) |
=================================================
           5 | NULL                             |
           1 | NULL                             |
           3 | NULL                             |
           6 | NULL                             |
           2 | NULL                             |
           4 | NULL                             |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 + 1 IN (select f1 from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and f1 + 1 IN (select f1 from st1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 + 1 IN (select null from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 + 1 IN (select f1 from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 + 1 IN (select f1 from st1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 + 1 IN (select null from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from st1 where f1 + 1 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |

taos> select f1 from st1 where f1 + 1 IN (select f1 from st1 limit 0) order by f1;

taos> select f1 from st1 where f1 + 1 IN (select null from st1) order by f1;

taos> select f1, f1 + 1 IN (select f1 from st1) from st1 where f1 > 0 and f1 + 1 IN (select f1 from st1) order by f1;
     f1      | f1 + 1 in (select f1 from st1) |
===============================================
           1 | true                           |
           2 | true                           |
           3 | true                           |
           4 | true                           |
           5 | true                           |

taos> select f1, f1 + 1 IN (select f1 from st1 limit 0) from st1 where f1 > 0 and f1 + 1 IN (select f1 from st1 limit 0) order by f1;

taos> select f1, f1 + 1 IN (select null from st1) from st1 where f1 > 0 and f1 + 1 IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or f1 + 1 IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 + 1 IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 + 1 IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 + 1 IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |

taos> select f1 from st1 partition by f1 having(f1 + 1 IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(f1 + 1 IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(f1 + 1 IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |

taos> select sum(f1) from st1 group by f1 having(f1 + 1 IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(f1 + 1 IN (select null from st1)) order by 1;

taos> select true from st1 union select f1 + 1 IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select f1 + 1 IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select f1 + 1 IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 + 1 IN (select f1 from st1) a from st1 union all select f1 + 1 IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select f1 + 1 IN (select f1 from st1 limit 0) a from st1 union all select f1 + 1 IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select f1 + 1 IN (select null from st1) a from st1 union all select f1 + 1 IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select sum(f1) IN (select f1 from st1) from st1 order by 1;
 sum(f1) in (select f1 from st1) |
==================================
 false                           |

taos> select sum(f1) IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) in (select f1 from st1 limit 0) |
==========================================
 false                                   |

taos> select sum(f1) IN (select null from st1) from st1 order by 1;
 sum(f1) in (select null from st1) |
====================================
 NULL                              |

taos> select tags sum(f1) IN (select f1 from st1) from st1 order by 1;
 sum(f1) in (select f1 from st1) |
==================================
 false                           |

taos> select tags sum(f1) IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) in (select f1 from st1 limit 0) |
==========================================
 false                                   |

taos> select tags sum(f1) IN (select null from st1) from st1 order by 1;
 sum(f1) in (select null from st1) |
====================================
 NULL                              |

taos> select distinct sum(f1) IN (select f1 from st1) from st1 order by 1;
 sum(f1) in (select f1 from st1) |
==================================
 false                           |

taos> select distinct sum(f1) IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) in (select f1 from st1 limit 0) |
==========================================
 false                                   |

taos> select distinct sum(f1) IN (select null from st1) from st1 order by 1;
 sum(f1) in (select null from st1) |
====================================
 NULL                              |

taos> select sum(f1) IN (select f1 from st1), sum(f1) IN (select f1 from st1) from st1 order by 1;
 sum(f1) in (select f1 from st1) | sum(f1) in (select f1 from st1) |
====================================================================
 false                           | false                           |

taos> select sum(f1) IN (select f1 from st1 limit 0), sum(f1) IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) in (select f1 from st1 limit 0) | sum(f1) in (select f1 from st1 limit 0) |
====================================================================================
 false                                   | false                                   |

taos> select sum(f1) IN (select null from st1), sum(f1) IN (select null from st1) from st1 order by 1;
 sum(f1) in (select null from st1) | sum(f1) in (select null from st1) |
========================================================================
 NULL                              | NULL                              |

taos> select sum(f1) IN (select f1 from st1), * from st1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) IN (select f1 from st1 limit 0), * from st1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) IN (select null from st1), * from st1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select case when sum(f1) IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when sum(f1) in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           1 |                     5 |
                                                           1 |                     1 |
                                                           1 |                     3 |
                                                           1 |                     6 |
                                                           1 |                     2 |
                                                           1 |                     4 |

taos> select case when sum(f1) IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when sum(f1) in (select f1 from st1 limit 0) then 1 else 2  |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when sum(f1) IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when sum(f1) in (select null from st1) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     5 |
                                                             2 |                     1 |
                                                             2 |                     3 |
                                                             2 |                     6 |
                                                             2 |                     2 |
                                                             2 |                     4 |

taos> select case when f1 = 1 then 1 else sum(f1) IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else sum(f1) in (select f1 from st1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else sum(f1) IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else sum(f1) in (select f1 from st1 limi |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else sum(f1) IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else sum(f1) in (select null from st1) e |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, sum(f1) IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | sum(f1) in (select f1 from st1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | false                           |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                           |                         4 |
 2025-12-03 00:00:00.000 | true                            |                         6 |

taos> select _wstart, sum(f1) IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | sum(f1) in (select f1 from st1 limit 0) |          avg(f1)          |
================================================================================================
 2025-12-01 00:00:00.000 | false                                   |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                                   |                         4 |
 2025-12-03 00:00:00.000 | false                                   |                         6 |

taos> select _wstart, sum(f1) IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | sum(f1) in (select null from st1) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | NULL                              |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                              |                         4 |
 2025-12-03 00:00:00.000 | NULL                              |                         6 |

taos> select case sum(f1) IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case sum(f1) in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             2 |          2.33333333333333 |
                                                             2 |                         4 |
                                                             1 |                         6 |

taos> select case sum(f1) IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case sum(f1) in (select f1 from st1 limit 0) when 1 then 1 else  |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select case sum(f1) IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case sum(f1) in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |          2.33333333333333 |
                                                               2 |                         4 |
                                                               2 |                         6 |

taos> select sum(case when sum(f1) IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select f1, sum(f1) IN (select f1 from st1) from st1 group by f1;
     f1      | sum(f1) in (select f1 from st1) |
================================================
           5 | true                            |
           1 | true                            |
           3 | true                            |
           6 | true                            |
           2 | true                            |
           4 | true                            |

taos> select f1, sum(f1) IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | sum(f1) in (select f1 from st1 limit 0) |
========================================================
           5 | false                                   |
           1 | false                                   |
           3 | false                                   |
           6 | false                                   |
           2 | false                                   |
           4 | false                                   |

taos> select f1, sum(f1) IN (select null from st1) from st1 group by f1;
     f1      | sum(f1) in (select null from st1) |
==================================================
           5 | NULL                              |
           1 | NULL                              |
           3 | NULL                              |
           6 | NULL                              |
           2 | NULL                              |
           4 | NULL                              |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and sum(f1) IN (select f1 from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and sum(f1) IN (select f1 from st1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and sum(f1) IN (select null from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and sum(f1) IN (select f1 from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and sum(f1) IN (select f1 from st1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and sum(f1) IN (select null from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from st1 where sum(f1) IN (select f1 from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where sum(f1) IN (select f1 from st1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where sum(f1) IN (select null from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) IN (select f1 from st1) from st1 where f1 > 0 and sum(f1) IN (select f1 from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) IN (select f1 from st1 limit 0) from st1 where f1 > 0 and sum(f1) IN (select f1 from st1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) IN (select null from st1) from st1 where f1 > 0 and sum(f1) IN (select null from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where f1 > 0 or sum(f1) IN (select f1 from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where f1 > 0 or sum(f1) IN (select f1 from st1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where f1 > 0 or sum(f1) IN (select null from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 partition by f1 having(sum(f1) IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(sum(f1) IN (select f1 from st1 limit 0)) order by f1;

taos> select f1 from st1 partition by f1 having(sum(f1) IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(sum(f1) IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(sum(f1) IN (select f1 from st1 limit 0)) order by 1;

taos> select sum(f1) from st1 group by f1 having(sum(f1) IN (select null from st1)) order by 1;

taos> select true from st1 union select sum(f1) IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select sum(f1) IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select sum(f1) IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select sum(f1) IN (select f1 from st1) a from st1 union all select sum(f1) IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |

taos> select sum(f1) IN (select f1 from st1 limit 0) a from st1 union all select sum(f1) IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 false |
 false |

taos> select sum(f1) IN (select null from st1) a from st1 union all select sum(f1) IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |

taos> select 1 NOT IN (select f1 from st1) from st1 order by 1;
 1 not in (select f1 from st1) |
================================
 false                         |
 false                         |
 false                         |
 false                         |
 false                         |
 false                         |

taos> select 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 1 not in (select f1 from st1 limit 0) |
========================================
 true                                  |
 true                                  |
 true                                  |
 true                                  |
 true                                  |
 true                                  |

taos> select 1 NOT IN (select null from st1) from st1 order by 1;
 1 not in (select null from st1) |
==================================
 NULL                            |
 NULL                            |
 NULL                            |
 NULL                            |
 NULL                            |
 NULL                            |

taos> select tags 1 NOT IN (select f1 from st1) from st1 order by 1;
 1 not in (select f1 from st1) |
================================
 false                         |
 false                         |
 false                         |

taos> select tags 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 1 not in (select f1 from st1 limit 0) |
========================================
 true                                  |
 true                                  |
 true                                  |

taos> select tags 1 NOT IN (select null from st1) from st1 order by 1;
 1 not in (select null from st1) |
==================================
 NULL                            |
 NULL                            |
 NULL                            |

taos> select distinct 1 NOT IN (select f1 from st1) from st1 order by 1;
 1 not in (select f1 from st1) |
================================
 false                         |

taos> select distinct 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 1 not in (select f1 from st1 limit 0) |
========================================
 true                                  |

taos> select distinct 1 NOT IN (select null from st1) from st1 order by 1;
 1 not in (select null from st1) |
==================================
 NULL                            |

taos> select 1 NOT IN (select f1 from st1), 1 NOT IN (select f1 from st1) from st1 order by 1;
 1 not in (select f1 from st1) | 1 not in (select f1 from st1) |
================================================================
 false                         | false                         |
 false                         | false                         |
 false                         | false                         |
 false                         | false                         |
 false                         | false                         |
 false                         | false                         |

taos> select 1 NOT IN (select f1 from st1 limit 0), 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 1 not in (select f1 from st1 limit 0) | 1 not in (select f1 from st1 limit 0) |
================================================================================
 true                                  | true                                  |
 true                                  | true                                  |
 true                                  | true                                  |
 true                                  | true                                  |
 true                                  | true                                  |
 true                                  | true                                  |

taos> select 1 NOT IN (select null from st1), 1 NOT IN (select null from st1) from st1 order by 1;
 1 not in (select null from st1) | 1 not in (select null from st1) |
====================================================================
 NULL                            | NULL                            |
 NULL                            | NULL                            |
 NULL                            | NULL                            |
 NULL                            | NULL                            |
 NULL                            | NULL                            |
 NULL                            | NULL                            |

taos> select 1 NOT IN (select f1 from st1), * from st1 order by ts, f1;
 1 not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
====================================================================================================
 false                         | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                         | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                         | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                         | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                         | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                         | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 1 NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 1 not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
============================================================================================================
 true                                  | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                  | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                  | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                  | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                  | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                  | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 1 NOT IN (select null from st1), * from st1 order by ts, f1;
 1 not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
======================================================================================================
 NULL                            | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                            | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                            | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                            | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                            | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                            | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when 1 NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 1 not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         2 |                     5 |
                                                         2 |                     1 |
                                                         2 |                     3 |
                                                         2 |                     6 |
                                                         2 |                     2 |
                                                         2 |                     4 |

taos> select case when 1 NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 1 not in (select f1 from st1 limit 0) then 1 else 2 en |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when 1 NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 1 not in (select null from st1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           2 |                     5 |
                                                           2 |                     1 |
                                                           2 |                     3 |
                                                           2 |                     6 |
                                                           2 |                     2 |
                                                           2 |                     4 |

taos> select case when f1 = 1 then 1 else 1 NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 1 not in (select f1 from st1) end |        sum(f1)        |
=========================================================================================
                                                              0 |                     5 |
                                                              1 |                     1 |
                                                              0 |                     3 |
                                                              0 |                     6 |
                                                              0 |                     2 |
                                                              0 |                     4 |

taos> select case when f1 = 1 then 1 else 1 NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 1 not in (select f1 from st1 limit  |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else 1 NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 1 not in (select null from st1) end |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, 1 NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | 1 not in (select f1 from st1) |          avg(f1)          |
======================================================================================
 2025-12-01 00:00:00.000 | false                         |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                         |                         4 |
 2025-12-03 00:00:00.000 | false                         |                         6 |

taos> select _wstart, 1 NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | 1 not in (select f1 from st1 limit 0) |          avg(f1)          |
==============================================================================================
 2025-12-01 00:00:00.000 | true                                  |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                  |                         4 |
 2025-12-03 00:00:00.000 | true                                  |                         6 |

taos> select _wstart, 1 NOT IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | 1 not in (select null from st1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | NULL                            |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                            |                         4 |
 2025-12-03 00:00:00.000 | NULL                            |                         6 |

taos> select case 1 NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 1 not in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
==========================================================================================
                                                           2 |          2.33333333333333 |
                                                           2 |                         4 |
                                                           2 |                         6 |

taos> select case 1 NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 1 not in (select f1 from st1 limit 0) when 1 then 1 else 2  |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case 1 NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 1 not in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             2 |          2.33333333333333 |
                                                             2 |                         4 |
                                                             2 |                         6 |

taos> select sum(case when 1 NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 1 NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 1 NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, 1 NOT IN (select f1 from st1) from st1 group by f1;
     f1      | 1 not in (select f1 from st1) |
==============================================
           5 | false                         |
           1 | false                         |
           3 | false                         |
           6 | false                         |
           2 | false                         |
           4 | false                         |

taos> select f1, 1 NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | 1 not in (select f1 from st1 limit 0) |
======================================================
           5 | true                                  |
           1 | true                                  |
           3 | true                                  |
           6 | true                                  |
           2 | true                                  |
           4 | true                                  |

taos> select f1, 1 NOT IN (select null from st1) from st1 group by f1;
     f1      | 1 not in (select null from st1) |
================================================
           5 | NULL                            |
           1 | NULL                            |
           3 | NULL                            |
           6 | NULL                            |
           2 | NULL                            |
           4 | NULL                            |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 1 NOT IN (select f1 from st1) order by b.f1;

taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and 1 NOT IN (select f1 from st1 limit 0) order by b.f1;
     f1      | (select f1 from st1 limit 0) + 1 |
=================================================
           1 | NULL                             |
           1 | NULL                             |
           1 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           3 | NULL                             |
           3 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           5 | NULL                             |
           5 | NULL                             |
           6 | NULL                             |

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 1 NOT IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 1 NOT IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and 1 NOT IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 1 NOT IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where 1 NOT IN (select f1 from st1) order by f1;

taos> select f1 from st1 where 1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where 1 NOT IN (select null from st1) order by f1;

taos> select f1, 1 NOT IN (select f1 from st1) from st1 where f1 > 0 and 1 NOT IN (select f1 from st1) order by f1;

taos> select f1, 1 NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and 1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | 1 not in (select f1 from st1 limit 0) |
======================================================
           1 | true                                  |
           2 | true                                  |
           3 | true                                  |
           4 | true                                  |
           5 | true                                  |
           6 | true                                  |

taos> select f1, 1 NOT IN (select null from st1) from st1 where f1 > 0 and 1 NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or 1 NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 1 NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(1 NOT IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(1 NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(1 NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(1 NOT IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(1 NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(1 NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select 1 NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select 1 NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 1 NOT IN (select f1 from st1) a from st1 union all select 1 NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select 1 NOT IN (select f1 from st1 limit 0) a from st1 union all select 1 NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select 1 NOT IN (select null from st1) a from st1 union all select 1 NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select 'a' NOT IN (select f1 from st1) from st1 order by 1;
 'a' not in (select f1 from st1) |
==================================
 true                            |
 true                            |
 true                            |
 true                            |
 true                            |
 true                            |

taos> select 'a' NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' not in (select f1 from st1 limit 0) |
==========================================
 true                                    |
 true                                    |
 true                                    |
 true                                    |
 true                                    |
 true                                    |

taos> select 'a' NOT IN (select null from st1) from st1 order by 1;
 'a' not in (select null from st1) |
====================================
 NULL                              |
 NULL                              |
 NULL                              |
 NULL                              |
 NULL                              |
 NULL                              |

taos> select tags 'a' NOT IN (select f1 from st1) from st1 order by 1;
 'a' not in (select f1 from st1) |
==================================
 true                            |
 true                            |
 true                            |

taos> select tags 'a' NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' not in (select f1 from st1 limit 0) |
==========================================
 true                                    |
 true                                    |
 true                                    |

taos> select tags 'a' NOT IN (select null from st1) from st1 order by 1;
 'a' not in (select null from st1) |
====================================
 NULL                              |
 NULL                              |
 NULL                              |

taos> select distinct 'a' NOT IN (select f1 from st1) from st1 order by 1;
 'a' not in (select f1 from st1) |
==================================
 true                            |

taos> select distinct 'a' NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' not in (select f1 from st1 limit 0) |
==========================================
 true                                    |

taos> select distinct 'a' NOT IN (select null from st1) from st1 order by 1;
 'a' not in (select null from st1) |
====================================
 NULL                              |

taos> select 'a' NOT IN (select f1 from st1), 'a' NOT IN (select f1 from st1) from st1 order by 1;
 'a' not in (select f1 from st1) | 'a' not in (select f1 from st1) |
====================================================================
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |
 true                            | true                            |

taos> select 'a' NOT IN (select f1 from st1 limit 0), 'a' NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 'a' not in (select f1 from st1 limit 0) | 'a' not in (select f1 from st1 limit 0) |
====================================================================================
 true                                    | true                                    |
 true                                    | true                                    |
 true                                    | true                                    |
 true                                    | true                                    |
 true                                    | true                                    |
 true                                    | true                                    |

taos> select 'a' NOT IN (select null from st1), 'a' NOT IN (select null from st1) from st1 order by 1;
 'a' not in (select null from st1) | 'a' not in (select null from st1) |
========================================================================
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |
 NULL                              | NULL                              |

taos> select 'a' NOT IN (select f1 from st1), * from st1 order by ts, f1;
 'a' not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
======================================================================================================
 true                            | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                            | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                            | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                            | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                            | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                            | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 'a' NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 'a' not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
==============================================================================================================
 true                                    | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                    | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                    | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                    | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                    | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                    | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 'a' NOT IN (select null from st1), * from st1 order by ts, f1;
 'a' not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
========================================================================================================
 NULL                              | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                              | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                              | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                              | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                              | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                              | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when 'a' NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 'a' not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
======================================================================================
                                                           1 |                     5 |
                                                           1 |                     1 |
                                                           1 |                     3 |
                                                           1 |                     6 |
                                                           1 |                     2 |
                                                           1 |                     4 |

taos> select case when 'a' NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 'a' not in (select f1 from st1 limit 0) then 1 else 2  |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when 'a' NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 'a' not in (select null from st1) then 1 else 2 end |        sum(f1)        |
========================================================================================
                                                             2 |                     5 |
                                                             2 |                     1 |
                                                             2 |                     3 |
                                                             2 |                     6 |
                                                             2 |                     2 |
                                                             2 |                     4 |

taos> select case when f1 = 1 then 1 else 'a' NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 'a' not in (select f1 from st1) end |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else 'a' NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 'a' not in (select f1 from st1 limi |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else 'a' NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 'a' not in (select null from st1) e |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, 'a' NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | 'a' not in (select f1 from st1) |          avg(f1)          |
========================================================================================
 2025-12-01 00:00:00.000 | true                            |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                            |                         4 |
 2025-12-03 00:00:00.000 | true                            |                         6 |

taos> select _wstart, 'a' NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | 'a' not in (select f1 from st1 limit 0) |          avg(f1)          |
================================================================================================
 2025-12-01 00:00:00.000 | true                                    |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                    |                         4 |
 2025-12-03 00:00:00.000 | true                                    |                         6 |

taos> select _wstart, 'a' NOT IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | 'a' not in (select null from st1) |          avg(f1)          |
==========================================================================================
 2025-12-01 00:00:00.000 | NULL                              |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                              |                         4 |
 2025-12-03 00:00:00.000 | NULL                              |                         6 |

taos> select case 'a' NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 'a' not in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
============================================================================================
                                                             1 |          2.33333333333333 |
                                                             1 |                         4 |
                                                             1 |                         6 |

taos> select case 'a' NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 'a' not in (select f1 from st1 limit 0) when 1 then 1 else  |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case 'a' NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 'a' not in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
==============================================================================================
                                                               2 |          2.33333333333333 |
                                                               2 |                         4 |
                                                               2 |                         6 |

taos> select sum(case when 'a' NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 'a' NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 'a' NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, 'a' NOT IN (select f1 from st1) from st1 group by f1;
     f1      | 'a' not in (select f1 from st1) |
================================================
           5 | true                            |
           1 | true                            |
           3 | true                            |
           6 | true                            |
           2 | true                            |
           4 | true                            |

taos> select f1, 'a' NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | 'a' not in (select f1 from st1 limit 0) |
========================================================
           5 | true                                    |
           1 | true                                    |
           3 | true                                    |
           6 | true                                    |
           2 | true                                    |
           4 | true                                    |

taos> select f1, 'a' NOT IN (select null from st1) from st1 group by f1;
     f1      | 'a' not in (select null from st1) |
==================================================
           5 | NULL                              |
           1 | NULL                              |
           3 | NULL                              |
           6 | NULL                              |
           2 | NULL                              |
           4 | NULL                              |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 'a' NOT IN (select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and 'a' NOT IN (select f1 from st1 limit 0) order by b.f1;
     f1      | (select f1 from st1 limit 0) + 1 |
=================================================
           1 | NULL                             |
           1 | NULL                             |
           1 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           3 | NULL                             |
           3 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           5 | NULL                             |
           5 | NULL                             |
           6 | NULL                             |

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 'a' NOT IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 'a' NOT IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and 'a' NOT IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 'a' NOT IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where 'a' NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where 'a' NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where 'a' NOT IN (select null from st1) order by f1;

taos> select f1, 'a' NOT IN (select f1 from st1) from st1 where f1 > 0 and 'a' NOT IN (select f1 from st1) order by f1;
     f1      | 'a' not in (select f1 from st1) |
================================================
           1 | true                            |
           2 | true                            |
           3 | true                            |
           4 | true                            |
           5 | true                            |
           6 | true                            |

taos> select f1, 'a' NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and 'a' NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | 'a' not in (select f1 from st1 limit 0) |
========================================================
           1 | true                                    |
           2 | true                                    |
           3 | true                                    |
           4 | true                                    |
           5 | true                                    |
           6 | true                                    |

taos> select f1, 'a' NOT IN (select null from st1) from st1 where f1 > 0 and 'a' NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or 'a' NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 'a' NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 'a' NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having('a' NOT IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having('a' NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having('a' NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having('a' NOT IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having('a' NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having('a' NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select 'a' NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select 'a' NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select 'a' NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 'a' NOT IN (select f1 from st1) a from st1 union all select 'a' NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select 'a' NOT IN (select f1 from st1 limit 0) a from st1 union all select 'a' NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select 'a' NOT IN (select null from st1) a from st1 union all select 'a' NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select f1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 not in (select f1 from st1) |
=================================
 false                          |
 false                          |
 false                          |
 false                          |
 false                          |
 false                          |

taos> select f1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 not in (select f1 from st1 limit 0) |
=========================================
 true                                   |
 true                                   |
 true                                   |
 true                                   |
 true                                   |
 true                                   |

taos> select f1 NOT IN (select null from st1) from st1 order by 1;
 f1 not in (select null from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |

taos> select tags f1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 not in (select f1 from st1) |
=================================
 false                          |
 false                          |
 false                          |
 false                          |
 false                          |
 false                          |

taos> select tags f1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 not in (select f1 from st1 limit 0) |
=========================================
 true                                   |
 true                                   |
 true                                   |
 true                                   |
 true                                   |
 true                                   |

taos> select tags f1 NOT IN (select null from st1) from st1 order by 1;
 f1 not in (select null from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |

taos> select distinct f1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 not in (select f1 from st1) |
=================================
 false                          |

taos> select distinct f1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 not in (select f1 from st1 limit 0) |
=========================================
 true                                   |

taos> select distinct f1 NOT IN (select null from st1) from st1 order by 1;
 f1 not in (select null from st1) |
===================================
 NULL                             |

taos> select f1 NOT IN (select f1 from st1), f1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 not in (select f1 from st1) | f1 not in (select f1 from st1) |
==================================================================
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |
 false                          | false                          |

taos> select f1 NOT IN (select f1 from st1 limit 0), f1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 not in (select f1 from st1 limit 0) | f1 not in (select f1 from st1 limit 0) |
==================================================================================
 true                                   | true                                   |
 true                                   | true                                   |
 true                                   | true                                   |
 true                                   | true                                   |
 true                                   | true                                   |
 true                                   | true                                   |

taos> select f1 NOT IN (select null from st1), f1 NOT IN (select null from st1) from st1 order by 1;
 f1 not in (select null from st1) | f1 not in (select null from st1) |
======================================================================
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |

taos> select f1 NOT IN (select f1 from st1), * from st1 order by ts, f1;
 f1 not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=====================================================================================================
 false                          | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                          | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                          | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                          | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                          | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                          | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 f1 not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
=============================================================================================================
 true                                   | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                   | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                   | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                   | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                   | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                   | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 NOT IN (select null from st1), * from st1 order by ts, f1;
 f1 not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                             | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                             | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                             | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                             | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                             | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when f1 NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          2 |                     5 |
                                                          2 |                     1 |
                                                          2 |                     3 |
                                                          2 |                     6 |
                                                          2 |                     2 |
                                                          2 |                     4 |

taos> select case when f1 NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 not in (select f1 from st1 limit 0) then 1 else 2 e |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 not in (select null from st1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     5 |
                                                            2 |                     1 |
                                                            2 |                     3 |
                                                            2 |                     6 |
                                                            2 |                     2 |
                                                            2 |                     4 |

taos> select case when f1 = 1 then 1 else f1 NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 not in (select f1 from st1) end |        sum(f1)        |
==========================================================================================
                                                               0 |                     5 |
                                                               1 |                     1 |
                                                               0 |                     3 |
                                                               0 |                     6 |
                                                               0 |                     2 |
                                                               0 |                     4 |

taos> select case when f1 = 1 then 1 else f1 NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 not in (select f1 from st1 limit |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else f1 NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 not in (select null from st1) en |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, f1 NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 NOT IN (select null from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, f1 NOT IN (select f1 from st1) from st1 group by f1;
     f1      | f1 not in (select f1 from st1) |
===============================================
           5 | false                          |
           1 | false                          |
           3 | false                          |
           6 | false                          |
           2 | false                          |
           4 | false                          |

taos> select f1, f1 NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | f1 not in (select f1 from st1 limit 0) |
=======================================================
           5 | true                                   |
           1 | true                                   |
           3 | true                                   |
           6 | true                                   |
           2 | true                                   |
           4 | true                                   |

taos> select f1, f1 NOT IN (select null from st1) from st1 group by f1;
     f1      | f1 not in (select null from st1) |
=================================================
           5 | NULL                             |
           1 | NULL                             |
           3 | NULL                             |
           6 | NULL                             |
           2 | NULL                             |
           4 | NULL                             |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 NOT IN (select f1 from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and f1 NOT IN (select f1 from st1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 NOT IN (select null from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 NOT IN (select f1 from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 NOT IN (select f1 from st1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 NOT IN (select null from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from st1 where f1 NOT IN (select f1 from st1) order by f1;

taos> select f1 from st1 where f1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 NOT IN (select null from st1) order by f1;

taos> select f1, f1 NOT IN (select f1 from st1) from st1 where f1 > 0 and f1 NOT IN (select f1 from st1) order by f1;

taos> select f1, f1 NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and f1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | f1 not in (select f1 from st1 limit 0) |
=======================================================
           1 | true                                   |
           2 | true                                   |
           3 | true                                   |
           4 | true                                   |
           5 | true                                   |
           6 | true                                   |

taos> select f1, f1 NOT IN (select null from st1) from st1 where f1 > 0 and f1 NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or f1 NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 NOT IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(f1 NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(f1 NOT IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(f1 NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(f1 NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select f1 NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select f1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select f1 NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 NOT IN (select f1 from st1) a from st1 union all select f1 NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select f1 NOT IN (select f1 from st1 limit 0) a from st1 union all select f1 NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select f1 NOT IN (select null from st1) a from st1 union all select f1 NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select NULL NOT IN (select f1 from st1) from st1 order by 1;
 null not in (select f1 from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |
 NULL                             |

taos> select NULL NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 null not in (select f1 from st1 limit 0) |
===========================================
 true                                     |
 true                                     |
 true                                     |
 true                                     |
 true                                     |
 true                                     |

taos> select NULL NOT IN (select null from st1) from st1 order by 1;
 null not in (select null from st1) |
=====================================
 NULL                               |
 NULL                               |
 NULL                               |
 NULL                               |
 NULL                               |
 NULL                               |

taos> select tags NULL NOT IN (select f1 from st1) from st1 order by 1;
 null not in (select f1 from st1) |
===================================
 NULL                             |
 NULL                             |
 NULL                             |

taos> select tags NULL NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 null not in (select f1 from st1 limit 0) |
===========================================
 true                                     |
 true                                     |
 true                                     |

taos> select tags NULL NOT IN (select null from st1) from st1 order by 1;
 null not in (select null from st1) |
=====================================
 NULL                               |
 NULL                               |
 NULL                               |

taos> select distinct NULL NOT IN (select f1 from st1) from st1 order by 1;
 null not in (select f1 from st1) |
===================================
 NULL                             |

taos> select distinct NULL NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 null not in (select f1 from st1 limit 0) |
===========================================
 true                                     |

taos> select distinct NULL NOT IN (select null from st1) from st1 order by 1;
 null not in (select null from st1) |
=====================================
 NULL                               |

taos> select NULL NOT IN (select f1 from st1), NULL NOT IN (select f1 from st1) from st1 order by 1;
 null not in (select f1 from st1) | null not in (select f1 from st1) |
======================================================================
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |
 NULL                             | NULL                             |

taos> select NULL NOT IN (select f1 from st1 limit 0), NULL NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 null not in (select f1 from st1 limit 0) | null not in (select f1 from st1 limit 0) |
======================================================================================
 true                                     | true                                     |
 true                                     | true                                     |
 true                                     | true                                     |
 true                                     | true                                     |
 true                                     | true                                     |
 true                                     | true                                     |

taos> select NULL NOT IN (select null from st1), NULL NOT IN (select null from st1) from st1 order by 1;
 null not in (select null from st1) | null not in (select null from st1) |
==========================================================================
 NULL                               | NULL                               |
 NULL                               | NULL                               |
 NULL                               | NULL                               |
 NULL                               | NULL                               |
 NULL                               | NULL                               |
 NULL                               | NULL                               |

taos> select NULL NOT IN (select f1 from st1), * from st1 order by ts, f1;
 null not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================
 NULL                             | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                             | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                             | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                             | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                             | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                             | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select NULL NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 null not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
===============================================================================================================
 true                                     | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                     | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                     | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                     | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                     | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                     | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select NULL NOT IN (select null from st1), * from st1 order by ts, f1;
 null not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
=========================================================================================================
 NULL                               | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                               | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                               | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                               | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                               | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                               | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when NULL NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when null not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=======================================================================================
                                                            2 |                     5 |
                                                            2 |                     1 |
                                                            2 |                     3 |
                                                            2 |                     6 |
                                                            2 |                     2 |
                                                            2 |                     4 |

taos> select case when NULL NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when null not in (select f1 from st1 limit 0) then 1 else 2 |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when NULL NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when null not in (select null from st1) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              2 |                     5 |
                                                              2 |                     1 |
                                                              2 |                     3 |
                                                              2 |                     6 |
                                                              2 |                     2 |
                                                              2 |                     4 |

taos> select case when f1 = 1 then 1 else NULL NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else null not in (select f1 from st1) en |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select case when f1 = 1 then 1 else NULL NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else null not in (select f1 from st1 lim |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else NULL NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else null not in (select null from st1)  |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, NULL NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | null not in (select f1 from st1) |          avg(f1)          |
=========================================================================================
 2025-12-01 00:00:00.000 | NULL                             |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                             |                         4 |
 2025-12-03 00:00:00.000 | NULL                             |                         6 |

taos> select _wstart, NULL NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | null not in (select f1 from st1 limit 0) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 | true                                     |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                     |                         4 |
 2025-12-03 00:00:00.000 | true                                     |                         6 |

taos> select _wstart, NULL NOT IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | null not in (select null from st1) |          avg(f1)          |
===========================================================================================
 2025-12-01 00:00:00.000 | NULL                               |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                               |                         4 |
 2025-12-03 00:00:00.000 | NULL                               |                         6 |

taos> select case NULL NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case null not in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
=============================================================================================
                                                              2 |          2.33333333333333 |
                                                              2 |                         4 |
                                                              2 |                         6 |

taos> select case NULL NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case null not in (select f1 from st1 limit 0) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case NULL NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case null not in (select null from st1) when 1 then 1 else 2 end |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select sum(case when NULL NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when NULL NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when NULL NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, NULL NOT IN (select f1 from st1) from st1 group by f1;
     f1      | null not in (select f1 from st1) |
=================================================
           5 | NULL                             |
           1 | NULL                             |
           3 | NULL                             |
           6 | NULL                             |
           2 | NULL                             |
           4 | NULL                             |

taos> select f1, NULL NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | null not in (select f1 from st1 limit 0) |
=========================================================
           5 | true                                     |
           1 | true                                     |
           3 | true                                     |
           6 | true                                     |
           2 | true                                     |
           4 | true                                     |

taos> select f1, NULL NOT IN (select null from st1) from st1 group by f1;
     f1      | null not in (select null from st1) |
===================================================
           5 | NULL                               |
           1 | NULL                               |
           3 | NULL                               |
           6 | NULL                               |
           2 | NULL                               |
           4 | NULL                               |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and NULL NOT IN (select f1 from st1) order by b.f1;

taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and NULL NOT IN (select f1 from st1 limit 0) order by b.f1;
     f1      | (select f1 from st1 limit 0) + 1 |
=================================================
           1 | NULL                             |
           1 | NULL                             |
           1 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           3 | NULL                             |
           3 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           5 | NULL                             |
           5 | NULL                             |
           6 | NULL                             |

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and NULL NOT IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and NULL NOT IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and NULL NOT IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and NULL NOT IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where NULL NOT IN (select f1 from st1) order by f1;

taos> select f1 from st1 where NULL NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where NULL NOT IN (select null from st1) order by f1;

taos> select f1, NULL NOT IN (select f1 from st1) from st1 where f1 > 0 and NULL NOT IN (select f1 from st1) order by f1;

taos> select f1, NULL NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and NULL NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | null not in (select f1 from st1 limit 0) |
=========================================================
           1 | true                                     |
           2 | true                                     |
           3 | true                                     |
           4 | true                                     |
           5 | true                                     |
           6 | true                                     |

taos> select f1, NULL NOT IN (select null from st1) from st1 where f1 > 0 and NULL NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or NULL NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or NULL NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or NULL NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(NULL NOT IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(NULL NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(NULL NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(NULL NOT IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(NULL NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(NULL NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select NULL NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select true from st1 union select NULL NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select NULL NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select NULL NOT IN (select f1 from st1) a from st1 union all select NULL NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select NULL NOT IN (select f1 from st1 limit 0) a from st1 union all select NULL NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select NULL NOT IN (select null from st1) a from st1 union all select NULL NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select 123.45 NOT IN (select f1 from st1) from st1 order by 1;
 123.45 not in (select f1 from st1) |
=====================================
 true                               |
 true                               |
 true                               |
 true                               |
 true                               |
 true                               |

taos> select 123.45 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 not in (select f1 from st1 limit 0) |
=============================================
 true                                       |
 true                                       |
 true                                       |
 true                                       |
 true                                       |
 true                                       |

taos> select 123.45 NOT IN (select null from st1) from st1 order by 1;
 123.45 not in (select null from st1) |
=======================================
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |

taos> select tags 123.45 NOT IN (select f1 from st1) from st1 order by 1;
 123.45 not in (select f1 from st1) |
=====================================
 true                               |
 true                               |
 true                               |

taos> select tags 123.45 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 not in (select f1 from st1 limit 0) |
=============================================
 true                                       |
 true                                       |
 true                                       |

taos> select tags 123.45 NOT IN (select null from st1) from st1 order by 1;
 123.45 not in (select null from st1) |
=======================================
 NULL                                 |
 NULL                                 |
 NULL                                 |

taos> select distinct 123.45 NOT IN (select f1 from st1) from st1 order by 1;
 123.45 not in (select f1 from st1) |
=====================================
 true                               |

taos> select distinct 123.45 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 not in (select f1 from st1 limit 0) |
=============================================
 true                                       |

taos> select distinct 123.45 NOT IN (select null from st1) from st1 order by 1;
 123.45 not in (select null from st1) |
=======================================
 NULL                                 |

taos> select 123.45 NOT IN (select f1 from st1), 123.45 NOT IN (select f1 from st1) from st1 order by 1;
 123.45 not in (select f1 from st1) | 123.45 not in (select f1 from st1) |
==========================================================================
 true                               | true                               |
 true                               | true                               |
 true                               | true                               |
 true                               | true                               |
 true                               | true                               |
 true                               | true                               |

taos> select 123.45 NOT IN (select f1 from st1 limit 0), 123.45 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 123.45 not in (select f1 from st1 limit 0) | 123.45 not in (select f1 from st1 limit 0) |
==========================================================================================
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |

taos> select 123.45 NOT IN (select null from st1), 123.45 NOT IN (select null from st1) from st1 order by 1;
 123.45 not in (select null from st1) | 123.45 not in (select null from st1) |
==============================================================================
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |

taos> select 123.45 NOT IN (select f1 from st1), * from st1 order by ts, f1;
 123.45 not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=========================================================================================================
 true                               | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                               | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                               | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                               | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                               | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                               | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 123.45 NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 123.45 not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
=================================================================================================================
 true                                       | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                       | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                       | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                       | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                       | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                       | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select 123.45 NOT IN (select null from st1), * from st1 order by ts, f1;
 123.45 not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
===========================================================================================================
 NULL                                 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                                 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                                 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                                 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                                 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                                 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when 123.45 NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 123.45 not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              1 |                     5 |
                                                              1 |                     1 |
                                                              1 |                     3 |
                                                              1 |                     6 |
                                                              1 |                     2 |
                                                              1 |                     4 |

taos> select case when 123.45 NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 123.45 not in (select f1 from st1 limit 0) then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when 123.45 NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when 123.45 not in (select null from st1) then 1 else 2 end |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when f1 = 1 then 1 else 123.45 NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 123.45 not in (select f1 from st1)  |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else 123.45 NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 123.45 not in (select f1 from st1 l |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else 123.45 NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else 123.45 not in (select null from st1 |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, 123.45 NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | 123.45 not in (select f1 from st1) |          avg(f1)          |
===========================================================================================
 2025-12-01 00:00:00.000 | true                               |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                               |                         4 |
 2025-12-03 00:00:00.000 | true                               |                         6 |

taos> select _wstart, 123.45 NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | 123.45 not in (select f1 from st1 limit 0) |          avg(f1)          |
===================================================================================================
 2025-12-01 00:00:00.000 | true                                       |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                       |                         4 |
 2025-12-03 00:00:00.000 | true                                       |                         6 |

taos> select _wstart, 123.45 NOT IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | 123.45 not in (select null from st1) |          avg(f1)          |
=============================================================================================
 2025-12-01 00:00:00.000 | NULL                                 |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                                 |                         4 |
 2025-12-03 00:00:00.000 | NULL                                 |                         6 |

taos> select case 123.45 NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 123.45 not in (select f1 from st1) when 1 then 1 else 2 end |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case 123.45 NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 123.45 not in (select f1 from st1 limit 0) when 1 then 1 el |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case 123.45 NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case 123.45 not in (select null from st1) when 1 then 1 else 2 e |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select sum(case when 123.45 NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 123.45 NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when 123.45 NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, 123.45 NOT IN (select f1 from st1) from st1 group by f1;
     f1      | 123.45 not in (select f1 from st1) |
===================================================
           5 | true                               |
           1 | true                               |
           3 | true                               |
           6 | true                               |
           2 | true                               |
           4 | true                               |

taos> select f1, 123.45 NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | 123.45 not in (select f1 from st1 limit 0) |
===========================================================
           5 | true                                       |
           1 | true                                       |
           3 | true                                       |
           6 | true                                       |
           2 | true                                       |
           4 | true                                       |

taos> select f1, 123.45 NOT IN (select null from st1) from st1 group by f1;
     f1      | 123.45 not in (select null from st1) |
=====================================================
           5 | NULL                                 |
           1 | NULL                                 |
           3 | NULL                                 |
           6 | NULL                                 |
           2 | NULL                                 |
           4 | NULL                                 |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from st1 limit 0) order by b.f1;
     f1      | (select f1 from st1 limit 0) + 1 |
=================================================
           1 | NULL                             |
           1 | NULL                             |
           1 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           3 | NULL                             |
           3 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           5 | NULL                             |
           5 | NULL                             |
           6 | NULL                             |

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and 123.45 NOT IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and 123.45 NOT IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and 123.45 NOT IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where 123.45 NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where 123.45 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where 123.45 NOT IN (select null from st1) order by f1;

taos> select f1, 123.45 NOT IN (select f1 from st1) from st1 where f1 > 0 and 123.45 NOT IN (select f1 from st1) order by f1;
     f1      | 123.45 not in (select f1 from st1) |
===================================================
           1 | true                               |
           2 | true                               |
           3 | true                               |
           4 | true                               |
           5 | true                               |
           6 | true                               |

taos> select f1, 123.45 NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and 123.45 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | 123.45 not in (select f1 from st1 limit 0) |
===========================================================
           1 | true                                       |
           2 | true                                       |
           3 | true                                       |
           4 | true                                       |
           5 | true                                       |
           6 | true                                       |

taos> select f1, 123.45 NOT IN (select null from st1) from st1 where f1 > 0 and 123.45 NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or 123.45 NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 123.45 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or 123.45 NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(123.45 NOT IN (select f1 from st1)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(123.45 NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(123.45 NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(123.45 NOT IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(123.45 NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(123.45 NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select 123.45 NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select 123.45 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select 123.45 NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select 123.45 NOT IN (select f1 from st1) a from st1 union all select 123.45 NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select 123.45 NOT IN (select f1 from st1 limit 0) a from st1 union all select 123.45 NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select 123.45 NOT IN (select null from st1) a from st1 union all select 123.45 NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select abs(-2) NOT IN (select f1 from st1) from st1 order by 1;
 abs(-2) not in (select f1 from st1) |
======================================
 false                               |
 false                               |
 false                               |
 false                               |
 false                               |
 false                               |

taos> select abs(-2) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) not in (select f1 from st1 limit 0) |
==============================================
 true                                        |
 true                                        |
 true                                        |
 true                                        |
 true                                        |
 true                                        |

taos> select abs(-2) NOT IN (select null from st1) from st1 order by 1;
 abs(-2) not in (select null from st1) |
========================================
 NULL                                  |
 NULL                                  |
 NULL                                  |
 NULL                                  |
 NULL                                  |
 NULL                                  |

taos> select tags abs(-2) NOT IN (select f1 from st1) from st1 order by 1;
 abs(-2) not in (select f1 from st1) |
======================================
 false                               |
 false                               |
 false                               |

taos> select tags abs(-2) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) not in (select f1 from st1 limit 0) |
==============================================
 true                                        |
 true                                        |
 true                                        |

taos> select tags abs(-2) NOT IN (select null from st1) from st1 order by 1;
 abs(-2) not in (select null from st1) |
========================================
 NULL                                  |
 NULL                                  |
 NULL                                  |

taos> select distinct abs(-2) NOT IN (select f1 from st1) from st1 order by 1;
 abs(-2) not in (select f1 from st1) |
======================================
 false                               |

taos> select distinct abs(-2) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) not in (select f1 from st1 limit 0) |
==============================================
 true                                        |

taos> select distinct abs(-2) NOT IN (select null from st1) from st1 order by 1;
 abs(-2) not in (select null from st1) |
========================================
 NULL                                  |

taos> select abs(-2) NOT IN (select f1 from st1), abs(-2) NOT IN (select f1 from st1) from st1 order by 1;
 abs(-2) not in (select f1 from st1) | abs(-2) not in (select f1 from st1) |
============================================================================
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |
 false                               | false                               |

taos> select abs(-2) NOT IN (select f1 from st1 limit 0), abs(-2) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 abs(-2) not in (select f1 from st1 limit 0) | abs(-2) not in (select f1 from st1 limit 0) |
============================================================================================
 true                                        | true                                        |
 true                                        | true                                        |
 true                                        | true                                        |
 true                                        | true                                        |
 true                                        | true                                        |
 true                                        | true                                        |

taos> select abs(-2) NOT IN (select null from st1), abs(-2) NOT IN (select null from st1) from st1 order by 1;
 abs(-2) not in (select null from st1) | abs(-2) not in (select null from st1) |
================================================================================
 NULL                                  | NULL                                  |
 NULL                                  | NULL                                  |
 NULL                                  | NULL                                  |
 NULL                                  | NULL                                  |
 NULL                                  | NULL                                  |
 NULL                                  | NULL                                  |

taos> select abs(-2) NOT IN (select f1 from st1), * from st1 order by ts, f1;
 abs(-2) not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
==========================================================================================================
 false                               | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                               | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                               | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                               | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                               | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 false                               | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select abs(-2) NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 abs(-2) not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
==================================================================================================================
 true                                        | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                        | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                        | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                        | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                        | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                        | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select abs(-2) NOT IN (select null from st1), * from st1 order by ts, f1;
 abs(-2) not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
============================================================================================================
 NULL                                  | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                                  | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                                  | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                                  | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                                  | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                                  | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when abs(-2) NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when abs(-2) not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
==========================================================================================
                                                               2 |                     5 |
                                                               2 |                     1 |
                                                               2 |                     3 |
                                                               2 |                     6 |
                                                               2 |                     2 |
                                                               2 |                     4 |

taos> select case when abs(-2) NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when abs(-2) not in (select f1 from st1 limit 0) then 1 els |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when abs(-2) NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when abs(-2) not in (select null from st1) then 1 else 2 en |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when f1 = 1 then 1 else abs(-2) NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else abs(-2) not in (select f1 from st1) |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else abs(-2) NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else abs(-2) not in (select f1 from st1  |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else abs(-2) NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else abs(-2) not in (select null from st |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, abs(-2) NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | abs(-2) not in (select f1 from st1) |          avg(f1)          |
============================================================================================
 2025-12-01 00:00:00.000 | false                               |          2.33333333333333 |
 2025-12-02 00:00:00.000 | false                               |                         4 |
 2025-12-03 00:00:00.000 | false                               |                         6 |

taos> select _wstart, abs(-2) NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | abs(-2) not in (select f1 from st1 limit 0) |          avg(f1)          |
====================================================================================================
 2025-12-01 00:00:00.000 | true                                        |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                        |                         4 |
 2025-12-03 00:00:00.000 | true                                        |                         6 |

taos> select _wstart, abs(-2) NOT IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | abs(-2) not in (select null from st1) |          avg(f1)          |
==============================================================================================
 2025-12-01 00:00:00.000 | NULL                                  |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                                  |                         4 |
 2025-12-03 00:00:00.000 | NULL                                  |                         6 |

taos> select case abs(-2) NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case abs(-2) not in (select f1 from st1) when 1 then 1 else 2 en |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select case abs(-2) NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case abs(-2) not in (select f1 from st1 limit 0) when 1 then 1 e |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case abs(-2) NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case abs(-2) not in (select null from st1) when 1 then 1 else 2  |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select sum(case when abs(-2) NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when abs(-2) NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when abs(-2) NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, abs(-2) NOT IN (select f1 from st1) from st1 group by f1;
     f1      | abs(-2) not in (select f1 from st1) |
====================================================
           5 | false                               |
           1 | false                               |
           3 | false                               |
           6 | false                               |
           2 | false                               |
           4 | false                               |

taos> select f1, abs(-2) NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | abs(-2) not in (select f1 from st1 limit 0) |
============================================================
           5 | true                                        |
           1 | true                                        |
           3 | true                                        |
           6 | true                                        |
           2 | true                                        |
           4 | true                                        |

taos> select f1, abs(-2) NOT IN (select null from st1) from st1 group by f1;
     f1      | abs(-2) not in (select null from st1) |
======================================================
           5 | NULL                                  |
           1 | NULL                                  |
           3 | NULL                                  |
           6 | NULL                                  |
           2 | NULL                                  |
           4 | NULL                                  |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from st1) order by b.f1;

taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from st1 limit 0) order by b.f1;
     f1      | (select f1 from st1 limit 0) + 1 |
=================================================
           1 | NULL                             |
           1 | NULL                             |
           1 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           2 | NULL                             |
           3 | NULL                             |
           3 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           4 | NULL                             |
           5 | NULL                             |
           5 | NULL                             |
           6 | NULL                             |

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and abs(-2) NOT IN (select null from st1) order by b.f1;

taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and abs(-2) NOT IN (select f1 from st1 limit 0);
 (select f1 from st1 limit 0) + 1 | avg((select f1 from st1 limit 0) + 2) |
===========================================================================
 NULL                             | NULL                                  |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and abs(-2) NOT IN (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where abs(-2) NOT IN (select f1 from st1) order by f1;

taos> select f1 from st1 where abs(-2) NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where abs(-2) NOT IN (select null from st1) order by f1;

taos> select f1, abs(-2) NOT IN (select f1 from st1) from st1 where f1 > 0 and abs(-2) NOT IN (select f1 from st1) order by f1;

taos> select f1, abs(-2) NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and abs(-2) NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | abs(-2) not in (select f1 from st1 limit 0) |
============================================================
           1 | true                                        |
           2 | true                                        |
           3 | true                                        |
           4 | true                                        |
           5 | true                                        |
           6 | true                                        |

taos> select f1, abs(-2) NOT IN (select null from st1) from st1 where f1 > 0 and abs(-2) NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or abs(-2) NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or abs(-2) NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or abs(-2) NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(abs(-2) NOT IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(abs(-2) NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(abs(-2) NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(abs(-2) NOT IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(abs(-2) NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(abs(-2) NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select abs(-2) NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select abs(-2) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select abs(-2) NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select abs(-2) NOT IN (select f1 from st1) a from st1 union all select abs(-2) NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |

taos> select abs(-2) NOT IN (select f1 from st1 limit 0) a from st1 union all select abs(-2) NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select abs(-2) NOT IN (select null from st1) a from st1 union all select abs(-2) NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select f1 + 1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 + 1 not in (select f1 from st1) |
=====================================
 false                              |
 false                              |
 false                              |
 false                              |
 false                              |
 true                               |

taos> select f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 not in (select f1 from st1 limit 0) |
=============================================
 true                                       |
 true                                       |
 true                                       |
 true                                       |
 true                                       |
 true                                       |

taos> select f1 + 1 NOT IN (select null from st1) from st1 order by 1;
 f1 + 1 not in (select null from st1) |
=======================================
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |

taos> select tags f1 + 1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 + 1 not in (select f1 from st1) |
=====================================
 false                              |
 false                              |
 false                              |
 false                              |
 false                              |
 true                               |

taos> select tags f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 not in (select f1 from st1 limit 0) |
=============================================
 true                                       |
 true                                       |
 true                                       |
 true                                       |
 true                                       |
 true                                       |

taos> select tags f1 + 1 NOT IN (select null from st1) from st1 order by 1;
 f1 + 1 not in (select null from st1) |
=======================================
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |
 NULL                                 |

taos> select distinct f1 + 1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 + 1 not in (select f1 from st1) |
=====================================
 false                              |
 true                               |

taos> select distinct f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 not in (select f1 from st1 limit 0) |
=============================================
 true                                       |

taos> select distinct f1 + 1 NOT IN (select null from st1) from st1 order by 1;
 f1 + 1 not in (select null from st1) |
=======================================
 NULL                                 |

taos> select f1 + 1 NOT IN (select f1 from st1), f1 + 1 NOT IN (select f1 from st1) from st1 order by 1;
 f1 + 1 not in (select f1 from st1) | f1 + 1 not in (select f1 from st1) |
==========================================================================
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |
 false                              | false                              |
 true                               | true                               |

taos> select f1 + 1 NOT IN (select f1 from st1 limit 0), f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 f1 + 1 not in (select f1 from st1 limit 0) | f1 + 1 not in (select f1 from st1 limit 0) |
==========================================================================================
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |
 true                                       | true                                       |

taos> select f1 + 1 NOT IN (select null from st1), f1 + 1 NOT IN (select null from st1) from st1 order by 1;
 f1 + 1 not in (select null from st1) | f1 + 1 not in (select null from st1) |
==============================================================================
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |
 NULL                                 | NULL                                 |

taos> select f1 + 1 NOT IN (select f1 from st1), * from st1 order by ts, f1;
 f1 + 1 not in (select f1 from st1) |           ts            |     f1      |     f2      |     tg1     |
=========================================================================================================
 false                              | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 false                              | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 false                              | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 false                              | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 false                              | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                               | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 + 1 NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;
 f1 + 1 not in (select f1 from st1 limit 0) |           ts            |     f1      |     f2      |     tg1     |
=================================================================================================================
 true                                       | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 true                                       | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 true                                       | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 true                                       | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 true                                       | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 true                                       | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select f1 + 1 NOT IN (select null from st1), * from st1 order by ts, f1;
 f1 + 1 not in (select null from st1) |           ts            |     f1      |     f2      |     tg1     |
===========================================================================================================
 NULL                                 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 NULL                                 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
 NULL                                 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
 NULL                                 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
 NULL                                 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
 NULL                                 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select case when f1 + 1 NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 + 1 not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
=========================================================================================
                                                              2 |                     5 |
                                                              2 |                     1 |
                                                              2 |                     3 |
                                                              1 |                     6 |
                                                              2 |                     2 |
                                                              2 |                     4 |

taos> select case when f1 + 1 NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 + 1 not in (select f1 from st1 limit 0) then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 + 1 NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when f1 + 1 not in (select null from st1) then 1 else 2 end |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when f1 = 1 then 1 else f1 + 1 NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 not in (select f1 from st1)  |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                1 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else f1 + 1 NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 not in (select f1 from st1 l |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else f1 + 1 NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else f1 + 1 not in (select null from st1 |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, f1 + 1 NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select _wstart, f1 + 1 NOT IN (select null from st1), avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case f1 + 1 NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select sum(case when f1 + 1 NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 + 1 NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 + 1 NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select f1, f1 + 1 NOT IN (select f1 from st1) from st1 group by f1;
     f1      | f1 + 1 not in (select f1 from st1) |
===================================================
           5 | false                              |
           1 | false                              |
           3 | false                              |
           6 | true                               |
           2 | false                              |
           4 | false                              |

taos> select f1, f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | f1 + 1 not in (select f1 from st1 limit 0) |
===========================================================
           5 | true                                       |
           1 | true                                       |
           3 | true                                       |
           6 | true                                       |
           2 | true                                       |
           4 | true                                       |

taos> select f1, f1 + 1 NOT IN (select null from st1) from st1 group by f1;
     f1      | f1 + 1 not in (select null from st1) |
=====================================================
           5 | NULL                                 |
           1 | NULL                                 |
           3 | NULL                                 |
           6 | NULL                                 |
           2 | NULL                                 |
           4 | NULL                                 |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from st1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and f1 + 1 NOT IN (select null from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 + 1 NOT IN (select f1 from st1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and f1 + 1 NOT IN (select null from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from st1 where f1 + 1 NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           6 |

taos> select f1 from st1 where f1 + 1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 + 1 NOT IN (select null from st1) order by f1;

taos> select f1, f1 + 1 NOT IN (select f1 from st1) from st1 where f1 > 0 and f1 + 1 NOT IN (select f1 from st1) order by f1;
     f1      | f1 + 1 not in (select f1 from st1) |
===================================================
           6 | true                               |

taos> select f1, f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and f1 + 1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      | f1 + 1 not in (select f1 from st1 limit 0) |
===========================================================
           1 | true                                       |
           2 | true                                       |
           3 | true                                       |
           4 | true                                       |
           5 | true                                       |
           6 | true                                       |

taos> select f1, f1 + 1 NOT IN (select null from st1) from st1 where f1 > 0 and f1 + 1 NOT IN (select null from st1) order by f1;

taos> select f1 from st1 where f1 > 0 or f1 + 1 NOT IN (select f1 from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 + 1 NOT IN (select f1 from st1 limit 0) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 > 0 or f1 + 1 NOT IN (select null from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 + 1 NOT IN (select f1 from st1)) order by f1;
     f1      |
==============
           6 |

taos> select f1 from st1 partition by f1 having(f1 + 1 NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(f1 + 1 NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(f1 + 1 NOT IN (select f1 from st1)) order by 1;
        sum(f1)        |
========================
                     6 |

taos> select sum(f1) from st1 group by f1 having(f1 + 1 NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(f1 + 1 NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select f1 + 1 NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 false |
 true  |

taos> select true from st1 union select f1 + 1 NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select f1 + 1 NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select f1 + 1 NOT IN (select f1 from st1) a from st1 union all select f1 + 1 NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 false |
 true  |
 true  |

taos> select f1 + 1 NOT IN (select f1 from st1 limit 0) a from st1 union all select f1 + 1 NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |
 true  |

taos> select f1 + 1 NOT IN (select null from st1) a from st1 union all select f1 + 1 NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |
 NULL  |

taos> select sum(f1) NOT IN (select f1 from st1) from st1 order by 1;
 sum(f1) not in (select f1 from st1) |
======================================
 true                                |

taos> select sum(f1) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) not in (select f1 from st1 limit 0) |
==============================================
 true                                        |

taos> select sum(f1) NOT IN (select null from st1) from st1 order by 1;
 sum(f1) not in (select null from st1) |
========================================
 NULL                                  |

taos> select tags sum(f1) NOT IN (select f1 from st1) from st1 order by 1;
 sum(f1) not in (select f1 from st1) |
======================================
 true                                |

taos> select tags sum(f1) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) not in (select f1 from st1 limit 0) |
==============================================
 true                                        |

taos> select tags sum(f1) NOT IN (select null from st1) from st1 order by 1;
 sum(f1) not in (select null from st1) |
========================================
 NULL                                  |

taos> select distinct sum(f1) NOT IN (select f1 from st1) from st1 order by 1;
 sum(f1) not in (select f1 from st1) |
======================================
 true                                |

taos> select distinct sum(f1) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) not in (select f1 from st1 limit 0) |
==============================================
 true                                        |

taos> select distinct sum(f1) NOT IN (select null from st1) from st1 order by 1;
 sum(f1) not in (select null from st1) |
========================================
 NULL                                  |

taos> select sum(f1) NOT IN (select f1 from st1), sum(f1) NOT IN (select f1 from st1) from st1 order by 1;
 sum(f1) not in (select f1 from st1) | sum(f1) not in (select f1 from st1) |
============================================================================
 true                                | true                                |

taos> select sum(f1) NOT IN (select f1 from st1 limit 0), sum(f1) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 sum(f1) not in (select f1 from st1 limit 0) | sum(f1) not in (select f1 from st1 limit 0) |
============================================================================================
 true                                        | true                                        |

taos> select sum(f1) NOT IN (select null from st1), sum(f1) NOT IN (select null from st1) from st1 order by 1;
 sum(f1) not in (select null from st1) | sum(f1) not in (select null from st1) |
================================================================================
 NULL                                  | NULL                                  |

taos> select sum(f1) NOT IN (select f1 from st1), * from st1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) NOT IN (select f1 from st1 limit 0), * from st1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select sum(f1) NOT IN (select null from st1), * from st1 order by ts, f1;

DB error: Not a single-group group function [0x8000260C] 
taos> select case when sum(f1) NOT IN (select f1 from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when sum(f1) not in (select f1 from st1) then 1 else 2 end |        sum(f1)        |
==========================================================================================
                                                               2 |                     5 |
                                                               2 |                     1 |
                                                               2 |                     3 |
                                                               2 |                     6 |
                                                               2 |                     2 |
                                                               2 |                     4 |

taos> select case when sum(f1) NOT IN (select f1 from st1 limit 0) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when sum(f1) not in (select f1 from st1 limit 0) then 1 els |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when sum(f1) NOT IN (select null from st1) then 1 else 2 end, sum(f1) from st1 group by f1;
 case when sum(f1) not in (select null from st1) then 1 else 2 en |        sum(f1)        |
===========================================================================================
                                                                2 |                     5 |
                                                                2 |                     1 |
                                                                2 |                     3 |
                                                                2 |                     6 |
                                                                2 |                     2 |
                                                                2 |                     4 |

taos> select case when f1 = 1 then 1 else sum(f1) NOT IN (select f1 from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else sum(f1) not in (select f1 from st1) |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     6 |
                                                                0 |                     2 |
                                                                0 |                     4 |

taos> select case when f1 = 1 then 1 else sum(f1) NOT IN (select f1 from st1 limit 0) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else sum(f1) not in (select f1 from st1  |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     6 |
                                                                1 |                     2 |
                                                                1 |                     4 |

taos> select case when f1 = 1 then 1 else sum(f1) NOT IN (select null from st1) end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else sum(f1) not in (select null from st |        sum(f1)        |
===========================================================================================
 NULL                                                             |                     5 |
                                                                1 |                     1 |
 NULL                                                             |                     3 |
 NULL                                                             |                     6 |
 NULL                                                             |                     2 |
 NULL                                                             |                     4 |

taos> select _wstart, sum(f1) NOT IN (select f1 from st1), avg(f1) from st1 interval(1d);
         _wstart         | sum(f1) not in (select f1 from st1) |          avg(f1)          |
============================================================================================
 2025-12-01 00:00:00.000 | true                                |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                |                         4 |
 2025-12-03 00:00:00.000 | false                               |                         6 |

taos> select _wstart, sum(f1) NOT IN (select f1 from st1 limit 0), avg(f1) from st1 interval(1d);
         _wstart         | sum(f1) not in (select f1 from st1 limit 0) |          avg(f1)          |
====================================================================================================
 2025-12-01 00:00:00.000 | true                                        |          2.33333333333333 |
 2025-12-02 00:00:00.000 | true                                        |                         4 |
 2025-12-03 00:00:00.000 | true                                        |                         6 |

taos> select _wstart, sum(f1) NOT IN (select null from st1), avg(f1) from st1 interval(1d);
         _wstart         | sum(f1) not in (select null from st1) |          avg(f1)          |
==============================================================================================
 2025-12-01 00:00:00.000 | NULL                                  |          2.33333333333333 |
 2025-12-02 00:00:00.000 | NULL                                  |                         4 |
 2025-12-03 00:00:00.000 | NULL                                  |                         6 |

taos> select case sum(f1) NOT IN (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case sum(f1) not in (select f1 from st1) when 1 then 1 else 2 en |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                2 |                         6 |

taos> select case sum(f1) NOT IN (select f1 from st1 limit 0) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case sum(f1) not in (select f1 from st1 limit 0) when 1 then 1 e |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case sum(f1) NOT IN (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case sum(f1) not in (select null from st1) when 1 then 1 else 2  |          avg(f1)          |
===============================================================================================
                                                                2 |          2.33333333333333 |
                                                                2 |                         4 |
                                                                2 |                         6 |

taos> select sum(case when sum(f1) NOT IN (select f1 from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) NOT IN (select f1 from st1 limit 0) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select sum(case when sum(f1) NOT IN (select null from st1) then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Aggregate functions do not support nesting [0x80002627] 
taos> select f1, sum(f1) NOT IN (select f1 from st1) from st1 group by f1;
     f1      | sum(f1) not in (select f1 from st1) |
====================================================
           5 | false                               |
           1 | false                               |
           3 | false                               |
           6 | false                               |
           2 | false                               |
           4 | false                               |

taos> select f1, sum(f1) NOT IN (select f1 from st1 limit 0) from st1 group by f1;
     f1      | sum(f1) not in (select f1 from st1 limit 0) |
============================================================
           5 | true                                        |
           1 | true                                        |
           3 | true                                        |
           6 | true                                        |
           2 | true                                        |
           4 | true                                        |

taos> select f1, sum(f1) NOT IN (select null from st1) from st1 group by f1;
     f1      | sum(f1) not in (select null from st1) |
======================================================
           5 | NULL                                  |
           1 | NULL                                  |
           3 | NULL                                  |
           6 | NULL                                  |
           2 | NULL                                  |
           4 | NULL                                  |

taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select f1 from st1 limit 0) + 1 from st1 a join st1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from st1 limit 0) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and sum(f1) NOT IN (select null from st1) order by b.f1;

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select f1 from st1 limit 0) + 1, avg((select f1 from st1 limit 0) + 2) from st1 a left join st1 b on a.ts = b.ts and sum(f1) NOT IN (select f1 from st1 limit 0);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and sum(f1) NOT IN (select null from st1);

DB error: Column is ambiguous: f1 [0x80002604] 
taos> select f1 from st1 where sum(f1) NOT IN (select f1 from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where sum(f1) NOT IN (select f1 from st1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where sum(f1) NOT IN (select null from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) NOT IN (select f1 from st1) from st1 where f1 > 0 and sum(f1) NOT IN (select f1 from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) NOT IN (select f1 from st1 limit 0) from st1 where f1 > 0 and sum(f1) NOT IN (select f1 from st1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1, sum(f1) NOT IN (select null from st1) from st1 where f1 > 0 and sum(f1) NOT IN (select null from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where f1 > 0 or sum(f1) NOT IN (select f1 from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where f1 > 0 or sum(f1) NOT IN (select f1 from st1 limit 0) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 where f1 > 0 or sum(f1) NOT IN (select null from st1) order by f1;

DB error: There mustn't be aggregation [0x80002608] 
taos> select f1 from st1 partition by f1 having(sum(f1) NOT IN (select f1 from st1)) order by f1;

taos> select f1 from st1 partition by f1 having(sum(f1) NOT IN (select f1 from st1 limit 0)) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 partition by f1 having(sum(f1) NOT IN (select null from st1)) order by f1;

taos> select sum(f1) from st1 group by f1 having(sum(f1) NOT IN (select f1 from st1)) order by 1;

taos> select sum(f1) from st1 group by f1 having(sum(f1) NOT IN (select f1 from st1 limit 0)) order by 1;
        sum(f1)        |
========================
                     1 |
                     2 |
                     3 |
                     4 |
                     5 |
                     6 |

taos> select sum(f1) from st1 group by f1 having(sum(f1) NOT IN (select null from st1)) order by 1;

taos> select true from st1 union select sum(f1) NOT IN (select f1 from st1) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select sum(f1) NOT IN (select f1 from st1 limit 0) from st1 order by 1;
 true  |
========
 true  |

taos> select true from st1 union select sum(f1) NOT IN (select null from st1) from st1 order by 1;
 true  |
========
 NULL  |
 true  |

taos> select sum(f1) NOT IN (select f1 from st1) a from st1 union all select sum(f1) NOT IN (select f1 from st1) b from st1 order by a;
   a   |
========
 true  |
 true  |

taos> select sum(f1) NOT IN (select f1 from st1 limit 0) a from st1 union all select sum(f1) NOT IN (select f1 from st1 limit 0) b from st1 order by a;
   a   |
========
 true  |
 true  |

taos> select sum(f1) NOT IN (select null from st1) a from st1 union all select sum(f1) NOT IN (select null from st1) b from st1 order by a;
   a   |
========
 NULL  |
 NULL  |

