
taos> use db1;
Database changed.

taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb1 order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from tb1 partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from tb1 interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb1 union select f1 from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb1 union all select f1 from tb1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) from tb1;
 (select f1 from tb1) |
=======================
                    1 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) from tb1;
 (select f1 from tb1 order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select (select count(*) from tb1) from tb1;
 (select count(*) from tb1) |
=============================
                          1 |

taos> select (select null from tb1) from tb1;
 (select null from tb1) |
=========================
 NULL                   |

taos> select (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) from tb1;
  (select 2 from tb1)  |
========================
                     2 |

taos> select (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) |
============================
                         1 |

taos> select (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) |
============================================
                                         1 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) |
=========================================
                                      1 |

taos> select (select f1 from tb1 union select f1 from tb1) from tb1;
 (select f1 from tb1 union select f1 from tb1) |
================================================
                                             1 |

taos> select (select f1 from tb1 union all select f1 from tb1) from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) a from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) a from tb1;
      a      |
==============
           1 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) a from tb1;
      a      |
==============
           1 |

taos> select (select count(*) from tb1) a from tb1;
           a           |
========================
                     1 |

taos> select (select null from tb1) a from tb1;
 a  |
=====
 N. |

taos> select (select * from tb1) a from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) a from tb1;
           a           |
========================
                     2 |

taos> select (select avg(f1) from tb1) a from tb1;
             a             |
============================
                         1 |

taos> select (select last(*) from tb1) a from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) a from tb1;
      a      |
==============
           1 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) a from tb1;
            a            |
==========================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)) a from tb1;
           a           |
========================
                     1 |

taos> select (select f1 from tb1 union select f1 from tb1) a from tb1;
      a      |
==============
           1 |

taos> select (select f1 from tb1 union all select f1 from tb1) a from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select 1) from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from tb1) from tb1;
 (select f1 from tb1) |
=======================
                    1 |

taos> select tags (select f1 from tb1 order by ts, f1 limit 1) from tb1;
 (select f1 from tb1 order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select tags (select count(*) from tb1) from tb1;
 (select count(*) from tb1) |
=============================
                          1 |

taos> select tags (select null from tb1) from tb1;
 (select null from tb1) |
=========================
 NULL                   |

taos> select tags (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from tb1) from tb1;
  (select 2 from tb1)  |
========================
                     2 |

taos> select tags (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) |
============================
                         1 |

taos> select tags (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) |
============================================
                                         1 |

taos> select tags (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select tags (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) |
=========================================
                                      1 |

taos> select tags (select f1 from tb1 union select f1 from tb1) from tb1;
 (select f1 from tb1 union select f1 from tb1) |
================================================
                                             1 |

taos> select tags (select f1 from tb1 union all select f1 from tb1) from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1) from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tb1) from tb1;
 (select f1 from tb1) |
=======================
                    1 |

taos> select distinct (select f1 from tb1 order by ts, f1 limit 1) from tb1;
 (select f1 from tb1 order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select distinct (select count(*) from tb1) from tb1;
 (select count(*) from tb1) |
=============================
                          1 |

taos> select distinct (select null from tb1) from tb1;
 (select null from tb1) |
=========================
 NULL                   |

taos> select distinct (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tb1) from tb1;
  (select 2 from tb1)  |
========================
                     2 |

taos> select distinct (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) |
============================
                         1 |

taos> select distinct (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) |
============================================
                                         1 |

taos> select distinct (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select distinct (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) |
=========================================
                                      1 |

taos> select distinct (select f1 from tb1 union select f1 from tb1) from tb1;
 (select f1 from tb1 union select f1 from tb1) |
================================================
                                             1 |

taos> select distinct (select f1 from tb1 union all select f1 from tb1) from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1), f1 from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tb1), f1 from tb1;
 (select f1 from tb1) |     f1      |
=====================================
                    1 |           1 |

taos> select distinct (select f1 from tb1 order by ts, f1 limit 1), f1 from tb1;
 (select f1 from tb1 order by ts, f1 limit 1) |     f1      |
=============================================================
                                            1 |           1 |

taos> select distinct (select count(*) from tb1), f1 from tb1;
 (select count(*) from tb1) |     f1      |
===========================================
                          1 |           1 |

taos> select distinct (select null from tb1), f1 from tb1;
 (select null from tb1) |     f1      |
=======================================
 NULL                   |           1 |

taos> select distinct (select * from tb1), f1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tb1), f1 from tb1;
  (select 2 from tb1)  |     f1      |
======================================
                     2 |           1 |

taos> select distinct (select avg(f1) from tb1), f1 from tb1;
 (select avg(f1) from tb1) |     f1      |
==========================================
                         1 |           1 |

taos> select distinct (select last(*) from tb1), f1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tb1 partition by f1), f1 from tb1;
 (select max(f1) from tb1 partition by f1) |     f1      |
==========================================================
                                         1 |           1 |

taos> select distinct (select a.ts from tb1 a join tb1 b on a.ts = b.ts), f1 from tb1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |     f1      |
===================================================================
 2025-12-01 00:00:00.000 |           1 |

taos> select distinct (select sum(f1) from tb1 interval(1d)), f1 from tb1;
 (select sum(f1) from tb1 interval(1d)) |     f1      |
=======================================================
                                      1 |           1 |

taos> select distinct (select f1 from tb1 union select f1 from tb1), f1 from tb1;
 (select f1 from tb1 union select f1 from tb1) |     f1      |
==============================================================
                                             1 |           1 |

taos> select distinct (select f1 from tb1 union all select f1 from tb1), f1 from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select 1) + 1 from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from tb1) + 1 from tb1;
 (select f1 from tb1) + 1  |
============================
                         2 |

taos> select distinct tags (select f1 from tb1 order by ts, f1 limit 1) + 1 from tb1;
 (select f1 from tb1 order by ts, f1 limit 1) + 1 |
===================================================
                                                2 |

taos> select distinct tags (select count(*) from tb1) + 1 from tb1;
 (select count(*) from tb1) + 1 |
=================================
                              2 |

taos> select distinct tags (select null from tb1) + 1 from tb1;
 (select null from tb1) + 1 |
=============================
 NULL                       |

taos> select distinct tags (select * from tb1) + 1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from tb1) + 1 from tb1;
  (select 2 from tb1) + 1  |
============================
                         3 |

taos> select distinct tags (select avg(f1) from tb1) + 1 from tb1;
 (select avg(f1) from tb1) + 1 |
================================
                             2 |

taos> select distinct tags (select last(*) from tb1) + 1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from tb1 partition by f1) + 1 from tb1;
 (select max(f1) from tb1 partition by f1) + 1 |
================================================
                                             2 |

taos> select distinct tags (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1 from tb1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1 |
=========================================================
 2025-12-01 00:00:00.001 |

taos> select distinct tags (select sum(f1) from tb1 interval(1d)) + 1 from tb1;
 (select sum(f1) from tb1 interval(1d)) + 1 |
=============================================
                                          2 |

taos> select distinct tags (select f1 from tb1 union select f1 from tb1) + 1 from tb1;
 (select f1 from tb1 union select f1 from tb1) + 1 |
====================================================
                                                 2 |

taos> select distinct tags (select f1 from tb1 union all select f1 from tb1) + 1 from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) from tb1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1), (select f1 from tb1) from tb1;
 (select f1 from tb1) | (select f1 from tb1) |
==============================================
                    1 |                    1 |

taos> select (select f1 from tb1 order by ts, f1 limit 1), (select f1 from tb1 order by ts, f1 limit 1) from tb1;
 (select f1 from tb1 order by ts, f1 limit 1) | (select f1 from tb1 order by ts, f1 limit 1) |
==============================================================================================
                                            1 |                                            1 |

taos> select (select count(*) from tb1), (select count(*) from tb1) from tb1;
 (select count(*) from tb1) | (select count(*) from tb1) |
==========================================================
                          1 |                          1 |

taos> select (select null from tb1), (select null from tb1) from tb1;
 (select null from tb1) | (select null from tb1) |
==================================================
 NULL                   | NULL                   |

taos> select (select * from tb1), (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1), (select 2 from tb1) from tb1;
  (select 2 from tb1)  |  (select 2 from tb1)  |
================================================
                     2 |                     2 |

taos> select (select avg(f1) from tb1), (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) | (select avg(f1) from tb1) |
========================================================
                         1 |                         1 |

taos> select (select last(*) from tb1), (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1), (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) | (select max(f1) from tb1 partition by f1) |
========================================================================================
                                         1 |                                         1 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts), (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
==========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)), (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) | (select sum(f1) from tb1 interval(1d)) |
==================================================================================
                                      1 |                                      1 |

taos> select (select f1 from tb1 union select f1 from tb1), (select f1 from tb1 union select f1 from tb1) from tb1;
 (select f1 from tb1 union select f1 from tb1) | (select f1 from tb1 union select f1 from tb1) |
================================================================================================
                                             1 |                                             1 |

taos> select (select f1 from tb1 union all select f1 from tb1), (select f1 from tb1 union all select f1 from tb1) from tb1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select 1) from tb1 order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from tb1) from tb1 order by ts;
           1           | (select f1 from tb1) |
===============================================
                     1 |                    1 |

taos> select 1, (select f1 from tb1 order by ts, f1 limit 1) from tb1 order by ts;
           1           | (select f1 from tb1 order by ts, f1 limit 1) |
=======================================================================
                     1 |                                            1 |

taos> select 1, (select count(*) from tb1) from tb1 order by ts;
           1           | (select count(*) from tb1) |
=====================================================
                     1 |                          1 |

taos> select 1, (select null from tb1) from tb1 order by ts;
           1           | (select null from tb1) |
=================================================
                     1 | NULL                   |

taos> select 1, (select * from tb1) from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from tb1) from tb1 order by ts;
           1           |  (select 2 from tb1)  |
================================================
                     1 |                     2 |

taos> select 1, (select avg(f1) from tb1) from tb1 order by ts;
           1           | (select avg(f1) from tb1) |
====================================================
                     1 |                         1 |

taos> select 1, (select last(*) from tb1) from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from tb1 partition by f1) from tb1 order by ts;
           1           | (select max(f1) from tb1 partition by f1) |
====================================================================
                     1 |                                         1 |

taos> select 1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 order by ts;
           1           | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
=============================================================================
                     1 | 2025-12-01 00:00:00.000 |

taos> select 1, (select sum(f1) from tb1 interval(1d)) from tb1 order by ts;
           1           | (select sum(f1) from tb1 interval(1d)) |
=================================================================
                     1 |                                      1 |

taos> select 1, (select f1 from tb1 union select f1 from tb1) from tb1 order by ts;
           1           | (select f1 from tb1 union select f1 from tb1) |
========================================================================
                     1 |                                             1 |

taos> select 1, (select f1 from tb1 union all select f1 from tb1) from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), * from tb1 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1), * from tb1 order by ts, f1;
 (select f1 from tb1) |           ts            |     f1      |     f2      |
=============================================================================
                    1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 order by ts, f1 limit 1), * from tb1 order by ts, f1;
 (select f1 from tb1 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |
=====================================================================================================
                                            1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select count(*) from tb1), * from tb1 order by ts, f1;
 (select count(*) from tb1) |           ts            |     f1      |     f2      |
===================================================================================
                          1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select null from tb1), * from tb1 order by ts, f1;
 (select null from tb1) |           ts            |     f1      |     f2      |
===============================================================================
 NULL                   | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select * from tb1), * from tb1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1), * from tb1 order by ts, f1;
  (select 2 from tb1)  |           ts            |     f1      |     f2      |
==============================================================================
                     2 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select avg(f1) from tb1), * from tb1 order by ts, f1;
 (select avg(f1) from tb1) |           ts            |     f1      |     f2      |
==================================================================================
                         1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select last(*) from tb1), * from tb1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1), * from tb1 order by ts, f1;
 (select max(f1) from tb1 partition by f1) |           ts            |     f1      |     f2      |
==================================================================================================
                                         1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts), * from tb1 order by ts, f1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |           ts            |     f1      |     f2      |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select sum(f1) from tb1 interval(1d)), * from tb1 order by ts, f1;
 (select sum(f1) from tb1 interval(1d)) |           ts            |     f1      |     f2      |
===============================================================================================
                                      1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 union select f1 from tb1), * from tb1 order by ts, f1;
 (select f1 from tb1 union select f1 from tb1) |           ts            |     f1      |     f2      |
======================================================================================================
                                             1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 union all select f1 from tb1), * from tb1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) * (select 1), * from tb1 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) * (select f1 from tb1), * from tb1 order by ts, f1;
 (select f1 from tb1) * (select f1 from tb1) |           ts            |     f1      |     f2      |
====================================================================================================
                                           1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) * (select f1 from tb1 order by ts, f1 limit 1), * from tb1 order by ts, f1;
 (select f1 from tb1 order by ts, f1 limit 1) * (select f1 from t |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select count(*) from tb1) * (select count(*) from tb1), * from tb1 order by ts, f1;
 (select count(*) from tb1) * (select count(*) from tb1) |           ts            |     f1      |     f2      |
================================================================================================================
                                                       1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select null from tb1) * (select null from tb1), * from tb1 order by ts, f1;
 (select null from tb1) * (select null from tb1) |           ts            |     f1      |     f2      |
========================================================================================================
 NULL                                            | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select * from tb1) * (select * from tb1), * from tb1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) * (select 2 from tb1), * from tb1 order by ts, f1;
 (select 2 from tb1) * (select 2 from tb1) |           ts            |     f1      |     f2      |
==================================================================================================
                                         4 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select avg(f1) from tb1) * (select avg(f1) from tb1), * from tb1 order by ts, f1;
 (select avg(f1) from tb1) * (select avg(f1) from tb1) |           ts            |     f1      |     f2      |
==============================================================================================================
                                                     1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select last(*) from tb1) * (select last(*) from tb1), * from tb1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) * (select max(f1) from tb1 partition by f1), * from tb1 order by ts, f1;
 (select max(f1) from tb1 partition by f1) * (select max(f1) from |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) * (select a.ts from tb1 a join tb1 b on a.ts = b.ts), * from tb1 order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb1 interval(1d)) * (select sum(f1) from tb1 interval(1d)), * from tb1 order by ts, f1;
 (select sum(f1) from tb1 interval(1d)) * (select sum(f1) from tb |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 union select f1 from tb1) * (select f1 from tb1 union select f1 from tb1), * from tb1 order by ts, f1;
 (select f1 from tb1 union select f1 from tb1) * (select f1 from  |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 union all select f1 from tb1) * (select f1 from tb1 union all select f1 from tb1), * from tb1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)) from tb1;

DB error: unrecognized token: "{funcname}((select 1)) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts, f1 limit 1)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts, f1 limit 1)) from tb1;" [0x80002600] 
taos> select {funcName}((select count(*) from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select count(*) from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select null from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select null from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select * from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select * from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select 2 from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select 2 from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select last(*) from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select last(*) from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1)) from tb1;

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1)) from tb1;" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb1 b on a.ts = b.ts)) from tb1;

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb1 b on a.ts = b.ts)) from tb1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d))) from tb1;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d))) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts, f1 limit 1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts, f1 limit 1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select count(*) from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select count(*) from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select null from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select null from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select * from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select * from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select 2 from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select 2 from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select last(*) from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select last(*) from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d)) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d)) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts, f1 limit 1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts, f1 limit 1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select count(*) from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select count(*) from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select null from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select null from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select * from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select * from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select 2 from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select 2 from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select last(*) from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select last(*) from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d)) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d)) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select (select 1) + (select 1) from tb1 partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) + (select f1 from tb1) from tb1 partition by tbname;
 (select f1 from tb1) + (select f1 from tb1) |
==============================================
                                           2 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) + (select f1 from tb1 order by ts, f1 limit 1) from tb1 partition by tbname;
 (select f1 from tb1 order by ts, f1 limit 1) + (select f1 from t |
===================================================================
                                                               2 |

taos> select (select count(*) from tb1) + (select count(*) from tb1) from tb1 partition by tbname;
 (select count(*) from tb1) + (select count(*) from tb1) |
==========================================================
                                                       2 |

taos> select (select null from tb1) + (select null from tb1) from tb1 partition by tbname;
 (select null from tb1) + (select null from tb1) |
==================================================
 NULL                                            |

taos> select (select * from tb1) + (select * from tb1) from tb1 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) + (select 2 from tb1) from tb1 partition by tbname;
 (select 2 from tb1) + (select 2 from tb1) |
============================================
                                         4 |

taos> select (select avg(f1) from tb1) + (select avg(f1) from tb1) from tb1 partition by tbname;
 (select avg(f1) from tb1) + (select avg(f1) from tb1) |
========================================================
                                                     2 |

taos> select (select last(*) from tb1) + (select last(*) from tb1) from tb1 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) + (select max(f1) from tb1 partition by f1) from tb1 partition by tbname;
 (select max(f1) from tb1 partition by f1) + (select max(f1) from |
===================================================================
                                                               2 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb1 interval(1d)) + (select sum(f1) from tb1 interval(1d)) from tb1 partition by tbname;
 (select sum(f1) from tb1 interval(1d)) + (select sum(f1) from tb |
===================================================================
                                                               2 |

taos> select (select f1 from tb1 union select f1 from tb1) + (select f1 from tb1 union select f1 from tb1) from tb1 partition by tbname;
 (select f1 from tb1 union select f1 from tb1) + (select f1 from  |
===================================================================
                                                               2 |

taos> select (select f1 from tb1 union all select f1 from tb1) + (select f1 from tb1 union all select f1 from tb1) from tb1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + f1 from tb1 partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) + f1 from tb1 partition by f1;
 (select f1 from tb1) + f1 |
============================
                         2 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) + f1 from tb1 partition by f1;
 (select f1 from tb1 order by ts, f1 limit 1) + f1 |
====================================================
                                                 2 |

taos> select (select count(*) from tb1) + f1 from tb1 partition by f1;
 (select count(*) from tb1) + f1 |
==================================
                               2 |

taos> select (select null from tb1) + f1 from tb1 partition by f1;
 (select null from tb1) + f1 |
==============================
 NULL                        |

taos> select (select * from tb1) + f1 from tb1 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) + f1 from tb1 partition by f1;
 (select 2 from tb1) + f1  |
============================
                         3 |

taos> select (select avg(f1) from tb1) + f1 from tb1 partition by f1;
 (select avg(f1) from tb1) + f1 |
=================================
                              2 |

taos> select (select last(*) from tb1) + f1 from tb1 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) + f1 from tb1 partition by f1;
 (select max(f1) from tb1 partition by f1) + f1 |
=================================================
                                              2 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + f1 from tb1 partition by f1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + f1 |
==========================================================
 2025-12-01 00:00:00.001 |

taos> select (select sum(f1) from tb1 interval(1d)) + f1 from tb1 partition by f1;
 (select sum(f1) from tb1 interval(1d)) + f1 |
==============================================
                                           2 |

taos> select (select f1 from tb1 union select f1 from tb1) + f1 from tb1 partition by f1;
 (select f1 from tb1 union select f1 from tb1) + f1 |
=====================================================
                                                  2 |

taos> select (select f1 from tb1 union all select f1 from tb1) + f1 from tb1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select f1 from tb1) > 0 then 1 else 2 end |        sum(f1)        |
===============================================================================
                                                    1 |                     1 |

taos> select case when (select f1 from tb1 order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select f1 from tb1 order by ts, f1 limit 1) > 0 then  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select count(*) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select count(*) from tb1) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     1 |

taos> select case when (select null from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select null from tb1) > 0 then 1 else 2 end |        sum(f1)        |
=================================================================================
                                                      2 |                     1 |

taos> select case when (select * from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select 2 from tb1) > 0 then 1 else 2 end |        sum(f1)        |
==============================================================================
                                                   1 |                     1 |

taos> select case when (select avg(f1) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select avg(f1) from tb1) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     1 |

taos> select case when (select last(*) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from tb1 partition by f1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select max(f1) from tb1 partition by f1) > 0 then 1 e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select a.ts from tb1 a join tb1 b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select a.ts from tb1 a join tb1 b on a.ts = b.ts) > 0 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select f1 from tb1 union select f1 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select f1 from tb1 union select f1 from tb1) > 0 then |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select f1 from tb1 union all select f1 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb1) else 2 end |        sum(f1)        |
====================================================================================
 2                                                         |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tb1 order by ts, f1 limit 1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb1 order by ts, f1 li |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select count(*) from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select count(*) from tb1) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     1 |

taos> select case when f1 = 1 then 2 / (select null from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select null from tb1) else 2 end |        sum(f1)        |
======================================================================================
 NULL                                                        |                     1 |

taos> select case when f1 = 1 then 2 / (select * from tb1) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select 2 from tb1) else 2 end |        sum(f1)        |
===================================================================================
 1                                                        |                     1 |

taos> select case when f1 = 1 then 2 / (select avg(f1) from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from tb1) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     1 |

taos> select case when f1 = 1 then 2 / (select last(*) from tb1) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tb1 partition by f1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select max(f1) from tb1 partition by  |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select a.ts from tb1 a join tb1 b on a.ts = b.ts) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select a.ts from tb1 a join tb1 b on  |        sum(f1)        |
===========================================================================================
 1.13345375145989e-12                                             |                     1 |

taos> select case when f1 = 1 then 2 / (select sum(f1) from tb1 interval(1d)) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select sum(f1) from tb1 interval(1d)) |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tb1 union select f1 from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb1 union select f1 fr |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tb1 union all select f1 from tb1) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb1) is null end |        sum(f1)        |
========================================================================================
                                                             1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tb1 order by ts, f1 limit 1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb1 order by ts, f1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select count(*) from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select count(*) from tb1) is null  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select null from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select null from tb1) is null end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when f1 = 1 then 1 else (select * from tb1) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select 2 from tb1) is null end |        sum(f1)        |
=======================================================================================
                                                            1 |                     1 |

taos> select case when f1 = 1 then 1 else (select avg(f1) from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from tb1) is null e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select last(*) from tb1) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tb1 partition by f1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select max(f1) from tb1 partition  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select a.ts from tb1 a join tb1 b on a.ts = b.ts) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select a.ts from tb1 a join tb1 b  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1d)) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tb1 union select f1 from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb1 union select f1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tb1 union all select f1 from tb1) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tb1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select f1 from tb1) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tb1 order by ts, f1 limit 1), avg(f1) from tb1 interval(1d);
         _wstart         | (select f1 from tb1 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            1 |                         1 |

taos> select _wstart, (select count(*) from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select count(*) from tb1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select null from tb1) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         1 |

taos> select _wstart, (select * from tb1), avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         |  (select 2 from tb1)  |          avg(f1)          |
==============================================================================
 2025-12-01 00:00:00.000 |                     2 |                         1 |

taos> select _wstart, (select avg(f1) from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select avg(f1) from tb1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         1 |                         1 |

taos> select _wstart, (select last(*) from tb1), avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tb1 partition by f1), avg(f1) from tb1 interval(1d);
         _wstart         | (select max(f1) from tb1 partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-01 00:00:00.000 |                                         1 |                         1 |

taos> select _wstart, (select a.ts from tb1 a join tb1 b on a.ts = b.ts), avg(f1) from tb1 interval(1d);
         _wstart         | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |                         1 |

taos> select _wstart, (select sum(f1) from tb1 interval(1d)), avg(f1) from tb1 interval(1d);
         _wstart         | (select sum(f1) from tb1 interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 |                                      1 |                         1 |

taos> select _wstart, (select f1 from tb1 union select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select f1 from tb1 union select f1 from tb1) |          avg(f1)          |
======================================================================================================
 2025-12-01 00:00:00.000 |                                             1 |                         1 |

taos> select _wstart, (select f1 from tb1 union all select f1 from tb1), avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tb1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select f1 from tb1) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) + 1, avg(f1) from tb1 interval(1d);
 (select f1 from tb1 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                2 |                         1 |

taos> select (select count(*) from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select count(*) from tb1) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select null from tb1) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select * from tb1) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) + 1, avg(f1) from tb1 interval(1d);
  (select 2 from tb1) + 1  |          avg(f1)          |
========================================================
                         3 |                         1 |

taos> select (select avg(f1) from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select avg(f1) from tb1) + 1 |          avg(f1)          |
============================================================
                             2 |                         1 |

taos> select (select last(*) from tb1) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) + 1, avg(f1) from tb1 interval(1d);
 (select max(f1) from tb1 partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             2 |                         1 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1, avg(f1) from tb1 interval(1d);
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.001 |                         1 |

taos> select (select sum(f1) from tb1 interval(1d)) + 1, avg(f1) from tb1 interval(1d);
 (select sum(f1) from tb1 interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          2 |                         1 |

taos> select (select f1 from tb1 union select f1 from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select f1 from tb1 union select f1 from tb1) + 1 |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select (select f1 from tb1 union all select f1 from tb1) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts, f1 limit 1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts, f1 limit 1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb1 b on a.ts = b.ts)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb1 b on a.ts = b.ts)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d))), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d))), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts, f1 limit 1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts, f1 limit 1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d)) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d)) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=================================================================================
                                                  1 |                         1 |

taos> select case (select f1 from tb1 order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select f1 from tb1 order by ts, f1 limit 1) when 1 then 1  |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select count(*) from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select count(*) from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        1 |                         1 |

taos> select case (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
===================================================================================
                                                    2 |                         1 |

taos> select case (select * from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select 2 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select case (select avg(f1) from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select avg(f1) from tb1) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       1 |                         1 |

taos> select case (select last(*) from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from tb1 partition by f1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select max(f1) from tb1 partition by f1) when 1 then 1 els |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select a.ts from tb1 a join tb1 b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select a.ts from tb1 a join tb1 b on a.ts = b.ts) when 1 t |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case (select sum(f1) from tb1 interval(1d)) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select sum(f1) from tb1 interval(1d)) when 1 then 1 else 2 |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select f1 from tb1 union select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select f1 from tb1 union select f1 from tb1) when 1 then 1 |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select f1 from tb1 union all select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select f1 from tb1) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tb1 order by ts, f1 limit 1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select f1 from tb1 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            1 |                         1 |

taos> select _wstart, (select count(*) from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select count(*) from tb1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select null from tb1) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         1 |

taos> select _wstart, (select * from tb1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         |  (select 2 from tb1)  |          avg(f1)          |
==============================================================================
 2025-12-01 00:00:00.000 |                     2 |                         1 |

taos> select _wstart, (select avg(f1) from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select avg(f1) from tb1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         1 |                         1 |

taos> select _wstart, (select last(*) from tb1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tb1 partition by f1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select max(f1) from tb1 partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-01 00:00:00.000 |                                         1 |                         1 |

taos> select _wstart, (select a.ts from tb1 a join tb1 b on a.ts = b.ts), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |                         1 |

taos> select _wstart, (select sum(f1) from tb1 interval(1d)), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select sum(f1) from tb1 interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 |                                      1 |                         1 |

taos> select _wstart, (select f1 from tb1 union select f1 from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select f1 from tb1 union select f1 from tb1) |          avg(f1)          |
======================================================================================================
 2025-12-01 00:00:00.000 |                                             1 |                         1 |

taos> select _wstart, (select f1 from tb1 union all select f1 from tb1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select f1 from tb1) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select f1 from tb1 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                2 |                         1 |

taos> select (select count(*) from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select count(*) from tb1) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select null from tb1) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select * from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
  (select 2 from tb1) + 1  |          avg(f1)          |
========================================================
                         3 |                         1 |

taos> select (select avg(f1) from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select avg(f1) from tb1) + 1 |          avg(f1)          |
============================================================
                             2 |                         1 |

taos> select (select last(*) from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select max(f1) from tb1 partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             2 |                         1 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.001 |                         1 |

taos> select (select sum(f1) from tb1 interval(1d)) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select sum(f1) from tb1 interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          2 |                         1 |

taos> select (select f1 from tb1 union select f1 from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select f1 from tb1 union select f1 from tb1) + 1 |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select (select f1 from tb1 union all select f1 from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) > 0 from tb1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb1 order by ts, f1 limit 1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tb1 interval(1d)) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb1 union select f1 from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb1 union all select f1 from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select f1 from tb1) > 0 then 1 else 2 end) |
============================================================
                                                         1 |

taos> select sum(case when (select f1 from tb1 order by ts, f1 limit 1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select f1 from tb1 order by ts, f1 limit 1) > 0 t |
===================================================================
                                                                1 |

taos> select sum(case when (select count(*) from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select count(*) from tb1) > 0 then 1 else 2 end) |
==================================================================
                                                               1 |

taos> select sum(case when (select null from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select null from tb1) > 0 then 1 else 2 end) |
==============================================================
                                                           2 |

taos> select sum(case when (select * from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select 2 from tb1) > 0 then 1 else 2 end) |
===========================================================
                                                        1 |

taos> select sum(case when (select avg(f1) from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select avg(f1) from tb1) > 0 then 1 else 2 end) |
=================================================================
                                                              1 |

taos> select sum(case when (select last(*) from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from tb1 partition by f1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select max(f1) from tb1 partition by f1) > 0 then |
===================================================================
                                                                1 |

taos> select sum(case when (select a.ts from tb1 a join tb1 b on a.ts = b.ts) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
===================================================================
                                                                1 |

taos> select sum(case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select sum(f1) from tb1 interval(1d)) > 0 then 1  |
===================================================================
                                                                1 |

taos> select sum(case when (select f1 from tb1 union select f1 from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select f1 from tb1 union select f1 from tb1) > 0  |
===================================================================
                                                                1 |

taos> select sum(case when (select f1 from tb1 union all select f1 from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tb1) as bigin |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1 order by ts, f1 limit 1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tb1 order by  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select count(*) from tb1) as |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select null from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select null from tb1) as big |
===================================================================
 NULL                                                             |

taos> select sum(case when f1 = 1 then cast(2 / (select * from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select 2 from tb1) as bigint |
===================================================================
                                                                1 |

taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb1) as  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tb1 partition by f1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select max(f1) from tb1 part |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tb1 a join tb1 b on a.ts = b.ts) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select a.ts from tb1 a join  |
===================================================================
                                                                0 |

taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tb1 interval(1d)) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select sum(f1) from tb1 inte |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1 union select f1 from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tb1 union sel |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1 union all select f1 from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb1) is null en |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1 order by ts, f1 limit 1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb1 order by ts |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select count(*) from tb1) is n |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select null from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select null from tb1) is null  |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select * from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select 2 from tb1) is null end |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select avg(f1) from tb1) is nu |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tb1 partition by f1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select max(f1) from tb1 partit |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select a.ts from tb1 a join tb1 b on a.ts = b.ts) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select a.ts from tb1 a join tb |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1d)) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select sum(f1) from tb1 interv |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1 union select f1 from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb1 union selec |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1 union all select f1 from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select 1)) from tb1 partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from tb1)) from tb1 partition by tbname interval(1d);
 sum((select f1 from tb1)) |
============================
                         1 |

taos> select sum((select f1 from tb1 order by ts, f1 limit 1)) from tb1 partition by tbname interval(1d);
 sum((select f1 from tb1 order by ts, f1 limit 1)) |
====================================================
                                                 1 |

taos> select sum((select count(*) from tb1)) from tb1 partition by tbname interval(1d);
 sum((select count(*) from tb1)) |
==================================
                               1 |

taos> select sum((select null from tb1)) from tb1 partition by tbname interval(1d);
 sum((select null from tb1)) |
==============================
 NULL                        |

taos> select sum((select * from tb1)) from tb1 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from tb1)) from tb1 partition by tbname interval(1d);
 sum((select 2 from tb1)) |
===========================
                        2 |

taos> select sum((select avg(f1) from tb1)) from tb1 partition by tbname interval(1d);
 sum((select avg(f1) from tb1)) |
=================================
                              1 |

taos> select sum((select last(*) from tb1)) from tb1 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from tb1 partition by f1)) from tb1 partition by tbname interval(1d);
 sum((select max(f1) from tb1 partition by f1)) |
=================================================
                                              1 |

taos> select sum((select a.ts from tb1 a join tb1 b on a.ts = b.ts)) from tb1 partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tb1 interval(1d))) from tb1 partition by tbname interval(1d);
 sum((select sum(f1) from tb1 interval(1d))) |
==============================================
                                           1 |

taos> select sum((select f1 from tb1 union select f1 from tb1)) from tb1 partition by tbname interval(1d);
 sum((select f1 from tb1 union select f1 from tb1)) |
=====================================================
                                                  1 |

taos> select sum((select f1 from tb1 union all select f1 from tb1)) from tb1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select 1) * -1)) from tb1 partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select f1 from tb1) * -1)) |
======================================
                                   1 |

taos> select avg(abs((select f1 from tb1 order by ts, f1 limit 1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select f1 from tb1 order by ts, f1 limit 1) * -1)) |
==============================================================
                                                           1 |

taos> select avg(abs((select count(*) from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select count(*) from tb1) * -1)) |
============================================
                                         1 |

taos> select avg(abs((select null from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select null from tb1) * -1)) |
========================================
 NULL                                  |

taos> select avg(abs((select * from tb1) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select 2 from tb1) * -1)) |
=====================================
                                  2 |

taos> select avg(abs((select avg(f1) from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select avg(f1) from tb1) * -1)) |
===========================================
                                        1 |

taos> select avg(abs((select last(*) from tb1) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from tb1 partition by f1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select max(f1) from tb1 partition by f1) * -1)) |
===========================================================
                                                        1 |

taos> select avg(abs((select a.ts from tb1 a join tb1 b on a.ts = b.ts) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select a.ts from tb1 a join tb1 b on a.ts = b.ts) * -1) |
===================================================================
                                                   1764518400000 |

taos> select avg(abs((select sum(f1) from tb1 interval(1d)) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select sum(f1) from tb1 interval(1d)) * -1)) |
========================================================
                                                     1 |

taos> select avg(abs((select f1 from tb1 union select f1 from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select f1 from tb1 union select f1 from tb1) * -1)) |
===============================================================
                                                            1 |

taos> select avg(abs((select f1 from tb1 union all select f1 from tb1) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb1) from tb1 group by f1;
     f1      | (select f1 from tb1) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tb1 order by ts, f1 limit 1) from tb1 group by f1;
     f1      | (select f1 from tb1 order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from tb1) from tb1 group by f1;
     f1      | (select count(*) from tb1) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tb1) from tb1 group by f1;
     f1      | (select null from tb1) |
=======================================
           1 | NULL                   |

taos> select f1, (select * from tb1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb1) from tb1 group by f1;
     f1      |  (select 2 from tb1)  |
======================================
           1 |                     2 |

taos> select f1, (select avg(f1) from tb1) from tb1 group by f1;
     f1      | (select avg(f1) from tb1) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tb1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb1 partition by f1) from tb1 group by f1;
     f1      | (select max(f1) from tb1 partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 group by f1;
     f1      | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
===================================================================
           1 | 2025-12-01 00:00:00.000 |

taos> select f1, (select sum(f1) from tb1 interval(1d)) from tb1 group by f1;
     f1      | (select sum(f1) from tb1 interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tb1 union select f1 from tb1) from tb1 group by f1;
     f1      | (select f1 from tb1 union select f1 from tb1) |
==============================================================
           1 |                                             1 |

taos> select f1, (select f1 from tb1 union all select f1 from tb1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1), avg((select 1)) from tb1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb1), avg((select f1 from tb1)) from tb1 group by f1;
     f1      | (select f1 from tb1) | avg((select f1 from tb1)) |
=================================================================
           1 |                    1 |                         1 |

taos> select f1, (select f1 from tb1 order by ts, f1 limit 1), avg((select f1 from tb1 order by ts, f1 limit 1)) from tb1 group by f1;
     f1      | (select f1 from tb1 order by ts, f1 limit 1) | avg((select f1 from tb1 order by ts, f1 limit 1)) |
=================================================================================================================
           1 |                                            1 |                                                 1 |

taos> select f1, (select count(*) from tb1), avg((select count(*) from tb1)) from tb1 group by f1;
     f1      | (select count(*) from tb1) | avg((select count(*) from tb1)) |
=============================================================================
           1 |                          1 |                               1 |

taos> select f1, (select null from tb1), avg((select null from tb1)) from tb1 group by f1;
     f1      | (select null from tb1) | avg((select null from tb1)) |
=====================================================================
           1 | NULL                   | NULL                        |

taos> select f1, (select * from tb1), avg((select * from tb1)) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb1), avg((select 2 from tb1)) from tb1 group by f1;
     f1      |  (select 2 from tb1)  | avg((select 2 from tb1))  |
==================================================================
           1 |                     2 |                         2 |

taos> select f1, (select avg(f1) from tb1), avg((select avg(f1) from tb1)) from tb1 group by f1;
     f1      | (select avg(f1) from tb1) | avg((select avg(f1) from tb1)) |
===========================================================================
           1 |                         1 |                              1 |

taos> select f1, (select last(*) from tb1), avg((select last(*) from tb1)) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb1 partition by f1), avg((select max(f1) from tb1 partition by f1)) from tb1 group by f1;
     f1      | (select max(f1) from tb1 partition by f1) | avg((select max(f1) from tb1 partition by f1)) |
===========================================================================================================
           1 |                                         1 |                                              1 |

taos> select f1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts), avg((select a.ts from tb1 a join tb1 b on a.ts = b.ts)) from tb1 group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from tb1 interval(1d)), avg((select sum(f1) from tb1 interval(1d))) from tb1 group by f1;
     f1      | (select sum(f1) from tb1 interval(1d)) | avg((select sum(f1) from tb1 interval(1d))) |
=====================================================================================================
           1 |                                      1 |                                           1 |

taos> select f1, (select f1 from tb1 union select f1 from tb1), avg((select f1 from tb1 union select f1 from tb1)) from tb1 group by f1;
     f1      | (select f1 from tb1 union select f1 from tb1) | avg((select f1 from tb1 union select f1 from tb1)) |
===================================================================================================================
           1 |                                             1 |                                                  1 |

taos> select f1, (select f1 from tb1 union all select f1 from tb1), avg((select f1 from tb1 union all select f1 from tb1)) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select 1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1) order by b.f1;
     f1      | (select f1 from tb1) + 1  |
==========================================
           1 |                         2 |

taos> select b.f1, (select f1 from tb1 order by ts, f1 limit 1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1 order by ts, f1 limit 1) order by b.f1;
     f1      | (select f1 from tb1 order by ts, f1 limit 1) + 1 |
=================================================================
           1 |                                                2 |

taos> select b.f1, (select count(*) from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select count(*) from tb1) order by b.f1;
     f1      | (select count(*) from tb1) + 1 |
===============================================
           1 |                              2 |

taos> select b.f1, (select null from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select null from tb1) order by b.f1;

taos> select b.f1, (select * from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select * from tb1) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select 2 from tb1) order by b.f1;

taos> select b.f1, (select avg(f1) from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select avg(f1) from tb1) order by b.f1;
     f1      | (select avg(f1) from tb1) + 1 |
==============================================
           1 |                             2 |

taos> select b.f1, (select last(*) from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select last(*) from tb1) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from tb1 partition by f1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select max(f1) from tb1 partition by f1) order by b.f1;
     f1      | (select max(f1) from tb1 partition by f1) + 1 |
==============================================================
           1 |                                             2 |

taos> select b.f1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select a.ts from tb1 a join tb1 b on a.ts = b.ts) order by b.f1;

taos> select b.f1, (select sum(f1) from tb1 interval(1d)) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select sum(f1) from tb1 interval(1d)) order by b.f1;
     f1      | (select sum(f1) from tb1 interval(1d)) + 1 |
===========================================================
           1 |                                          2 |

taos> select b.f1, (select f1 from tb1 union select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1 union select f1 from tb1) order by b.f1;
     f1      | (select f1 from tb1 union select f1 from tb1) + 1 |
==================================================================
           1 |                                                 2 |

taos> select b.f1, (select f1 from tb1 union all select f1 from tb1) + 1 from tb1 a join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1 union all select f1 from tb1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg((select 1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) + 1, avg((select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1);
 (select f1 from tb1) + 1  | avg((select f1 from tb1) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) + 1, avg((select f1 from tb1 order by ts, f1 limit 1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1 order by ts, f1 limit 1);
 (select f1 from tb1 order by ts, f1 limit 1) + 1 | avg((select f1 from tb1 order by ts, f1 limit 1) + 2) |
===========================================================================================================
                                                2 |                                                     3 |

taos> select (select count(*) from tb1) + 1, avg((select count(*) from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select count(*) from tb1);
 (select count(*) from tb1) + 1 | avg((select count(*) from tb1) + 2) |
=======================================================================
                              2 |                                   3 |

taos> select (select null from tb1) + 1, avg((select null from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select null from tb1);
 (select null from tb1) + 1 | avg((select null from tb1) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select (select * from tb1) + 1, avg((select * from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select * from tb1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) + 1, avg((select 2 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select 2 from tb1);
  (select 2 from tb1) + 1  | avg((select 2 from tb1) + 2) |
===========================================================
                         3 |                            4 |

taos> select (select avg(f1) from tb1) + 1, avg((select avg(f1) from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select avg(f1) from tb1);
 (select avg(f1) from tb1) + 1 | avg((select avg(f1) from tb1) + 2) |
=====================================================================
                             2 |                                  3 |

taos> select (select last(*) from tb1) + 1, avg((select last(*) from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select last(*) from tb1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) + 1, avg((select max(f1) from tb1 partition by f1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select max(f1) from tb1 partition by f1);
 (select max(f1) from tb1 partition by f1) + 1 | avg((select max(f1) from tb1 partition by f1) + 2) |
=====================================================================================================
                                             2 |                                                  3 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1, avg((select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select a.ts from tb1 a join tb1 b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from tb1 interval(1d)) + 1, avg((select sum(f1) from tb1 interval(1d)) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select sum(f1) from tb1 interval(1d));
 (select sum(f1) from tb1 interval(1d)) + 1 | avg((select sum(f1) from tb1 interval(1d)) + 2) |
===============================================================================================
                                          2 |                                               3 |

taos> select (select f1 from tb1 union select f1 from tb1) + 1, avg((select f1 from tb1 union select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1 union select f1 from tb1);
 (select f1 from tb1 union select f1 from tb1) + 1 | avg((select f1 from tb1 union select f1 from tb1) + 2) |
=============================================================================================================
                                                 2 |                                                      3 |

taos> select (select f1 from tb1 union all select f1 from tb1) + 1, avg((select f1 from tb1 union all select f1 from tb1) + 2) from tb1 a left join tb1 b on a.ts = b.ts and a.f1 = (select f1 from tb1 union all select f1 from tb1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select 1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select f1 from tb1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select f1 from tb1) |           ts            |     f1      |     f2      |
===================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                    1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select f1 from tb1 order by ts, f1 limit 1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select f1 from tb1 order by ts, f1 limit 1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select f1 from tb1 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |
===========================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                                            1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select count(*) from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select count(*) from tb1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select count(*) from tb1) |           ts            |     f1      |     f2      |
=========================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                          1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select null from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select null from tb1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select null from tb1) |           ts            |     f1      |     f2      |
=====================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 | NULL                   | NULL                    | NULL        | NULL        |

taos> select a.*, (select * from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select * from tb1) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select 2 from tb1) order by a.ts, a.f1;
           ts            |     f1      |     f2      |  (select 2 from tb1)  |           ts            |     f1      |     f2      |
====================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                     2 | NULL                    | NULL        | NULL        |

taos> select a.*, (select avg(f1) from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select avg(f1) from tb1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select avg(f1) from tb1) |           ts            |     f1      |     f2      |
========================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                         1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select last(*) from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select last(*) from tb1) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from tb1 partition by f1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select max(f1) from tb1 partition by f1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select max(f1) from tb1 partition by f1) |           ts            |     f1      |     f2      |
========================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                                         1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select a.ts from tb1 a join tb1 b on a.ts = b.ts), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select a.ts from tb1 a join tb1 b on a.ts = b.ts) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |           ts            |     f1      |     f2      |
=================================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 | 2025-12-01 00:00:00.000 | NULL                    | NULL        | NULL        |

taos> select a.*, (select sum(f1) from tb1 interval(1d)), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select sum(f1) from tb1 interval(1d)) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select sum(f1) from tb1 interval(1d)) |           ts            |     f1      |     f2      |
=====================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                                      1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select f1 from tb1 union select f1 from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select f1 from tb1 union select f1 from tb1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select f1 from tb1 union select f1 from tb1) |           ts            |     f1      |     f2      |
============================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |                                             1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select a.*, (select f1 from tb1 union all select f1 from tb1), b.* from tb1 a left join tb1 b on a.ts = b.ts and b.f1 = (select f1 from tb1 union all select f1 from tb1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb1 where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from tb1 where f1 != (select f1 from tb1) order by f1;

taos> select f1 from tb1 where f1 != (select f1 from tb1 order by ts, f1 limit 1) order by f1;

taos> select f1 from tb1 where f1 != (select count(*) from tb1) order by f1;

taos> select f1 from tb1 where f1 != (select null from tb1) order by f1;

taos> select f1 from tb1 where f1 != (select * from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tb1 where f1 != (select 2 from tb1) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 != (select avg(f1) from tb1) order by f1;

taos> select f1 from tb1 where f1 != (select last(*) from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tb1 where f1 != (select max(f1) from tb1 partition by f1) order by f1;

taos> select f1 from tb1 where f1 != (select a.ts from tb1 a join tb1 b on a.ts = b.ts) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tb1 where f1 != (select sum(f1) from tb1 interval(1d)) order by f1;

taos> select f1 from tb1 where f1 != (select f1 from tb1 union select f1 from tb1) order by f1;

taos> select f1 from tb1 where f1 != (select f1 from tb1 union all select f1 from tb1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb1 where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb1) from tb1 where f1 = (select f1 from tb1) order by f1;
     f1      | (select f1 from tb1) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tb1 order by ts, f1 limit 1) from tb1 where f1 = (select f1 from tb1 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tb1 order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from tb1) from tb1 where f1 = (select count(*) from tb1) order by f1;
     f1      | (select count(*) from tb1) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tb1) from tb1 where f1 = (select null from tb1) order by f1;

taos> select f1, (select * from tb1) from tb1 where f1 = (select * from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb1) from tb1 where f1 = (select 2 from tb1) order by f1;

taos> select f1, (select avg(f1) from tb1) from tb1 where f1 = (select avg(f1) from tb1) order by f1;
     f1      | (select avg(f1) from tb1) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tb1) from tb1 where f1 = (select last(*) from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb1 partition by f1) from tb1 where f1 = (select max(f1) from tb1 partition by f1) order by f1;
     f1      | (select max(f1) from tb1 partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 where f1 = (select a.ts from tb1 a join tb1 b on a.ts = b.ts) order by f1;

taos> select f1, (select sum(f1) from tb1 interval(1d)) from tb1 where f1 = (select sum(f1) from tb1 interval(1d)) order by f1;
     f1      | (select sum(f1) from tb1 interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tb1 union select f1 from tb1) from tb1 where f1 = (select f1 from tb1 union select f1 from tb1) order by f1;
     f1      | (select f1 from tb1 union select f1 from tb1) |
==============================================================
           1 |                                             1 |

taos> select f1, (select f1 from tb1 union all select f1 from tb1) from tb1 where f1 = (select f1 from tb1 union all select f1 from tb1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb1 where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select f1 from tb1));

DB error: syntax error near "(select f1 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select f1 from tb1 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tb1 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select count(*) from tb1));

DB error: syntax error near "(select count(*) from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select null from tb1));

DB error: syntax error near "(select null from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select * from tb1));

DB error: syntax error near "(select * from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select 2 from tb1));

DB error: syntax error near "(select 2 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select avg(f1) from tb1));

DB error: syntax error near "(select avg(f1) from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select last(*) from tb1));

DB error: syntax error near "(select last(*) from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select max(f1) from tb1 partition by f1));

DB error: syntax error near "(select max(f1) from tb1 partition by f1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select a.ts from tb1 a join tb1 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tb1 a join tb1 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select sum(f1) from tb1 interval(1d)));

DB error: syntax error near "(select sum(f1) from tb1 interval(1d)));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select f1 from tb1 union select f1 from tb1));

DB error: syntax error near "(select f1 from tb1 union select f1 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 in ((select f1 from tb1 union all select f1 from tb1));

DB error: syntax error near "(select f1 from tb1 union all select f1 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select f1 from tb1));

DB error: syntax error near "(select f1 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select f1 from tb1 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tb1 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select count(*) from tb1));

DB error: syntax error near "(select count(*) from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select null from tb1));

DB error: syntax error near "(select null from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select * from tb1));

DB error: syntax error near "(select * from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select 2 from tb1));

DB error: syntax error near "(select 2 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select avg(f1) from tb1));

DB error: syntax error near "(select avg(f1) from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select last(*) from tb1));

DB error: syntax error near "(select last(*) from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select max(f1) from tb1 partition by f1));

DB error: syntax error near "(select max(f1) from tb1 partition by f1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select a.ts from tb1 a join tb1 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tb1 a join tb1 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select sum(f1) from tb1 interval(1d)));

DB error: syntax error near "(select sum(f1) from tb1 interval(1d)));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select f1 from tb1 union select f1 from tb1));

DB error: syntax error near "(select f1 from tb1 union select f1 from tb1));" [0x80002600] 
taos> select f1 from tb1 where f1 not in ((select f1 from tb1 union all select f1 from tb1));

DB error: syntax error near "(select f1 from tb1 union all select f1 from tb1));" [0x80002600] 
taos> select (select 1) from tb1 where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) from tb1 where (select f1 from tb1) is null order by f1;

taos> select (select f1 from tb1 order by ts, f1 limit 1) from tb1 where (select f1 from tb1 order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from tb1) from tb1 where (select count(*) from tb1) is null order by f1;

taos> select (select null from tb1) from tb1 where (select null from tb1) is null order by f1;
 (select null from tb1) |
=========================
 NULL                   |

taos> select (select * from tb1) from tb1 where (select * from tb1) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) from tb1 where (select 2 from tb1) is null order by f1;

taos> select (select avg(f1) from tb1) from tb1 where (select avg(f1) from tb1) is null order by f1;

taos> select (select last(*) from tb1) from tb1 where (select last(*) from tb1) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) from tb1 where (select max(f1) from tb1 partition by f1) is null order by f1;

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 where (select a.ts from tb1 a join tb1 b on a.ts = b.ts) is null order by f1;

taos> select (select sum(f1) from tb1 interval(1d)) from tb1 where (select sum(f1) from tb1 interval(1d)) is null order by f1;

taos> select (select f1 from tb1 union select f1 from tb1) from tb1 where (select f1 from tb1 union select f1 from tb1) is null order by f1;

taos> select (select f1 from tb1 union all select f1 from tb1) from tb1 where (select f1 from tb1 union all select f1 from tb1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) from tb1 where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1) from tb1 where (select f1 from tb1) is not null order by f1;
 (select f1 from tb1) |
=======================
                    1 |

taos> select (select f1 from tb1 order by ts, f1 limit 1) from tb1 where (select f1 from tb1 order by ts, f1 limit 1) is not null order by f1;
 (select f1 from tb1 order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select (select count(*) from tb1) from tb1 where (select count(*) from tb1) is not null order by f1;
 (select count(*) from tb1) |
=============================
                          1 |

taos> select (select null from tb1) from tb1 where (select null from tb1) is not null order by f1;

taos> select (select * from tb1) from tb1 where (select * from tb1) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1) from tb1 where (select 2 from tb1) is not null order by f1;
  (select 2 from tb1)  |
========================
                     2 |

taos> select (select avg(f1) from tb1) from tb1 where (select avg(f1) from tb1) is not null order by f1;
 (select avg(f1) from tb1) |
============================
                         1 |

taos> select (select last(*) from tb1) from tb1 where (select last(*) from tb1) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1) from tb1 where (select max(f1) from tb1 partition by f1) is not null order by f1;
 (select max(f1) from tb1 partition by f1) |
============================================
                                         1 |

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 where (select a.ts from tb1 a join tb1 b on a.ts = b.ts) is not null order by f1;
 (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)) from tb1 where (select sum(f1) from tb1 interval(1d)) is not null order by f1;
 (select sum(f1) from tb1 interval(1d)) |
=========================================
                                      1 |

taos> select (select f1 from tb1 union select f1 from tb1) from tb1 where (select f1 from tb1 union select f1 from tb1) is not null order by f1;
 (select f1 from tb1 union select f1 from tb1) |
================================================
                                             1 |

taos> select (select f1 from tb1 union all select f1 from tb1) from tb1 where (select f1 from tb1 union all select f1 from tb1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select 1) as varchar) from tb1 where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from tb1) as varchar) from tb1 where abs((select f1 from tb1)) > 0 order by f1;
     f1      | cast((select f1 from tb1) as varchar) |
======================================================
           1 | 1                                     |

taos> select f1, cast((select f1 from tb1 order by ts, f1 limit 1) as varchar) from tb1 where abs((select f1 from tb1 order by ts, f1 limit 1)) > 0 order by f1;
     f1      | cast((select f1 from tb1 order by ts, f1 limit 1) as varchar) |
==============================================================================
           1 | 1                                                             |

taos> select f1, cast((select count(*) from tb1) as varchar) from tb1 where abs((select count(*) from tb1)) > 0 order by f1;
     f1      | cast((select count(*) from tb1) as varchar) |
============================================================
           1 | 1                                           |

taos> select f1, cast((select null from tb1) as varchar) from tb1 where abs((select null from tb1)) > 0 order by f1;

taos> select f1, cast((select * from tb1) as varchar) from tb1 where abs((select * from tb1)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from tb1) as varchar) from tb1 where abs((select 2 from tb1)) > 0 order by f1;
     f1      | cast((select 2 from tb1) as varchar) |
=====================================================
           1 | 2                                    |

taos> select f1, cast((select avg(f1) from tb1) as varchar) from tb1 where abs((select avg(f1) from tb1)) > 0 order by f1;
     f1      | cast((select avg(f1) from tb1) as varchar) |
===========================================================
           1 | 1                                          |

taos> select f1, cast((select last(*) from tb1) as varchar) from tb1 where abs((select last(*) from tb1)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from tb1 partition by f1) as varchar) from tb1 where abs((select max(f1) from tb1 partition by f1)) > 0 order by f1;
     f1      | cast((select max(f1) from tb1 partition by f1) as varchar) |
===========================================================================
           1 | 1                                                          |

taos> select f1, cast((select a.ts from tb1 a join tb1 b on a.ts = b.ts) as varchar) from tb1 where abs((select a.ts from tb1 a join tb1 b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from tb1 interval(1d)) as varchar) from tb1 where abs((select sum(f1) from tb1 interval(1d))) > 0 order by f1;
     f1      | cast((select sum(f1) from tb1 interval(1d)) as varchar) |
========================================================================
           1 | 1                                                       |

taos> select f1, cast((select f1 from tb1 union select f1 from tb1) as varchar) from tb1 where abs((select f1 from tb1 union select f1 from tb1)) > 0 order by f1;
     f1      | cast((select f1 from tb1 union select f1 from tb1) as varchar) |
===============================================================================
           1 | 1                                                              |

taos> select f1, cast((select f1 from tb1 union all select f1 from tb1) as varchar) from tb1 where abs((select f1 from tb1 union all select f1 from tb1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb1 where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb1) from tb1 where f1 > (select f1 from tb1) or f1 < (select f1 from tb1) order by f1;

taos> select f1, (select f1 from tb1 order by ts, f1 limit 1) from tb1 where f1 > (select f1 from tb1 order by ts, f1 limit 1) or f1 < (select f1 from tb1 order by ts, f1 limit 1) order by f1;

taos> select f1, (select count(*) from tb1) from tb1 where f1 > (select count(*) from tb1) or f1 < (select count(*) from tb1) order by f1;

taos> select f1, (select null from tb1) from tb1 where f1 > (select null from tb1) or f1 < (select null from tb1) order by f1;

taos> select f1, (select * from tb1) from tb1 where f1 > (select * from tb1) or f1 < (select * from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb1) from tb1 where f1 > (select 2 from tb1) or f1 < (select 2 from tb1) order by f1;
     f1      |  (select 2 from tb1)  |
======================================
           1 |                     2 |

taos> select f1, (select avg(f1) from tb1) from tb1 where f1 > (select avg(f1) from tb1) or f1 < (select avg(f1) from tb1) order by f1;

taos> select f1, (select last(*) from tb1) from tb1 where f1 > (select last(*) from tb1) or f1 < (select last(*) from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb1 partition by f1) from tb1 where f1 > (select max(f1) from tb1 partition by f1) or f1 < (select max(f1) from tb1 partition by f1) order by f1;

taos> select f1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 where f1 > (select a.ts from tb1 a join tb1 b on a.ts = b.ts) or f1 < (select a.ts from tb1 a join tb1 b on a.ts = b.ts) order by f1;
     f1      | (select a.ts from tb1 a join tb1 b on a.ts = b.ts) |
===================================================================
           1 | 2025-12-01 00:00:00.000 |

taos> select f1, (select sum(f1) from tb1 interval(1d)) from tb1 where f1 > (select sum(f1) from tb1 interval(1d)) or f1 < (select sum(f1) from tb1 interval(1d)) order by f1;

taos> select f1, (select f1 from tb1 union select f1 from tb1) from tb1 where f1 > (select f1 from tb1 union select f1 from tb1) or f1 < (select f1 from tb1 union select f1 from tb1) order by f1;

taos> select f1, (select f1 from tb1 union all select f1 from tb1) from tb1 where f1 > (select f1 from tb1 union all select f1 from tb1) or f1 < (select f1 from tb1 union all select f1 from tb1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb1 where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb1) from tb1 where f1 between (select f1 from tb1) and (select f1 from tb1) + 1 order by f1;
     f1      | (select f1 from tb1) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tb1 order by ts, f1 limit 1) from tb1 where f1 between (select f1 from tb1 order by ts, f1 limit 1) and (select f1 from tb1 order by ts, f1 limit 1) + 1 order by f1;
     f1      | (select f1 from tb1 order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from tb1) from tb1 where f1 between (select count(*) from tb1) and (select count(*) from tb1) + 1 order by f1;
     f1      | (select count(*) from tb1) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tb1) from tb1 where f1 between (select null from tb1) and (select null from tb1) + 1 order by f1;

taos> select f1, (select * from tb1) from tb1 where f1 between (select * from tb1) and (select * from tb1) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb1) from tb1 where f1 between (select 2 from tb1) and (select 2 from tb1) + 1 order by f1;

taos> select f1, (select avg(f1) from tb1) from tb1 where f1 between (select avg(f1) from tb1) and (select avg(f1) from tb1) + 1 order by f1;
     f1      | (select avg(f1) from tb1) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tb1) from tb1 where f1 between (select last(*) from tb1) and (select last(*) from tb1) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb1 partition by f1) from tb1 where f1 between (select max(f1) from tb1 partition by f1) and (select max(f1) from tb1 partition by f1) + 1 order by f1;
     f1      | (select max(f1) from tb1 partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tb1 a join tb1 b on a.ts = b.ts) from tb1 where f1 between (select a.ts from tb1 a join tb1 b on a.ts = b.ts) and (select a.ts from tb1 a join tb1 b on a.ts = b.ts) + 1 order by f1;

taos> select f1, (select sum(f1) from tb1 interval(1d)) from tb1 where f1 between (select sum(f1) from tb1 interval(1d)) and (select sum(f1) from tb1 interval(1d)) + 1 order by f1;
     f1      | (select sum(f1) from tb1 interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tb1 union select f1 from tb1) from tb1 where f1 between (select f1 from tb1 union select f1 from tb1) and (select f1 from tb1 union select f1 from tb1) + 1 order by f1;
     f1      | (select f1 from tb1 union select f1 from tb1) |
==============================================================
           1 |                                             1 |

taos> select f1, (select f1 from tb1 union all select f1 from tb1) from tb1 where f1 between (select f1 from tb1 union all select f1 from tb1) and (select f1 from tb1 union all select f1 from tb1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) > 0 from tb1 where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb1), (select f1 from tb1) > 0 from tb1 where (select f1 from tb1) > 0 and f1 > (select f1 from tb1) order by f1;

taos> select (select f1 from tb1 order by ts, f1 limit 1), (select f1 from tb1 order by ts, f1 limit 1) > 0 from tb1 where (select f1 from tb1 order by ts, f1 limit 1) > 0 and f1 > (select f1 from tb1 order by ts, f1 limit 1) order by f1;

taos> select (select count(*) from tb1), (select count(*) from tb1) > 0 from tb1 where (select count(*) from tb1) > 0 and f1 > (select count(*) from tb1) order by f1;

taos> select (select null from tb1), (select null from tb1) > 0 from tb1 where (select null from tb1) > 0 and f1 > (select null from tb1) order by f1;

taos> select (select * from tb1), (select * from tb1) > 0 from tb1 where (select * from tb1) > 0 and f1 > (select * from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb1), (select 2 from tb1) > 0 from tb1 where (select 2 from tb1) > 0 and f1 > (select 2 from tb1) order by f1;

taos> select (select avg(f1) from tb1), (select avg(f1) from tb1) > 0 from tb1 where (select avg(f1) from tb1) > 0 and f1 > (select avg(f1) from tb1) order by f1;

taos> select (select last(*) from tb1), (select last(*) from tb1) > 0 from tb1 where (select last(*) from tb1) > 0 and f1 > (select last(*) from tb1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb1 partition by f1), (select max(f1) from tb1 partition by f1) > 0 from tb1 where (select max(f1) from tb1 partition by f1) > 0 and f1 > (select max(f1) from tb1 partition by f1) order by f1;

taos> select (select a.ts from tb1 a join tb1 b on a.ts = b.ts), (select a.ts from tb1 a join tb1 b on a.ts = b.ts) > 0 from tb1 where (select a.ts from tb1 a join tb1 b on a.ts = b.ts) > 0 and f1 > (select a.ts from tb1 a join tb1 b on a.ts = b.ts) order by f1;

taos> select (select sum(f1) from tb1 interval(1d)), (select sum(f1) from tb1 interval(1d)) > 0 from tb1 where (select sum(f1) from tb1 interval(1d)) > 0 and f1 > (select sum(f1) from tb1 interval(1d)) order by f1;

taos> select (select f1 from tb1 union select f1 from tb1), (select f1 from tb1 union select f1 from tb1) > 0 from tb1 where (select f1 from tb1 union select f1 from tb1) > 0 and f1 > (select f1 from tb1 union select f1 from tb1) order by f1;

taos> select (select f1 from tb1 union all select f1 from tb1), (select f1 from tb1 union all select f1 from tb1) > 0 from tb1 where (select f1 from tb1 union all select f1 from tb1) > 0 and f1 > (select f1 from tb1 union all select f1 from tb1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb2 order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from tb2 partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from tb2 interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb2 union select f1 from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb2 union all select f1 from tb2);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) from tb2;
 (select f1 from tb2 order by ts, f1 limit 1) |
===============================================
                                            2 |
                                            2 |

taos> select (select count(*) from tb2) from tb2;
 (select count(*) from tb2) |
=============================
                          2 |
                          2 |

taos> select (select null from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) from tb2;
 (select avg(f1) from tb2) |
============================
                       2.5 |
                       2.5 |

taos> select (select last(*) from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) a from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) a from tb2;
      a      |
==============
           2 |
           2 |

taos> select (select count(*) from tb2) a from tb2;
           a           |
========================
                     2 |
                     2 |

taos> select (select null from tb2) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) a from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) a from tb2;
             a             |
============================
                       2.5 |
                       2.5 |

taos> select (select last(*) from tb2) a from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) a from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select 1) from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from tb2 order by ts, f1 limit 1) from tb2;
 (select f1 from tb2 order by ts, f1 limit 1) |
===============================================
                                            2 |

taos> select tags (select count(*) from tb2) from tb2;
 (select count(*) from tb2) |
=============================
                          2 |

taos> select tags (select null from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select * from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select avg(f1) from tb2) from tb2;
 (select avg(f1) from tb2) |
============================
                       2.5 |

taos> select tags (select last(*) from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from tb2 partition by f1) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select sum(f1) from tb2 interval(1d)) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from tb2 union select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from tb2 union all select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1) from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb2 order by ts, f1 limit 1) from tb2;
 (select f1 from tb2 order by ts, f1 limit 1) |
===============================================
                                            2 |

taos> select distinct (select count(*) from tb2) from tb2;
 (select count(*) from tb2) |
=============================
                          2 |

taos> select distinct (select null from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select * from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select avg(f1) from tb2) from tb2;
 (select avg(f1) from tb2) |
============================
                       2.5 |

taos> select distinct (select last(*) from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tb2 partition by f1) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select sum(f1) from tb2 interval(1d)) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb2 union select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb2 union all select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1), f1 from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tb2), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb2 order by ts, f1 limit 1), f1 from tb2;
 (select f1 from tb2 order by ts, f1 limit 1) |     f1      |
=============================================================
                                            2 |           3 |
                                            2 |           2 |

taos> select distinct (select count(*) from tb2), f1 from tb2;
 (select count(*) from tb2) |     f1      |
===========================================
                          2 |           2 |
                          2 |           3 |

taos> select distinct (select null from tb2), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select * from tb2), f1 from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tb2), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select avg(f1) from tb2), f1 from tb2;
 (select avg(f1) from tb2) |     f1      |
==========================================
                       2.5 |           2 |
                       2.5 |           3 |

taos> select distinct (select last(*) from tb2), f1 from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tb2 partition by f1), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select a.ts from tb2 a join tb2 b on a.ts = b.ts), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select sum(f1) from tb2 interval(1d)), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb2 union select f1 from tb2), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb2 union all select f1 from tb2), f1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select 1) + 1 from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from tb2) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from tb2 order by ts, f1 limit 1) + 1 from tb2;
 (select f1 from tb2 order by ts, f1 limit 1) + 1 |
===================================================
                                                3 |

taos> select distinct tags (select count(*) from tb2) + 1 from tb2;
 (select count(*) from tb2) + 1 |
=================================
                              3 |

taos> select distinct tags (select null from tb2) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select * from tb2) + 1 from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from tb2) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select avg(f1) from tb2) + 1 from tb2;
 (select avg(f1) from tb2) + 1 |
================================
                           3.5 |

taos> select distinct tags (select last(*) from tb2) + 1 from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from tb2 partition by f1) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select sum(f1) from tb2 interval(1d)) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from tb2 union select f1 from tb2) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from tb2 union all select f1 from tb2) + 1 from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) from tb2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2), (select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1), (select f1 from tb2 order by ts, f1 limit 1) from tb2;
 (select f1 from tb2 order by ts, f1 limit 1) | (select f1 from tb2 order by ts, f1 limit 1) |
==============================================================================================
                                            2 |                                            2 |
                                            2 |                                            2 |

taos> select (select count(*) from tb2), (select count(*) from tb2) from tb2;
 (select count(*) from tb2) | (select count(*) from tb2) |
==========================================================
                          2 |                          2 |
                          2 |                          2 |

taos> select (select null from tb2), (select null from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2), (select * from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2), (select 2 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2), (select avg(f1) from tb2) from tb2;
 (select avg(f1) from tb2) | (select avg(f1) from tb2) |
========================================================
                       2.5 |                       2.5 |
                       2.5 |                       2.5 |

taos> select (select last(*) from tb2), (select last(*) from tb2) from tb2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1), (select max(f1) from tb2 partition by f1) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts), (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)), (select sum(f1) from tb2 interval(1d)) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2), (select f1 from tb2 union select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2), (select f1 from tb2 union all select f1 from tb2) from tb2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select 1) from tb2 order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from tb2) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from tb2 order by ts, f1 limit 1) from tb2 order by ts;
           1           | (select f1 from tb2 order by ts, f1 limit 1) |
=======================================================================
                     1 |                                            2 |
                     1 |                                            2 |

taos> select 1, (select count(*) from tb2) from tb2 order by ts;
           1           | (select count(*) from tb2) |
=====================================================
                     1 |                          2 |
                     1 |                          2 |

taos> select 1, (select null from tb2) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select * from tb2) from tb2 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from tb2) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select avg(f1) from tb2) from tb2 order by ts;
           1           | (select avg(f1) from tb2) |
====================================================
                     1 |                       2.5 |
                     1 |                       2.5 |

taos> select 1, (select last(*) from tb2) from tb2 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from tb2 partition by f1) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select sum(f1) from tb2 interval(1d)) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from tb2 union select f1 from tb2) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from tb2 union all select f1 from tb2) from tb2 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), * from tb2 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1), * from tb2 order by ts, f1;
 (select f1 from tb2 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |
=====================================================================================================
                                            2 | 2025-12-01 00:00:00.000 |           2 |          21 |
                                            2 | 2025-12-02 00:00:00.000 |           3 |          23 |

taos> select (select count(*) from tb2), * from tb2 order by ts, f1;
 (select count(*) from tb2) |           ts            |     f1      |     f2      |
===================================================================================
                          2 | 2025-12-01 00:00:00.000 |           2 |          21 |
                          2 | 2025-12-02 00:00:00.000 |           3 |          23 |

taos> select (select null from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2), * from tb2 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2), * from tb2 order by ts, f1;
 (select avg(f1) from tb2) |           ts            |     f1      |     f2      |
==================================================================================
                       2.5 | 2025-12-01 00:00:00.000 |           2 |          21 |
                       2.5 | 2025-12-02 00:00:00.000 |           3 |          23 |

taos> select (select last(*) from tb2), * from tb2 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) * (select 1), * from tb2 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) * (select f1 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) * (select f1 from tb2 order by ts, f1 limit 1), * from tb2 order by ts, f1;
 (select f1 from tb2 order by ts, f1 limit 1) * (select f1 from t |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               4 | 2025-12-01 00:00:00.000 |           2 |          21 |
                                                               4 | 2025-12-02 00:00:00.000 |           3 |          23 |

taos> select (select count(*) from tb2) * (select count(*) from tb2), * from tb2 order by ts, f1;
 (select count(*) from tb2) * (select count(*) from tb2) |           ts            |     f1      |     f2      |
================================================================================================================
                                                       4 | 2025-12-01 00:00:00.000 |           2 |          21 |
                                                       4 | 2025-12-02 00:00:00.000 |           3 |          23 |

taos> select (select null from tb2) * (select null from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) * (select * from tb2), * from tb2 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) * (select 2 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) * (select avg(f1) from tb2), * from tb2 order by ts, f1;
 (select avg(f1) from tb2) * (select avg(f1) from tb2) |           ts            |     f1      |     f2      |
==============================================================================================================
                                                  6.25 | 2025-12-01 00:00:00.000 |           2 |          21 |
                                                  6.25 | 2025-12-02 00:00:00.000 |           3 |          23 |

taos> select (select last(*) from tb2) * (select last(*) from tb2), * from tb2 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) * (select max(f1) from tb2 partition by f1), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) * (select a.ts from tb2 a join tb2 b on a.ts = b.ts), * from tb2 order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb2 interval(1d)) * (select sum(f1) from tb2 interval(1d)), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) * (select f1 from tb2 union select f1 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) * (select f1 from tb2 union all select f1 from tb2), * from tb2 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)) from tb2;

DB error: unrecognized token: "{funcname}((select 1)) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts, f1 limit 1)) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts, f1 limit 1)) from tb2;" [0x80002600] 
taos> select {funcName}((select count(*) from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select count(*) from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select null from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select null from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select * from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select * from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select 2 from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select 2 from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select last(*) from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select last(*) from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb2 partition by f1)) from tb2;

DB error: unrecognized token: "{funcname}((select max(f1) from tb2 partition by f1)) from tb2;" [0x80002600] 
taos> select {funcName}((select a.ts from tb2 a join tb2 b on a.ts = b.ts)) from tb2;

DB error: unrecognized token: "{funcname}((select a.ts from tb2 a join tb2 b on a.ts = b.ts)) from tb2;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb2 interval(1d))) from tb2;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb2 interval(1d))) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union select f1 from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 union select f1 from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union all select f1 from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 union all select f1 from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts, f1 limit 1) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts, f1 limit 1) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select count(*) from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select count(*) from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select null from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select null from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select * from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select * from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select 2 from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select 2 from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select last(*) from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select last(*) from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb2 partition by f1) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select max(f1) from tb2 partition by f1) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb2 interval(1d)) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb2 interval(1d)) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union select f1 from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 union select f1 from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union all select f1 from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 union all select f1 from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts, f1 limit 1) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts, f1 limit 1) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select count(*) from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select count(*) from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select null from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select null from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select * from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select * from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select 2 from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select 2 from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select last(*) from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select last(*) from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb2 partition by f1) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select max(f1) from tb2 partition by f1) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb2 interval(1d)) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb2 interval(1d)) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union select f1 from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 union select f1 from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union all select f1 from tb2) + 1) + 2 from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 union all select f1 from tb2) + 1) + 2 from tb2;" [0x80002600] 
taos> select (select 1) + (select 1) from tb2 partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) + (select f1 from tb2) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) + (select f1 from tb2 order by ts, f1 limit 1) from tb2 partition by tbname;
 (select f1 from tb2 order by ts, f1 limit 1) + (select f1 from t |
===================================================================
                                                               4 |
                                                               4 |

taos> select (select count(*) from tb2) + (select count(*) from tb2) from tb2 partition by tbname;
 (select count(*) from tb2) + (select count(*) from tb2) |
==========================================================
                                                       4 |
                                                       4 |

taos> select (select null from tb2) + (select null from tb2) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) + (select * from tb2) from tb2 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) + (select 2 from tb2) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) + (select avg(f1) from tb2) from tb2 partition by tbname;
 (select avg(f1) from tb2) + (select avg(f1) from tb2) |
========================================================
                                                     5 |
                                                     5 |

taos> select (select last(*) from tb2) + (select last(*) from tb2) from tb2 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) + (select max(f1) from tb2 partition by f1) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb2 interval(1d)) + (select sum(f1) from tb2 interval(1d)) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) + (select f1 from tb2 union select f1 from tb2) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) + (select f1 from tb2 union all select f1 from tb2) from tb2 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + f1 from tb2 partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) + f1 from tb2 partition by f1;
 (select f1 from tb2 order by ts, f1 limit 1) + f1 |
====================================================
                                                 4 |
                                                 5 |

taos> select (select count(*) from tb2) + f1 from tb2 partition by f1;
 (select count(*) from tb2) + f1 |
==================================
                               4 |
                               5 |

taos> select (select null from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) + f1 from tb2 partition by f1;
 (select avg(f1) from tb2) + f1 |
=================================
                            4.5 |
                            5.5 |

taos> select (select last(*) from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) + f1 from tb2 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from tb2 order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;
 case when (select f1 from tb2 order by ts, f1 limit 1) > 0 then  |        sum(f1)        |
===========================================================================================
                                                                1 |                     2 |
                                                                1 |                     3 |

taos> select case when (select count(*) from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;
 case when (select count(*) from tb2) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     2 |
                                                          1 |                     3 |

taos> select case when (select null from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select * from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select avg(f1) from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;
 case when (select avg(f1) from tb2) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     2 |
                                                         1 |                     3 |

taos> select case when (select last(*) from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from tb2 partition by f1) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select a.ts from tb2 a join tb2 b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select sum(f1) from tb2 interval(1d)) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from tb2 union select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from tb2 union all select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tb2 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from tb2 order by ts, f1 limit 1) else 2 end, sum(f1) from tb2 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb2 order by ts, f1 li |        sum(f1)        |
===========================================================================================
 2                                                                |                     2 |
 2                                                                |                     3 |

taos> select case when f1 = 1 then 2 / (select count(*) from tb2) else 2 end, sum(f1) from tb2 group by f1;
 case when f1 = 1 then 2 / (select count(*) from tb2) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     2 |
 2                                                               |                     3 |

taos> select case when f1 = 1 then 2 / (select null from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select * from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select avg(f1) from tb2) else 2 end, sum(f1) from tb2 group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from tb2) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     2 |
 2                                                              |                     3 |

taos> select case when f1 = 1 then 2 / (select last(*) from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tb2 partition by f1) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select a.ts from tb2 a join tb2 b on a.ts = b.ts) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select sum(f1) from tb2 interval(1d)) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from tb2 union select f1 from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from tb2 union all select f1 from tb2) else 2 end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tb2 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from tb2 order by ts, f1 limit 1) is null end, sum(f1) from tb2 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb2 order by ts, f1 |        sum(f1)        |
===========================================================================================
                                                                0 |                     2 |
                                                                0 |                     3 |

taos> select case when f1 = 1 then 1 else (select count(*) from tb2) is null end, sum(f1) from tb2 group by f1;
 case when f1 = 1 then 1 else (select count(*) from tb2) is null  |        sum(f1)        |
===========================================================================================
                                                                0 |                     2 |
                                                                0 |                     3 |

taos> select case when f1 = 1 then 1 else (select null from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select * from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select avg(f1) from tb2) is null end, sum(f1) from tb2 group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from tb2) is null e |        sum(f1)        |
===========================================================================================
                                                                0 |                     2 |
                                                                0 |                     3 |

taos> select case when f1 = 1 then 1 else (select last(*) from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tb2 partition by f1) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select a.ts from tb2 a join tb2 b on a.ts = b.ts) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select sum(f1) from tb2 interval(1d)) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from tb2 union select f1 from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from tb2 union all select f1 from tb2) is null end, sum(f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tb2 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb2 order by ts, f1 limit 1), avg(f1) from tb2 interval(1d);
         _wstart         | (select f1 from tb2 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            2 |                         2 |
 2025-12-02 00:00:00.000 |                                            2 |                         3 |

taos> select _wstart, (select count(*) from tb2), avg(f1) from tb2 interval(1d);
         _wstart         | (select count(*) from tb2) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          2 |                         2 |
 2025-12-02 00:00:00.000 |                          2 |                         3 |

taos> select _wstart, (select null from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select * from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select avg(f1) from tb2), avg(f1) from tb2 interval(1d);
         _wstart         | (select avg(f1) from tb2) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                       2.5 |                         2 |
 2025-12-02 00:00:00.000 |                       2.5 |                         3 |

taos> select _wstart, (select last(*) from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tb2 partition by f1), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select a.ts from tb2 a join tb2 b on a.ts = b.ts), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select sum(f1) from tb2 interval(1d)), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb2 union select f1 from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb2 union all select f1 from tb2), avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tb2 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) + 1, avg(f1) from tb2 interval(1d);
 (select f1 from tb2 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                3 |                         2 |
                                                3 |                         3 |

taos> select (select count(*) from tb2) + 1, avg(f1) from tb2 interval(1d);
 (select count(*) from tb2) + 1 |          avg(f1)          |
=============================================================
                              3 |                         2 |
                              3 |                         3 |

taos> select (select null from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) + 1, avg(f1) from tb2 interval(1d);
 (select avg(f1) from tb2) + 1 |          avg(f1)          |
============================================================
                           3.5 |                         2 |
                           3.5 |                         3 |

taos> select (select last(*) from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts, f1 limit 1)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts, f1 limit 1)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb2 partition by f1)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb2 partition by f1)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb2 a join tb2 b on a.ts = b.ts)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb2 a join tb2 b on a.ts = b.ts)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb2 interval(1d))), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb2 interval(1d))), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union select f1 from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 union select f1 from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union all select f1 from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 union all select f1 from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts, f1 limit 1) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts, f1 limit 1) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb2 partition by f1) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb2 partition by f1) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb2 interval(1d)) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb2 interval(1d)) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 union select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 union all select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 union all select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from tb2 order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);
 case (select f1 from tb2 order by ts, f1 limit 1) when 1 then 1  |          avg(f1)          |
===============================================================================================
                                                                2 |                         2 |
                                                                2 |                         3 |

taos> select case (select count(*) from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);
 case (select count(*) from tb2) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        2 |                         2 |
                                                        2 |                         3 |

taos> select case (select null from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select * from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select avg(f1) from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);
 case (select avg(f1) from tb2) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       2 |                         2 |
                                                       2 |                         3 |

taos> select case (select last(*) from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from tb2 partition by f1) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select a.ts from tb2 a join tb2 b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select sum(f1) from tb2 interval(1d)) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from tb2 union select f1 from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from tb2 union all select f1 from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb2 order by ts, f1 limit 1), avg(f1) from tb2 SESSION(ts, 1d);
         _wstart         | (select f1 from tb2 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            2 |                       2.5 |

taos> select _wstart, (select count(*) from tb2), avg(f1) from tb2 SESSION(ts, 1d);
         _wstart         | (select count(*) from tb2) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          2 |                       2.5 |

taos> select _wstart, (select null from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select * from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select avg(f1) from tb2), avg(f1) from tb2 SESSION(ts, 1d);
         _wstart         | (select avg(f1) from tb2) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                       2.5 |                       2.5 |

taos> select _wstart, (select last(*) from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tb2 partition by f1), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select a.ts from tb2 a join tb2 b on a.ts = b.ts), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select sum(f1) from tb2 interval(1d)), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb2 union select f1 from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb2 union all select f1 from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) + 1, avg(f1) from tb2 SESSION(ts, 1d);
 (select f1 from tb2 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                3 |                       2.5 |

taos> select (select count(*) from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);
 (select count(*) from tb2) + 1 |          avg(f1)          |
=============================================================
                              3 |                       2.5 |

taos> select (select null from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);
 (select avg(f1) from tb2) + 1 |          avg(f1)          |
============================================================
                           3.5 |                       2.5 |

taos> select (select last(*) from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) > 0 from tb2 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tb2 interval(1d)) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb2 union select f1 from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb2 union all select f1 from tb2) > 0 from tb2 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from tb2 order by ts, f1 limit 1) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);
 sum(case when (select f1 from tb2 order by ts, f1 limit 1) > 0 t |
===================================================================
                                                                1 |
                                                                1 |

taos> select sum(case when (select count(*) from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);
 sum(case when (select count(*) from tb2) > 0 then 1 else 2 end) |
==================================================================
                                                               1 |
                                                               1 |

taos> select sum(case when (select null from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select * from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select avg(f1) from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);
 sum(case when (select avg(f1) from tb2) > 0 then 1 else 2 end) |
=================================================================
                                                              1 |
                                                              1 |

taos> select sum(case when (select last(*) from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from tb2 partition by f1) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select a.ts from tb2 a join tb2 b on a.ts = b.ts) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select sum(f1) from tb2 interval(1d)) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from tb2 union select f1 from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from tb2 union all select f1 from tb2) > 0 then 1 else 2 end) from tb2 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb2 order by ts, f1 limit 1) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tb2 order by  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select count(*) from tb2) as |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select null from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select * from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb2) as  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tb2 partition by f1) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tb2 a join tb2 b on a.ts = b.ts) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tb2 interval(1d)) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb2 union select f1 from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb2 union all select f1 from tb2) as bigint) else 2 end) from tb2 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb2 order by ts, f1 limit 1) is null end + 1) from tb2 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb2 order by ts |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select count(*) from tb2) is n |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select null from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select * from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select avg(f1) from tb2) is nu |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tb2 partition by f1) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select a.ts from tb2 a join tb2 b on a.ts = b.ts) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tb2 interval(1d)) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb2 union select f1 from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb2 union all select f1 from tb2) is null end + 1) from tb2 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select 1)) from tb2 partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from tb2 order by ts, f1 limit 1)) from tb2 partition by tbname interval(1d);
 sum((select f1 from tb2 order by ts, f1 limit 1)) |
====================================================
                                                 2 |
                                                 2 |

taos> select sum((select count(*) from tb2)) from tb2 partition by tbname interval(1d);
 sum((select count(*) from tb2)) |
==================================
                               2 |
                               2 |

taos> select sum((select null from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select * from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select avg(f1) from tb2)) from tb2 partition by tbname interval(1d);
 sum((select avg(f1) from tb2)) |
=================================
                            2.5 |
                            2.5 |

taos> select sum((select last(*) from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from tb2 partition by f1)) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select a.ts from tb2 a join tb2 b on a.ts = b.ts)) from tb2 partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tb2 interval(1d))) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from tb2 union select f1 from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from tb2 union all select f1 from tb2)) from tb2 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select 1) * -1)) from tb2 partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from tb2 order by ts, f1 limit 1) * -1)) from tb2 partition by f1 interval(1d);
 avg(abs((select f1 from tb2 order by ts, f1 limit 1) * -1)) |
==============================================================
                                                           2 |
                                                           2 |

taos> select avg(abs((select count(*) from tb2) * -1)) from tb2 partition by f1 interval(1d);
 avg(abs((select count(*) from tb2) * -1)) |
============================================
                                         2 |
                                         2 |

taos> select avg(abs((select null from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select * from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select avg(f1) from tb2) * -1)) from tb2 partition by f1 interval(1d);
 avg(abs((select avg(f1) from tb2) * -1)) |
===========================================
                                      2.5 |
                                      2.5 |

taos> select avg(abs((select last(*) from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from tb2 partition by f1) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select a.ts from tb2 a join tb2 b on a.ts = b.ts) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select sum(f1) from tb2 interval(1d)) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from tb2 union select f1 from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from tb2 union all select f1 from tb2) * -1)) from tb2 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb2 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb2) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 order by ts, f1 limit 1) from tb2 group by f1;
     f1      | (select f1 from tb2 order by ts, f1 limit 1) |
=============================================================
           2 |                                            2 |
           3 |                                            2 |

taos> select f1, (select count(*) from tb2) from tb2 group by f1;
     f1      | (select count(*) from tb2) |
===========================================
           2 |                          2 |
           3 |                          2 |

taos> select f1, (select null from tb2) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb2) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb2) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb2) from tb2 group by f1;
     f1      | (select avg(f1) from tb2) |
==========================================
           2 |                       2.5 |
           3 |                       2.5 |

taos> select f1, (select last(*) from tb2) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb2 partition by f1) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb2 interval(1d)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union select f1 from tb2) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union all select f1 from tb2) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1), avg((select 1)) from tb2 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb2), avg((select f1 from tb2)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 order by ts, f1 limit 1), avg((select f1 from tb2 order by ts, f1 limit 1)) from tb2 group by f1;
     f1      | (select f1 from tb2 order by ts, f1 limit 1) | avg((select f1 from tb2 order by ts, f1 limit 1)) |
=================================================================================================================
           2 |                                            2 |                                                 2 |
           3 |                                            2 |                                                 2 |

taos> select f1, (select count(*) from tb2), avg((select count(*) from tb2)) from tb2 group by f1;
     f1      | (select count(*) from tb2) | avg((select count(*) from tb2)) |
=============================================================================
           2 |                          2 |                               2 |
           3 |                          2 |                               2 |

taos> select f1, (select null from tb2), avg((select null from tb2)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb2), avg((select * from tb2)) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb2), avg((select 2 from tb2)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb2), avg((select avg(f1) from tb2)) from tb2 group by f1;
     f1      | (select avg(f1) from tb2) | avg((select avg(f1) from tb2)) |
===========================================================================
           2 |                       2.5 |                            2.5 |
           3 |                       2.5 |                            2.5 |

taos> select f1, (select last(*) from tb2), avg((select last(*) from tb2)) from tb2 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb2 partition by f1), avg((select max(f1) from tb2 partition by f1)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts), avg((select a.ts from tb2 a join tb2 b on a.ts = b.ts)) from tb2 group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from tb2 interval(1d)), avg((select sum(f1) from tb2 interval(1d))) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union select f1 from tb2), avg((select f1 from tb2 union select f1 from tb2)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union all select f1 from tb2), avg((select f1 from tb2 union all select f1 from tb2)) from tb2 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select 1) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from tb2 order by ts, f1 limit 1) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2 order by ts, f1 limit 1) order by b.f1;
     f1      | (select f1 from tb2 order by ts, f1 limit 1) + 1 |
=================================================================
           2 |                                                3 |

taos> select b.f1, (select count(*) from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select count(*) from tb2) order by b.f1;
     f1      | (select count(*) from tb2) + 1 |
===============================================
           2 |                              3 |

taos> select b.f1, (select null from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select null from tb2) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select * from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select * from tb2) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select 2 from tb2) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select avg(f1) from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select avg(f1) from tb2) order by b.f1;

taos> select b.f1, (select last(*) from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select last(*) from tb2) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from tb2 partition by f1) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select max(f1) from tb2 partition by f1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select a.ts from tb2 a join tb2 b on a.ts = b.ts) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select sum(f1) from tb2 interval(1d)) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select sum(f1) from tb2 interval(1d)) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from tb2 union select f1 from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2 union select f1 from tb2) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from tb2 union all select f1 from tb2) + 1 from tb2 a join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2 union all select f1 from tb2) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg((select 1) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) + 1, avg((select f1 from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) + 1, avg((select f1 from tb2 order by ts, f1 limit 1) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2 order by ts, f1 limit 1);
 (select f1 from tb2 order by ts, f1 limit 1) + 1 | avg((select f1 from tb2 order by ts, f1 limit 1) + 2) |
===========================================================================================================
                                                3 |                                                     4 |

taos> select (select count(*) from tb2) + 1, avg((select count(*) from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select count(*) from tb2);
 (select count(*) from tb2) + 1 | avg((select count(*) from tb2) + 2) |
=======================================================================
                              3 |                                   4 |

taos> select (select null from tb2) + 1, avg((select null from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select null from tb2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) + 1, avg((select * from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select * from tb2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) + 1, avg((select 2 from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select 2 from tb2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) + 1, avg((select avg(f1) from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select avg(f1) from tb2);
 (select avg(f1) from tb2) + 1 | avg((select avg(f1) from tb2) + 2) |
=====================================================================
                           3.5 |                                4.5 |

taos> select (select last(*) from tb2) + 1, avg((select last(*) from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select last(*) from tb2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) + 1, avg((select max(f1) from tb2 partition by f1) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select max(f1) from tb2 partition by f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1, avg((select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select a.ts from tb2 a join tb2 b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from tb2 interval(1d)) + 1, avg((select sum(f1) from tb2 interval(1d)) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select sum(f1) from tb2 interval(1d));

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) + 1, avg((select f1 from tb2 union select f1 from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2 union select f1 from tb2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) + 1, avg((select f1 from tb2 union all select f1 from tb2) + 2) from tb2 a left join tb2 b on a.ts = b.ts and a.f1 = (select f1 from tb2 union all select f1 from tb2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select 1), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select f1 from tb2) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from tb2 order by ts, f1 limit 1), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select f1 from tb2 order by ts, f1 limit 1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select f1 from tb2 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |
===========================================================================================================================================================
 2025-12-01 00:00:00.000 |           2 |          21 |                                            2 | 2025-12-01 00:00:00.000 |           2 |          21 |
 2025-12-02 00:00:00.000 |           3 |          23 |                                            2 | NULL                    | NULL        | NULL        |

taos> select a.*, (select count(*) from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select count(*) from tb2) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select count(*) from tb2) |           ts            |     f1      |     f2      |
=========================================================================================================================================
 2025-12-01 00:00:00.000 |           2 |          21 |                          2 | 2025-12-01 00:00:00.000 |           2 |          21 |
 2025-12-02 00:00:00.000 |           3 |          23 |                          2 | NULL                    | NULL        | NULL        |

taos> select a.*, (select null from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select null from tb2) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select * from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select * from tb2) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select 2 from tb2) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select avg(f1) from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select avg(f1) from tb2) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select avg(f1) from tb2) |           ts            |     f1      |     f2      |
========================================================================================================================================
 2025-12-01 00:00:00.000 |           2 |          21 |                       2.5 | NULL                    | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           3 |          23 |                       2.5 | NULL                    | NULL        | NULL        |

taos> select a.*, (select last(*) from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select last(*) from tb2) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from tb2 partition by f1), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select max(f1) from tb2 partition by f1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select a.ts from tb2 a join tb2 b on a.ts = b.ts), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select a.ts from tb2 a join tb2 b on a.ts = b.ts) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select sum(f1) from tb2 interval(1d)), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select sum(f1) from tb2 interval(1d)) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from tb2 union select f1 from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select f1 from tb2 union select f1 from tb2) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from tb2 union all select f1 from tb2), b.* from tb2 a left join tb2 b on a.ts = b.ts and b.f1 = (select f1 from tb2 union all select f1 from tb2) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from tb2 where f1 != (select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select f1 from tb2 order by ts, f1 limit 1) order by f1;
     f1      |
==============
           3 |

taos> select f1 from tb2 where f1 != (select count(*) from tb2) order by f1;
     f1      |
==============
           3 |

taos> select f1 from tb2 where f1 != (select null from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select * from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tb2 where f1 != (select 2 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select avg(f1) from tb2) order by f1;
     f1      |
==============
           2 |
           3 |

taos> select f1 from tb2 where f1 != (select last(*) from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tb2 where f1 != (select max(f1) from tb2 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select a.ts from tb2 a join tb2 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select sum(f1) from tb2 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select f1 from tb2 union select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 != (select f1 from tb2 union all select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb2 where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb2) from tb2 where f1 = (select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 order by ts, f1 limit 1) from tb2 where f1 = (select f1 from tb2 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tb2 order by ts, f1 limit 1) |
=============================================================
           2 |                                            2 |

taos> select f1, (select count(*) from tb2) from tb2 where f1 = (select count(*) from tb2) order by f1;
     f1      | (select count(*) from tb2) |
===========================================
           2 |                          2 |

taos> select f1, (select null from tb2) from tb2 where f1 = (select null from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb2) from tb2 where f1 = (select * from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb2) from tb2 where f1 = (select 2 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb2) from tb2 where f1 = (select avg(f1) from tb2) order by f1;

taos> select f1, (select last(*) from tb2) from tb2 where f1 = (select last(*) from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb2 partition by f1) from tb2 where f1 = (select max(f1) from tb2 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 where f1 = (select a.ts from tb2 a join tb2 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb2 interval(1d)) from tb2 where f1 = (select sum(f1) from tb2 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union select f1 from tb2) from tb2 where f1 = (select f1 from tb2 union select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union all select f1 from tb2) from tb2 where f1 = (select f1 from tb2 union all select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb2 where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select f1 from tb2));

DB error: syntax error near "(select f1 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select f1 from tb2 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tb2 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select count(*) from tb2));

DB error: syntax error near "(select count(*) from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select null from tb2));

DB error: syntax error near "(select null from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select * from tb2));

DB error: syntax error near "(select * from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select 2 from tb2));

DB error: syntax error near "(select 2 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select avg(f1) from tb2));

DB error: syntax error near "(select avg(f1) from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select last(*) from tb2));

DB error: syntax error near "(select last(*) from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select max(f1) from tb2 partition by f1));

DB error: syntax error near "(select max(f1) from tb2 partition by f1));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select a.ts from tb2 a join tb2 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tb2 a join tb2 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select sum(f1) from tb2 interval(1d)));

DB error: syntax error near "(select sum(f1) from tb2 interval(1d)));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select f1 from tb2 union select f1 from tb2));

DB error: syntax error near "(select f1 from tb2 union select f1 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 in ((select f1 from tb2 union all select f1 from tb2));

DB error: syntax error near "(select f1 from tb2 union all select f1 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select f1 from tb2));

DB error: syntax error near "(select f1 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select f1 from tb2 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tb2 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select count(*) from tb2));

DB error: syntax error near "(select count(*) from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select null from tb2));

DB error: syntax error near "(select null from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select * from tb2));

DB error: syntax error near "(select * from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select 2 from tb2));

DB error: syntax error near "(select 2 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select avg(f1) from tb2));

DB error: syntax error near "(select avg(f1) from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select last(*) from tb2));

DB error: syntax error near "(select last(*) from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select max(f1) from tb2 partition by f1));

DB error: syntax error near "(select max(f1) from tb2 partition by f1));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select a.ts from tb2 a join tb2 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tb2 a join tb2 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select sum(f1) from tb2 interval(1d)));

DB error: syntax error near "(select sum(f1) from tb2 interval(1d)));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select f1 from tb2 union select f1 from tb2));

DB error: syntax error near "(select f1 from tb2 union select f1 from tb2));" [0x80002600] 
taos> select f1 from tb2 where f1 not in ((select f1 from tb2 union all select f1 from tb2));

DB error: syntax error near "(select f1 from tb2 union all select f1 from tb2));" [0x80002600] 
taos> select (select 1) from tb2 where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) from tb2 where (select f1 from tb2) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) from tb2 where (select f1 from tb2 order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from tb2) from tb2 where (select count(*) from tb2) is null order by f1;

taos> select (select null from tb2) from tb2 where (select null from tb2) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) from tb2 where (select * from tb2) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) from tb2 where (select 2 from tb2) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) from tb2 where (select avg(f1) from tb2) is null order by f1;

taos> select (select last(*) from tb2) from tb2 where (select last(*) from tb2) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) from tb2 where (select max(f1) from tb2 partition by f1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 where (select a.ts from tb2 a join tb2 b on a.ts = b.ts) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) from tb2 where (select sum(f1) from tb2 interval(1d)) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) from tb2 where (select f1 from tb2 union select f1 from tb2) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) from tb2 where (select f1 from tb2 union all select f1 from tb2) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) from tb2 where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2) from tb2 where (select f1 from tb2) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1) from tb2 where (select f1 from tb2 order by ts, f1 limit 1) is not null order by f1;
 (select f1 from tb2 order by ts, f1 limit 1) |
===============================================
                                            2 |
                                            2 |

taos> select (select count(*) from tb2) from tb2 where (select count(*) from tb2) is not null order by f1;
 (select count(*) from tb2) |
=============================
                          2 |
                          2 |

taos> select (select null from tb2) from tb2 where (select null from tb2) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2) from tb2 where (select * from tb2) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2) from tb2 where (select 2 from tb2) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2) from tb2 where (select avg(f1) from tb2) is not null order by f1;
 (select avg(f1) from tb2) |
============================
                       2.5 |
                       2.5 |

taos> select (select last(*) from tb2) from tb2 where (select last(*) from tb2) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1) from tb2 where (select max(f1) from tb2 partition by f1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 where (select a.ts from tb2 a join tb2 b on a.ts = b.ts) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)) from tb2 where (select sum(f1) from tb2 interval(1d)) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2) from tb2 where (select f1 from tb2 union select f1 from tb2) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2) from tb2 where (select f1 from tb2 union all select f1 from tb2) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select 1) as varchar) from tb2 where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from tb2) as varchar) from tb2 where abs((select f1 from tb2)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from tb2 order by ts, f1 limit 1) as varchar) from tb2 where abs((select f1 from tb2 order by ts, f1 limit 1)) > 0 order by f1;
     f1      | cast((select f1 from tb2 order by ts, f1 limit 1) as varchar) |
==============================================================================
           2 | 2                                                             |
           3 | 2                                                             |

taos> select f1, cast((select count(*) from tb2) as varchar) from tb2 where abs((select count(*) from tb2)) > 0 order by f1;
     f1      | cast((select count(*) from tb2) as varchar) |
============================================================
           2 | 2                                           |
           3 | 2                                           |

taos> select f1, cast((select null from tb2) as varchar) from tb2 where abs((select null from tb2)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select * from tb2) as varchar) from tb2 where abs((select * from tb2)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from tb2) as varchar) from tb2 where abs((select 2 from tb2)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select avg(f1) from tb2) as varchar) from tb2 where abs((select avg(f1) from tb2)) > 0 order by f1;
     f1      | cast((select avg(f1) from tb2) as varchar) |
===========================================================
           2 | 2.5                                        |
           3 | 2.5                                        |

taos> select f1, cast((select last(*) from tb2) as varchar) from tb2 where abs((select last(*) from tb2)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from tb2 partition by f1) as varchar) from tb2 where abs((select max(f1) from tb2 partition by f1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select a.ts from tb2 a join tb2 b on a.ts = b.ts) as varchar) from tb2 where abs((select a.ts from tb2 a join tb2 b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from tb2 interval(1d)) as varchar) from tb2 where abs((select sum(f1) from tb2 interval(1d))) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from tb2 union select f1 from tb2) as varchar) from tb2 where abs((select f1 from tb2 union select f1 from tb2)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from tb2 union all select f1 from tb2) as varchar) from tb2 where abs((select f1 from tb2 union all select f1 from tb2)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb2 where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb2) from tb2 where f1 > (select f1 from tb2) or f1 < (select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 order by ts, f1 limit 1) from tb2 where f1 > (select f1 from tb2 order by ts, f1 limit 1) or f1 < (select f1 from tb2 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tb2 order by ts, f1 limit 1) |
=============================================================
           3 |                                            2 |

taos> select f1, (select count(*) from tb2) from tb2 where f1 > (select count(*) from tb2) or f1 < (select count(*) from tb2) order by f1;
     f1      | (select count(*) from tb2) |
===========================================
           3 |                          2 |

taos> select f1, (select null from tb2) from tb2 where f1 > (select null from tb2) or f1 < (select null from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb2) from tb2 where f1 > (select * from tb2) or f1 < (select * from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb2) from tb2 where f1 > (select 2 from tb2) or f1 < (select 2 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb2) from tb2 where f1 > (select avg(f1) from tb2) or f1 < (select avg(f1) from tb2) order by f1;
     f1      | (select avg(f1) from tb2) |
==========================================
           2 |                       2.5 |
           3 |                       2.5 |

taos> select f1, (select last(*) from tb2) from tb2 where f1 > (select last(*) from tb2) or f1 < (select last(*) from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb2 partition by f1) from tb2 where f1 > (select max(f1) from tb2 partition by f1) or f1 < (select max(f1) from tb2 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 where f1 > (select a.ts from tb2 a join tb2 b on a.ts = b.ts) or f1 < (select a.ts from tb2 a join tb2 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb2 interval(1d)) from tb2 where f1 > (select sum(f1) from tb2 interval(1d)) or f1 < (select sum(f1) from tb2 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union select f1 from tb2) from tb2 where f1 > (select f1 from tb2 union select f1 from tb2) or f1 < (select f1 from tb2 union select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union all select f1 from tb2) from tb2 where f1 > (select f1 from tb2 union all select f1 from tb2) or f1 < (select f1 from tb2 union all select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb2 where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb2) from tb2 where f1 between (select f1 from tb2) and (select f1 from tb2) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 order by ts, f1 limit 1) from tb2 where f1 between (select f1 from tb2 order by ts, f1 limit 1) and (select f1 from tb2 order by ts, f1 limit 1) + 1 order by f1;
     f1      | (select f1 from tb2 order by ts, f1 limit 1) |
=============================================================
           2 |                                            2 |
           3 |                                            2 |

taos> select f1, (select count(*) from tb2) from tb2 where f1 between (select count(*) from tb2) and (select count(*) from tb2) + 1 order by f1;
     f1      | (select count(*) from tb2) |
===========================================
           2 |                          2 |
           3 |                          2 |

taos> select f1, (select null from tb2) from tb2 where f1 between (select null from tb2) and (select null from tb2) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb2) from tb2 where f1 between (select * from tb2) and (select * from tb2) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb2) from tb2 where f1 between (select 2 from tb2) and (select 2 from tb2) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb2) from tb2 where f1 between (select avg(f1) from tb2) and (select avg(f1) from tb2) + 1 order by f1;
     f1      | (select avg(f1) from tb2) |
==========================================
           3 |                       2.5 |

taos> select f1, (select last(*) from tb2) from tb2 where f1 between (select last(*) from tb2) and (select last(*) from tb2) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb2 partition by f1) from tb2 where f1 between (select max(f1) from tb2 partition by f1) and (select max(f1) from tb2 partition by f1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb2 a join tb2 b on a.ts = b.ts) from tb2 where f1 between (select a.ts from tb2 a join tb2 b on a.ts = b.ts) and (select a.ts from tb2 a join tb2 b on a.ts = b.ts) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb2 interval(1d)) from tb2 where f1 between (select sum(f1) from tb2 interval(1d)) and (select sum(f1) from tb2 interval(1d)) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union select f1 from tb2) from tb2 where f1 between (select f1 from tb2 union select f1 from tb2) and (select f1 from tb2 union select f1 from tb2) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb2 union all select f1 from tb2) from tb2 where f1 between (select f1 from tb2 union all select f1 from tb2) and (select f1 from tb2 union all select f1 from tb2) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) > 0 from tb2 where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb2), (select f1 from tb2) > 0 from tb2 where (select f1 from tb2) > 0 and f1 > (select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 order by ts, f1 limit 1), (select f1 from tb2 order by ts, f1 limit 1) > 0 from tb2 where (select f1 from tb2 order by ts, f1 limit 1) > 0 and f1 > (select f1 from tb2 order by ts, f1 limit 1) order by f1;
 (select f1 from tb2 order by ts, f1 limit 1) | (select f1 from tb2 order by ts, f1 limit 1) > 0 |
==================================================================================================
                                            2 | true                                             |

taos> select (select count(*) from tb2), (select count(*) from tb2) > 0 from tb2 where (select count(*) from tb2) > 0 and f1 > (select count(*) from tb2) order by f1;
 (select count(*) from tb2) | (select count(*) from tb2) > 0 |
==============================================================
                          2 | true                           |

taos> select (select null from tb2), (select null from tb2) > 0 from tb2 where (select null from tb2) > 0 and f1 > (select null from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb2), (select * from tb2) > 0 from tb2 where (select * from tb2) > 0 and f1 > (select * from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb2), (select 2 from tb2) > 0 from tb2 where (select 2 from tb2) > 0 and f1 > (select 2 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb2), (select avg(f1) from tb2) > 0 from tb2 where (select avg(f1) from tb2) > 0 and f1 > (select avg(f1) from tb2) order by f1;
 (select avg(f1) from tb2) | (select avg(f1) from tb2) > 0 |
============================================================
                       2.5 | true                          |

taos> select (select last(*) from tb2), (select last(*) from tb2) > 0 from tb2 where (select last(*) from tb2) > 0 and f1 > (select last(*) from tb2) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb2 partition by f1), (select max(f1) from tb2 partition by f1) > 0 from tb2 where (select max(f1) from tb2 partition by f1) > 0 and f1 > (select max(f1) from tb2 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb2 a join tb2 b on a.ts = b.ts), (select a.ts from tb2 a join tb2 b on a.ts = b.ts) > 0 from tb2 where (select a.ts from tb2 a join tb2 b on a.ts = b.ts) > 0 and f1 > (select a.ts from tb2 a join tb2 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb2 interval(1d)), (select sum(f1) from tb2 interval(1d)) > 0 from tb2 where (select sum(f1) from tb2 interval(1d)) > 0 and f1 > (select sum(f1) from tb2 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union select f1 from tb2), (select f1 from tb2 union select f1 from tb2) > 0 from tb2 where (select f1 from tb2 union select f1 from tb2) > 0 and f1 > (select f1 from tb2 union select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb2 union all select f1 from tb2), (select f1 from tb2 union all select f1 from tb2) > 0 from tb2 where (select f1 from tb2 union all select f1 from tb2) > 0 and f1 > (select f1 from tb2 union all select f1 from tb2) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb3 order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from tb3 partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from tb3 interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb3 union select f1 from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tb3 union all select f1 from tb3);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) from tb3;
 (select f1 from tb3 order by ts, f1 limit 1) |
===============================================
                                            4 |
                                            4 |
                                            4 |

taos> select (select count(*) from tb3) from tb3;
 (select count(*) from tb3) |
=============================
                          3 |
                          3 |
                          3 |

taos> select (select null from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) from tb3;
 (select avg(f1) from tb3) |
============================
                         5 |
                         5 |
                         5 |

taos> select (select last(*) from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) a from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) a from tb3;
      a      |
==============
           4 |
           4 |
           4 |

taos> select (select count(*) from tb3) a from tb3;
           a           |
========================
                     3 |
                     3 |
                     3 |

taos> select (select null from tb3) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) a from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) a from tb3;
             a             |
============================
                         5 |
                         5 |
                         5 |

taos> select (select last(*) from tb3) a from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) a from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select 1) from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from tb3 order by ts, f1 limit 1) from tb3;
 (select f1 from tb3 order by ts, f1 limit 1) |
===============================================
                                            4 |

taos> select tags (select count(*) from tb3) from tb3;
 (select count(*) from tb3) |
=============================
                          3 |

taos> select tags (select null from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select * from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select avg(f1) from tb3) from tb3;
 (select avg(f1) from tb3) |
============================
                         5 |

taos> select tags (select last(*) from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from tb3 partition by f1) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select sum(f1) from tb3 interval(1d)) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from tb3 union select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from tb3 union all select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1) from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb3 order by ts, f1 limit 1) from tb3;
 (select f1 from tb3 order by ts, f1 limit 1) |
===============================================
                                            4 |

taos> select distinct (select count(*) from tb3) from tb3;
 (select count(*) from tb3) |
=============================
                          3 |

taos> select distinct (select null from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select * from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select avg(f1) from tb3) from tb3;
 (select avg(f1) from tb3) |
============================
                         5 |

taos> select distinct (select last(*) from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tb3 partition by f1) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select sum(f1) from tb3 interval(1d)) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb3 union select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb3 union all select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1), f1 from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tb3), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb3 order by ts, f1 limit 1), f1 from tb3;
 (select f1 from tb3 order by ts, f1 limit 1) |     f1      |
=============================================================
                                            4 |           6 |
                                            4 |           4 |
                                            4 |           5 |

taos> select distinct (select count(*) from tb3), f1 from tb3;
 (select count(*) from tb3) |     f1      |
===========================================
                          3 |           5 |
                          3 |           4 |
                          3 |           6 |

taos> select distinct (select null from tb3), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select * from tb3), f1 from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tb3), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select avg(f1) from tb3), f1 from tb3;
 (select avg(f1) from tb3) |     f1      |
==========================================
                         5 |           6 |
                         5 |           4 |
                         5 |           5 |

taos> select distinct (select last(*) from tb3), f1 from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tb3 partition by f1), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select a.ts from tb3 a join tb3 b on a.ts = b.ts), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select sum(f1) from tb3 interval(1d)), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb3 union select f1 from tb3), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from tb3 union all select f1 from tb3), f1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select 1) + 1 from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from tb3) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from tb3 order by ts, f1 limit 1) + 1 from tb3;
 (select f1 from tb3 order by ts, f1 limit 1) + 1 |
===================================================
                                                5 |

taos> select distinct tags (select count(*) from tb3) + 1 from tb3;
 (select count(*) from tb3) + 1 |
=================================
                              4 |

taos> select distinct tags (select null from tb3) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select * from tb3) + 1 from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from tb3) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select avg(f1) from tb3) + 1 from tb3;
 (select avg(f1) from tb3) + 1 |
================================
                             6 |

taos> select distinct tags (select last(*) from tb3) + 1 from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from tb3 partition by f1) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select sum(f1) from tb3 interval(1d)) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from tb3 union select f1 from tb3) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from tb3 union all select f1 from tb3) + 1 from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) from tb3;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3), (select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1), (select f1 from tb3 order by ts, f1 limit 1) from tb3;
 (select f1 from tb3 order by ts, f1 limit 1) | (select f1 from tb3 order by ts, f1 limit 1) |
==============================================================================================
                                            4 |                                            4 |
                                            4 |                                            4 |
                                            4 |                                            4 |

taos> select (select count(*) from tb3), (select count(*) from tb3) from tb3;
 (select count(*) from tb3) | (select count(*) from tb3) |
==========================================================
                          3 |                          3 |
                          3 |                          3 |
                          3 |                          3 |

taos> select (select null from tb3), (select null from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3), (select * from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3), (select 2 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3), (select avg(f1) from tb3) from tb3;
 (select avg(f1) from tb3) | (select avg(f1) from tb3) |
========================================================
                         5 |                         5 |
                         5 |                         5 |
                         5 |                         5 |

taos> select (select last(*) from tb3), (select last(*) from tb3) from tb3;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1), (select max(f1) from tb3 partition by f1) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts), (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)), (select sum(f1) from tb3 interval(1d)) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3), (select f1 from tb3 union select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3), (select f1 from tb3 union all select f1 from tb3) from tb3;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select 1) from tb3 order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from tb3) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from tb3 order by ts, f1 limit 1) from tb3 order by ts;
           1           | (select f1 from tb3 order by ts, f1 limit 1) |
=======================================================================
                     1 |                                            4 |
                     1 |                                            4 |
                     1 |                                            4 |

taos> select 1, (select count(*) from tb3) from tb3 order by ts;
           1           | (select count(*) from tb3) |
=====================================================
                     1 |                          3 |
                     1 |                          3 |
                     1 |                          3 |

taos> select 1, (select null from tb3) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select * from tb3) from tb3 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from tb3) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select avg(f1) from tb3) from tb3 order by ts;
           1           | (select avg(f1) from tb3) |
====================================================
                     1 |                         5 |
                     1 |                         5 |
                     1 |                         5 |

taos> select 1, (select last(*) from tb3) from tb3 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from tb3 partition by f1) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select sum(f1) from tb3 interval(1d)) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from tb3 union select f1 from tb3) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from tb3 union all select f1 from tb3) from tb3 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), * from tb3 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1), * from tb3 order by ts, f1;
 (select f1 from tb3 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |
=====================================================================================================
                                            4 | 2025-12-01 00:00:00.000 |           4 |          31 |
                                            4 | 2025-12-02 00:00:00.000 |           5 |          32 |
                                            4 | 2025-12-03 00:00:00.000 |           6 |          33 |

taos> select (select count(*) from tb3), * from tb3 order by ts, f1;
 (select count(*) from tb3) |           ts            |     f1      |     f2      |
===================================================================================
                          3 | 2025-12-01 00:00:00.000 |           4 |          31 |
                          3 | 2025-12-02 00:00:00.000 |           5 |          32 |
                          3 | 2025-12-03 00:00:00.000 |           6 |          33 |

taos> select (select null from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3), * from tb3 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3), * from tb3 order by ts, f1;
 (select avg(f1) from tb3) |           ts            |     f1      |     f2      |
==================================================================================
                         5 | 2025-12-01 00:00:00.000 |           4 |          31 |
                         5 | 2025-12-02 00:00:00.000 |           5 |          32 |
                         5 | 2025-12-03 00:00:00.000 |           6 |          33 |

taos> select (select last(*) from tb3), * from tb3 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) * (select 1), * from tb3 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) * (select f1 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) * (select f1 from tb3 order by ts, f1 limit 1), * from tb3 order by ts, f1;
 (select f1 from tb3 order by ts, f1 limit 1) * (select f1 from t |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                              16 | 2025-12-01 00:00:00.000 |           4 |          31 |
                                                              16 | 2025-12-02 00:00:00.000 |           5 |          32 |
                                                              16 | 2025-12-03 00:00:00.000 |           6 |          33 |

taos> select (select count(*) from tb3) * (select count(*) from tb3), * from tb3 order by ts, f1;
 (select count(*) from tb3) * (select count(*) from tb3) |           ts            |     f1      |     f2      |
================================================================================================================
                                                       9 | 2025-12-01 00:00:00.000 |           4 |          31 |
                                                       9 | 2025-12-02 00:00:00.000 |           5 |          32 |
                                                       9 | 2025-12-03 00:00:00.000 |           6 |          33 |

taos> select (select null from tb3) * (select null from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) * (select * from tb3), * from tb3 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) * (select 2 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) * (select avg(f1) from tb3), * from tb3 order by ts, f1;
 (select avg(f1) from tb3) * (select avg(f1) from tb3) |           ts            |     f1      |     f2      |
==============================================================================================================
                                                    25 | 2025-12-01 00:00:00.000 |           4 |          31 |
                                                    25 | 2025-12-02 00:00:00.000 |           5 |          32 |
                                                    25 | 2025-12-03 00:00:00.000 |           6 |          33 |

taos> select (select last(*) from tb3) * (select last(*) from tb3), * from tb3 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) * (select max(f1) from tb3 partition by f1), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) * (select a.ts from tb3 a join tb3 b on a.ts = b.ts), * from tb3 order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb3 interval(1d)) * (select sum(f1) from tb3 interval(1d)), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) * (select f1 from tb3 union select f1 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) * (select f1 from tb3 union all select f1 from tb3), * from tb3 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)) from tb3;

DB error: unrecognized token: "{funcname}((select 1)) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts, f1 limit 1)) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts, f1 limit 1)) from tb3;" [0x80002600] 
taos> select {funcName}((select count(*) from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select count(*) from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select null from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select null from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select * from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select * from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select 2 from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select 2 from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select last(*) from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select last(*) from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb3 partition by f1)) from tb3;

DB error: unrecognized token: "{funcname}((select max(f1) from tb3 partition by f1)) from tb3;" [0x80002600] 
taos> select {funcName}((select a.ts from tb3 a join tb3 b on a.ts = b.ts)) from tb3;

DB error: unrecognized token: "{funcname}((select a.ts from tb3 a join tb3 b on a.ts = b.ts)) from tb3;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb3 interval(1d))) from tb3;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb3 interval(1d))) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union select f1 from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 union select f1 from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union all select f1 from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 union all select f1 from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts, f1 limit 1) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts, f1 limit 1) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select count(*) from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select count(*) from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select null from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select null from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select * from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select * from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select 2 from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select 2 from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select last(*) from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select last(*) from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb3 partition by f1) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select max(f1) from tb3 partition by f1) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb3 interval(1d)) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb3 interval(1d)) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union select f1 from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 union select f1 from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union all select f1 from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 union all select f1 from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts, f1 limit 1) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts, f1 limit 1) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select count(*) from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select count(*) from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select null from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select null from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select * from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select * from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select 2 from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select 2 from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select last(*) from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select last(*) from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb3 partition by f1) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select max(f1) from tb3 partition by f1) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb3 interval(1d)) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb3 interval(1d)) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union select f1 from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 union select f1 from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union all select f1 from tb3) + 1) + 2 from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 union all select f1 from tb3) + 1) + 2 from tb3;" [0x80002600] 
taos> select (select 1) + (select 1) from tb3 partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) + (select f1 from tb3) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) + (select f1 from tb3 order by ts, f1 limit 1) from tb3 partition by tbname;
 (select f1 from tb3 order by ts, f1 limit 1) + (select f1 from t |
===================================================================
                                                               8 |
                                                               8 |
                                                               8 |

taos> select (select count(*) from tb3) + (select count(*) from tb3) from tb3 partition by tbname;
 (select count(*) from tb3) + (select count(*) from tb3) |
==========================================================
                                                       6 |
                                                       6 |
                                                       6 |

taos> select (select null from tb3) + (select null from tb3) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) + (select * from tb3) from tb3 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) + (select 2 from tb3) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) + (select avg(f1) from tb3) from tb3 partition by tbname;
 (select avg(f1) from tb3) + (select avg(f1) from tb3) |
========================================================
                                                    10 |
                                                    10 |
                                                    10 |

taos> select (select last(*) from tb3) + (select last(*) from tb3) from tb3 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) + (select max(f1) from tb3 partition by f1) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb3 interval(1d)) + (select sum(f1) from tb3 interval(1d)) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) + (select f1 from tb3 union select f1 from tb3) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) + (select f1 from tb3 union all select f1 from tb3) from tb3 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + f1 from tb3 partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) + f1 from tb3 partition by f1;
 (select f1 from tb3 order by ts, f1 limit 1) + f1 |
====================================================
                                                 9 |
                                                10 |
                                                 8 |

taos> select (select count(*) from tb3) + f1 from tb3 partition by f1;
 (select count(*) from tb3) + f1 |
==================================
                               8 |
                               9 |
                               7 |

taos> select (select null from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) + f1 from tb3 partition by f1;
 (select avg(f1) from tb3) + f1 |
=================================
                             10 |
                             11 |
                              9 |

taos> select (select last(*) from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) + f1 from tb3 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from tb3 order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;
 case when (select f1 from tb3 order by ts, f1 limit 1) > 0 then  |        sum(f1)        |
===========================================================================================
                                                                1 |                     6 |
                                                                1 |                     4 |
                                                                1 |                     5 |

taos> select case when (select count(*) from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;
 case when (select count(*) from tb3) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     6 |
                                                          1 |                     4 |
                                                          1 |                     5 |

taos> select case when (select null from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select * from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select avg(f1) from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;
 case when (select avg(f1) from tb3) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     6 |
                                                         1 |                     4 |
                                                         1 |                     5 |

taos> select case when (select last(*) from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from tb3 partition by f1) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select a.ts from tb3 a join tb3 b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select sum(f1) from tb3 interval(1d)) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from tb3 union select f1 from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from tb3 union all select f1 from tb3) > 0 then 1 else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tb3 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from tb3 order by ts, f1 limit 1) else 2 end, sum(f1) from tb3 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb3 order by ts, f1 li |        sum(f1)        |
===========================================================================================
 2                                                                |                     6 |
 2                                                                |                     4 |
 2                                                                |                     5 |

taos> select case when f1 = 1 then 2 / (select count(*) from tb3) else 2 end, sum(f1) from tb3 group by f1;
 case when f1 = 1 then 2 / (select count(*) from tb3) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     6 |
 2                                                               |                     4 |
 2                                                               |                     5 |

taos> select case when f1 = 1 then 2 / (select null from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select * from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select avg(f1) from tb3) else 2 end, sum(f1) from tb3 group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from tb3) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     6 |
 2                                                              |                     4 |
 2                                                              |                     5 |

taos> select case when f1 = 1 then 2 / (select last(*) from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tb3 partition by f1) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select a.ts from tb3 a join tb3 b on a.ts = b.ts) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select sum(f1) from tb3 interval(1d)) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from tb3 union select f1 from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from tb3 union all select f1 from tb3) else 2 end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tb3 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from tb3 order by ts, f1 limit 1) is null end, sum(f1) from tb3 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb3 order by ts, f1 |        sum(f1)        |
===========================================================================================
                                                                0 |                     6 |
                                                                0 |                     4 |
                                                                0 |                     5 |

taos> select case when f1 = 1 then 1 else (select count(*) from tb3) is null end, sum(f1) from tb3 group by f1;
 case when f1 = 1 then 1 else (select count(*) from tb3) is null  |        sum(f1)        |
===========================================================================================
                                                                0 |                     6 |
                                                                0 |                     4 |
                                                                0 |                     5 |

taos> select case when f1 = 1 then 1 else (select null from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select * from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select avg(f1) from tb3) is null end, sum(f1) from tb3 group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from tb3) is null e |        sum(f1)        |
===========================================================================================
                                                                0 |                     6 |
                                                                0 |                     4 |
                                                                0 |                     5 |

taos> select case when f1 = 1 then 1 else (select last(*) from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tb3 partition by f1) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select a.ts from tb3 a join tb3 b on a.ts = b.ts) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select sum(f1) from tb3 interval(1d)) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from tb3 union select f1 from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from tb3 union all select f1 from tb3) is null end, sum(f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tb3 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb3 order by ts, f1 limit 1), avg(f1) from tb3 interval(1d);
         _wstart         | (select f1 from tb3 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            4 |                         4 |
 2025-12-02 00:00:00.000 |                                            4 |                         5 |
 2025-12-03 00:00:00.000 |                                            4 |                         6 |

taos> select _wstart, (select count(*) from tb3), avg(f1) from tb3 interval(1d);
         _wstart         | (select count(*) from tb3) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          3 |                         4 |
 2025-12-02 00:00:00.000 |                          3 |                         5 |
 2025-12-03 00:00:00.000 |                          3 |                         6 |

taos> select _wstart, (select null from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select * from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select avg(f1) from tb3), avg(f1) from tb3 interval(1d);
         _wstart         | (select avg(f1) from tb3) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         5 |                         4 |
 2025-12-02 00:00:00.000 |                         5 |                         5 |
 2025-12-03 00:00:00.000 |                         5 |                         6 |

taos> select _wstart, (select last(*) from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tb3 partition by f1), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select a.ts from tb3 a join tb3 b on a.ts = b.ts), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select sum(f1) from tb3 interval(1d)), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb3 union select f1 from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb3 union all select f1 from tb3), avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tb3 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) + 1, avg(f1) from tb3 interval(1d);
 (select f1 from tb3 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                5 |                         4 |
                                                5 |                         5 |
                                                5 |                         6 |

taos> select (select count(*) from tb3) + 1, avg(f1) from tb3 interval(1d);
 (select count(*) from tb3) + 1 |          avg(f1)          |
=============================================================
                              4 |                         4 |
                              4 |                         5 |
                              4 |                         6 |

taos> select (select null from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) + 1, avg(f1) from tb3 interval(1d);
 (select avg(f1) from tb3) + 1 |          avg(f1)          |
============================================================
                             6 |                         4 |
                             6 |                         5 |
                             6 |                         6 |

taos> select (select last(*) from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts, f1 limit 1)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts, f1 limit 1)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb3 partition by f1)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb3 partition by f1)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb3 a join tb3 b on a.ts = b.ts)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb3 a join tb3 b on a.ts = b.ts)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb3 interval(1d))), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb3 interval(1d))), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union select f1 from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 union select f1 from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union all select f1 from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 union all select f1 from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts, f1 limit 1) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts, f1 limit 1) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb3 partition by f1) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb3 partition by f1) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb3 interval(1d)) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb3 interval(1d)) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 union select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 union all select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 union all select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from tb3 order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);
 case (select f1 from tb3 order by ts, f1 limit 1) when 1 then 1  |          avg(f1)          |
===============================================================================================
                                                                2 |                         4 |
                                                                2 |                         5 |
                                                                2 |                         6 |

taos> select case (select count(*) from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);
 case (select count(*) from tb3) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        2 |                         4 |
                                                        2 |                         5 |
                                                        2 |                         6 |

taos> select case (select null from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select * from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select avg(f1) from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);
 case (select avg(f1) from tb3) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       2 |                         4 |
                                                       2 |                         5 |
                                                       2 |                         6 |

taos> select case (select last(*) from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from tb3 partition by f1) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select a.ts from tb3 a join tb3 b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select sum(f1) from tb3 interval(1d)) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from tb3 union select f1 from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from tb3 union all select f1 from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb3 order by ts, f1 limit 1), avg(f1) from tb3 SESSION(ts, 1d);
         _wstart         | (select f1 from tb3 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            4 |                         5 |

taos> select _wstart, (select count(*) from tb3), avg(f1) from tb3 SESSION(ts, 1d);
         _wstart         | (select count(*) from tb3) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          3 |                         5 |

taos> select _wstart, (select null from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select * from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select avg(f1) from tb3), avg(f1) from tb3 SESSION(ts, 1d);
         _wstart         | (select avg(f1) from tb3) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         5 |                         5 |

taos> select _wstart, (select last(*) from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tb3 partition by f1), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select a.ts from tb3 a join tb3 b on a.ts = b.ts), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select sum(f1) from tb3 interval(1d)), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb3 union select f1 from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from tb3 union all select f1 from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) + 1, avg(f1) from tb3 SESSION(ts, 1d);
 (select f1 from tb3 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                5 |                         5 |

taos> select (select count(*) from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);
 (select count(*) from tb3) + 1 |          avg(f1)          |
=============================================================
                              4 |                         5 |

taos> select (select null from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);
 (select avg(f1) from tb3) + 1 |          avg(f1)          |
============================================================
                             6 |                         5 |

taos> select (select last(*) from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) > 0 from tb3 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tb3 interval(1d)) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb3 union select f1 from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb3 union all select f1 from tb3) > 0 from tb3 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from tb3 order by ts, f1 limit 1) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);
 sum(case when (select f1 from tb3 order by ts, f1 limit 1) > 0 t |
===================================================================
                                                                1 |
                                                                1 |
                                                                1 |

taos> select sum(case when (select count(*) from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);
 sum(case when (select count(*) from tb3) > 0 then 1 else 2 end) |
==================================================================
                                                               1 |
                                                               1 |
                                                               1 |

taos> select sum(case when (select null from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select * from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select avg(f1) from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);
 sum(case when (select avg(f1) from tb3) > 0 then 1 else 2 end) |
=================================================================
                                                              1 |
                                                              1 |
                                                              1 |

taos> select sum(case when (select last(*) from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from tb3 partition by f1) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select a.ts from tb3 a join tb3 b on a.ts = b.ts) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select sum(f1) from tb3 interval(1d)) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from tb3 union select f1 from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from tb3 union all select f1 from tb3) > 0 then 1 else 2 end) from tb3 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb3 order by ts, f1 limit 1) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select null from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select * from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tb3 partition by f1) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tb3 a join tb3 b on a.ts = b.ts) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tb3 interval(1d)) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb3 union select f1 from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb3 union all select f1 from tb3) as bigint) else 2 end) from tb3 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb3 order by ts, f1 limit 1) is null end + 1) from tb3 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb3 order by ts |
===================================================================
                                                               2 |
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select count(*) from tb3) is n |
===================================================================
                                                               2 |
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select null from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select * from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select avg(f1) from tb3) is nu |
===================================================================
                                                               2 |
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tb3 partition by f1) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select a.ts from tb3 a join tb3 b on a.ts = b.ts) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tb3 interval(1d)) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb3 union select f1 from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb3 union all select f1 from tb3) is null end + 1) from tb3 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select 1)) from tb3 partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from tb3 order by ts, f1 limit 1)) from tb3 partition by tbname interval(1d);
 sum((select f1 from tb3 order by ts, f1 limit 1)) |
====================================================
                                                 4 |
                                                 4 |
                                                 4 |

taos> select sum((select count(*) from tb3)) from tb3 partition by tbname interval(1d);
 sum((select count(*) from tb3)) |
==================================
                               3 |
                               3 |
                               3 |

taos> select sum((select null from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select * from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select avg(f1) from tb3)) from tb3 partition by tbname interval(1d);
 sum((select avg(f1) from tb3)) |
=================================
                              5 |
                              5 |
                              5 |

taos> select sum((select last(*) from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from tb3 partition by f1)) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select a.ts from tb3 a join tb3 b on a.ts = b.ts)) from tb3 partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tb3 interval(1d))) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from tb3 union select f1 from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from tb3 union all select f1 from tb3)) from tb3 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select 1) * -1)) from tb3 partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from tb3 order by ts, f1 limit 1) * -1)) from tb3 partition by f1 interval(1d);
 avg(abs((select f1 from tb3 order by ts, f1 limit 1) * -1)) |
==============================================================
                                                           4 |
                                                           4 |
                                                           4 |

taos> select avg(abs((select count(*) from tb3) * -1)) from tb3 partition by f1 interval(1d);
 avg(abs((select count(*) from tb3) * -1)) |
============================================
                                         3 |
                                         3 |
                                         3 |

taos> select avg(abs((select null from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select * from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select avg(f1) from tb3) * -1)) from tb3 partition by f1 interval(1d);
 avg(abs((select avg(f1) from tb3) * -1)) |
===========================================
                                        5 |
                                        5 |
                                        5 |

taos> select avg(abs((select last(*) from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from tb3 partition by f1) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select a.ts from tb3 a join tb3 b on a.ts = b.ts) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select sum(f1) from tb3 interval(1d)) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from tb3 union select f1 from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from tb3 union all select f1 from tb3) * -1)) from tb3 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb3 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb3) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 order by ts, f1 limit 1) from tb3 group by f1;
     f1      | (select f1 from tb3 order by ts, f1 limit 1) |
=============================================================
           6 |                                            4 |
           4 |                                            4 |
           5 |                                            4 |

taos> select f1, (select count(*) from tb3) from tb3 group by f1;
     f1      | (select count(*) from tb3) |
===========================================
           6 |                          3 |
           4 |                          3 |
           5 |                          3 |

taos> select f1, (select null from tb3) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb3) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb3) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb3) from tb3 group by f1;
     f1      | (select avg(f1) from tb3) |
==========================================
           6 |                         5 |
           4 |                         5 |
           5 |                         5 |

taos> select f1, (select last(*) from tb3) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb3 partition by f1) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb3 interval(1d)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union select f1 from tb3) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union all select f1 from tb3) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1), avg((select 1)) from tb3 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb3), avg((select f1 from tb3)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 order by ts, f1 limit 1), avg((select f1 from tb3 order by ts, f1 limit 1)) from tb3 group by f1;
     f1      | (select f1 from tb3 order by ts, f1 limit 1) | avg((select f1 from tb3 order by ts, f1 limit 1)) |
=================================================================================================================
           6 |                                            4 |                                                 4 |
           4 |                                            4 |                                                 4 |
           5 |                                            4 |                                                 4 |

taos> select f1, (select count(*) from tb3), avg((select count(*) from tb3)) from tb3 group by f1;
     f1      | (select count(*) from tb3) | avg((select count(*) from tb3)) |
=============================================================================
           6 |                          3 |                               3 |
           4 |                          3 |                               3 |
           5 |                          3 |                               3 |

taos> select f1, (select null from tb3), avg((select null from tb3)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb3), avg((select * from tb3)) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb3), avg((select 2 from tb3)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb3), avg((select avg(f1) from tb3)) from tb3 group by f1;
     f1      | (select avg(f1) from tb3) | avg((select avg(f1) from tb3)) |
===========================================================================
           6 |                         5 |                              5 |
           4 |                         5 |                              5 |
           5 |                         5 |                              5 |

taos> select f1, (select last(*) from tb3), avg((select last(*) from tb3)) from tb3 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb3 partition by f1), avg((select max(f1) from tb3 partition by f1)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts), avg((select a.ts from tb3 a join tb3 b on a.ts = b.ts)) from tb3 group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from tb3 interval(1d)), avg((select sum(f1) from tb3 interval(1d))) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union select f1 from tb3), avg((select f1 from tb3 union select f1 from tb3)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union all select f1 from tb3), avg((select f1 from tb3 union all select f1 from tb3)) from tb3 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select 1) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from tb3 order by ts, f1 limit 1) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3 order by ts, f1 limit 1) order by b.f1;
     f1      | (select f1 from tb3 order by ts, f1 limit 1) + 1 |
=================================================================
           4 |                                                5 |

taos> select b.f1, (select count(*) from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select count(*) from tb3) order by b.f1;

taos> select b.f1, (select null from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select null from tb3) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select * from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select * from tb3) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select 2 from tb3) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select avg(f1) from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select avg(f1) from tb3) order by b.f1;
     f1      | (select avg(f1) from tb3) + 1 |
==============================================
           5 |                             6 |

taos> select b.f1, (select last(*) from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select last(*) from tb3) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from tb3 partition by f1) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select max(f1) from tb3 partition by f1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select a.ts from tb3 a join tb3 b on a.ts = b.ts) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select sum(f1) from tb3 interval(1d)) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select sum(f1) from tb3 interval(1d)) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from tb3 union select f1 from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3 union select f1 from tb3) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from tb3 union all select f1 from tb3) + 1 from tb3 a join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3 union all select f1 from tb3) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg((select 1) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) + 1, avg((select f1 from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) + 1, avg((select f1 from tb3 order by ts, f1 limit 1) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3 order by ts, f1 limit 1);
 (select f1 from tb3 order by ts, f1 limit 1) + 1 | avg((select f1 from tb3 order by ts, f1 limit 1) + 2) |
===========================================================================================================
                                                5 |                                                     6 |

taos> select (select count(*) from tb3) + 1, avg((select count(*) from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select count(*) from tb3);
 (select count(*) from tb3) + 1 | avg((select count(*) from tb3) + 2) |
=======================================================================
                              4 |                                   5 |

taos> select (select null from tb3) + 1, avg((select null from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select null from tb3);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) + 1, avg((select * from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select * from tb3);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) + 1, avg((select 2 from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select 2 from tb3);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) + 1, avg((select avg(f1) from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select avg(f1) from tb3);
 (select avg(f1) from tb3) + 1 | avg((select avg(f1) from tb3) + 2) |
=====================================================================
                             6 |                                  7 |

taos> select (select last(*) from tb3) + 1, avg((select last(*) from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select last(*) from tb3);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) + 1, avg((select max(f1) from tb3 partition by f1) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select max(f1) from tb3 partition by f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1, avg((select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select a.ts from tb3 a join tb3 b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from tb3 interval(1d)) + 1, avg((select sum(f1) from tb3 interval(1d)) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select sum(f1) from tb3 interval(1d));

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) + 1, avg((select f1 from tb3 union select f1 from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3 union select f1 from tb3);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) + 1, avg((select f1 from tb3 union all select f1 from tb3) + 2) from tb3 a left join tb3 b on a.ts = b.ts and a.f1 = (select f1 from tb3 union all select f1 from tb3);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select 1), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select f1 from tb3) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from tb3 order by ts, f1 limit 1), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select f1 from tb3 order by ts, f1 limit 1) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select f1 from tb3 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |
===========================================================================================================================================================
 2025-12-01 00:00:00.000 |           4 |          31 |                                            4 | 2025-12-01 00:00:00.000 |           4 |          31 |
 2025-12-02 00:00:00.000 |           5 |          32 |                                            4 | NULL                    | NULL        | NULL        |
 2025-12-03 00:00:00.000 |           6 |          33 |                                            4 | NULL                    | NULL        | NULL        |

taos> select a.*, (select count(*) from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select count(*) from tb3) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select count(*) from tb3) |           ts            |     f1      |     f2      |
=========================================================================================================================================
 2025-12-01 00:00:00.000 |           4 |          31 |                          3 | NULL                    | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           5 |          32 |                          3 | NULL                    | NULL        | NULL        |
 2025-12-03 00:00:00.000 |           6 |          33 |                          3 | NULL                    | NULL        | NULL        |

taos> select a.*, (select null from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select null from tb3) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select * from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select * from tb3) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select 2 from tb3) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select avg(f1) from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select avg(f1) from tb3) order by a.ts, a.f1;
           ts            |     f1      |     f2      | (select avg(f1) from tb3) |           ts            |     f1      |     f2      |
========================================================================================================================================
 2025-12-01 00:00:00.000 |           4 |          31 |                         5 | NULL                    | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           5 |          32 |                         5 | 2025-12-02 00:00:00.000 |           5 |          32 |
 2025-12-03 00:00:00.000 |           6 |          33 |                         5 | NULL                    | NULL        | NULL        |

taos> select a.*, (select last(*) from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select last(*) from tb3) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from tb3 partition by f1), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select max(f1) from tb3 partition by f1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select a.ts from tb3 a join tb3 b on a.ts = b.ts), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select a.ts from tb3 a join tb3 b on a.ts = b.ts) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select sum(f1) from tb3 interval(1d)), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select sum(f1) from tb3 interval(1d)) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from tb3 union select f1 from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select f1 from tb3 union select f1 from tb3) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from tb3 union all select f1 from tb3), b.* from tb3 a left join tb3 b on a.ts = b.ts and b.f1 = (select f1 from tb3 union all select f1 from tb3) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from tb3 where f1 != (select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select f1 from tb3 order by ts, f1 limit 1) order by f1;
     f1      |
==============
           5 |
           6 |

taos> select f1 from tb3 where f1 != (select count(*) from tb3) order by f1;
     f1      |
==============
           4 |
           5 |
           6 |

taos> select f1 from tb3 where f1 != (select null from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select * from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tb3 where f1 != (select 2 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select avg(f1) from tb3) order by f1;
     f1      |
==============
           4 |
           6 |

taos> select f1 from tb3 where f1 != (select last(*) from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tb3 where f1 != (select max(f1) from tb3 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select a.ts from tb3 a join tb3 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select sum(f1) from tb3 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select f1 from tb3 union select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 != (select f1 from tb3 union all select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb3 where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb3) from tb3 where f1 = (select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 order by ts, f1 limit 1) from tb3 where f1 = (select f1 from tb3 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tb3 order by ts, f1 limit 1) |
=============================================================
           4 |                                            4 |

taos> select f1, (select count(*) from tb3) from tb3 where f1 = (select count(*) from tb3) order by f1;

taos> select f1, (select null from tb3) from tb3 where f1 = (select null from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb3) from tb3 where f1 = (select * from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb3) from tb3 where f1 = (select 2 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb3) from tb3 where f1 = (select avg(f1) from tb3) order by f1;
     f1      | (select avg(f1) from tb3) |
==========================================
           5 |                         5 |

taos> select f1, (select last(*) from tb3) from tb3 where f1 = (select last(*) from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb3 partition by f1) from tb3 where f1 = (select max(f1) from tb3 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 where f1 = (select a.ts from tb3 a join tb3 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb3 interval(1d)) from tb3 where f1 = (select sum(f1) from tb3 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union select f1 from tb3) from tb3 where f1 = (select f1 from tb3 union select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union all select f1 from tb3) from tb3 where f1 = (select f1 from tb3 union all select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tb3 where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select f1 from tb3));

DB error: syntax error near "(select f1 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select f1 from tb3 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tb3 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select count(*) from tb3));

DB error: syntax error near "(select count(*) from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select null from tb3));

DB error: syntax error near "(select null from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select * from tb3));

DB error: syntax error near "(select * from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select 2 from tb3));

DB error: syntax error near "(select 2 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select avg(f1) from tb3));

DB error: syntax error near "(select avg(f1) from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select last(*) from tb3));

DB error: syntax error near "(select last(*) from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select max(f1) from tb3 partition by f1));

DB error: syntax error near "(select max(f1) from tb3 partition by f1));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select a.ts from tb3 a join tb3 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tb3 a join tb3 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select sum(f1) from tb3 interval(1d)));

DB error: syntax error near "(select sum(f1) from tb3 interval(1d)));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select f1 from tb3 union select f1 from tb3));

DB error: syntax error near "(select f1 from tb3 union select f1 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 in ((select f1 from tb3 union all select f1 from tb3));

DB error: syntax error near "(select f1 from tb3 union all select f1 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select f1 from tb3));

DB error: syntax error near "(select f1 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select f1 from tb3 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tb3 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select count(*) from tb3));

DB error: syntax error near "(select count(*) from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select null from tb3));

DB error: syntax error near "(select null from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select * from tb3));

DB error: syntax error near "(select * from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select 2 from tb3));

DB error: syntax error near "(select 2 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select avg(f1) from tb3));

DB error: syntax error near "(select avg(f1) from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select last(*) from tb3));

DB error: syntax error near "(select last(*) from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select max(f1) from tb3 partition by f1));

DB error: syntax error near "(select max(f1) from tb3 partition by f1));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select a.ts from tb3 a join tb3 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tb3 a join tb3 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select sum(f1) from tb3 interval(1d)));

DB error: syntax error near "(select sum(f1) from tb3 interval(1d)));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select f1 from tb3 union select f1 from tb3));

DB error: syntax error near "(select f1 from tb3 union select f1 from tb3));" [0x80002600] 
taos> select f1 from tb3 where f1 not in ((select f1 from tb3 union all select f1 from tb3));

DB error: syntax error near "(select f1 from tb3 union all select f1 from tb3));" [0x80002600] 
taos> select (select 1) from tb3 where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) from tb3 where (select f1 from tb3) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) from tb3 where (select f1 from tb3 order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from tb3) from tb3 where (select count(*) from tb3) is null order by f1;

taos> select (select null from tb3) from tb3 where (select null from tb3) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) from tb3 where (select * from tb3) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) from tb3 where (select 2 from tb3) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) from tb3 where (select avg(f1) from tb3) is null order by f1;

taos> select (select last(*) from tb3) from tb3 where (select last(*) from tb3) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) from tb3 where (select max(f1) from tb3 partition by f1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 where (select a.ts from tb3 a join tb3 b on a.ts = b.ts) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) from tb3 where (select sum(f1) from tb3 interval(1d)) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) from tb3 where (select f1 from tb3 union select f1 from tb3) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) from tb3 where (select f1 from tb3 union all select f1 from tb3) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) from tb3 where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3) from tb3 where (select f1 from tb3) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1) from tb3 where (select f1 from tb3 order by ts, f1 limit 1) is not null order by f1;
 (select f1 from tb3 order by ts, f1 limit 1) |
===============================================
                                            4 |
                                            4 |
                                            4 |

taos> select (select count(*) from tb3) from tb3 where (select count(*) from tb3) is not null order by f1;
 (select count(*) from tb3) |
=============================
                          3 |
                          3 |
                          3 |

taos> select (select null from tb3) from tb3 where (select null from tb3) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3) from tb3 where (select * from tb3) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3) from tb3 where (select 2 from tb3) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3) from tb3 where (select avg(f1) from tb3) is not null order by f1;
 (select avg(f1) from tb3) |
============================
                         5 |
                         5 |
                         5 |

taos> select (select last(*) from tb3) from tb3 where (select last(*) from tb3) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1) from tb3 where (select max(f1) from tb3 partition by f1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 where (select a.ts from tb3 a join tb3 b on a.ts = b.ts) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)) from tb3 where (select sum(f1) from tb3 interval(1d)) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3) from tb3 where (select f1 from tb3 union select f1 from tb3) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3) from tb3 where (select f1 from tb3 union all select f1 from tb3) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select 1) as varchar) from tb3 where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from tb3) as varchar) from tb3 where abs((select f1 from tb3)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from tb3 order by ts, f1 limit 1) as varchar) from tb3 where abs((select f1 from tb3 order by ts, f1 limit 1)) > 0 order by f1;
     f1      | cast((select f1 from tb3 order by ts, f1 limit 1) as varchar) |
==============================================================================
           4 | 4                                                             |
           5 | 4                                                             |
           6 | 4                                                             |

taos> select f1, cast((select count(*) from tb3) as varchar) from tb3 where abs((select count(*) from tb3)) > 0 order by f1;
     f1      | cast((select count(*) from tb3) as varchar) |
============================================================
           4 | 3                                           |
           5 | 3                                           |
           6 | 3                                           |

taos> select f1, cast((select null from tb3) as varchar) from tb3 where abs((select null from tb3)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select * from tb3) as varchar) from tb3 where abs((select * from tb3)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from tb3) as varchar) from tb3 where abs((select 2 from tb3)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select avg(f1) from tb3) as varchar) from tb3 where abs((select avg(f1) from tb3)) > 0 order by f1;
     f1      | cast((select avg(f1) from tb3) as varchar) |
===========================================================
           4 | 5                                          |
           5 | 5                                          |
           6 | 5                                          |

taos> select f1, cast((select last(*) from tb3) as varchar) from tb3 where abs((select last(*) from tb3)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from tb3 partition by f1) as varchar) from tb3 where abs((select max(f1) from tb3 partition by f1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select a.ts from tb3 a join tb3 b on a.ts = b.ts) as varchar) from tb3 where abs((select a.ts from tb3 a join tb3 b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from tb3 interval(1d)) as varchar) from tb3 where abs((select sum(f1) from tb3 interval(1d))) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from tb3 union select f1 from tb3) as varchar) from tb3 where abs((select f1 from tb3 union select f1 from tb3)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from tb3 union all select f1 from tb3) as varchar) from tb3 where abs((select f1 from tb3 union all select f1 from tb3)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb3 where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb3) from tb3 where f1 > (select f1 from tb3) or f1 < (select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 order by ts, f1 limit 1) from tb3 where f1 > (select f1 from tb3 order by ts, f1 limit 1) or f1 < (select f1 from tb3 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tb3 order by ts, f1 limit 1) |
=============================================================
           5 |                                            4 |
           6 |                                            4 |

taos> select f1, (select count(*) from tb3) from tb3 where f1 > (select count(*) from tb3) or f1 < (select count(*) from tb3) order by f1;
     f1      | (select count(*) from tb3) |
===========================================
           4 |                          3 |
           5 |                          3 |
           6 |                          3 |

taos> select f1, (select null from tb3) from tb3 where f1 > (select null from tb3) or f1 < (select null from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb3) from tb3 where f1 > (select * from tb3) or f1 < (select * from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb3) from tb3 where f1 > (select 2 from tb3) or f1 < (select 2 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb3) from tb3 where f1 > (select avg(f1) from tb3) or f1 < (select avg(f1) from tb3) order by f1;
     f1      | (select avg(f1) from tb3) |
==========================================
           4 |                         5 |
           6 |                         5 |

taos> select f1, (select last(*) from tb3) from tb3 where f1 > (select last(*) from tb3) or f1 < (select last(*) from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb3 partition by f1) from tb3 where f1 > (select max(f1) from tb3 partition by f1) or f1 < (select max(f1) from tb3 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 where f1 > (select a.ts from tb3 a join tb3 b on a.ts = b.ts) or f1 < (select a.ts from tb3 a join tb3 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb3 interval(1d)) from tb3 where f1 > (select sum(f1) from tb3 interval(1d)) or f1 < (select sum(f1) from tb3 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union select f1 from tb3) from tb3 where f1 > (select f1 from tb3 union select f1 from tb3) or f1 < (select f1 from tb3 union select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union all select f1 from tb3) from tb3 where f1 > (select f1 from tb3 union all select f1 from tb3) or f1 < (select f1 from tb3 union all select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tb3 where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tb3) from tb3 where f1 between (select f1 from tb3) and (select f1 from tb3) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 order by ts, f1 limit 1) from tb3 where f1 between (select f1 from tb3 order by ts, f1 limit 1) and (select f1 from tb3 order by ts, f1 limit 1) + 1 order by f1;
     f1      | (select f1 from tb3 order by ts, f1 limit 1) |
=============================================================
           4 |                                            4 |
           5 |                                            4 |

taos> select f1, (select count(*) from tb3) from tb3 where f1 between (select count(*) from tb3) and (select count(*) from tb3) + 1 order by f1;
     f1      | (select count(*) from tb3) |
===========================================
           4 |                          3 |

taos> select f1, (select null from tb3) from tb3 where f1 between (select null from tb3) and (select null from tb3) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from tb3) from tb3 where f1 between (select * from tb3) and (select * from tb3) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tb3) from tb3 where f1 between (select 2 from tb3) and (select 2 from tb3) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from tb3) from tb3 where f1 between (select avg(f1) from tb3) and (select avg(f1) from tb3) + 1 order by f1;
     f1      | (select avg(f1) from tb3) |
==========================================
           5 |                         5 |
           6 |                         5 |

taos> select f1, (select last(*) from tb3) from tb3 where f1 between (select last(*) from tb3) and (select last(*) from tb3) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tb3 partition by f1) from tb3 where f1 between (select max(f1) from tb3 partition by f1) and (select max(f1) from tb3 partition by f1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from tb3 a join tb3 b on a.ts = b.ts) from tb3 where f1 between (select a.ts from tb3 a join tb3 b on a.ts = b.ts) and (select a.ts from tb3 a join tb3 b on a.ts = b.ts) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from tb3 interval(1d)) from tb3 where f1 between (select sum(f1) from tb3 interval(1d)) and (select sum(f1) from tb3 interval(1d)) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union select f1 from tb3) from tb3 where f1 between (select f1 from tb3 union select f1 from tb3) and (select f1 from tb3 union select f1 from tb3) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from tb3 union all select f1 from tb3) from tb3 where f1 between (select f1 from tb3 union all select f1 from tb3) and (select f1 from tb3 union all select f1 from tb3) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) > 0 from tb3 where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tb3), (select f1 from tb3) > 0 from tb3 where (select f1 from tb3) > 0 and f1 > (select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 order by ts, f1 limit 1), (select f1 from tb3 order by ts, f1 limit 1) > 0 from tb3 where (select f1 from tb3 order by ts, f1 limit 1) > 0 and f1 > (select f1 from tb3 order by ts, f1 limit 1) order by f1;
 (select f1 from tb3 order by ts, f1 limit 1) | (select f1 from tb3 order by ts, f1 limit 1) > 0 |
==================================================================================================
                                            4 | true                                             |
                                            4 | true                                             |

taos> select (select count(*) from tb3), (select count(*) from tb3) > 0 from tb3 where (select count(*) from tb3) > 0 and f1 > (select count(*) from tb3) order by f1;
 (select count(*) from tb3) | (select count(*) from tb3) > 0 |
==============================================================
                          3 | true                           |
                          3 | true                           |
                          3 | true                           |

taos> select (select null from tb3), (select null from tb3) > 0 from tb3 where (select null from tb3) > 0 and f1 > (select null from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from tb3), (select * from tb3) > 0 from tb3 where (select * from tb3) > 0 and f1 > (select * from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tb3), (select 2 from tb3) > 0 from tb3 where (select 2 from tb3) > 0 and f1 > (select 2 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from tb3), (select avg(f1) from tb3) > 0 from tb3 where (select avg(f1) from tb3) > 0 and f1 > (select avg(f1) from tb3) order by f1;
 (select avg(f1) from tb3) | (select avg(f1) from tb3) > 0 |
============================================================
                         5 | true                          |

taos> select (select last(*) from tb3), (select last(*) from tb3) > 0 from tb3 where (select last(*) from tb3) > 0 and f1 > (select last(*) from tb3) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tb3 partition by f1), (select max(f1) from tb3 partition by f1) > 0 from tb3 where (select max(f1) from tb3 partition by f1) > 0 and f1 > (select max(f1) from tb3 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from tb3 a join tb3 b on a.ts = b.ts), (select a.ts from tb3 a join tb3 b on a.ts = b.ts) > 0 from tb3 where (select a.ts from tb3 a join tb3 b on a.ts = b.ts) > 0 and f1 > (select a.ts from tb3 a join tb3 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from tb3 interval(1d)), (select sum(f1) from tb3 interval(1d)) > 0 from tb3 where (select sum(f1) from tb3 interval(1d)) > 0 and f1 > (select sum(f1) from tb3 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union select f1 from tb3), (select f1 from tb3 union select f1 from tb3) > 0 from tb3 where (select f1 from tb3 union select f1 from tb3) > 0 and f1 > (select f1 from tb3 union select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from tb3 union all select f1 from tb3), (select f1 from tb3 union all select f1 from tb3) > 0 from tb3 where (select f1 from tb3 union all select f1 from tb3) > 0 and f1 > (select f1 from tb3 union all select f1 from tb3) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tba order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from tba partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from tba a join tba b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from tba interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tba union select f1 from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tba union all select f1 from tba);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) from tba;
 (select f1 from tba) |
=======================
                    0 |

taos> select (select f1 from tba order by ts, f1 limit 1) from tba;
 (select f1 from tba order by ts, f1 limit 1) |
===============================================
                                            0 |

taos> select (select count(*) from tba) from tba;
 (select count(*) from tba) |
=============================
                          1 |

taos> select (select null from tba) from tba;
 (select null from tba) |
=========================
 NULL                   |

taos> select (select * from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) from tba;
  (select 2 from tba)  |
========================
                     2 |

taos> select (select avg(f1) from tba) from tba;
 (select avg(f1) from tba) |
============================
                         0 |

taos> select (select last(*) from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) from tba;
 (select max(f1) from tba partition by f1) |
============================================
                                         0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) from tba;
 (select a.ts from tba a join tba b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tba interval(1d)) from tba;
 (select sum(f1) from tba interval(1d)) |
=========================================
                                      0 |

taos> select (select f1 from tba union select f1 from tba) from tba;
 (select f1 from tba union select f1 from tba) |
================================================
                                             0 |

taos> select (select f1 from tba union all select f1 from tba) from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) a from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) a from tba;
      a      |
==============
           0 |

taos> select (select f1 from tba order by ts, f1 limit 1) a from tba;
      a      |
==============
           0 |

taos> select (select count(*) from tba) a from tba;
           a           |
========================
                     1 |

taos> select (select null from tba) a from tba;
 a  |
=====
 N. |

taos> select (select * from tba) a from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) a from tba;
           a           |
========================
                     2 |

taos> select (select avg(f1) from tba) a from tba;
             a             |
============================
                         0 |

taos> select (select last(*) from tba) a from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) a from tba;
      a      |
==============
           0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) a from tba;
            a            |
==========================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tba interval(1d)) a from tba;
           a           |
========================
                     0 |

taos> select (select f1 from tba union select f1 from tba) a from tba;
      a      |
==============
           0 |

taos> select (select f1 from tba union all select f1 from tba) a from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select 1) from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from tba) from tba;
 (select f1 from tba) |
=======================
                    0 |

taos> select tags (select f1 from tba order by ts, f1 limit 1) from tba;
 (select f1 from tba order by ts, f1 limit 1) |
===============================================
                                            0 |

taos> select tags (select count(*) from tba) from tba;
 (select count(*) from tba) |
=============================
                          1 |

taos> select tags (select null from tba) from tba;
 (select null from tba) |
=========================
 NULL                   |

taos> select tags (select * from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from tba) from tba;
  (select 2 from tba)  |
========================
                     2 |

taos> select tags (select avg(f1) from tba) from tba;
 (select avg(f1) from tba) |
============================
                         0 |

taos> select tags (select last(*) from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from tba partition by f1) from tba;
 (select max(f1) from tba partition by f1) |
============================================
                                         0 |

taos> select tags (select a.ts from tba a join tba b on a.ts = b.ts) from tba;
 (select a.ts from tba a join tba b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select tags (select sum(f1) from tba interval(1d)) from tba;
 (select sum(f1) from tba interval(1d)) |
=========================================
                                      0 |

taos> select tags (select f1 from tba union select f1 from tba) from tba;
 (select f1 from tba union select f1 from tba) |
================================================
                                             0 |

taos> select tags (select f1 from tba union all select f1 from tba) from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1) from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tba) from tba;
 (select f1 from tba) |
=======================
                    0 |

taos> select distinct (select f1 from tba order by ts, f1 limit 1) from tba;
 (select f1 from tba order by ts, f1 limit 1) |
===============================================
                                            0 |

taos> select distinct (select count(*) from tba) from tba;
 (select count(*) from tba) |
=============================
                          1 |

taos> select distinct (select null from tba) from tba;
 (select null from tba) |
=========================
 NULL                   |

taos> select distinct (select * from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tba) from tba;
  (select 2 from tba)  |
========================
                     2 |

taos> select distinct (select avg(f1) from tba) from tba;
 (select avg(f1) from tba) |
============================
                         0 |

taos> select distinct (select last(*) from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tba partition by f1) from tba;
 (select max(f1) from tba partition by f1) |
============================================
                                         0 |

taos> select distinct (select a.ts from tba a join tba b on a.ts = b.ts) from tba;
 (select a.ts from tba a join tba b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select distinct (select sum(f1) from tba interval(1d)) from tba;
 (select sum(f1) from tba interval(1d)) |
=========================================
                                      0 |

taos> select distinct (select f1 from tba union select f1 from tba) from tba;
 (select f1 from tba union select f1 from tba) |
================================================
                                             0 |

taos> select distinct (select f1 from tba union all select f1 from tba) from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1), f1 from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tba), f1 from tba;
 (select f1 from tba) |     f1      |
=====================================
                    0 |           0 |

taos> select distinct (select f1 from tba order by ts, f1 limit 1), f1 from tba;
 (select f1 from tba order by ts, f1 limit 1) |     f1      |
=============================================================
                                            0 |           0 |

taos> select distinct (select count(*) from tba), f1 from tba;
 (select count(*) from tba) |     f1      |
===========================================
                          1 |           0 |

taos> select distinct (select null from tba), f1 from tba;
 (select null from tba) |     f1      |
=======================================
 NULL                   |           0 |

taos> select distinct (select * from tba), f1 from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tba), f1 from tba;
  (select 2 from tba)  |     f1      |
======================================
                     2 |           0 |

taos> select distinct (select avg(f1) from tba), f1 from tba;
 (select avg(f1) from tba) |     f1      |
==========================================
                         0 |           0 |

taos> select distinct (select last(*) from tba), f1 from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tba partition by f1), f1 from tba;
 (select max(f1) from tba partition by f1) |     f1      |
==========================================================
                                         0 |           0 |

taos> select distinct (select a.ts from tba a join tba b on a.ts = b.ts), f1 from tba;
 (select a.ts from tba a join tba b on a.ts = b.ts) |     f1      |
===================================================================
 2025-12-01 00:00:00.000 |           0 |

taos> select distinct (select sum(f1) from tba interval(1d)), f1 from tba;
 (select sum(f1) from tba interval(1d)) |     f1      |
=======================================================
                                      0 |           0 |

taos> select distinct (select f1 from tba union select f1 from tba), f1 from tba;
 (select f1 from tba union select f1 from tba) |     f1      |
==============================================================
                                             0 |           0 |

taos> select distinct (select f1 from tba union all select f1 from tba), f1 from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select 1) + 1 from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from tba) + 1 from tba;
 (select f1 from tba) + 1  |
============================
                         1 |

taos> select distinct tags (select f1 from tba order by ts, f1 limit 1) + 1 from tba;
 (select f1 from tba order by ts, f1 limit 1) + 1 |
===================================================
                                                1 |

taos> select distinct tags (select count(*) from tba) + 1 from tba;
 (select count(*) from tba) + 1 |
=================================
                              2 |

taos> select distinct tags (select null from tba) + 1 from tba;
 (select null from tba) + 1 |
=============================
 NULL                       |

taos> select distinct tags (select * from tba) + 1 from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from tba) + 1 from tba;
  (select 2 from tba) + 1  |
============================
                         3 |

taos> select distinct tags (select avg(f1) from tba) + 1 from tba;
 (select avg(f1) from tba) + 1 |
================================
                             1 |

taos> select distinct tags (select last(*) from tba) + 1 from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from tba partition by f1) + 1 from tba;
 (select max(f1) from tba partition by f1) + 1 |
================================================
                                             1 |

taos> select distinct tags (select a.ts from tba a join tba b on a.ts = b.ts) + 1 from tba;
 (select a.ts from tba a join tba b on a.ts = b.ts) + 1 |
=========================================================
 2025-12-01 00:00:00.001 |

taos> select distinct tags (select sum(f1) from tba interval(1d)) + 1 from tba;
 (select sum(f1) from tba interval(1d)) + 1 |
=============================================
                                          1 |

taos> select distinct tags (select f1 from tba union select f1 from tba) + 1 from tba;
 (select f1 from tba union select f1 from tba) + 1 |
====================================================
                                                 1 |

taos> select distinct tags (select f1 from tba union all select f1 from tba) + 1 from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) from tba;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba), (select f1 from tba) from tba;
 (select f1 from tba) | (select f1 from tba) |
==============================================
                    0 |                    0 |

taos> select (select f1 from tba order by ts, f1 limit 1), (select f1 from tba order by ts, f1 limit 1) from tba;
 (select f1 from tba order by ts, f1 limit 1) | (select f1 from tba order by ts, f1 limit 1) |
==============================================================================================
                                            0 |                                            0 |

taos> select (select count(*) from tba), (select count(*) from tba) from tba;
 (select count(*) from tba) | (select count(*) from tba) |
==========================================================
                          1 |                          1 |

taos> select (select null from tba), (select null from tba) from tba;
 (select null from tba) | (select null from tba) |
==================================================
 NULL                   | NULL                   |

taos> select (select * from tba), (select * from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba), (select 2 from tba) from tba;
  (select 2 from tba)  |  (select 2 from tba)  |
================================================
                     2 |                     2 |

taos> select (select avg(f1) from tba), (select avg(f1) from tba) from tba;
 (select avg(f1) from tba) | (select avg(f1) from tba) |
========================================================
                         0 |                         0 |

taos> select (select last(*) from tba), (select last(*) from tba) from tba;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1), (select max(f1) from tba partition by f1) from tba;
 (select max(f1) from tba partition by f1) | (select max(f1) from tba partition by f1) |
========================================================================================
                                         0 |                                         0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts), (select a.ts from tba a join tba b on a.ts = b.ts) from tba;
 (select a.ts from tba a join tba b on a.ts = b.ts) | (select a.ts from tba a join tba b on a.ts = b.ts) |
==========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tba interval(1d)), (select sum(f1) from tba interval(1d)) from tba;
 (select sum(f1) from tba interval(1d)) | (select sum(f1) from tba interval(1d)) |
==================================================================================
                                      0 |                                      0 |

taos> select (select f1 from tba union select f1 from tba), (select f1 from tba union select f1 from tba) from tba;
 (select f1 from tba union select f1 from tba) | (select f1 from tba union select f1 from tba) |
================================================================================================
                                             0 |                                             0 |

taos> select (select f1 from tba union all select f1 from tba), (select f1 from tba union all select f1 from tba) from tba;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select 1) from tba order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from tba) from tba order by ts;
           1           | (select f1 from tba) |
===============================================
                     1 |                    0 |

taos> select 1, (select f1 from tba order by ts, f1 limit 1) from tba order by ts;
           1           | (select f1 from tba order by ts, f1 limit 1) |
=======================================================================
                     1 |                                            0 |

taos> select 1, (select count(*) from tba) from tba order by ts;
           1           | (select count(*) from tba) |
=====================================================
                     1 |                          1 |

taos> select 1, (select null from tba) from tba order by ts;
           1           | (select null from tba) |
=================================================
                     1 | NULL                   |

taos> select 1, (select * from tba) from tba order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from tba) from tba order by ts;
           1           |  (select 2 from tba)  |
================================================
                     1 |                     2 |

taos> select 1, (select avg(f1) from tba) from tba order by ts;
           1           | (select avg(f1) from tba) |
====================================================
                     1 |                         0 |

taos> select 1, (select last(*) from tba) from tba order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from tba partition by f1) from tba order by ts;
           1           | (select max(f1) from tba partition by f1) |
====================================================================
                     1 |                                         0 |

taos> select 1, (select a.ts from tba a join tba b on a.ts = b.ts) from tba order by ts;
           1           | (select a.ts from tba a join tba b on a.ts = b.ts) |
=============================================================================
                     1 | 2025-12-01 00:00:00.000 |

taos> select 1, (select sum(f1) from tba interval(1d)) from tba order by ts;
           1           | (select sum(f1) from tba interval(1d)) |
=================================================================
                     1 |                                      0 |

taos> select 1, (select f1 from tba union select f1 from tba) from tba order by ts;
           1           | (select f1 from tba union select f1 from tba) |
========================================================================
                     1 |                                             0 |

taos> select 1, (select f1 from tba union all select f1 from tba) from tba order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), * from tba order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba), * from tba order by ts, f1;
 (select f1 from tba) |           ts            |     f1      |
===============================================================
                    0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba order by ts, f1 limit 1), * from tba order by ts, f1;
 (select f1 from tba order by ts, f1 limit 1) |           ts            |     f1      |
=======================================================================================
                                            0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select count(*) from tba), * from tba order by ts, f1;
 (select count(*) from tba) |           ts            |     f1      |
=====================================================================
                          1 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select null from tba), * from tba order by ts, f1;
 (select null from tba) |           ts            |     f1      |
=================================================================
 NULL                   | 2025-12-01 00:00:00.000 |           0 |

taos> select (select * from tba), * from tba order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba), * from tba order by ts, f1;
  (select 2 from tba)  |           ts            |     f1      |
================================================================
                     2 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select avg(f1) from tba), * from tba order by ts, f1;
 (select avg(f1) from tba) |           ts            |     f1      |
====================================================================
                         0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select last(*) from tba), * from tba order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1), * from tba order by ts, f1;
 (select max(f1) from tba partition by f1) |           ts            |     f1      |
====================================================================================
                                         0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts), * from tba order by ts, f1;
 (select a.ts from tba a join tba b on a.ts = b.ts) |           ts            |     f1      |
=============================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select sum(f1) from tba interval(1d)), * from tba order by ts, f1;
 (select sum(f1) from tba interval(1d)) |           ts            |     f1      |
=================================================================================
                                      0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba union select f1 from tba), * from tba order by ts, f1;
 (select f1 from tba union select f1 from tba) |           ts            |     f1      |
========================================================================================
                                             0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba union all select f1 from tba), * from tba order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) * (select 1), * from tba order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) * (select f1 from tba), * from tba order by ts, f1;
 (select f1 from tba) * (select f1 from tba) |           ts            |     f1      |
======================================================================================
                                           0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba order by ts, f1 limit 1) * (select f1 from tba order by ts, f1 limit 1), * from tba order by ts, f1;
 (select f1 from tba order by ts, f1 limit 1) * (select f1 from t |           ts            |     f1      |
===========================================================================================================
                                                               0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select count(*) from tba) * (select count(*) from tba), * from tba order by ts, f1;
 (select count(*) from tba) * (select count(*) from tba) |           ts            |     f1      |
==================================================================================================
                                                       1 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select null from tba) * (select null from tba), * from tba order by ts, f1;
 (select null from tba) * (select null from tba) |           ts            |     f1      |
==========================================================================================
 NULL                                            | 2025-12-01 00:00:00.000 |           0 |

taos> select (select * from tba) * (select * from tba), * from tba order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) * (select 2 from tba), * from tba order by ts, f1;
 (select 2 from tba) * (select 2 from tba) |           ts            |     f1      |
====================================================================================
                                         4 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select avg(f1) from tba) * (select avg(f1) from tba), * from tba order by ts, f1;
 (select avg(f1) from tba) * (select avg(f1) from tba) |           ts            |     f1      |
================================================================================================
                                                     0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select last(*) from tba) * (select last(*) from tba), * from tba order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) * (select max(f1) from tba partition by f1), * from tba order by ts, f1;
 (select max(f1) from tba partition by f1) * (select max(f1) from |           ts            |     f1      |
===========================================================================================================
                                                               0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) * (select a.ts from tba a join tba b on a.ts = b.ts), * from tba order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tba interval(1d)) * (select sum(f1) from tba interval(1d)), * from tba order by ts, f1;
 (select sum(f1) from tba interval(1d)) * (select sum(f1) from tb |           ts            |     f1      |
===========================================================================================================
                                                               0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba union select f1 from tba) * (select f1 from tba union select f1 from tba), * from tba order by ts, f1;
 (select f1 from tba union select f1 from tba) * (select f1 from  |           ts            |     f1      |
===========================================================================================================
                                                               0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba union all select f1 from tba) * (select f1 from tba union all select f1 from tba), * from tba order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)) from tba;

DB error: unrecognized token: "{funcname}((select 1)) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba)) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts, f1 limit 1)) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts, f1 limit 1)) from tba;" [0x80002600] 
taos> select {funcName}((select count(*) from tba)) from tba;

DB error: unrecognized token: "{funcname}((select count(*) from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select null from tba)) from tba;

DB error: unrecognized token: "{funcname}((select null from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select * from tba)) from tba;

DB error: unrecognized token: "{funcname}((select * from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select 2 from tba)) from tba;

DB error: unrecognized token: "{funcname}((select 2 from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tba)) from tba;

DB error: unrecognized token: "{funcname}((select avg(f1) from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select last(*) from tba)) from tba;

DB error: unrecognized token: "{funcname}((select last(*) from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select max(f1) from tba partition by f1)) from tba;

DB error: unrecognized token: "{funcname}((select max(f1) from tba partition by f1)) from tba;" [0x80002600] 
taos> select {funcName}((select a.ts from tba a join tba b on a.ts = b.ts)) from tba;

DB error: unrecognized token: "{funcname}((select a.ts from tba a join tba b on a.ts = b.ts)) from tba;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tba interval(1d))) from tba;

DB error: unrecognized token: "{funcname}((select sum(f1) from tba interval(1d))) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba union select f1 from tba)) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba union select f1 from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba union all select f1 from tba)) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba union all select f1 from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tba;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts, f1 limit 1) + 1) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts, f1 limit 1) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select count(*) from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select count(*) from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select null from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select null from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select * from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select * from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select 2 from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select 2 from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select avg(f1) from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select last(*) from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select last(*) from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select max(f1) from tba partition by f1) + 1) from tba;

DB error: unrecognized token: "{funcname}((select max(f1) from tba partition by f1) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select a.ts from tba a join tba b on a.ts = b.ts) + 1) from tba;

DB error: unrecognized token: "{funcname}((select a.ts from tba a join tba b on a.ts = b.ts) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tba interval(1d)) + 1) from tba;

DB error: unrecognized token: "{funcname}((select sum(f1) from tba interval(1d)) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba union select f1 from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba union select f1 from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba union all select f1 from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba union all select f1 from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts, f1 limit 1) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts, f1 limit 1) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select count(*) from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select count(*) from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select null from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select null from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select * from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select * from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select 2 from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select 2 from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select avg(f1) from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select last(*) from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select last(*) from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select max(f1) from tba partition by f1) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select max(f1) from tba partition by f1) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select a.ts from tba a join tba b on a.ts = b.ts) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select a.ts from tba a join tba b on a.ts = b.ts) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tba interval(1d)) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select sum(f1) from tba interval(1d)) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba union select f1 from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba union select f1 from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba union all select f1 from tba) + 1) + 2 from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba union all select f1 from tba) + 1) + 2 from tba;" [0x80002600] 
taos> select (select 1) + (select 1) from tba partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) + (select f1 from tba) from tba partition by tbname;
 (select f1 from tba) + (select f1 from tba) |
==============================================
                                           0 |

taos> select (select f1 from tba order by ts, f1 limit 1) + (select f1 from tba order by ts, f1 limit 1) from tba partition by tbname;
 (select f1 from tba order by ts, f1 limit 1) + (select f1 from t |
===================================================================
                                                               0 |

taos> select (select count(*) from tba) + (select count(*) from tba) from tba partition by tbname;
 (select count(*) from tba) + (select count(*) from tba) |
==========================================================
                                                       2 |

taos> select (select null from tba) + (select null from tba) from tba partition by tbname;
 (select null from tba) + (select null from tba) |
==================================================
 NULL                                            |

taos> select (select * from tba) + (select * from tba) from tba partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) + (select 2 from tba) from tba partition by tbname;
 (select 2 from tba) + (select 2 from tba) |
============================================
                                         4 |

taos> select (select avg(f1) from tba) + (select avg(f1) from tba) from tba partition by tbname;
 (select avg(f1) from tba) + (select avg(f1) from tba) |
========================================================
                                                     0 |

taos> select (select last(*) from tba) + (select last(*) from tba) from tba partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) + (select max(f1) from tba partition by f1) from tba partition by tbname;
 (select max(f1) from tba partition by f1) + (select max(f1) from |
===================================================================
                                                               0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) + (select a.ts from tba a join tba b on a.ts = b.ts) from tba partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tba interval(1d)) + (select sum(f1) from tba interval(1d)) from tba partition by tbname;
 (select sum(f1) from tba interval(1d)) + (select sum(f1) from tb |
===================================================================
                                                               0 |

taos> select (select f1 from tba union select f1 from tba) + (select f1 from tba union select f1 from tba) from tba partition by tbname;
 (select f1 from tba union select f1 from tba) + (select f1 from  |
===================================================================
                                                               0 |

taos> select (select f1 from tba union all select f1 from tba) + (select f1 from tba union all select f1 from tba) from tba partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + f1 from tba partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) + f1 from tba partition by f1;
 (select f1 from tba) + f1 |
============================
                         0 |

taos> select (select f1 from tba order by ts, f1 limit 1) + f1 from tba partition by f1;
 (select f1 from tba order by ts, f1 limit 1) + f1 |
====================================================
                                                 0 |

taos> select (select count(*) from tba) + f1 from tba partition by f1;
 (select count(*) from tba) + f1 |
==================================
                               1 |

taos> select (select null from tba) + f1 from tba partition by f1;
 (select null from tba) + f1 |
==============================
 NULL                        |

taos> select (select * from tba) + f1 from tba partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) + f1 from tba partition by f1;
 (select 2 from tba) + f1  |
============================
                         2 |

taos> select (select avg(f1) from tba) + f1 from tba partition by f1;
 (select avg(f1) from tba) + f1 |
=================================
                              0 |

taos> select (select last(*) from tba) + f1 from tba partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) + f1 from tba partition by f1;
 (select max(f1) from tba partition by f1) + f1 |
=================================================
                                              0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) + f1 from tba partition by f1;
 (select a.ts from tba a join tba b on a.ts = b.ts) + f1 |
==========================================================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tba interval(1d)) + f1 from tba partition by f1;
 (select sum(f1) from tba interval(1d)) + f1 |
==============================================
                                           0 |

taos> select (select f1 from tba union select f1 from tba) + f1 from tba partition by f1;
 (select f1 from tba union select f1 from tba) + f1 |
=====================================================
                                                  0 |

taos> select (select f1 from tba union all select f1 from tba) + f1 from tba partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tba group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select f1 from tba) > 0 then 1 else 2 end |        sum(f1)        |
===============================================================================
                                                    2 |                     0 |

taos> select case when (select f1 from tba order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select f1 from tba order by ts, f1 limit 1) > 0 then  |        sum(f1)        |
===========================================================================================
                                                                2 |                     0 |

taos> select case when (select count(*) from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select count(*) from tba) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     0 |

taos> select case when (select null from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select null from tba) > 0 then 1 else 2 end |        sum(f1)        |
=================================================================================
                                                      2 |                     0 |

taos> select case when (select * from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select 2 from tba) > 0 then 1 else 2 end |        sum(f1)        |
==============================================================================
                                                   1 |                     0 |

taos> select case when (select avg(f1) from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select avg(f1) from tba) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         2 |                     0 |

taos> select case when (select last(*) from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from tba partition by f1) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select max(f1) from tba partition by f1) > 0 then 1 e |        sum(f1)        |
===========================================================================================
                                                                2 |                     0 |

taos> select case when (select a.ts from tba a join tba b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select a.ts from tba a join tba b on a.ts = b.ts) > 0 |        sum(f1)        |
===========================================================================================
                                                                1 |                     0 |

taos> select case when (select sum(f1) from tba interval(1d)) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select sum(f1) from tba interval(1d)) > 0 then 1 else |        sum(f1)        |
===========================================================================================
                                                                2 |                     0 |

taos> select case when (select f1 from tba union select f1 from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;
 case when (select f1 from tba union select f1 from tba) > 0 then |        sum(f1)        |
===========================================================================================
                                                                2 |                     0 |

taos> select case when (select f1 from tba union all select f1 from tba) > 0 then 1 else 2 end, sum(f1) from tba group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tba group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from tba) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select f1 from tba) else 2 end |        sum(f1)        |
====================================================================================
 2                                                         |                     0 |

taos> select case when f1 = 1 then 2 / (select f1 from tba order by ts, f1 limit 1) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select f1 from tba order by ts, f1 li |        sum(f1)        |
===========================================================================================
 2                                                                |                     0 |

taos> select case when f1 = 1 then 2 / (select count(*) from tba) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select count(*) from tba) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     0 |

taos> select case when f1 = 1 then 2 / (select null from tba) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select null from tba) else 2 end |        sum(f1)        |
======================================================================================
 2                                                           |                     0 |

taos> select case when f1 = 1 then 2 / (select * from tba) else 2 end, sum(f1) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from tba) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select 2 from tba) else 2 end |        sum(f1)        |
===================================================================================
 2                                                        |                     0 |

taos> select case when f1 = 1 then 2 / (select avg(f1) from tba) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from tba) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     0 |

taos> select case when f1 = 1 then 2 / (select last(*) from tba) else 2 end, sum(f1) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tba partition by f1) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select max(f1) from tba partition by  |        sum(f1)        |
===========================================================================================
 2                                                                |                     0 |

taos> select case when f1 = 1 then 2 / (select a.ts from tba a join tba b on a.ts = b.ts) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select a.ts from tba a join tba b on  |        sum(f1)        |
===========================================================================================
 2                                                                |                     0 |

taos> select case when f1 = 1 then 2 / (select sum(f1) from tba interval(1d)) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select sum(f1) from tba interval(1d)) |        sum(f1)        |
===========================================================================================
 2                                                                |                     0 |

taos> select case when f1 = 1 then 2 / (select f1 from tba union select f1 from tba) else 2 end, sum(f1) from tba group by f1;
 case when f1 = 1 then 2 / (select f1 from tba union select f1 fr |        sum(f1)        |
===========================================================================================
 2                                                                |                     0 |

taos> select case when f1 = 1 then 2 / (select f1 from tba union all select f1 from tba) else 2 end, sum(f1) from tba group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tba group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from tba) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select f1 from tba) is null end |        sum(f1)        |
========================================================================================
                                                             0 |                     0 |

taos> select case when f1 = 1 then 1 else (select f1 from tba order by ts, f1 limit 1) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select f1 from tba order by ts, f1 |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select count(*) from tba) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select count(*) from tba) is null  |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select null from tba) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select null from tba) is null end |        sum(f1)        |
==========================================================================================
                                                               1 |                     0 |

taos> select case when f1 = 1 then 1 else (select * from tba) is null end, sum(f1) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from tba) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select 2 from tba) is null end |        sum(f1)        |
=======================================================================================
                                                            0 |                     0 |

taos> select case when f1 = 1 then 1 else (select avg(f1) from tba) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from tba) is null e |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select last(*) from tba) is null end, sum(f1) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tba partition by f1) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select max(f1) from tba partition  |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select a.ts from tba a join tba b on a.ts = b.ts) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select a.ts from tba a join tba b  |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select sum(f1) from tba interval(1d)) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select sum(f1) from tba interval(1 |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select f1 from tba union select f1 from tba) is null end, sum(f1) from tba group by f1;
 case when f1 = 1 then 1 else (select f1 from tba union select f1 |        sum(f1)        |
===========================================================================================
                                                                0 |                     0 |

taos> select case when f1 = 1 then 1 else (select f1 from tba union all select f1 from tba) is null end, sum(f1) from tba group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tba interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tba), avg(f1) from tba interval(1d);
         _wstart         | (select f1 from tba) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    0 |                         0 |

taos> select _wstart, (select f1 from tba order by ts, f1 limit 1), avg(f1) from tba interval(1d);
         _wstart         | (select f1 from tba order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            0 |                         0 |

taos> select _wstart, (select count(*) from tba), avg(f1) from tba interval(1d);
         _wstart         | (select count(*) from tba) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         0 |

taos> select _wstart, (select null from tba), avg(f1) from tba interval(1d);
         _wstart         | (select null from tba) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         0 |

taos> select _wstart, (select * from tba), avg(f1) from tba interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tba), avg(f1) from tba interval(1d);
         _wstart         |  (select 2 from tba)  |          avg(f1)          |
==============================================================================
 2025-12-01 00:00:00.000 |                     2 |                         0 |

taos> select _wstart, (select avg(f1) from tba), avg(f1) from tba interval(1d);
         _wstart         | (select avg(f1) from tba) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         0 |                         0 |

taos> select _wstart, (select last(*) from tba), avg(f1) from tba interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tba partition by f1), avg(f1) from tba interval(1d);
         _wstart         | (select max(f1) from tba partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-01 00:00:00.000 |                                         0 |                         0 |

taos> select _wstart, (select a.ts from tba a join tba b on a.ts = b.ts), avg(f1) from tba interval(1d);
         _wstart         | (select a.ts from tba a join tba b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |                         0 |

taos> select _wstart, (select sum(f1) from tba interval(1d)), avg(f1) from tba interval(1d);
         _wstart         | (select sum(f1) from tba interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 |                                      0 |                         0 |

taos> select _wstart, (select f1 from tba union select f1 from tba), avg(f1) from tba interval(1d);
         _wstart         | (select f1 from tba union select f1 from tba) |          avg(f1)          |
======================================================================================================
 2025-12-01 00:00:00.000 |                                             0 |                         0 |

taos> select _wstart, (select f1 from tba union all select f1 from tba), avg(f1) from tba interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tba interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) + 1, avg(f1) from tba interval(1d);
 (select f1 from tba) + 1  |          avg(f1)          |
========================================================
                         1 |                         0 |

taos> select (select f1 from tba order by ts, f1 limit 1) + 1, avg(f1) from tba interval(1d);
 (select f1 from tba order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                1 |                         0 |

taos> select (select count(*) from tba) + 1, avg(f1) from tba interval(1d);
 (select count(*) from tba) + 1 |          avg(f1)          |
=============================================================
                              2 |                         0 |

taos> select (select null from tba) + 1, avg(f1) from tba interval(1d);
 (select null from tba) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         0 |

taos> select (select * from tba) + 1, avg(f1) from tba interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) + 1, avg(f1) from tba interval(1d);
  (select 2 from tba) + 1  |          avg(f1)          |
========================================================
                         3 |                         0 |

taos> select (select avg(f1) from tba) + 1, avg(f1) from tba interval(1d);
 (select avg(f1) from tba) + 1 |          avg(f1)          |
============================================================
                             1 |                         0 |

taos> select (select last(*) from tba) + 1, avg(f1) from tba interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) + 1, avg(f1) from tba interval(1d);
 (select max(f1) from tba partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             1 |                         0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) + 1, avg(f1) from tba interval(1d);
 (select a.ts from tba a join tba b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.001 |                         0 |

taos> select (select sum(f1) from tba interval(1d)) + 1, avg(f1) from tba interval(1d);
 (select sum(f1) from tba interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          1 |                         0 |

taos> select (select f1 from tba union select f1 from tba) + 1, avg(f1) from tba interval(1d);
 (select f1 from tba union select f1 from tba) + 1 |          avg(f1)          |
================================================================================
                                                 1 |                         0 |

taos> select (select f1 from tba union all select f1 from tba) + 1, avg(f1) from tba interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts, f1 limit 1)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts, f1 limit 1)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select null from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select * from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tba partition by f1)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tba partition by f1)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tba a join tba b on a.ts = b.ts)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tba a join tba b on a.ts = b.ts)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tba interval(1d))), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tba interval(1d))), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba union select f1 from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba union select f1 from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba union all select f1 from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba union all select f1 from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts, f1 limit 1) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts, f1 limit 1) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select null from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select * from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tba partition by f1) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tba partition by f1) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tba a join tba b on a.ts = b.ts) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tba a join tba b on a.ts = b.ts) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tba interval(1d)) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tba interval(1d)) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba union select f1 from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba union select f1 from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba union all select f1 from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba union all select f1 from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select f1 from tba) when 1 then 1 else 2 end |          avg(f1)          |
=================================================================================
                                                  2 |                         0 |

taos> select case (select f1 from tba order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select f1 from tba order by ts, f1 limit 1) when 1 then 1  |          avg(f1)          |
===============================================================================================
                                                                2 |                         0 |

taos> select case (select count(*) from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select count(*) from tba) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        1 |                         0 |

taos> select case (select null from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select null from tba) when 1 then 1 else 2 end |          avg(f1)          |
===================================================================================
                                                    2 |                         0 |

taos> select case (select * from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select 2 from tba) when 1 then 1 else 2 end |          avg(f1)          |
================================================================================
                                                 2 |                         0 |

taos> select case (select avg(f1) from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select avg(f1) from tba) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       2 |                         0 |

taos> select case (select last(*) from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from tba partition by f1) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select max(f1) from tba partition by f1) when 1 then 1 els |          avg(f1)          |
===============================================================================================
                                                                2 |                         0 |

taos> select case (select a.ts from tba a join tba b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select a.ts from tba a join tba b on a.ts = b.ts) when 1 t |          avg(f1)          |
===============================================================================================
                                                                2 |                         0 |

taos> select case (select sum(f1) from tba interval(1d)) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select sum(f1) from tba interval(1d)) when 1 then 1 else 2 |          avg(f1)          |
===============================================================================================
                                                                2 |                         0 |

taos> select case (select f1 from tba union select f1 from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select f1 from tba union select f1 from tba) when 1 then 1 |          avg(f1)          |
===============================================================================================
                                                                2 |                         0 |

taos> select case (select f1 from tba union all select f1 from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tba SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select f1 from tba) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    0 |                         0 |

taos> select _wstart, (select f1 from tba order by ts, f1 limit 1), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select f1 from tba order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            0 |                         0 |

taos> select _wstart, (select count(*) from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select count(*) from tba) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         0 |

taos> select _wstart, (select null from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select null from tba) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         0 |

taos> select _wstart, (select * from tba), avg(f1) from tba SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         |  (select 2 from tba)  |          avg(f1)          |
==============================================================================
 2025-12-01 00:00:00.000 |                     2 |                         0 |

taos> select _wstart, (select avg(f1) from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select avg(f1) from tba) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         0 |                         0 |

taos> select _wstart, (select last(*) from tba), avg(f1) from tba SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tba partition by f1), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select max(f1) from tba partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-01 00:00:00.000 |                                         0 |                         0 |

taos> select _wstart, (select a.ts from tba a join tba b on a.ts = b.ts), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select a.ts from tba a join tba b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |                         0 |

taos> select _wstart, (select sum(f1) from tba interval(1d)), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select sum(f1) from tba interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 |                                      0 |                         0 |

taos> select _wstart, (select f1 from tba union select f1 from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select f1 from tba union select f1 from tba) |          avg(f1)          |
======================================================================================================
 2025-12-01 00:00:00.000 |                                             0 |                         0 |

taos> select _wstart, (select f1 from tba union all select f1 from tba), avg(f1) from tba SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tba SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select f1 from tba) + 1  |          avg(f1)          |
========================================================
                         1 |                         0 |

taos> select (select f1 from tba order by ts, f1 limit 1) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select f1 from tba order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                1 |                         0 |

taos> select (select count(*) from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select count(*) from tba) + 1 |          avg(f1)          |
=============================================================
                              2 |                         0 |

taos> select (select null from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select null from tba) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         0 |

taos> select (select * from tba) + 1, avg(f1) from tba SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
  (select 2 from tba) + 1  |          avg(f1)          |
========================================================
                         3 |                         0 |

taos> select (select avg(f1) from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select avg(f1) from tba) + 1 |          avg(f1)          |
============================================================
                             1 |                         0 |

taos> select (select last(*) from tba) + 1, avg(f1) from tba SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select max(f1) from tba partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             1 |                         0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select a.ts from tba a join tba b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.001 |                         0 |

taos> select (select sum(f1) from tba interval(1d)) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select sum(f1) from tba interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          1 |                         0 |

taos> select (select f1 from tba union select f1 from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select f1 from tba union select f1 from tba) + 1 |          avg(f1)          |
================================================================================
                                                 1 |                         0 |

taos> select (select f1 from tba union all select f1 from tba) + 1, avg(f1) from tba SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) > 0 from tba SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tba order by ts, f1 limit 1) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tba) > 0 from tba SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tba) > 0 from tba SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tba a join tba b on a.ts = b.ts) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tba interval(1d)) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tba union select f1 from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tba union all select f1 from tba) > 0 from tba SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select f1 from tba) > 0 then 1 else 2 end) |
============================================================
                                                         2 |

taos> select sum(case when (select f1 from tba order by ts, f1 limit 1) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select f1 from tba order by ts, f1 limit 1) > 0 t |
===================================================================
                                                                2 |

taos> select sum(case when (select count(*) from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select count(*) from tba) > 0 then 1 else 2 end) |
==================================================================
                                                               1 |

taos> select sum(case when (select null from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select null from tba) > 0 then 1 else 2 end) |
==============================================================
                                                           2 |

taos> select sum(case when (select * from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select 2 from tba) > 0 then 1 else 2 end) |
===========================================================
                                                        1 |

taos> select sum(case when (select avg(f1) from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select avg(f1) from tba) > 0 then 1 else 2 end) |
=================================================================
                                                              2 |

taos> select sum(case when (select last(*) from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from tba partition by f1) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select max(f1) from tba partition by f1) > 0 then |
===================================================================
                                                                2 |

taos> select sum(case when (select a.ts from tba a join tba b on a.ts = b.ts) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select a.ts from tba a join tba b on a.ts = b.ts) |
===================================================================
                                                                1 |

taos> select sum(case when (select sum(f1) from tba interval(1d)) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select sum(f1) from tba interval(1d)) > 0 then 1  |
===================================================================
                                                                2 |

taos> select sum(case when (select f1 from tba union select f1 from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);
 sum(case when (select f1 from tba union select f1 from tba) > 0  |
===================================================================
                                                                2 |

taos> select sum(case when (select f1 from tba union all select f1 from tba) > 0 then 1 else 2 end) from tba STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tba order by ts, f1 limit 1) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select null from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select * from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tba partition by f1) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tba a join tba b on a.ts = b.ts) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tba interval(1d)) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tba union select f1 from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tba union all select f1 from tba) as bigint) else 2 end) from tba EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tba COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tba) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tba) is null en |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tba order by ts, f1 limit 1) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tba order by ts |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tba) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select count(*) from tba) is n |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select null from tba) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select null from tba) is null  |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select * from tba) is null end + 1) from tba COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tba) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select 2 from tba) is null end |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tba) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select avg(f1) from tba) is nu |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tba) is null end + 1) from tba COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tba partition by f1) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select max(f1) from tba partit |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select a.ts from tba a join tba b on a.ts = b.ts) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select a.ts from tba a join tb |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tba interval(1d)) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select sum(f1) from tba interv |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tba union select f1 from tba) is null end + 1) from tba COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tba union selec |
===================================================================
                                                               1 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tba union all select f1 from tba) is null end + 1) from tba COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select 1)) from tba partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from tba)) from tba partition by tbname interval(1d);
 sum((select f1 from tba)) |
============================
                         0 |

taos> select sum((select f1 from tba order by ts, f1 limit 1)) from tba partition by tbname interval(1d);
 sum((select f1 from tba order by ts, f1 limit 1)) |
====================================================
                                                 0 |

taos> select sum((select count(*) from tba)) from tba partition by tbname interval(1d);
 sum((select count(*) from tba)) |
==================================
                               1 |

taos> select sum((select null from tba)) from tba partition by tbname interval(1d);
 sum((select null from tba)) |
==============================
 NULL                        |

taos> select sum((select * from tba)) from tba partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from tba)) from tba partition by tbname interval(1d);
 sum((select 2 from tba)) |
===========================
                        2 |

taos> select sum((select avg(f1) from tba)) from tba partition by tbname interval(1d);
 sum((select avg(f1) from tba)) |
=================================
                              0 |

taos> select sum((select last(*) from tba)) from tba partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from tba partition by f1)) from tba partition by tbname interval(1d);
 sum((select max(f1) from tba partition by f1)) |
=================================================
                                              0 |

taos> select sum((select a.ts from tba a join tba b on a.ts = b.ts)) from tba partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tba interval(1d))) from tba partition by tbname interval(1d);
 sum((select sum(f1) from tba interval(1d))) |
==============================================
                                           0 |

taos> select sum((select f1 from tba union select f1 from tba)) from tba partition by tbname interval(1d);
 sum((select f1 from tba union select f1 from tba)) |
=====================================================
                                                  0 |

taos> select sum((select f1 from tba union all select f1 from tba)) from tba partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select 1) * -1)) from tba partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from tba) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select f1 from tba) * -1)) |
======================================
                                   0 |

taos> select avg(abs((select f1 from tba order by ts, f1 limit 1) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select f1 from tba order by ts, f1 limit 1) * -1)) |
==============================================================
                                                           0 |

taos> select avg(abs((select count(*) from tba) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select count(*) from tba) * -1)) |
============================================
                                         1 |

taos> select avg(abs((select null from tba) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select null from tba) * -1)) |
========================================
 NULL                                  |

taos> select avg(abs((select * from tba) * -1)) from tba partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from tba) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select 2 from tba) * -1)) |
=====================================
                                  2 |

taos> select avg(abs((select avg(f1) from tba) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select avg(f1) from tba) * -1)) |
===========================================
                                        0 |

taos> select avg(abs((select last(*) from tba) * -1)) from tba partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from tba partition by f1) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select max(f1) from tba partition by f1) * -1)) |
===========================================================
                                                        0 |

taos> select avg(abs((select a.ts from tba a join tba b on a.ts = b.ts) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select a.ts from tba a join tba b on a.ts = b.ts) * -1) |
===================================================================
                                                   1764518400000 |

taos> select avg(abs((select sum(f1) from tba interval(1d)) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select sum(f1) from tba interval(1d)) * -1)) |
========================================================
                                                     0 |

taos> select avg(abs((select f1 from tba union select f1 from tba) * -1)) from tba partition by f1 interval(1d);
 avg(abs((select f1 from tba union select f1 from tba) * -1)) |
===============================================================
                                                            0 |

taos> select avg(abs((select f1 from tba union all select f1 from tba) * -1)) from tba partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tba group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tba) from tba group by f1;
     f1      | (select f1 from tba) |
=====================================
           0 |                    0 |

taos> select f1, (select f1 from tba order by ts, f1 limit 1) from tba group by f1;
     f1      | (select f1 from tba order by ts, f1 limit 1) |
=============================================================
           0 |                                            0 |

taos> select f1, (select count(*) from tba) from tba group by f1;
     f1      | (select count(*) from tba) |
===========================================
           0 |                          1 |

taos> select f1, (select null from tba) from tba group by f1;
     f1      | (select null from tba) |
=======================================
           0 | NULL                   |

taos> select f1, (select * from tba) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tba) from tba group by f1;
     f1      |  (select 2 from tba)  |
======================================
           0 |                     2 |

taos> select f1, (select avg(f1) from tba) from tba group by f1;
     f1      | (select avg(f1) from tba) |
==========================================
           0 |                         0 |

taos> select f1, (select last(*) from tba) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tba partition by f1) from tba group by f1;
     f1      | (select max(f1) from tba partition by f1) |
==========================================================
           0 |                                         0 |

taos> select f1, (select a.ts from tba a join tba b on a.ts = b.ts) from tba group by f1;
     f1      | (select a.ts from tba a join tba b on a.ts = b.ts) |
===================================================================
           0 | 2025-12-01 00:00:00.000 |

taos> select f1, (select sum(f1) from tba interval(1d)) from tba group by f1;
     f1      | (select sum(f1) from tba interval(1d)) |
=======================================================
           0 |                                      0 |

taos> select f1, (select f1 from tba union select f1 from tba) from tba group by f1;
     f1      | (select f1 from tba union select f1 from tba) |
==============================================================
           0 |                                             0 |

taos> select f1, (select f1 from tba union all select f1 from tba) from tba group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1), avg((select 1)) from tba group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tba), avg((select f1 from tba)) from tba group by f1;
     f1      | (select f1 from tba) | avg((select f1 from tba)) |
=================================================================
           0 |                    0 |                         0 |

taos> select f1, (select f1 from tba order by ts, f1 limit 1), avg((select f1 from tba order by ts, f1 limit 1)) from tba group by f1;
     f1      | (select f1 from tba order by ts, f1 limit 1) | avg((select f1 from tba order by ts, f1 limit 1)) |
=================================================================================================================
           0 |                                            0 |                                                 0 |

taos> select f1, (select count(*) from tba), avg((select count(*) from tba)) from tba group by f1;
     f1      | (select count(*) from tba) | avg((select count(*) from tba)) |
=============================================================================
           0 |                          1 |                               1 |

taos> select f1, (select null from tba), avg((select null from tba)) from tba group by f1;
     f1      | (select null from tba) | avg((select null from tba)) |
=====================================================================
           0 | NULL                   | NULL                        |

taos> select f1, (select * from tba), avg((select * from tba)) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tba), avg((select 2 from tba)) from tba group by f1;
     f1      |  (select 2 from tba)  | avg((select 2 from tba))  |
==================================================================
           0 |                     2 |                         2 |

taos> select f1, (select avg(f1) from tba), avg((select avg(f1) from tba)) from tba group by f1;
     f1      | (select avg(f1) from tba) | avg((select avg(f1) from tba)) |
===========================================================================
           0 |                         0 |                              0 |

taos> select f1, (select last(*) from tba), avg((select last(*) from tba)) from tba group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tba partition by f1), avg((select max(f1) from tba partition by f1)) from tba group by f1;
     f1      | (select max(f1) from tba partition by f1) | avg((select max(f1) from tba partition by f1)) |
===========================================================================================================
           0 |                                         0 |                                              0 |

taos> select f1, (select a.ts from tba a join tba b on a.ts = b.ts), avg((select a.ts from tba a join tba b on a.ts = b.ts)) from tba group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from tba interval(1d)), avg((select sum(f1) from tba interval(1d))) from tba group by f1;
     f1      | (select sum(f1) from tba interval(1d)) | avg((select sum(f1) from tba interval(1d))) |
=====================================================================================================
           0 |                                      0 |                                           0 |

taos> select f1, (select f1 from tba union select f1 from tba), avg((select f1 from tba union select f1 from tba)) from tba group by f1;
     f1      | (select f1 from tba union select f1 from tba) | avg((select f1 from tba union select f1 from tba)) |
===================================================================================================================
           0 |                                             0 |                                                  0 |

taos> select f1, (select f1 from tba union all select f1 from tba), avg((select f1 from tba union all select f1 from tba)) from tba group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select 1) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select f1 from tba) order by b.f1;
     f1      | (select f1 from tba) + 1  |
==========================================
           0 |                         1 |

taos> select b.f1, (select f1 from tba order by ts, f1 limit 1) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select f1 from tba order by ts, f1 limit 1) order by b.f1;
     f1      | (select f1 from tba order by ts, f1 limit 1) + 1 |
=================================================================
           0 |                                                1 |

taos> select b.f1, (select count(*) from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select count(*) from tba) order by b.f1;

taos> select b.f1, (select null from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select null from tba) order by b.f1;

taos> select b.f1, (select * from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select * from tba) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select 2 from tba) order by b.f1;

taos> select b.f1, (select avg(f1) from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select avg(f1) from tba) order by b.f1;
     f1      | (select avg(f1) from tba) + 1 |
==============================================
           0 |                             1 |

taos> select b.f1, (select last(*) from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select last(*) from tba) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from tba partition by f1) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select max(f1) from tba partition by f1) order by b.f1;
     f1      | (select max(f1) from tba partition by f1) + 1 |
==============================================================
           0 |                                             1 |

taos> select b.f1, (select a.ts from tba a join tba b on a.ts = b.ts) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select a.ts from tba a join tba b on a.ts = b.ts) order by b.f1;

taos> select b.f1, (select sum(f1) from tba interval(1d)) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select sum(f1) from tba interval(1d)) order by b.f1;
     f1      | (select sum(f1) from tba interval(1d)) + 1 |
===========================================================
           0 |                                          1 |

taos> select b.f1, (select f1 from tba union select f1 from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select f1 from tba union select f1 from tba) order by b.f1;
     f1      | (select f1 from tba union select f1 from tba) + 1 |
==================================================================
           0 |                                                 1 |

taos> select b.f1, (select f1 from tba union all select f1 from tba) + 1 from tba a join tba b on a.ts = b.ts and a.f1 = (select f1 from tba union all select f1 from tba) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg((select 1) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) + 1, avg((select f1 from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select f1 from tba);
 (select f1 from tba) + 1  | avg((select f1 from tba) + 2) |
============================================================
                         1 |                             2 |

taos> select (select f1 from tba order by ts, f1 limit 1) + 1, avg((select f1 from tba order by ts, f1 limit 1) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select f1 from tba order by ts, f1 limit 1);
 (select f1 from tba order by ts, f1 limit 1) + 1 | avg((select f1 from tba order by ts, f1 limit 1) + 2) |
===========================================================================================================
                                                1 |                                                     2 |

taos> select (select count(*) from tba) + 1, avg((select count(*) from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select count(*) from tba);
 (select count(*) from tba) + 1 | avg((select count(*) from tba) + 2) |
=======================================================================
                              2 |                                   3 |

taos> select (select null from tba) + 1, avg((select null from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select null from tba);
 (select null from tba) + 1 | avg((select null from tba) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select (select * from tba) + 1, avg((select * from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select * from tba);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) + 1, avg((select 2 from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select 2 from tba);
  (select 2 from tba) + 1  | avg((select 2 from tba) + 2) |
===========================================================
                         3 |                            4 |

taos> select (select avg(f1) from tba) + 1, avg((select avg(f1) from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select avg(f1) from tba);
 (select avg(f1) from tba) + 1 | avg((select avg(f1) from tba) + 2) |
=====================================================================
                             1 |                                  2 |

taos> select (select last(*) from tba) + 1, avg((select last(*) from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select last(*) from tba);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) + 1, avg((select max(f1) from tba partition by f1) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select max(f1) from tba partition by f1);
 (select max(f1) from tba partition by f1) + 1 | avg((select max(f1) from tba partition by f1) + 2) |
=====================================================================================================
                                             1 |                                                  2 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) + 1, avg((select a.ts from tba a join tba b on a.ts = b.ts) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select a.ts from tba a join tba b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from tba interval(1d)) + 1, avg((select sum(f1) from tba interval(1d)) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select sum(f1) from tba interval(1d));
 (select sum(f1) from tba interval(1d)) + 1 | avg((select sum(f1) from tba interval(1d)) + 2) |
===============================================================================================
                                          1 |                                               2 |

taos> select (select f1 from tba union select f1 from tba) + 1, avg((select f1 from tba union select f1 from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select f1 from tba union select f1 from tba);
 (select f1 from tba union select f1 from tba) + 1 | avg((select f1 from tba union select f1 from tba) + 2) |
=============================================================================================================
                                                 1 |                                                      2 |

taos> select (select f1 from tba union all select f1 from tba) + 1, avg((select f1 from tba union all select f1 from tba) + 2) from tba a left join tba b on a.ts = b.ts and a.f1 = (select f1 from tba union all select f1 from tba);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select 1), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select f1 from tba) order by a.ts, a.f1;
           ts            |     f1      | (select f1 from tba) |           ts            |     f1      |
=======================================================================================================
 2025-12-01 00:00:00.000 |           0 |                    0 | 2025-12-01 00:00:00.000 |           0 |

taos> select a.*, (select f1 from tba order by ts, f1 limit 1), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select f1 from tba order by ts, f1 limit 1) order by a.ts, a.f1;
           ts            |     f1      | (select f1 from tba order by ts, f1 limit 1) |           ts            |     f1      |
===============================================================================================================================
 2025-12-01 00:00:00.000 |           0 |                                            0 | 2025-12-01 00:00:00.000 |           0 |

taos> select a.*, (select count(*) from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select count(*) from tba) order by a.ts, a.f1;
           ts            |     f1      | (select count(*) from tba) |           ts            |     f1      |
=============================================================================================================
 2025-12-01 00:00:00.000 |           0 |                          1 | NULL                    | NULL        |

taos> select a.*, (select null from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select null from tba) order by a.ts, a.f1;
           ts            |     f1      | (select null from tba) |           ts            |     f1      |
=========================================================================================================
 2025-12-01 00:00:00.000 |           0 | NULL                   | NULL                    | NULL        |

taos> select a.*, (select * from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select * from tba) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select 2 from tba) order by a.ts, a.f1;
           ts            |     f1      |  (select 2 from tba)  |           ts            |     f1      |
========================================================================================================
 2025-12-01 00:00:00.000 |           0 |                     2 | NULL                    | NULL        |

taos> select a.*, (select avg(f1) from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select avg(f1) from tba) order by a.ts, a.f1;
           ts            |     f1      | (select avg(f1) from tba) |           ts            |     f1      |
============================================================================================================
 2025-12-01 00:00:00.000 |           0 |                         0 | 2025-12-01 00:00:00.000 |           0 |

taos> select a.*, (select last(*) from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select last(*) from tba) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from tba partition by f1), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select max(f1) from tba partition by f1) order by a.ts, a.f1;
           ts            |     f1      | (select max(f1) from tba partition by f1) |           ts            |     f1      |
============================================================================================================================
 2025-12-01 00:00:00.000 |           0 |                                         0 | 2025-12-01 00:00:00.000 |           0 |

taos> select a.*, (select a.ts from tba a join tba b on a.ts = b.ts), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select a.ts from tba a join tba b on a.ts = b.ts) order by a.ts, a.f1;
           ts            |     f1      | (select a.ts from tba a join tba b on a.ts = b.ts) |           ts            |     f1      |
=====================================================================================================================================
 2025-12-01 00:00:00.000 |           0 | 2025-12-01 00:00:00.000 | NULL                    | NULL        |

taos> select a.*, (select sum(f1) from tba interval(1d)), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select sum(f1) from tba interval(1d)) order by a.ts, a.f1;
           ts            |     f1      | (select sum(f1) from tba interval(1d)) |           ts            |     f1      |
=========================================================================================================================
 2025-12-01 00:00:00.000 |           0 |                                      0 | 2025-12-01 00:00:00.000 |           0 |

taos> select a.*, (select f1 from tba union select f1 from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select f1 from tba union select f1 from tba) order by a.ts, a.f1;
           ts            |     f1      | (select f1 from tba union select f1 from tba) |           ts            |     f1      |
================================================================================================================================
 2025-12-01 00:00:00.000 |           0 |                                             0 | 2025-12-01 00:00:00.000 |           0 |

taos> select a.*, (select f1 from tba union all select f1 from tba), b.* from tba a left join tba b on a.ts = b.ts and b.f1 = (select f1 from tba union all select f1 from tba) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tba where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from tba where f1 != (select f1 from tba) order by f1;

taos> select f1 from tba where f1 != (select f1 from tba order by ts, f1 limit 1) order by f1;

taos> select f1 from tba where f1 != (select count(*) from tba) order by f1;
     f1      |
==============
           0 |

taos> select f1 from tba where f1 != (select null from tba) order by f1;

taos> select f1 from tba where f1 != (select * from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tba where f1 != (select 2 from tba) order by f1;
     f1      |
==============
           0 |

taos> select f1 from tba where f1 != (select avg(f1) from tba) order by f1;

taos> select f1 from tba where f1 != (select last(*) from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tba where f1 != (select max(f1) from tba partition by f1) order by f1;

taos> select f1 from tba where f1 != (select a.ts from tba a join tba b on a.ts = b.ts) order by f1;
     f1      |
==============
           0 |

taos> select f1 from tba where f1 != (select sum(f1) from tba interval(1d)) order by f1;

taos> select f1 from tba where f1 != (select f1 from tba union select f1 from tba) order by f1;

taos> select f1 from tba where f1 != (select f1 from tba union all select f1 from tba) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tba where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tba) from tba where f1 = (select f1 from tba) order by f1;
     f1      | (select f1 from tba) |
=====================================
           0 |                    0 |

taos> select f1, (select f1 from tba order by ts, f1 limit 1) from tba where f1 = (select f1 from tba order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tba order by ts, f1 limit 1) |
=============================================================
           0 |                                            0 |

taos> select f1, (select count(*) from tba) from tba where f1 = (select count(*) from tba) order by f1;

taos> select f1, (select null from tba) from tba where f1 = (select null from tba) order by f1;

taos> select f1, (select * from tba) from tba where f1 = (select * from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tba) from tba where f1 = (select 2 from tba) order by f1;

taos> select f1, (select avg(f1) from tba) from tba where f1 = (select avg(f1) from tba) order by f1;
     f1      | (select avg(f1) from tba) |
==========================================
           0 |                         0 |

taos> select f1, (select last(*) from tba) from tba where f1 = (select last(*) from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tba partition by f1) from tba where f1 = (select max(f1) from tba partition by f1) order by f1;
     f1      | (select max(f1) from tba partition by f1) |
==========================================================
           0 |                                         0 |

taos> select f1, (select a.ts from tba a join tba b on a.ts = b.ts) from tba where f1 = (select a.ts from tba a join tba b on a.ts = b.ts) order by f1;

taos> select f1, (select sum(f1) from tba interval(1d)) from tba where f1 = (select sum(f1) from tba interval(1d)) order by f1;
     f1      | (select sum(f1) from tba interval(1d)) |
=======================================================
           0 |                                      0 |

taos> select f1, (select f1 from tba union select f1 from tba) from tba where f1 = (select f1 from tba union select f1 from tba) order by f1;
     f1      | (select f1 from tba union select f1 from tba) |
==============================================================
           0 |                                             0 |

taos> select f1, (select f1 from tba union all select f1 from tba) from tba where f1 = (select f1 from tba union all select f1 from tba) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tba where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tba where f1 in ((select f1 from tba));

DB error: syntax error near "(select f1 from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select f1 from tba order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tba order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tba where f1 in ((select count(*) from tba));

DB error: syntax error near "(select count(*) from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select null from tba));

DB error: syntax error near "(select null from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select * from tba));

DB error: syntax error near "(select * from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select 2 from tba));

DB error: syntax error near "(select 2 from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select avg(f1) from tba));

DB error: syntax error near "(select avg(f1) from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select last(*) from tba));

DB error: syntax error near "(select last(*) from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select max(f1) from tba partition by f1));

DB error: syntax error near "(select max(f1) from tba partition by f1));" [0x80002600] 
taos> select f1 from tba where f1 in ((select a.ts from tba a join tba b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tba a join tba b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tba where f1 in ((select sum(f1) from tba interval(1d)));

DB error: syntax error near "(select sum(f1) from tba interval(1d)));" [0x80002600] 
taos> select f1 from tba where f1 in ((select f1 from tba union select f1 from tba));

DB error: syntax error near "(select f1 from tba union select f1 from tba));" [0x80002600] 
taos> select f1 from tba where f1 in ((select f1 from tba union all select f1 from tba));

DB error: syntax error near "(select f1 from tba union all select f1 from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select f1 from tba));

DB error: syntax error near "(select f1 from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select f1 from tba order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tba order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select count(*) from tba));

DB error: syntax error near "(select count(*) from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select null from tba));

DB error: syntax error near "(select null from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select * from tba));

DB error: syntax error near "(select * from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select 2 from tba));

DB error: syntax error near "(select 2 from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select avg(f1) from tba));

DB error: syntax error near "(select avg(f1) from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select last(*) from tba));

DB error: syntax error near "(select last(*) from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select max(f1) from tba partition by f1));

DB error: syntax error near "(select max(f1) from tba partition by f1));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select a.ts from tba a join tba b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tba a join tba b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select sum(f1) from tba interval(1d)));

DB error: syntax error near "(select sum(f1) from tba interval(1d)));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select f1 from tba union select f1 from tba));

DB error: syntax error near "(select f1 from tba union select f1 from tba));" [0x80002600] 
taos> select f1 from tba where f1 not in ((select f1 from tba union all select f1 from tba));

DB error: syntax error near "(select f1 from tba union all select f1 from tba));" [0x80002600] 
taos> select (select 1) from tba where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) from tba where (select f1 from tba) is null order by f1;

taos> select (select f1 from tba order by ts, f1 limit 1) from tba where (select f1 from tba order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from tba) from tba where (select count(*) from tba) is null order by f1;

taos> select (select null from tba) from tba where (select null from tba) is null order by f1;
 (select null from tba) |
=========================
 NULL                   |

taos> select (select * from tba) from tba where (select * from tba) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) from tba where (select 2 from tba) is null order by f1;

taos> select (select avg(f1) from tba) from tba where (select avg(f1) from tba) is null order by f1;

taos> select (select last(*) from tba) from tba where (select last(*) from tba) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) from tba where (select max(f1) from tba partition by f1) is null order by f1;

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) from tba where (select a.ts from tba a join tba b on a.ts = b.ts) is null order by f1;

taos> select (select sum(f1) from tba interval(1d)) from tba where (select sum(f1) from tba interval(1d)) is null order by f1;

taos> select (select f1 from tba union select f1 from tba) from tba where (select f1 from tba union select f1 from tba) is null order by f1;

taos> select (select f1 from tba union all select f1 from tba) from tba where (select f1 from tba union all select f1 from tba) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) from tba where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba) from tba where (select f1 from tba) is not null order by f1;
 (select f1 from tba) |
=======================
                    0 |

taos> select (select f1 from tba order by ts, f1 limit 1) from tba where (select f1 from tba order by ts, f1 limit 1) is not null order by f1;
 (select f1 from tba order by ts, f1 limit 1) |
===============================================
                                            0 |

taos> select (select count(*) from tba) from tba where (select count(*) from tba) is not null order by f1;
 (select count(*) from tba) |
=============================
                          1 |

taos> select (select null from tba) from tba where (select null from tba) is not null order by f1;

taos> select (select * from tba) from tba where (select * from tba) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba) from tba where (select 2 from tba) is not null order by f1;
  (select 2 from tba)  |
========================
                     2 |

taos> select (select avg(f1) from tba) from tba where (select avg(f1) from tba) is not null order by f1;
 (select avg(f1) from tba) |
============================
                         0 |

taos> select (select last(*) from tba) from tba where (select last(*) from tba) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1) from tba where (select max(f1) from tba partition by f1) is not null order by f1;
 (select max(f1) from tba partition by f1) |
============================================
                                         0 |

taos> select (select a.ts from tba a join tba b on a.ts = b.ts) from tba where (select a.ts from tba a join tba b on a.ts = b.ts) is not null order by f1;
 (select a.ts from tba a join tba b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tba interval(1d)) from tba where (select sum(f1) from tba interval(1d)) is not null order by f1;
 (select sum(f1) from tba interval(1d)) |
=========================================
                                      0 |

taos> select (select f1 from tba union select f1 from tba) from tba where (select f1 from tba union select f1 from tba) is not null order by f1;
 (select f1 from tba union select f1 from tba) |
================================================
                                             0 |

taos> select (select f1 from tba union all select f1 from tba) from tba where (select f1 from tba union all select f1 from tba) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select 1) as varchar) from tba where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from tba) as varchar) from tba where abs((select f1 from tba)) > 0 order by f1;

taos> select f1, cast((select f1 from tba order by ts, f1 limit 1) as varchar) from tba where abs((select f1 from tba order by ts, f1 limit 1)) > 0 order by f1;

taos> select f1, cast((select count(*) from tba) as varchar) from tba where abs((select count(*) from tba)) > 0 order by f1;
     f1      | cast((select count(*) from tba) as varchar) |
============================================================
           0 | 1                                           |

taos> select f1, cast((select null from tba) as varchar) from tba where abs((select null from tba)) > 0 order by f1;

taos> select f1, cast((select * from tba) as varchar) from tba where abs((select * from tba)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from tba) as varchar) from tba where abs((select 2 from tba)) > 0 order by f1;
     f1      | cast((select 2 from tba) as varchar) |
=====================================================
           0 | 2                                    |

taos> select f1, cast((select avg(f1) from tba) as varchar) from tba where abs((select avg(f1) from tba)) > 0 order by f1;

taos> select f1, cast((select last(*) from tba) as varchar) from tba where abs((select last(*) from tba)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from tba partition by f1) as varchar) from tba where abs((select max(f1) from tba partition by f1)) > 0 order by f1;

taos> select f1, cast((select a.ts from tba a join tba b on a.ts = b.ts) as varchar) from tba where abs((select a.ts from tba a join tba b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from tba interval(1d)) as varchar) from tba where abs((select sum(f1) from tba interval(1d))) > 0 order by f1;

taos> select f1, cast((select f1 from tba union select f1 from tba) as varchar) from tba where abs((select f1 from tba union select f1 from tba)) > 0 order by f1;

taos> select f1, cast((select f1 from tba union all select f1 from tba) as varchar) from tba where abs((select f1 from tba union all select f1 from tba)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tba where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tba) from tba where f1 > (select f1 from tba) or f1 < (select f1 from tba) order by f1;

taos> select f1, (select f1 from tba order by ts, f1 limit 1) from tba where f1 > (select f1 from tba order by ts, f1 limit 1) or f1 < (select f1 from tba order by ts, f1 limit 1) order by f1;

taos> select f1, (select count(*) from tba) from tba where f1 > (select count(*) from tba) or f1 < (select count(*) from tba) order by f1;
     f1      | (select count(*) from tba) |
===========================================
           0 |                          1 |

taos> select f1, (select null from tba) from tba where f1 > (select null from tba) or f1 < (select null from tba) order by f1;

taos> select f1, (select * from tba) from tba where f1 > (select * from tba) or f1 < (select * from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tba) from tba where f1 > (select 2 from tba) or f1 < (select 2 from tba) order by f1;
     f1      |  (select 2 from tba)  |
======================================
           0 |                     2 |

taos> select f1, (select avg(f1) from tba) from tba where f1 > (select avg(f1) from tba) or f1 < (select avg(f1) from tba) order by f1;

taos> select f1, (select last(*) from tba) from tba where f1 > (select last(*) from tba) or f1 < (select last(*) from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tba partition by f1) from tba where f1 > (select max(f1) from tba partition by f1) or f1 < (select max(f1) from tba partition by f1) order by f1;

taos> select f1, (select a.ts from tba a join tba b on a.ts = b.ts) from tba where f1 > (select a.ts from tba a join tba b on a.ts = b.ts) or f1 < (select a.ts from tba a join tba b on a.ts = b.ts) order by f1;
     f1      | (select a.ts from tba a join tba b on a.ts = b.ts) |
===================================================================
           0 | 2025-12-01 00:00:00.000 |

taos> select f1, (select sum(f1) from tba interval(1d)) from tba where f1 > (select sum(f1) from tba interval(1d)) or f1 < (select sum(f1) from tba interval(1d)) order by f1;

taos> select f1, (select f1 from tba union select f1 from tba) from tba where f1 > (select f1 from tba union select f1 from tba) or f1 < (select f1 from tba union select f1 from tba) order by f1;

taos> select f1, (select f1 from tba union all select f1 from tba) from tba where f1 > (select f1 from tba union all select f1 from tba) or f1 < (select f1 from tba union all select f1 from tba) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tba where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tba) from tba where f1 between (select f1 from tba) and (select f1 from tba) + 1 order by f1;
     f1      | (select f1 from tba) |
=====================================
           0 |                    0 |

taos> select f1, (select f1 from tba order by ts, f1 limit 1) from tba where f1 between (select f1 from tba order by ts, f1 limit 1) and (select f1 from tba order by ts, f1 limit 1) + 1 order by f1;
     f1      | (select f1 from tba order by ts, f1 limit 1) |
=============================================================
           0 |                                            0 |

taos> select f1, (select count(*) from tba) from tba where f1 between (select count(*) from tba) and (select count(*) from tba) + 1 order by f1;

taos> select f1, (select null from tba) from tba where f1 between (select null from tba) and (select null from tba) + 1 order by f1;

taos> select f1, (select * from tba) from tba where f1 between (select * from tba) and (select * from tba) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tba) from tba where f1 between (select 2 from tba) and (select 2 from tba) + 1 order by f1;

taos> select f1, (select avg(f1) from tba) from tba where f1 between (select avg(f1) from tba) and (select avg(f1) from tba) + 1 order by f1;
     f1      | (select avg(f1) from tba) |
==========================================
           0 |                         0 |

taos> select f1, (select last(*) from tba) from tba where f1 between (select last(*) from tba) and (select last(*) from tba) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tba partition by f1) from tba where f1 between (select max(f1) from tba partition by f1) and (select max(f1) from tba partition by f1) + 1 order by f1;
     f1      | (select max(f1) from tba partition by f1) |
==========================================================
           0 |                                         0 |

taos> select f1, (select a.ts from tba a join tba b on a.ts = b.ts) from tba where f1 between (select a.ts from tba a join tba b on a.ts = b.ts) and (select a.ts from tba a join tba b on a.ts = b.ts) + 1 order by f1;

taos> select f1, (select sum(f1) from tba interval(1d)) from tba where f1 between (select sum(f1) from tba interval(1d)) and (select sum(f1) from tba interval(1d)) + 1 order by f1;
     f1      | (select sum(f1) from tba interval(1d)) |
=======================================================
           0 |                                      0 |

taos> select f1, (select f1 from tba union select f1 from tba) from tba where f1 between (select f1 from tba union select f1 from tba) and (select f1 from tba union select f1 from tba) + 1 order by f1;
     f1      | (select f1 from tba union select f1 from tba) |
==============================================================
           0 |                                             0 |

taos> select f1, (select f1 from tba union all select f1 from tba) from tba where f1 between (select f1 from tba union all select f1 from tba) and (select f1 from tba union all select f1 from tba) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) > 0 from tba where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tba), (select f1 from tba) > 0 from tba where (select f1 from tba) > 0 and f1 > (select f1 from tba) order by f1;

taos> select (select f1 from tba order by ts, f1 limit 1), (select f1 from tba order by ts, f1 limit 1) > 0 from tba where (select f1 from tba order by ts, f1 limit 1) > 0 and f1 > (select f1 from tba order by ts, f1 limit 1) order by f1;

taos> select (select count(*) from tba), (select count(*) from tba) > 0 from tba where (select count(*) from tba) > 0 and f1 > (select count(*) from tba) order by f1;

taos> select (select null from tba), (select null from tba) > 0 from tba where (select null from tba) > 0 and f1 > (select null from tba) order by f1;

taos> select (select * from tba), (select * from tba) > 0 from tba where (select * from tba) > 0 and f1 > (select * from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tba), (select 2 from tba) > 0 from tba where (select 2 from tba) > 0 and f1 > (select 2 from tba) order by f1;

taos> select (select avg(f1) from tba), (select avg(f1) from tba) > 0 from tba where (select avg(f1) from tba) > 0 and f1 > (select avg(f1) from tba) order by f1;

taos> select (select last(*) from tba), (select last(*) from tba) > 0 from tba where (select last(*) from tba) > 0 and f1 > (select last(*) from tba) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tba partition by f1), (select max(f1) from tba partition by f1) > 0 from tba where (select max(f1) from tba partition by f1) > 0 and f1 > (select max(f1) from tba partition by f1) order by f1;

taos> select (select a.ts from tba a join tba b on a.ts = b.ts), (select a.ts from tba a join tba b on a.ts = b.ts) > 0 from tba where (select a.ts from tba a join tba b on a.ts = b.ts) > 0 and f1 > (select a.ts from tba a join tba b on a.ts = b.ts) order by f1;

taos> select (select sum(f1) from tba interval(1d)), (select sum(f1) from tba interval(1d)) > 0 from tba where (select sum(f1) from tba interval(1d)) > 0 and f1 > (select sum(f1) from tba interval(1d)) order by f1;

taos> select (select f1 from tba union select f1 from tba), (select f1 from tba union select f1 from tba) > 0 from tba where (select f1 from tba union select f1 from tba) > 0 and f1 > (select f1 from tba union select f1 from tba) order by f1;

taos> select (select f1 from tba union all select f1 from tba), (select f1 from tba union all select f1 from tba) > 0 from tba where (select f1 from tba union all select f1 from tba) > 0 and f1 > (select f1 from tba union all select f1 from tba) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbb order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from tbb partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from tbb interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbb union select f1 from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbb union all select f1 from tbb);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) from tbb;
 (select f1 from tbb) |
=======================
                    1 |

taos> select (select f1 from tbb order by ts, f1 limit 1) from tbb;
 (select f1 from tbb order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select (select count(*) from tbb) from tbb;
 (select count(*) from tbb) |
=============================
                          1 |

taos> select (select null from tbb) from tbb;
 (select null from tbb) |
=========================
 NULL                   |

taos> select (select * from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) from tbb;
  (select 2 from tbb)  |
========================
                     2 |

taos> select (select avg(f1) from tbb) from tbb;
 (select avg(f1) from tbb) |
============================
                         1 |

taos> select (select last(*) from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) from tbb;
 (select max(f1) from tbb partition by f1) |
============================================
                                         1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) |
=====================================================
 2025-12-02 00:00:00.000 |

taos> select (select sum(f1) from tbb interval(1d)) from tbb;
 (select sum(f1) from tbb interval(1d)) |
=========================================
                                      1 |

taos> select (select f1 from tbb union select f1 from tbb) from tbb;
 (select f1 from tbb union select f1 from tbb) |
================================================
                                             1 |

taos> select (select f1 from tbb union all select f1 from tbb) from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) a from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) a from tbb;
      a      |
==============
           1 |

taos> select (select f1 from tbb order by ts, f1 limit 1) a from tbb;
      a      |
==============
           1 |

taos> select (select count(*) from tbb) a from tbb;
           a           |
========================
                     1 |

taos> select (select null from tbb) a from tbb;
 a  |
=====
 N. |

taos> select (select * from tbb) a from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) a from tbb;
           a           |
========================
                     2 |

taos> select (select avg(f1) from tbb) a from tbb;
             a             |
============================
                         1 |

taos> select (select last(*) from tbb) a from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) a from tbb;
      a      |
==============
           1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) a from tbb;
            a            |
==========================
 2025-12-02 00:00:00.000 |

taos> select (select sum(f1) from tbb interval(1d)) a from tbb;
           a           |
========================
                     1 |

taos> select (select f1 from tbb union select f1 from tbb) a from tbb;
      a      |
==============
           1 |

taos> select (select f1 from tbb union all select f1 from tbb) a from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select 1) from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from tbb) from tbb;
 (select f1 from tbb) |
=======================
                    1 |

taos> select tags (select f1 from tbb order by ts, f1 limit 1) from tbb;
 (select f1 from tbb order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select tags (select count(*) from tbb) from tbb;
 (select count(*) from tbb) |
=============================
                          1 |

taos> select tags (select null from tbb) from tbb;
 (select null from tbb) |
=========================
 NULL                   |

taos> select tags (select * from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from tbb) from tbb;
  (select 2 from tbb)  |
========================
                     2 |

taos> select tags (select avg(f1) from tbb) from tbb;
 (select avg(f1) from tbb) |
============================
                         1 |

taos> select tags (select last(*) from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from tbb partition by f1) from tbb;
 (select max(f1) from tbb partition by f1) |
============================================
                                         1 |

taos> select tags (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) |
=====================================================
 2025-12-02 00:00:00.000 |

taos> select tags (select sum(f1) from tbb interval(1d)) from tbb;
 (select sum(f1) from tbb interval(1d)) |
=========================================
                                      1 |

taos> select tags (select f1 from tbb union select f1 from tbb) from tbb;
 (select f1 from tbb union select f1 from tbb) |
================================================
                                             1 |

taos> select tags (select f1 from tbb union all select f1 from tbb) from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1) from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tbb) from tbb;
 (select f1 from tbb) |
=======================
                    1 |

taos> select distinct (select f1 from tbb order by ts, f1 limit 1) from tbb;
 (select f1 from tbb order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select distinct (select count(*) from tbb) from tbb;
 (select count(*) from tbb) |
=============================
                          1 |

taos> select distinct (select null from tbb) from tbb;
 (select null from tbb) |
=========================
 NULL                   |

taos> select distinct (select * from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tbb) from tbb;
  (select 2 from tbb)  |
========================
                     2 |

taos> select distinct (select avg(f1) from tbb) from tbb;
 (select avg(f1) from tbb) |
============================
                         1 |

taos> select distinct (select last(*) from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tbb partition by f1) from tbb;
 (select max(f1) from tbb partition by f1) |
============================================
                                         1 |

taos> select distinct (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) |
=====================================================
 2025-12-02 00:00:00.000 |

taos> select distinct (select sum(f1) from tbb interval(1d)) from tbb;
 (select sum(f1) from tbb interval(1d)) |
=========================================
                                      1 |

taos> select distinct (select f1 from tbb union select f1 from tbb) from tbb;
 (select f1 from tbb union select f1 from tbb) |
================================================
                                             1 |

taos> select distinct (select f1 from tbb union all select f1 from tbb) from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1), f1 from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tbb), f1 from tbb;
 (select f1 from tbb) |     f1      |
=====================================
                    1 |           1 |

taos> select distinct (select f1 from tbb order by ts, f1 limit 1), f1 from tbb;
 (select f1 from tbb order by ts, f1 limit 1) |     f1      |
=============================================================
                                            1 |           1 |

taos> select distinct (select count(*) from tbb), f1 from tbb;
 (select count(*) from tbb) |     f1      |
===========================================
                          1 |           1 |

taos> select distinct (select null from tbb), f1 from tbb;
 (select null from tbb) |     f1      |
=======================================
 NULL                   |           1 |

taos> select distinct (select * from tbb), f1 from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tbb), f1 from tbb;
  (select 2 from tbb)  |     f1      |
======================================
                     2 |           1 |

taos> select distinct (select avg(f1) from tbb), f1 from tbb;
 (select avg(f1) from tbb) |     f1      |
==========================================
                         1 |           1 |

taos> select distinct (select last(*) from tbb), f1 from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tbb partition by f1), f1 from tbb;
 (select max(f1) from tbb partition by f1) |     f1      |
==========================================================
                                         1 |           1 |

taos> select distinct (select a.ts from tbb a join tbb b on a.ts = b.ts), f1 from tbb;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) |     f1      |
===================================================================
 2025-12-02 00:00:00.000 |           1 |

taos> select distinct (select sum(f1) from tbb interval(1d)), f1 from tbb;
 (select sum(f1) from tbb interval(1d)) |     f1      |
=======================================================
                                      1 |           1 |

taos> select distinct (select f1 from tbb union select f1 from tbb), f1 from tbb;
 (select f1 from tbb union select f1 from tbb) |     f1      |
==============================================================
                                             1 |           1 |

taos> select distinct (select f1 from tbb union all select f1 from tbb), f1 from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select 1) + 1 from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from tbb) + 1 from tbb;
 (select f1 from tbb) + 1  |
============================
                         2 |

taos> select distinct tags (select f1 from tbb order by ts, f1 limit 1) + 1 from tbb;
 (select f1 from tbb order by ts, f1 limit 1) + 1 |
===================================================
                                                2 |

taos> select distinct tags (select count(*) from tbb) + 1 from tbb;
 (select count(*) from tbb) + 1 |
=================================
                              2 |

taos> select distinct tags (select null from tbb) + 1 from tbb;
 (select null from tbb) + 1 |
=============================
 NULL                       |

taos> select distinct tags (select * from tbb) + 1 from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from tbb) + 1 from tbb;
  (select 2 from tbb) + 1  |
============================
                         3 |

taos> select distinct tags (select avg(f1) from tbb) + 1 from tbb;
 (select avg(f1) from tbb) + 1 |
================================
                             2 |

taos> select distinct tags (select last(*) from tbb) + 1 from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from tbb partition by f1) + 1 from tbb;
 (select max(f1) from tbb partition by f1) + 1 |
================================================
                                             2 |

taos> select distinct tags (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1 from tbb;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1 |
=========================================================
 2025-12-02 00:00:00.001 |

taos> select distinct tags (select sum(f1) from tbb interval(1d)) + 1 from tbb;
 (select sum(f1) from tbb interval(1d)) + 1 |
=============================================
                                          2 |

taos> select distinct tags (select f1 from tbb union select f1 from tbb) + 1 from tbb;
 (select f1 from tbb union select f1 from tbb) + 1 |
====================================================
                                                 2 |

taos> select distinct tags (select f1 from tbb union all select f1 from tbb) + 1 from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) from tbb;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb), (select f1 from tbb) from tbb;
 (select f1 from tbb) | (select f1 from tbb) |
==============================================
                    1 |                    1 |

taos> select (select f1 from tbb order by ts, f1 limit 1), (select f1 from tbb order by ts, f1 limit 1) from tbb;
 (select f1 from tbb order by ts, f1 limit 1) | (select f1 from tbb order by ts, f1 limit 1) |
==============================================================================================
                                            1 |                                            1 |

taos> select (select count(*) from tbb), (select count(*) from tbb) from tbb;
 (select count(*) from tbb) | (select count(*) from tbb) |
==========================================================
                          1 |                          1 |

taos> select (select null from tbb), (select null from tbb) from tbb;
 (select null from tbb) | (select null from tbb) |
==================================================
 NULL                   | NULL                   |

taos> select (select * from tbb), (select * from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb), (select 2 from tbb) from tbb;
  (select 2 from tbb)  |  (select 2 from tbb)  |
================================================
                     2 |                     2 |

taos> select (select avg(f1) from tbb), (select avg(f1) from tbb) from tbb;
 (select avg(f1) from tbb) | (select avg(f1) from tbb) |
========================================================
                         1 |                         1 |

taos> select (select last(*) from tbb), (select last(*) from tbb) from tbb;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1), (select max(f1) from tbb partition by f1) from tbb;
 (select max(f1) from tbb partition by f1) | (select max(f1) from tbb partition by f1) |
========================================================================================
                                         1 |                                         1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts), (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) | (select a.ts from tbb a join tbb b on a.ts = b.ts) |
==========================================================================================================
 2025-12-02 00:00:00.000 | 2025-12-02 00:00:00.000 |

taos> select (select sum(f1) from tbb interval(1d)), (select sum(f1) from tbb interval(1d)) from tbb;
 (select sum(f1) from tbb interval(1d)) | (select sum(f1) from tbb interval(1d)) |
==================================================================================
                                      1 |                                      1 |

taos> select (select f1 from tbb union select f1 from tbb), (select f1 from tbb union select f1 from tbb) from tbb;
 (select f1 from tbb union select f1 from tbb) | (select f1 from tbb union select f1 from tbb) |
================================================================================================
                                             1 |                                             1 |

taos> select (select f1 from tbb union all select f1 from tbb), (select f1 from tbb union all select f1 from tbb) from tbb;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select 1) from tbb order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from tbb) from tbb order by ts;
           1           | (select f1 from tbb) |
===============================================
                     1 |                    1 |

taos> select 1, (select f1 from tbb order by ts, f1 limit 1) from tbb order by ts;
           1           | (select f1 from tbb order by ts, f1 limit 1) |
=======================================================================
                     1 |                                            1 |

taos> select 1, (select count(*) from tbb) from tbb order by ts;
           1           | (select count(*) from tbb) |
=====================================================
                     1 |                          1 |

taos> select 1, (select null from tbb) from tbb order by ts;
           1           | (select null from tbb) |
=================================================
                     1 | NULL                   |

taos> select 1, (select * from tbb) from tbb order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from tbb) from tbb order by ts;
           1           |  (select 2 from tbb)  |
================================================
                     1 |                     2 |

taos> select 1, (select avg(f1) from tbb) from tbb order by ts;
           1           | (select avg(f1) from tbb) |
====================================================
                     1 |                         1 |

taos> select 1, (select last(*) from tbb) from tbb order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from tbb partition by f1) from tbb order by ts;
           1           | (select max(f1) from tbb partition by f1) |
====================================================================
                     1 |                                         1 |

taos> select 1, (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb order by ts;
           1           | (select a.ts from tbb a join tbb b on a.ts = b.ts) |
=============================================================================
                     1 | 2025-12-02 00:00:00.000 |

taos> select 1, (select sum(f1) from tbb interval(1d)) from tbb order by ts;
           1           | (select sum(f1) from tbb interval(1d)) |
=================================================================
                     1 |                                      1 |

taos> select 1, (select f1 from tbb union select f1 from tbb) from tbb order by ts;
           1           | (select f1 from tbb union select f1 from tbb) |
========================================================================
                     1 |                                             1 |

taos> select 1, (select f1 from tbb union all select f1 from tbb) from tbb order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), * from tbb order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb), * from tbb order by ts, f1;
 (select f1 from tbb) |           ts            |     f1      |
===============================================================
                    1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb order by ts, f1 limit 1), * from tbb order by ts, f1;
 (select f1 from tbb order by ts, f1 limit 1) |           ts            |     f1      |
=======================================================================================
                                            1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select count(*) from tbb), * from tbb order by ts, f1;
 (select count(*) from tbb) |           ts            |     f1      |
=====================================================================
                          1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select null from tbb), * from tbb order by ts, f1;
 (select null from tbb) |           ts            |     f1      |
=================================================================
 NULL                   | 2025-12-02 00:00:00.000 |           1 |

taos> select (select * from tbb), * from tbb order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb), * from tbb order by ts, f1;
  (select 2 from tbb)  |           ts            |     f1      |
================================================================
                     2 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select avg(f1) from tbb), * from tbb order by ts, f1;
 (select avg(f1) from tbb) |           ts            |     f1      |
====================================================================
                         1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select last(*) from tbb), * from tbb order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1), * from tbb order by ts, f1;
 (select max(f1) from tbb partition by f1) |           ts            |     f1      |
====================================================================================
                                         1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts), * from tbb order by ts, f1;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) |           ts            |     f1      |
=============================================================================================
 2025-12-02 00:00:00.000 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select sum(f1) from tbb interval(1d)), * from tbb order by ts, f1;
 (select sum(f1) from tbb interval(1d)) |           ts            |     f1      |
=================================================================================
                                      1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb union select f1 from tbb), * from tbb order by ts, f1;
 (select f1 from tbb union select f1 from tbb) |           ts            |     f1      |
========================================================================================
                                             1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb union all select f1 from tbb), * from tbb order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) * (select 1), * from tbb order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) * (select f1 from tbb), * from tbb order by ts, f1;
 (select f1 from tbb) * (select f1 from tbb) |           ts            |     f1      |
======================================================================================
                                           1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb order by ts, f1 limit 1) * (select f1 from tbb order by ts, f1 limit 1), * from tbb order by ts, f1;
 (select f1 from tbb order by ts, f1 limit 1) * (select f1 from t |           ts            |     f1      |
===========================================================================================================
                                                               1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select count(*) from tbb) * (select count(*) from tbb), * from tbb order by ts, f1;
 (select count(*) from tbb) * (select count(*) from tbb) |           ts            |     f1      |
==================================================================================================
                                                       1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select null from tbb) * (select null from tbb), * from tbb order by ts, f1;
 (select null from tbb) * (select null from tbb) |           ts            |     f1      |
==========================================================================================
 NULL                                            | 2025-12-02 00:00:00.000 |           1 |

taos> select (select * from tbb) * (select * from tbb), * from tbb order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) * (select 2 from tbb), * from tbb order by ts, f1;
 (select 2 from tbb) * (select 2 from tbb) |           ts            |     f1      |
====================================================================================
                                         4 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select avg(f1) from tbb) * (select avg(f1) from tbb), * from tbb order by ts, f1;
 (select avg(f1) from tbb) * (select avg(f1) from tbb) |           ts            |     f1      |
================================================================================================
                                                     1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select last(*) from tbb) * (select last(*) from tbb), * from tbb order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) * (select max(f1) from tbb partition by f1), * from tbb order by ts, f1;
 (select max(f1) from tbb partition by f1) * (select max(f1) from |           ts            |     f1      |
===========================================================================================================
                                                               1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) * (select a.ts from tbb a join tbb b on a.ts = b.ts), * from tbb order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tbb interval(1d)) * (select sum(f1) from tbb interval(1d)), * from tbb order by ts, f1;
 (select sum(f1) from tbb interval(1d)) * (select sum(f1) from tb |           ts            |     f1      |
===========================================================================================================
                                                               1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb union select f1 from tbb) * (select f1 from tbb union select f1 from tbb), * from tbb order by ts, f1;
 (select f1 from tbb union select f1 from tbb) * (select f1 from  |           ts            |     f1      |
===========================================================================================================
                                                               1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb union all select f1 from tbb) * (select f1 from tbb union all select f1 from tbb), * from tbb order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)) from tbb;

DB error: unrecognized token: "{funcname}((select 1)) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts, f1 limit 1)) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts, f1 limit 1)) from tbb;" [0x80002600] 
taos> select {funcName}((select count(*) from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select count(*) from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select null from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select null from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select * from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select * from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select 2 from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select 2 from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select avg(f1) from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select last(*) from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select last(*) from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select max(f1) from tbb partition by f1)) from tbb;

DB error: unrecognized token: "{funcname}((select max(f1) from tbb partition by f1)) from tbb;" [0x80002600] 
taos> select {funcName}((select a.ts from tbb a join tbb b on a.ts = b.ts)) from tbb;

DB error: unrecognized token: "{funcname}((select a.ts from tbb a join tbb b on a.ts = b.ts)) from tbb;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbb interval(1d))) from tbb;

DB error: unrecognized token: "{funcname}((select sum(f1) from tbb interval(1d))) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb union select f1 from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb union select f1 from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb union all select f1 from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb union all select f1 from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts, f1 limit 1) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts, f1 limit 1) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select count(*) from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select count(*) from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select null from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select null from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select * from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select * from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select 2 from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select 2 from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select avg(f1) from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select last(*) from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select last(*) from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select max(f1) from tbb partition by f1) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select max(f1) from tbb partition by f1) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select a.ts from tbb a join tbb b on a.ts = b.ts) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select a.ts from tbb a join tbb b on a.ts = b.ts) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbb interval(1d)) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select sum(f1) from tbb interval(1d)) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb union select f1 from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb union select f1 from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb union all select f1 from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb union all select f1 from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts, f1 limit 1) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts, f1 limit 1) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select count(*) from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select count(*) from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select null from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select null from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select * from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select * from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select 2 from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select 2 from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select avg(f1) from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select last(*) from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select last(*) from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select max(f1) from tbb partition by f1) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select max(f1) from tbb partition by f1) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select a.ts from tbb a join tbb b on a.ts = b.ts) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select a.ts from tbb a join tbb b on a.ts = b.ts) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbb interval(1d)) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select sum(f1) from tbb interval(1d)) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb union select f1 from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb union select f1 from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb union all select f1 from tbb) + 1) + 2 from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb union all select f1 from tbb) + 1) + 2 from tbb;" [0x80002600] 
taos> select (select 1) + (select 1) from tbb partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) + (select f1 from tbb) from tbb partition by tbname;
 (select f1 from tbb) + (select f1 from tbb) |
==============================================
                                           2 |

taos> select (select f1 from tbb order by ts, f1 limit 1) + (select f1 from tbb order by ts, f1 limit 1) from tbb partition by tbname;
 (select f1 from tbb order by ts, f1 limit 1) + (select f1 from t |
===================================================================
                                                               2 |

taos> select (select count(*) from tbb) + (select count(*) from tbb) from tbb partition by tbname;
 (select count(*) from tbb) + (select count(*) from tbb) |
==========================================================
                                                       2 |

taos> select (select null from tbb) + (select null from tbb) from tbb partition by tbname;
 (select null from tbb) + (select null from tbb) |
==================================================
 NULL                                            |

taos> select (select * from tbb) + (select * from tbb) from tbb partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) + (select 2 from tbb) from tbb partition by tbname;
 (select 2 from tbb) + (select 2 from tbb) |
============================================
                                         4 |

taos> select (select avg(f1) from tbb) + (select avg(f1) from tbb) from tbb partition by tbname;
 (select avg(f1) from tbb) + (select avg(f1) from tbb) |
========================================================
                                                     2 |

taos> select (select last(*) from tbb) + (select last(*) from tbb) from tbb partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) + (select max(f1) from tbb partition by f1) from tbb partition by tbname;
 (select max(f1) from tbb partition by f1) + (select max(f1) from |
===================================================================
                                                               2 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) + (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tbb interval(1d)) + (select sum(f1) from tbb interval(1d)) from tbb partition by tbname;
 (select sum(f1) from tbb interval(1d)) + (select sum(f1) from tb |
===================================================================
                                                               2 |

taos> select (select f1 from tbb union select f1 from tbb) + (select f1 from tbb union select f1 from tbb) from tbb partition by tbname;
 (select f1 from tbb union select f1 from tbb) + (select f1 from  |
===================================================================
                                                               2 |

taos> select (select f1 from tbb union all select f1 from tbb) + (select f1 from tbb union all select f1 from tbb) from tbb partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + f1 from tbb partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) + f1 from tbb partition by f1;
 (select f1 from tbb) + f1 |
============================
                         2 |

taos> select (select f1 from tbb order by ts, f1 limit 1) + f1 from tbb partition by f1;
 (select f1 from tbb order by ts, f1 limit 1) + f1 |
====================================================
                                                 2 |

taos> select (select count(*) from tbb) + f1 from tbb partition by f1;
 (select count(*) from tbb) + f1 |
==================================
                               2 |

taos> select (select null from tbb) + f1 from tbb partition by f1;
 (select null from tbb) + f1 |
==============================
 NULL                        |

taos> select (select * from tbb) + f1 from tbb partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) + f1 from tbb partition by f1;
 (select 2 from tbb) + f1  |
============================
                         3 |

taos> select (select avg(f1) from tbb) + f1 from tbb partition by f1;
 (select avg(f1) from tbb) + f1 |
=================================
                              2 |

taos> select (select last(*) from tbb) + f1 from tbb partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) + f1 from tbb partition by f1;
 (select max(f1) from tbb partition by f1) + f1 |
=================================================
                                              2 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) + f1 from tbb partition by f1;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) + f1 |
==========================================================
 2025-12-02 00:00:00.001 |

taos> select (select sum(f1) from tbb interval(1d)) + f1 from tbb partition by f1;
 (select sum(f1) from tbb interval(1d)) + f1 |
==============================================
                                           2 |

taos> select (select f1 from tbb union select f1 from tbb) + f1 from tbb partition by f1;
 (select f1 from tbb union select f1 from tbb) + f1 |
=====================================================
                                                  2 |

taos> select (select f1 from tbb union all select f1 from tbb) + f1 from tbb partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select f1 from tbb) > 0 then 1 else 2 end |        sum(f1)        |
===============================================================================
                                                    1 |                     1 |

taos> select case when (select f1 from tbb order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select f1 from tbb order by ts, f1 limit 1) > 0 then  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select count(*) from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select count(*) from tbb) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     1 |

taos> select case when (select null from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select null from tbb) > 0 then 1 else 2 end |        sum(f1)        |
=================================================================================
                                                      2 |                     1 |

taos> select case when (select * from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select 2 from tbb) > 0 then 1 else 2 end |        sum(f1)        |
==============================================================================
                                                   1 |                     1 |

taos> select case when (select avg(f1) from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select avg(f1) from tbb) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     1 |

taos> select case when (select last(*) from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from tbb partition by f1) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select max(f1) from tbb partition by f1) > 0 then 1 e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select a.ts from tbb a join tbb b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select a.ts from tbb a join tbb b on a.ts = b.ts) > 0 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select sum(f1) from tbb interval(1d)) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select sum(f1) from tbb interval(1d)) > 0 then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select f1 from tbb union select f1 from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;
 case when (select f1 from tbb union select f1 from tbb) > 0 then |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select f1 from tbb union all select f1 from tbb) > 0 then 1 else 2 end, sum(f1) from tbb group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tbb group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from tbb) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select f1 from tbb) else 2 end |        sum(f1)        |
====================================================================================
 2                                                         |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tbb order by ts, f1 limit 1) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select f1 from tbb order by ts, f1 li |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select count(*) from tbb) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select count(*) from tbb) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     1 |

taos> select case when f1 = 1 then 2 / (select null from tbb) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select null from tbb) else 2 end |        sum(f1)        |
======================================================================================
 NULL                                                        |                     1 |

taos> select case when f1 = 1 then 2 / (select * from tbb) else 2 end, sum(f1) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from tbb) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select 2 from tbb) else 2 end |        sum(f1)        |
===================================================================================
 1                                                        |                     1 |

taos> select case when f1 = 1 then 2 / (select avg(f1) from tbb) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from tbb) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     1 |

taos> select case when f1 = 1 then 2 / (select last(*) from tbb) else 2 end, sum(f1) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tbb partition by f1) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select max(f1) from tbb partition by  |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select a.ts from tbb a join tbb b on a.ts = b.ts) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select a.ts from tbb a join tbb b on  |        sum(f1)        |
===========================================================================================
 1.13339825438534e-12                                             |                     1 |

taos> select case when f1 = 1 then 2 / (select sum(f1) from tbb interval(1d)) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select sum(f1) from tbb interval(1d)) |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tbb union select f1 from tbb) else 2 end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 2 / (select f1 from tbb union select f1 fr |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tbb union all select f1 from tbb) else 2 end, sum(f1) from tbb group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tbb group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from tbb) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select f1 from tbb) is null end |        sum(f1)        |
========================================================================================
                                                             1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tbb order by ts, f1 limit 1) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select f1 from tbb order by ts, f1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select count(*) from tbb) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select count(*) from tbb) is null  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select null from tbb) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select null from tbb) is null end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when f1 = 1 then 1 else (select * from tbb) is null end, sum(f1) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from tbb) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select 2 from tbb) is null end |        sum(f1)        |
=======================================================================================
                                                            1 |                     1 |

taos> select case when f1 = 1 then 1 else (select avg(f1) from tbb) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from tbb) is null e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select last(*) from tbb) is null end, sum(f1) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tbb partition by f1) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select max(f1) from tbb partition  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select a.ts from tbb a join tbb b on a.ts = b.ts) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select a.ts from tbb a join tbb b  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select sum(f1) from tbb interval(1d)) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select sum(f1) from tbb interval(1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tbb union select f1 from tbb) is null end, sum(f1) from tbb group by f1;
 case when f1 = 1 then 1 else (select f1 from tbb union select f1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tbb union all select f1 from tbb) is null end, sum(f1) from tbb group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tbb interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select f1 from tbb) |          avg(f1)          |
=============================================================================
 2025-12-02 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tbb order by ts, f1 limit 1), avg(f1) from tbb interval(1d);
         _wstart         | (select f1 from tbb order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-02 00:00:00.000 |                                            1 |                         1 |

taos> select _wstart, (select count(*) from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select count(*) from tbb) |          avg(f1)          |
===================================================================================
 2025-12-02 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select null from tbb) |          avg(f1)          |
===============================================================================
 2025-12-02 00:00:00.000 | NULL                   |                         1 |

taos> select _wstart, (select * from tbb), avg(f1) from tbb interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tbb), avg(f1) from tbb interval(1d);
         _wstart         |  (select 2 from tbb)  |          avg(f1)          |
==============================================================================
 2025-12-02 00:00:00.000 |                     2 |                         1 |

taos> select _wstart, (select avg(f1) from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select avg(f1) from tbb) |          avg(f1)          |
==================================================================================
 2025-12-02 00:00:00.000 |                         1 |                         1 |

taos> select _wstart, (select last(*) from tbb), avg(f1) from tbb interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tbb partition by f1), avg(f1) from tbb interval(1d);
         _wstart         | (select max(f1) from tbb partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-02 00:00:00.000 |                                         1 |                         1 |

taos> select _wstart, (select a.ts from tbb a join tbb b on a.ts = b.ts), avg(f1) from tbb interval(1d);
         _wstart         | (select a.ts from tbb a join tbb b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-02 00:00:00.000 | 2025-12-02 00:00:00.000 |                         1 |

taos> select _wstart, (select sum(f1) from tbb interval(1d)), avg(f1) from tbb interval(1d);
         _wstart         | (select sum(f1) from tbb interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-02 00:00:00.000 |                                      1 |                         1 |

taos> select _wstart, (select f1 from tbb union select f1 from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select f1 from tbb union select f1 from tbb) |          avg(f1)          |
======================================================================================================
 2025-12-02 00:00:00.000 |                                             1 |                         1 |

taos> select _wstart, (select f1 from tbb union all select f1 from tbb), avg(f1) from tbb interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tbb interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) + 1, avg(f1) from tbb interval(1d);
 (select f1 from tbb) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tbb order by ts, f1 limit 1) + 1, avg(f1) from tbb interval(1d);
 (select f1 from tbb order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                2 |                         1 |

taos> select (select count(*) from tbb) + 1, avg(f1) from tbb interval(1d);
 (select count(*) from tbb) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tbb) + 1, avg(f1) from tbb interval(1d);
 (select null from tbb) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select * from tbb) + 1, avg(f1) from tbb interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) + 1, avg(f1) from tbb interval(1d);
  (select 2 from tbb) + 1  |          avg(f1)          |
========================================================
                         3 |                         1 |

taos> select (select avg(f1) from tbb) + 1, avg(f1) from tbb interval(1d);
 (select avg(f1) from tbb) + 1 |          avg(f1)          |
============================================================
                             2 |                         1 |

taos> select (select last(*) from tbb) + 1, avg(f1) from tbb interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) + 1, avg(f1) from tbb interval(1d);
 (select max(f1) from tbb partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             2 |                         1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1, avg(f1) from tbb interval(1d);
 (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-02 00:00:00.001 |                         1 |

taos> select (select sum(f1) from tbb interval(1d)) + 1, avg(f1) from tbb interval(1d);
 (select sum(f1) from tbb interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          2 |                         1 |

taos> select (select f1 from tbb union select f1 from tbb) + 1, avg(f1) from tbb interval(1d);
 (select f1 from tbb union select f1 from tbb) + 1 |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select (select f1 from tbb union all select f1 from tbb) + 1, avg(f1) from tbb interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts, f1 limit 1)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts, f1 limit 1)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select * from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tbb partition by f1)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tbb partition by f1)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tbb a join tbb b on a.ts = b.ts)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tbb a join tbb b on a.ts = b.ts)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbb interval(1d))), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tbb interval(1d))), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb union select f1 from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb union select f1 from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb union all select f1 from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb union all select f1 from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts, f1 limit 1) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts, f1 limit 1) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select * from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tbb partition by f1) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tbb partition by f1) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tbb a join tbb b on a.ts = b.ts) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tbb a join tbb b on a.ts = b.ts) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbb interval(1d)) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tbb interval(1d)) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb union select f1 from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb union select f1 from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb union all select f1 from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb union all select f1 from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select f1 from tbb) when 1 then 1 else 2 end |          avg(f1)          |
=================================================================================
                                                  1 |                         1 |

taos> select case (select f1 from tbb order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select f1 from tbb order by ts, f1 limit 1) when 1 then 1  |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select count(*) from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select count(*) from tbb) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        1 |                         1 |

taos> select case (select null from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select null from tbb) when 1 then 1 else 2 end |          avg(f1)          |
===================================================================================
                                                    2 |                         1 |

taos> select case (select * from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select 2 from tbb) when 1 then 1 else 2 end |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select case (select avg(f1) from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select avg(f1) from tbb) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       1 |                         1 |

taos> select case (select last(*) from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from tbb partition by f1) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select max(f1) from tbb partition by f1) when 1 then 1 els |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select a.ts from tbb a join tbb b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select a.ts from tbb a join tbb b on a.ts = b.ts) when 1 t |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case (select sum(f1) from tbb interval(1d)) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select sum(f1) from tbb interval(1d)) when 1 then 1 else 2 |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select f1 from tbb union select f1 from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select f1 from tbb union select f1 from tbb) when 1 then 1 |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select f1 from tbb union all select f1 from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from tbb SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select f1 from tbb) |          avg(f1)          |
=============================================================================
 2025-12-02 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tbb order by ts, f1 limit 1), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select f1 from tbb order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-02 00:00:00.000 |                                            1 |                         1 |

taos> select _wstart, (select count(*) from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select count(*) from tbb) |          avg(f1)          |
===================================================================================
 2025-12-02 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select null from tbb) |          avg(f1)          |
===============================================================================
 2025-12-02 00:00:00.000 | NULL                   |                         1 |

taos> select _wstart, (select * from tbb), avg(f1) from tbb SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         |  (select 2 from tbb)  |          avg(f1)          |
==============================================================================
 2025-12-02 00:00:00.000 |                     2 |                         1 |

taos> select _wstart, (select avg(f1) from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select avg(f1) from tbb) |          avg(f1)          |
==================================================================================
 2025-12-02 00:00:00.000 |                         1 |                         1 |

taos> select _wstart, (select last(*) from tbb), avg(f1) from tbb SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tbb partition by f1), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select max(f1) from tbb partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-02 00:00:00.000 |                                         1 |                         1 |

taos> select _wstart, (select a.ts from tbb a join tbb b on a.ts = b.ts), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select a.ts from tbb a join tbb b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-02 00:00:00.000 | 2025-12-02 00:00:00.000 |                         1 |

taos> select _wstart, (select sum(f1) from tbb interval(1d)), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select sum(f1) from tbb interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-02 00:00:00.000 |                                      1 |                         1 |

taos> select _wstart, (select f1 from tbb union select f1 from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select f1 from tbb union select f1 from tbb) |          avg(f1)          |
======================================================================================================
 2025-12-02 00:00:00.000 |                                             1 |                         1 |

taos> select _wstart, (select f1 from tbb union all select f1 from tbb), avg(f1) from tbb SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from tbb SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select f1 from tbb) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tbb order by ts, f1 limit 1) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select f1 from tbb order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                2 |                         1 |

taos> select (select count(*) from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select count(*) from tbb) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select null from tbb) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select * from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
  (select 2 from tbb) + 1  |          avg(f1)          |
========================================================
                         3 |                         1 |

taos> select (select avg(f1) from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select avg(f1) from tbb) + 1 |          avg(f1)          |
============================================================
                             2 |                         1 |

taos> select (select last(*) from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select max(f1) from tbb partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             2 |                         1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-02 00:00:00.001 |                         1 |

taos> select (select sum(f1) from tbb interval(1d)) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select sum(f1) from tbb interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          2 |                         1 |

taos> select (select f1 from tbb union select f1 from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select f1 from tbb union select f1 from tbb) + 1 |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select (select f1 from tbb union all select f1 from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) > 0 from tbb SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tbb order by ts, f1 limit 1) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tbb interval(1d)) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tbb union select f1 from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tbb union all select f1 from tbb) > 0 from tbb SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select f1 from tbb) > 0 then 1 else 2 end) |
============================================================
                                                         1 |

taos> select sum(case when (select f1 from tbb order by ts, f1 limit 1) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select f1 from tbb order by ts, f1 limit 1) > 0 t |
===================================================================
                                                                1 |

taos> select sum(case when (select count(*) from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select count(*) from tbb) > 0 then 1 else 2 end) |
==================================================================
                                                               1 |

taos> select sum(case when (select null from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select null from tbb) > 0 then 1 else 2 end) |
==============================================================
                                                           2 |

taos> select sum(case when (select * from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select 2 from tbb) > 0 then 1 else 2 end) |
===========================================================
                                                        1 |

taos> select sum(case when (select avg(f1) from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select avg(f1) from tbb) > 0 then 1 else 2 end) |
=================================================================
                                                              1 |

taos> select sum(case when (select last(*) from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from tbb partition by f1) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select max(f1) from tbb partition by f1) > 0 then |
===================================================================
                                                                1 |

taos> select sum(case when (select a.ts from tbb a join tbb b on a.ts = b.ts) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select a.ts from tbb a join tbb b on a.ts = b.ts) |
===================================================================
                                                                1 |

taos> select sum(case when (select sum(f1) from tbb interval(1d)) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select sum(f1) from tbb interval(1d)) > 0 then 1  |
===================================================================
                                                                1 |

taos> select sum(case when (select f1 from tbb union select f1 from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);
 sum(case when (select f1 from tbb union select f1 from tbb) > 0  |
===================================================================
                                                                1 |

taos> select sum(case when (select f1 from tbb union all select f1 from tbb) > 0 then 1 else 2 end) from tbb STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tbb) as bigin |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbb order by ts, f1 limit 1) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tbb order by  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select count(*) from tbb) as |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select null from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select null from tbb) as big |
===================================================================
 NULL                                                             |

taos> select sum(case when f1 = 1 then cast(2 / (select * from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select 2 from tbb) as bigint |
===================================================================
                                                                1 |

taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select avg(f1) from tbb) as  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tbb partition by f1) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select max(f1) from tbb part |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tbb a join tbb b on a.ts = b.ts) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select a.ts from tbb a join  |
===================================================================
                                                                0 |

taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tbb interval(1d)) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select sum(f1) from tbb inte |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbb union select f1 from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tbb union sel |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbb union all select f1 from tbb) as bigint) else 2 end) from tbb EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tbb COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tbb) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tbb) is null en |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tbb order by ts, f1 limit 1) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tbb order by ts |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tbb) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select count(*) from tbb) is n |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select null from tbb) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select null from tbb) is null  |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select * from tbb) is null end + 1) from tbb COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tbb) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select 2 from tbb) is null end |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tbb) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select avg(f1) from tbb) is nu |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tbb) is null end + 1) from tbb COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tbb partition by f1) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select max(f1) from tbb partit |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select a.ts from tbb a join tbb b on a.ts = b.ts) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select a.ts from tbb a join tb |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tbb interval(1d)) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select sum(f1) from tbb interv |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tbb union select f1 from tbb) is null end + 1) from tbb COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tbb union selec |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tbb union all select f1 from tbb) is null end + 1) from tbb COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select 1)) from tbb partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from tbb)) from tbb partition by tbname interval(1d);
 sum((select f1 from tbb)) |
============================
                         1 |

taos> select sum((select f1 from tbb order by ts, f1 limit 1)) from tbb partition by tbname interval(1d);
 sum((select f1 from tbb order by ts, f1 limit 1)) |
====================================================
                                                 1 |

taos> select sum((select count(*) from tbb)) from tbb partition by tbname interval(1d);
 sum((select count(*) from tbb)) |
==================================
                               1 |

taos> select sum((select null from tbb)) from tbb partition by tbname interval(1d);
 sum((select null from tbb)) |
==============================
 NULL                        |

taos> select sum((select * from tbb)) from tbb partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from tbb)) from tbb partition by tbname interval(1d);
 sum((select 2 from tbb)) |
===========================
                        2 |

taos> select sum((select avg(f1) from tbb)) from tbb partition by tbname interval(1d);
 sum((select avg(f1) from tbb)) |
=================================
                              1 |

taos> select sum((select last(*) from tbb)) from tbb partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from tbb partition by f1)) from tbb partition by tbname interval(1d);
 sum((select max(f1) from tbb partition by f1)) |
=================================================
                                              1 |

taos> select sum((select a.ts from tbb a join tbb b on a.ts = b.ts)) from tbb partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tbb interval(1d))) from tbb partition by tbname interval(1d);
 sum((select sum(f1) from tbb interval(1d))) |
==============================================
                                           1 |

taos> select sum((select f1 from tbb union select f1 from tbb)) from tbb partition by tbname interval(1d);
 sum((select f1 from tbb union select f1 from tbb)) |
=====================================================
                                                  1 |

taos> select sum((select f1 from tbb union all select f1 from tbb)) from tbb partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select 1) * -1)) from tbb partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from tbb) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select f1 from tbb) * -1)) |
======================================
                                   1 |

taos> select avg(abs((select f1 from tbb order by ts, f1 limit 1) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select f1 from tbb order by ts, f1 limit 1) * -1)) |
==============================================================
                                                           1 |

taos> select avg(abs((select count(*) from tbb) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select count(*) from tbb) * -1)) |
============================================
                                         1 |

taos> select avg(abs((select null from tbb) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select null from tbb) * -1)) |
========================================
 NULL                                  |

taos> select avg(abs((select * from tbb) * -1)) from tbb partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from tbb) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select 2 from tbb) * -1)) |
=====================================
                                  2 |

taos> select avg(abs((select avg(f1) from tbb) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select avg(f1) from tbb) * -1)) |
===========================================
                                        1 |

taos> select avg(abs((select last(*) from tbb) * -1)) from tbb partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from tbb partition by f1) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select max(f1) from tbb partition by f1) * -1)) |
===========================================================
                                                        1 |

taos> select avg(abs((select a.ts from tbb a join tbb b on a.ts = b.ts) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select a.ts from tbb a join tbb b on a.ts = b.ts) * -1) |
===================================================================
                                                   1764604800000 |

taos> select avg(abs((select sum(f1) from tbb interval(1d)) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select sum(f1) from tbb interval(1d)) * -1)) |
========================================================
                                                     1 |

taos> select avg(abs((select f1 from tbb union select f1 from tbb) * -1)) from tbb partition by f1 interval(1d);
 avg(abs((select f1 from tbb union select f1 from tbb) * -1)) |
===============================================================
                                                            1 |

taos> select avg(abs((select f1 from tbb union all select f1 from tbb) * -1)) from tbb partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tbb group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbb) from tbb group by f1;
     f1      | (select f1 from tbb) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tbb order by ts, f1 limit 1) from tbb group by f1;
     f1      | (select f1 from tbb order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from tbb) from tbb group by f1;
     f1      | (select count(*) from tbb) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tbb) from tbb group by f1;
     f1      | (select null from tbb) |
=======================================
           1 | NULL                   |

taos> select f1, (select * from tbb) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbb) from tbb group by f1;
     f1      |  (select 2 from tbb)  |
======================================
           1 |                     2 |

taos> select f1, (select avg(f1) from tbb) from tbb group by f1;
     f1      | (select avg(f1) from tbb) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tbb) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbb partition by f1) from tbb group by f1;
     f1      | (select max(f1) from tbb partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb group by f1;
     f1      | (select a.ts from tbb a join tbb b on a.ts = b.ts) |
===================================================================
           1 | 2025-12-02 00:00:00.000 |

taos> select f1, (select sum(f1) from tbb interval(1d)) from tbb group by f1;
     f1      | (select sum(f1) from tbb interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tbb union select f1 from tbb) from tbb group by f1;
     f1      | (select f1 from tbb union select f1 from tbb) |
==============================================================
           1 |                                             1 |

taos> select f1, (select f1 from tbb union all select f1 from tbb) from tbb group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1), avg((select 1)) from tbb group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbb), avg((select f1 from tbb)) from tbb group by f1;
     f1      | (select f1 from tbb) | avg((select f1 from tbb)) |
=================================================================
           1 |                    1 |                         1 |

taos> select f1, (select f1 from tbb order by ts, f1 limit 1), avg((select f1 from tbb order by ts, f1 limit 1)) from tbb group by f1;
     f1      | (select f1 from tbb order by ts, f1 limit 1) | avg((select f1 from tbb order by ts, f1 limit 1)) |
=================================================================================================================
           1 |                                            1 |                                                 1 |

taos> select f1, (select count(*) from tbb), avg((select count(*) from tbb)) from tbb group by f1;
     f1      | (select count(*) from tbb) | avg((select count(*) from tbb)) |
=============================================================================
           1 |                          1 |                               1 |

taos> select f1, (select null from tbb), avg((select null from tbb)) from tbb group by f1;
     f1      | (select null from tbb) | avg((select null from tbb)) |
=====================================================================
           1 | NULL                   | NULL                        |

taos> select f1, (select * from tbb), avg((select * from tbb)) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbb), avg((select 2 from tbb)) from tbb group by f1;
     f1      |  (select 2 from tbb)  | avg((select 2 from tbb))  |
==================================================================
           1 |                     2 |                         2 |

taos> select f1, (select avg(f1) from tbb), avg((select avg(f1) from tbb)) from tbb group by f1;
     f1      | (select avg(f1) from tbb) | avg((select avg(f1) from tbb)) |
===========================================================================
           1 |                         1 |                              1 |

taos> select f1, (select last(*) from tbb), avg((select last(*) from tbb)) from tbb group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbb partition by f1), avg((select max(f1) from tbb partition by f1)) from tbb group by f1;
     f1      | (select max(f1) from tbb partition by f1) | avg((select max(f1) from tbb partition by f1)) |
===========================================================================================================
           1 |                                         1 |                                              1 |

taos> select f1, (select a.ts from tbb a join tbb b on a.ts = b.ts), avg((select a.ts from tbb a join tbb b on a.ts = b.ts)) from tbb group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from tbb interval(1d)), avg((select sum(f1) from tbb interval(1d))) from tbb group by f1;
     f1      | (select sum(f1) from tbb interval(1d)) | avg((select sum(f1) from tbb interval(1d))) |
=====================================================================================================
           1 |                                      1 |                                           1 |

taos> select f1, (select f1 from tbb union select f1 from tbb), avg((select f1 from tbb union select f1 from tbb)) from tbb group by f1;
     f1      | (select f1 from tbb union select f1 from tbb) | avg((select f1 from tbb union select f1 from tbb)) |
===================================================================================================================
           1 |                                             1 |                                                  1 |

taos> select f1, (select f1 from tbb union all select f1 from tbb), avg((select f1 from tbb union all select f1 from tbb)) from tbb group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select 1) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb) order by b.f1;
     f1      | (select f1 from tbb) + 1  |
==========================================
           1 |                         2 |

taos> select b.f1, (select f1 from tbb order by ts, f1 limit 1) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb order by ts, f1 limit 1) order by b.f1;
     f1      | (select f1 from tbb order by ts, f1 limit 1) + 1 |
=================================================================
           1 |                                                2 |

taos> select b.f1, (select count(*) from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select count(*) from tbb) order by b.f1;
     f1      | (select count(*) from tbb) + 1 |
===============================================
           1 |                              2 |

taos> select b.f1, (select null from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select null from tbb) order by b.f1;

taos> select b.f1, (select * from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select * from tbb) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select 2 from tbb) order by b.f1;

taos> select b.f1, (select avg(f1) from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select avg(f1) from tbb) order by b.f1;
     f1      | (select avg(f1) from tbb) + 1 |
==============================================
           1 |                             2 |

taos> select b.f1, (select last(*) from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select last(*) from tbb) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from tbb partition by f1) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select max(f1) from tbb partition by f1) order by b.f1;
     f1      | (select max(f1) from tbb partition by f1) + 1 |
==============================================================
           1 |                                             2 |

taos> select b.f1, (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select a.ts from tbb a join tbb b on a.ts = b.ts) order by b.f1;

taos> select b.f1, (select sum(f1) from tbb interval(1d)) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select sum(f1) from tbb interval(1d)) order by b.f1;
     f1      | (select sum(f1) from tbb interval(1d)) + 1 |
===========================================================
           1 |                                          2 |

taos> select b.f1, (select f1 from tbb union select f1 from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb union select f1 from tbb) order by b.f1;
     f1      | (select f1 from tbb union select f1 from tbb) + 1 |
==================================================================
           1 |                                                 2 |

taos> select b.f1, (select f1 from tbb union all select f1 from tbb) + 1 from tbb a join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb union all select f1 from tbb) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg((select 1) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) + 1, avg((select f1 from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb);
 (select f1 from tbb) + 1  | avg((select f1 from tbb) + 2) |
============================================================
                         2 |                             3 |

taos> select (select f1 from tbb order by ts, f1 limit 1) + 1, avg((select f1 from tbb order by ts, f1 limit 1) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb order by ts, f1 limit 1);
 (select f1 from tbb order by ts, f1 limit 1) + 1 | avg((select f1 from tbb order by ts, f1 limit 1) + 2) |
===========================================================================================================
                                                2 |                                                     3 |

taos> select (select count(*) from tbb) + 1, avg((select count(*) from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select count(*) from tbb);
 (select count(*) from tbb) + 1 | avg((select count(*) from tbb) + 2) |
=======================================================================
                              2 |                                   3 |

taos> select (select null from tbb) + 1, avg((select null from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select null from tbb);
 (select null from tbb) + 1 | avg((select null from tbb) + 2) |
===============================================================
 NULL                       | NULL                            |

taos> select (select * from tbb) + 1, avg((select * from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select * from tbb);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) + 1, avg((select 2 from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select 2 from tbb);
  (select 2 from tbb) + 1  | avg((select 2 from tbb) + 2) |
===========================================================
                         3 |                            4 |

taos> select (select avg(f1) from tbb) + 1, avg((select avg(f1) from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select avg(f1) from tbb);
 (select avg(f1) from tbb) + 1 | avg((select avg(f1) from tbb) + 2) |
=====================================================================
                             2 |                                  3 |

taos> select (select last(*) from tbb) + 1, avg((select last(*) from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select last(*) from tbb);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) + 1, avg((select max(f1) from tbb partition by f1) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select max(f1) from tbb partition by f1);
 (select max(f1) from tbb partition by f1) + 1 | avg((select max(f1) from tbb partition by f1) + 2) |
=====================================================================================================
                                             2 |                                                  3 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1, avg((select a.ts from tbb a join tbb b on a.ts = b.ts) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select a.ts from tbb a join tbb b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from tbb interval(1d)) + 1, avg((select sum(f1) from tbb interval(1d)) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select sum(f1) from tbb interval(1d));
 (select sum(f1) from tbb interval(1d)) + 1 | avg((select sum(f1) from tbb interval(1d)) + 2) |
===============================================================================================
                                          2 |                                               3 |

taos> select (select f1 from tbb union select f1 from tbb) + 1, avg((select f1 from tbb union select f1 from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb union select f1 from tbb);
 (select f1 from tbb union select f1 from tbb) + 1 | avg((select f1 from tbb union select f1 from tbb) + 2) |
=============================================================================================================
                                                 2 |                                                      3 |

taos> select (select f1 from tbb union all select f1 from tbb) + 1, avg((select f1 from tbb union all select f1 from tbb) + 2) from tbb a left join tbb b on a.ts = b.ts and a.f1 = (select f1 from tbb union all select f1 from tbb);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select 1), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select f1 from tbb) order by a.ts, a.f1;
           ts            |     f1      | (select f1 from tbb) |           ts            |     f1      |
=======================================================================================================
 2025-12-02 00:00:00.000 |           1 |                    1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select f1 from tbb order by ts, f1 limit 1), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select f1 from tbb order by ts, f1 limit 1) order by a.ts, a.f1;
           ts            |     f1      | (select f1 from tbb order by ts, f1 limit 1) |           ts            |     f1      |
===============================================================================================================================
 2025-12-02 00:00:00.000 |           1 |                                            1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select count(*) from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select count(*) from tbb) order by a.ts, a.f1;
           ts            |     f1      | (select count(*) from tbb) |           ts            |     f1      |
=============================================================================================================
 2025-12-02 00:00:00.000 |           1 |                          1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select null from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select null from tbb) order by a.ts, a.f1;
           ts            |     f1      | (select null from tbb) |           ts            |     f1      |
=========================================================================================================
 2025-12-02 00:00:00.000 |           1 | NULL                   | NULL                    | NULL        |

taos> select a.*, (select * from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select * from tbb) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select 2 from tbb) order by a.ts, a.f1;
           ts            |     f1      |  (select 2 from tbb)  |           ts            |     f1      |
========================================================================================================
 2025-12-02 00:00:00.000 |           1 |                     2 | NULL                    | NULL        |

taos> select a.*, (select avg(f1) from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select avg(f1) from tbb) order by a.ts, a.f1;
           ts            |     f1      | (select avg(f1) from tbb) |           ts            |     f1      |
============================================================================================================
 2025-12-02 00:00:00.000 |           1 |                         1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select last(*) from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select last(*) from tbb) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from tbb partition by f1), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select max(f1) from tbb partition by f1) order by a.ts, a.f1;
           ts            |     f1      | (select max(f1) from tbb partition by f1) |           ts            |     f1      |
============================================================================================================================
 2025-12-02 00:00:00.000 |           1 |                                         1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select a.ts from tbb a join tbb b on a.ts = b.ts), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select a.ts from tbb a join tbb b on a.ts = b.ts) order by a.ts, a.f1;
           ts            |     f1      | (select a.ts from tbb a join tbb b on a.ts = b.ts) |           ts            |     f1      |
=====================================================================================================================================
 2025-12-02 00:00:00.000 |           1 | 2025-12-02 00:00:00.000 | NULL                    | NULL        |

taos> select a.*, (select sum(f1) from tbb interval(1d)), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select sum(f1) from tbb interval(1d)) order by a.ts, a.f1;
           ts            |     f1      | (select sum(f1) from tbb interval(1d)) |           ts            |     f1      |
=========================================================================================================================
 2025-12-02 00:00:00.000 |           1 |                                      1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select f1 from tbb union select f1 from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select f1 from tbb union select f1 from tbb) order by a.ts, a.f1;
           ts            |     f1      | (select f1 from tbb union select f1 from tbb) |           ts            |     f1      |
================================================================================================================================
 2025-12-02 00:00:00.000 |           1 |                                             1 | 2025-12-02 00:00:00.000 |           1 |

taos> select a.*, (select f1 from tbb union all select f1 from tbb), b.* from tbb a left join tbb b on a.ts = b.ts and b.f1 = (select f1 from tbb union all select f1 from tbb) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tbb where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from tbb where f1 != (select f1 from tbb) order by f1;

taos> select f1 from tbb where f1 != (select f1 from tbb order by ts, f1 limit 1) order by f1;

taos> select f1 from tbb where f1 != (select count(*) from tbb) order by f1;

taos> select f1 from tbb where f1 != (select null from tbb) order by f1;

taos> select f1 from tbb where f1 != (select * from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tbb where f1 != (select 2 from tbb) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tbb where f1 != (select avg(f1) from tbb) order by f1;

taos> select f1 from tbb where f1 != (select last(*) from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tbb where f1 != (select max(f1) from tbb partition by f1) order by f1;

taos> select f1 from tbb where f1 != (select a.ts from tbb a join tbb b on a.ts = b.ts) order by f1;
     f1      |
==============
           1 |

taos> select f1 from tbb where f1 != (select sum(f1) from tbb interval(1d)) order by f1;

taos> select f1 from tbb where f1 != (select f1 from tbb union select f1 from tbb) order by f1;

taos> select f1 from tbb where f1 != (select f1 from tbb union all select f1 from tbb) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tbb where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbb) from tbb where f1 = (select f1 from tbb) order by f1;
     f1      | (select f1 from tbb) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tbb order by ts, f1 limit 1) from tbb where f1 = (select f1 from tbb order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from tbb order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from tbb) from tbb where f1 = (select count(*) from tbb) order by f1;
     f1      | (select count(*) from tbb) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tbb) from tbb where f1 = (select null from tbb) order by f1;

taos> select f1, (select * from tbb) from tbb where f1 = (select * from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbb) from tbb where f1 = (select 2 from tbb) order by f1;

taos> select f1, (select avg(f1) from tbb) from tbb where f1 = (select avg(f1) from tbb) order by f1;
     f1      | (select avg(f1) from tbb) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tbb) from tbb where f1 = (select last(*) from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbb partition by f1) from tbb where f1 = (select max(f1) from tbb partition by f1) order by f1;
     f1      | (select max(f1) from tbb partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb where f1 = (select a.ts from tbb a join tbb b on a.ts = b.ts) order by f1;

taos> select f1, (select sum(f1) from tbb interval(1d)) from tbb where f1 = (select sum(f1) from tbb interval(1d)) order by f1;
     f1      | (select sum(f1) from tbb interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tbb union select f1 from tbb) from tbb where f1 = (select f1 from tbb union select f1 from tbb) order by f1;
     f1      | (select f1 from tbb union select f1 from tbb) |
==============================================================
           1 |                                             1 |

taos> select f1, (select f1 from tbb union all select f1 from tbb) from tbb where f1 = (select f1 from tbb union all select f1 from tbb) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from tbb where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select f1 from tbb));

DB error: syntax error near "(select f1 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select f1 from tbb order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tbb order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select count(*) from tbb));

DB error: syntax error near "(select count(*) from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select null from tbb));

DB error: syntax error near "(select null from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select * from tbb));

DB error: syntax error near "(select * from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select 2 from tbb));

DB error: syntax error near "(select 2 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select avg(f1) from tbb));

DB error: syntax error near "(select avg(f1) from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select last(*) from tbb));

DB error: syntax error near "(select last(*) from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select max(f1) from tbb partition by f1));

DB error: syntax error near "(select max(f1) from tbb partition by f1));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select a.ts from tbb a join tbb b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tbb a join tbb b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select sum(f1) from tbb interval(1d)));

DB error: syntax error near "(select sum(f1) from tbb interval(1d)));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select f1 from tbb union select f1 from tbb));

DB error: syntax error near "(select f1 from tbb union select f1 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 in ((select f1 from tbb union all select f1 from tbb));

DB error: syntax error near "(select f1 from tbb union all select f1 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select f1 from tbb));

DB error: syntax error near "(select f1 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select f1 from tbb order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tbb order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select count(*) from tbb));

DB error: syntax error near "(select count(*) from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select null from tbb));

DB error: syntax error near "(select null from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select * from tbb));

DB error: syntax error near "(select * from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select 2 from tbb));

DB error: syntax error near "(select 2 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select avg(f1) from tbb));

DB error: syntax error near "(select avg(f1) from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select last(*) from tbb));

DB error: syntax error near "(select last(*) from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select max(f1) from tbb partition by f1));

DB error: syntax error near "(select max(f1) from tbb partition by f1));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select a.ts from tbb a join tbb b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tbb a join tbb b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select sum(f1) from tbb interval(1d)));

DB error: syntax error near "(select sum(f1) from tbb interval(1d)));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select f1 from tbb union select f1 from tbb));

DB error: syntax error near "(select f1 from tbb union select f1 from tbb));" [0x80002600] 
taos> select f1 from tbb where f1 not in ((select f1 from tbb union all select f1 from tbb));

DB error: syntax error near "(select f1 from tbb union all select f1 from tbb));" [0x80002600] 
taos> select (select 1) from tbb where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) from tbb where (select f1 from tbb) is null order by f1;

taos> select (select f1 from tbb order by ts, f1 limit 1) from tbb where (select f1 from tbb order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from tbb) from tbb where (select count(*) from tbb) is null order by f1;

taos> select (select null from tbb) from tbb where (select null from tbb) is null order by f1;
 (select null from tbb) |
=========================
 NULL                   |

taos> select (select * from tbb) from tbb where (select * from tbb) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) from tbb where (select 2 from tbb) is null order by f1;

taos> select (select avg(f1) from tbb) from tbb where (select avg(f1) from tbb) is null order by f1;

taos> select (select last(*) from tbb) from tbb where (select last(*) from tbb) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) from tbb where (select max(f1) from tbb partition by f1) is null order by f1;

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb where (select a.ts from tbb a join tbb b on a.ts = b.ts) is null order by f1;

taos> select (select sum(f1) from tbb interval(1d)) from tbb where (select sum(f1) from tbb interval(1d)) is null order by f1;

taos> select (select f1 from tbb union select f1 from tbb) from tbb where (select f1 from tbb union select f1 from tbb) is null order by f1;

taos> select (select f1 from tbb union all select f1 from tbb) from tbb where (select f1 from tbb union all select f1 from tbb) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) from tbb where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb) from tbb where (select f1 from tbb) is not null order by f1;
 (select f1 from tbb) |
=======================
                    1 |

taos> select (select f1 from tbb order by ts, f1 limit 1) from tbb where (select f1 from tbb order by ts, f1 limit 1) is not null order by f1;
 (select f1 from tbb order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select (select count(*) from tbb) from tbb where (select count(*) from tbb) is not null order by f1;
 (select count(*) from tbb) |
=============================
                          1 |

taos> select (select null from tbb) from tbb where (select null from tbb) is not null order by f1;

taos> select (select * from tbb) from tbb where (select * from tbb) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb) from tbb where (select 2 from tbb) is not null order by f1;
  (select 2 from tbb)  |
========================
                     2 |

taos> select (select avg(f1) from tbb) from tbb where (select avg(f1) from tbb) is not null order by f1;
 (select avg(f1) from tbb) |
============================
                         1 |

taos> select (select last(*) from tbb) from tbb where (select last(*) from tbb) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1) from tbb where (select max(f1) from tbb partition by f1) is not null order by f1;
 (select max(f1) from tbb partition by f1) |
============================================
                                         1 |

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb where (select a.ts from tbb a join tbb b on a.ts = b.ts) is not null order by f1;
 (select a.ts from tbb a join tbb b on a.ts = b.ts) |
=====================================================
 2025-12-02 00:00:00.000 |

taos> select (select sum(f1) from tbb interval(1d)) from tbb where (select sum(f1) from tbb interval(1d)) is not null order by f1;
 (select sum(f1) from tbb interval(1d)) |
=========================================
                                      1 |

taos> select (select f1 from tbb union select f1 from tbb) from tbb where (select f1 from tbb union select f1 from tbb) is not null order by f1;
 (select f1 from tbb union select f1 from tbb) |
================================================
                                             1 |

taos> select (select f1 from tbb union all select f1 from tbb) from tbb where (select f1 from tbb union all select f1 from tbb) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select 1) as varchar) from tbb where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from tbb) as varchar) from tbb where abs((select f1 from tbb)) > 0 order by f1;
     f1      | cast((select f1 from tbb) as varchar) |
======================================================
           1 | 1                                     |

taos> select f1, cast((select f1 from tbb order by ts, f1 limit 1) as varchar) from tbb where abs((select f1 from tbb order by ts, f1 limit 1)) > 0 order by f1;
     f1      | cast((select f1 from tbb order by ts, f1 limit 1) as varchar) |
==============================================================================
           1 | 1                                                             |

taos> select f1, cast((select count(*) from tbb) as varchar) from tbb where abs((select count(*) from tbb)) > 0 order by f1;
     f1      | cast((select count(*) from tbb) as varchar) |
============================================================
           1 | 1                                           |

taos> select f1, cast((select null from tbb) as varchar) from tbb where abs((select null from tbb)) > 0 order by f1;

taos> select f1, cast((select * from tbb) as varchar) from tbb where abs((select * from tbb)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from tbb) as varchar) from tbb where abs((select 2 from tbb)) > 0 order by f1;
     f1      | cast((select 2 from tbb) as varchar) |
=====================================================
           1 | 2                                    |

taos> select f1, cast((select avg(f1) from tbb) as varchar) from tbb where abs((select avg(f1) from tbb)) > 0 order by f1;
     f1      | cast((select avg(f1) from tbb) as varchar) |
===========================================================
           1 | 1                                          |

taos> select f1, cast((select last(*) from tbb) as varchar) from tbb where abs((select last(*) from tbb)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from tbb partition by f1) as varchar) from tbb where abs((select max(f1) from tbb partition by f1)) > 0 order by f1;
     f1      | cast((select max(f1) from tbb partition by f1) as varchar) |
===========================================================================
           1 | 1                                                          |

taos> select f1, cast((select a.ts from tbb a join tbb b on a.ts = b.ts) as varchar) from tbb where abs((select a.ts from tbb a join tbb b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from tbb interval(1d)) as varchar) from tbb where abs((select sum(f1) from tbb interval(1d))) > 0 order by f1;
     f1      | cast((select sum(f1) from tbb interval(1d)) as varchar) |
========================================================================
           1 | 1                                                       |

taos> select f1, cast((select f1 from tbb union select f1 from tbb) as varchar) from tbb where abs((select f1 from tbb union select f1 from tbb)) > 0 order by f1;
     f1      | cast((select f1 from tbb union select f1 from tbb) as varchar) |
===============================================================================
           1 | 1                                                              |

taos> select f1, cast((select f1 from tbb union all select f1 from tbb) as varchar) from tbb where abs((select f1 from tbb union all select f1 from tbb)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tbb where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbb) from tbb where f1 > (select f1 from tbb) or f1 < (select f1 from tbb) order by f1;

taos> select f1, (select f1 from tbb order by ts, f1 limit 1) from tbb where f1 > (select f1 from tbb order by ts, f1 limit 1) or f1 < (select f1 from tbb order by ts, f1 limit 1) order by f1;

taos> select f1, (select count(*) from tbb) from tbb where f1 > (select count(*) from tbb) or f1 < (select count(*) from tbb) order by f1;

taos> select f1, (select null from tbb) from tbb where f1 > (select null from tbb) or f1 < (select null from tbb) order by f1;

taos> select f1, (select * from tbb) from tbb where f1 > (select * from tbb) or f1 < (select * from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbb) from tbb where f1 > (select 2 from tbb) or f1 < (select 2 from tbb) order by f1;
     f1      |  (select 2 from tbb)  |
======================================
           1 |                     2 |

taos> select f1, (select avg(f1) from tbb) from tbb where f1 > (select avg(f1) from tbb) or f1 < (select avg(f1) from tbb) order by f1;

taos> select f1, (select last(*) from tbb) from tbb where f1 > (select last(*) from tbb) or f1 < (select last(*) from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbb partition by f1) from tbb where f1 > (select max(f1) from tbb partition by f1) or f1 < (select max(f1) from tbb partition by f1) order by f1;

taos> select f1, (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb where f1 > (select a.ts from tbb a join tbb b on a.ts = b.ts) or f1 < (select a.ts from tbb a join tbb b on a.ts = b.ts) order by f1;
     f1      | (select a.ts from tbb a join tbb b on a.ts = b.ts) |
===================================================================
           1 | 2025-12-02 00:00:00.000 |

taos> select f1, (select sum(f1) from tbb interval(1d)) from tbb where f1 > (select sum(f1) from tbb interval(1d)) or f1 < (select sum(f1) from tbb interval(1d)) order by f1;

taos> select f1, (select f1 from tbb union select f1 from tbb) from tbb where f1 > (select f1 from tbb union select f1 from tbb) or f1 < (select f1 from tbb union select f1 from tbb) order by f1;

taos> select f1, (select f1 from tbb union all select f1 from tbb) from tbb where f1 > (select f1 from tbb union all select f1 from tbb) or f1 < (select f1 from tbb union all select f1 from tbb) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from tbb where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbb) from tbb where f1 between (select f1 from tbb) and (select f1 from tbb) + 1 order by f1;
     f1      | (select f1 from tbb) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tbb order by ts, f1 limit 1) from tbb where f1 between (select f1 from tbb order by ts, f1 limit 1) and (select f1 from tbb order by ts, f1 limit 1) + 1 order by f1;
     f1      | (select f1 from tbb order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from tbb) from tbb where f1 between (select count(*) from tbb) and (select count(*) from tbb) + 1 order by f1;
     f1      | (select count(*) from tbb) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tbb) from tbb where f1 between (select null from tbb) and (select null from tbb) + 1 order by f1;

taos> select f1, (select * from tbb) from tbb where f1 between (select * from tbb) and (select * from tbb) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbb) from tbb where f1 between (select 2 from tbb) and (select 2 from tbb) + 1 order by f1;

taos> select f1, (select avg(f1) from tbb) from tbb where f1 between (select avg(f1) from tbb) and (select avg(f1) from tbb) + 1 order by f1;
     f1      | (select avg(f1) from tbb) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tbb) from tbb where f1 between (select last(*) from tbb) and (select last(*) from tbb) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbb partition by f1) from tbb where f1 between (select max(f1) from tbb partition by f1) and (select max(f1) from tbb partition by f1) + 1 order by f1;
     f1      | (select max(f1) from tbb partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tbb a join tbb b on a.ts = b.ts) from tbb where f1 between (select a.ts from tbb a join tbb b on a.ts = b.ts) and (select a.ts from tbb a join tbb b on a.ts = b.ts) + 1 order by f1;

taos> select f1, (select sum(f1) from tbb interval(1d)) from tbb where f1 between (select sum(f1) from tbb interval(1d)) and (select sum(f1) from tbb interval(1d)) + 1 order by f1;
     f1      | (select sum(f1) from tbb interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tbb union select f1 from tbb) from tbb where f1 between (select f1 from tbb union select f1 from tbb) and (select f1 from tbb union select f1 from tbb) + 1 order by f1;
     f1      | (select f1 from tbb union select f1 from tbb) |
==============================================================
           1 |                                             1 |

taos> select f1, (select f1 from tbb union all select f1 from tbb) from tbb where f1 between (select f1 from tbb union all select f1 from tbb) and (select f1 from tbb union all select f1 from tbb) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) > 0 from tbb where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbb), (select f1 from tbb) > 0 from tbb where (select f1 from tbb) > 0 and f1 > (select f1 from tbb) order by f1;

taos> select (select f1 from tbb order by ts, f1 limit 1), (select f1 from tbb order by ts, f1 limit 1) > 0 from tbb where (select f1 from tbb order by ts, f1 limit 1) > 0 and f1 > (select f1 from tbb order by ts, f1 limit 1) order by f1;

taos> select (select count(*) from tbb), (select count(*) from tbb) > 0 from tbb where (select count(*) from tbb) > 0 and f1 > (select count(*) from tbb) order by f1;

taos> select (select null from tbb), (select null from tbb) > 0 from tbb where (select null from tbb) > 0 and f1 > (select null from tbb) order by f1;

taos> select (select * from tbb), (select * from tbb) > 0 from tbb where (select * from tbb) > 0 and f1 > (select * from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbb), (select 2 from tbb) > 0 from tbb where (select 2 from tbb) > 0 and f1 > (select 2 from tbb) order by f1;

taos> select (select avg(f1) from tbb), (select avg(f1) from tbb) > 0 from tbb where (select avg(f1) from tbb) > 0 and f1 > (select avg(f1) from tbb) order by f1;

taos> select (select last(*) from tbb), (select last(*) from tbb) > 0 from tbb where (select last(*) from tbb) > 0 and f1 > (select last(*) from tbb) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbb partition by f1), (select max(f1) from tbb partition by f1) > 0 from tbb where (select max(f1) from tbb partition by f1) > 0 and f1 > (select max(f1) from tbb partition by f1) order by f1;

taos> select (select a.ts from tbb a join tbb b on a.ts = b.ts), (select a.ts from tbb a join tbb b on a.ts = b.ts) > 0 from tbb where (select a.ts from tbb a join tbb b on a.ts = b.ts) > 0 and f1 > (select a.ts from tbb a join tbb b on a.ts = b.ts) order by f1;

taos> select (select sum(f1) from tbb interval(1d)), (select sum(f1) from tbb interval(1d)) > 0 from tbb where (select sum(f1) from tbb interval(1d)) > 0 and f1 > (select sum(f1) from tbb interval(1d)) order by f1;

taos> select (select f1 from tbb union select f1 from tbb), (select f1 from tbb union select f1 from tbb) > 0 from tbb where (select f1 from tbb union select f1 from tbb) > 0 and f1 > (select f1 from tbb union select f1 from tbb) order by f1;

taos> select (select f1 from tbb union all select f1 from tbb), (select f1 from tbb union all select f1 from tbb) > 0 from tbb where (select f1 from tbb union all select f1 from tbb) > 0 and f1 > (select f1 from tbb union all select f1 from tbb) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbe order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from tbe partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from tbe interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbe union select f1 from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from tbe union all select f1 from tbe);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) from tbe;

taos> select (select f1 from tbe order by ts, f1 limit 1) from tbe;

taos> select (select count(*) from tbe) from tbe;

taos> select (select null from tbe) from tbe;

taos> select (select * from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) from tbe;

taos> select (select avg(f1) from tbe) from tbe;

taos> select (select last(*) from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) from tbe;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe;

taos> select (select sum(f1) from tbe interval(1d)) from tbe;

taos> select (select f1 from tbe union select f1 from tbe) from tbe;

taos> select (select f1 from tbe union all select f1 from tbe) from tbe;

taos> select (select 1) a from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) a from tbe;

taos> select (select f1 from tbe order by ts, f1 limit 1) a from tbe;

taos> select (select count(*) from tbe) a from tbe;

taos> select (select null from tbe) a from tbe;

taos> select (select * from tbe) a from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) a from tbe;

taos> select (select avg(f1) from tbe) a from tbe;

taos> select (select last(*) from tbe) a from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) a from tbe;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) a from tbe;

taos> select (select sum(f1) from tbe interval(1d)) a from tbe;

taos> select (select f1 from tbe union select f1 from tbe) a from tbe;

taos> select (select f1 from tbe union all select f1 from tbe) a from tbe;

taos> select tags (select 1) from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from tbe) from tbe;
 (select f1 from tbe) |
=======================
 NULL                 |

taos> select tags (select f1 from tbe order by ts, f1 limit 1) from tbe;
 (select f1 from tbe order by ts, f1 limit 1) |
===============================================
 NULL                                         |

taos> select tags (select count(*) from tbe) from tbe;
 (select count(*) from tbe) |
=============================
                          0 |

taos> select tags (select null from tbe) from tbe;
 (select null from tbe) |
=========================
 NULL                   |

taos> select tags (select * from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from tbe) from tbe;
  (select 2 from tbe)  |
========================
 NULL                  |

taos> select tags (select avg(f1) from tbe) from tbe;
 (select avg(f1) from tbe) |
============================
 NULL                      |

taos> select tags (select last(*) from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from tbe partition by f1) from tbe;
 (select max(f1) from tbe partition by f1) |
============================================
 NULL                                      |

taos> select tags (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe;
 (select a.ts from tbe a join tbe b on a.ts = b.ts) |
=====================================================
 NULL                                               |

taos> select tags (select sum(f1) from tbe interval(1d)) from tbe;
 (select sum(f1) from tbe interval(1d)) |
=========================================
 NULL                                   |

taos> select tags (select f1 from tbe union select f1 from tbe) from tbe;
 (select f1 from tbe union select f1 from tbe) |
================================================
 NULL                                          |

taos> select tags (select f1 from tbe union all select f1 from tbe) from tbe;
 (select f1 from tbe union all select f1 from tbe) |
====================================================
 NULL                                              |

taos> select distinct (select 1) from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tbe) from tbe;

taos> select distinct (select f1 from tbe order by ts, f1 limit 1) from tbe;

taos> select distinct (select count(*) from tbe) from tbe;

taos> select distinct (select null from tbe) from tbe;

taos> select distinct (select * from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tbe) from tbe;

taos> select distinct (select avg(f1) from tbe) from tbe;

taos> select distinct (select last(*) from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tbe partition by f1) from tbe;

taos> select distinct (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe;

taos> select distinct (select sum(f1) from tbe interval(1d)) from tbe;

taos> select distinct (select f1 from tbe union select f1 from tbe) from tbe;

taos> select distinct (select f1 from tbe union all select f1 from tbe) from tbe;

taos> select distinct (select 1), f1 from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from tbe), f1 from tbe;

taos> select distinct (select f1 from tbe order by ts, f1 limit 1), f1 from tbe;

taos> select distinct (select count(*) from tbe), f1 from tbe;

taos> select distinct (select null from tbe), f1 from tbe;

taos> select distinct (select * from tbe), f1 from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from tbe), f1 from tbe;

taos> select distinct (select avg(f1) from tbe), f1 from tbe;

taos> select distinct (select last(*) from tbe), f1 from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from tbe partition by f1), f1 from tbe;

taos> select distinct (select a.ts from tbe a join tbe b on a.ts = b.ts), f1 from tbe;

taos> select distinct (select sum(f1) from tbe interval(1d)), f1 from tbe;

taos> select distinct (select f1 from tbe union select f1 from tbe), f1 from tbe;

taos> select distinct (select f1 from tbe union all select f1 from tbe), f1 from tbe;

taos> select distinct tags (select 1) + 1 from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from tbe) + 1 from tbe;
 (select f1 from tbe) + 1  |
============================
 NULL                      |

taos> select distinct tags (select f1 from tbe order by ts, f1 limit 1) + 1 from tbe;
 (select f1 from tbe order by ts, f1 limit 1) + 1 |
===================================================
 NULL                                             |

taos> select distinct tags (select count(*) from tbe) + 1 from tbe;
 (select count(*) from tbe) + 1 |
=================================
                              1 |

taos> select distinct tags (select null from tbe) + 1 from tbe;
 (select null from tbe) + 1 |
=============================
 NULL                       |

taos> select distinct tags (select * from tbe) + 1 from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from tbe) + 1 from tbe;
  (select 2 from tbe) + 1  |
============================
 NULL                      |

taos> select distinct tags (select avg(f1) from tbe) + 1 from tbe;
 (select avg(f1) from tbe) + 1 |
================================
 NULL                          |

taos> select distinct tags (select last(*) from tbe) + 1 from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from tbe partition by f1) + 1 from tbe;
 (select max(f1) from tbe partition by f1) + 1 |
================================================
 NULL                                          |

taos> select distinct tags (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1 from tbe;
 (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1 |
=========================================================
 NULL                                                   |

taos> select distinct tags (select sum(f1) from tbe interval(1d)) + 1 from tbe;
 (select sum(f1) from tbe interval(1d)) + 1 |
=============================================
 NULL                                       |

taos> select distinct tags (select f1 from tbe union select f1 from tbe) + 1 from tbe;
 (select f1 from tbe union select f1 from tbe) + 1 |
====================================================
 NULL                                              |

taos> select distinct tags (select f1 from tbe union all select f1 from tbe) + 1 from tbe;
 (select f1 from tbe union all select f1 from tbe) + 1 |
========================================================
 NULL                                                  |

taos> select (select 1), (select 1) from tbe;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe), (select f1 from tbe) from tbe;

taos> select (select f1 from tbe order by ts, f1 limit 1), (select f1 from tbe order by ts, f1 limit 1) from tbe;

taos> select (select count(*) from tbe), (select count(*) from tbe) from tbe;

taos> select (select null from tbe), (select null from tbe) from tbe;

taos> select (select * from tbe), (select * from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe), (select 2 from tbe) from tbe;

taos> select (select avg(f1) from tbe), (select avg(f1) from tbe) from tbe;

taos> select (select last(*) from tbe), (select last(*) from tbe) from tbe;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1), (select max(f1) from tbe partition by f1) from tbe;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts), (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe;

taos> select (select sum(f1) from tbe interval(1d)), (select sum(f1) from tbe interval(1d)) from tbe;

taos> select (select f1 from tbe union select f1 from tbe), (select f1 from tbe union select f1 from tbe) from tbe;

taos> select (select f1 from tbe union all select f1 from tbe), (select f1 from tbe union all select f1 from tbe) from tbe;

taos> select 1, (select 1) from tbe order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from tbe) from tbe order by ts;

taos> select 1, (select f1 from tbe order by ts, f1 limit 1) from tbe order by ts;

taos> select 1, (select count(*) from tbe) from tbe order by ts;

taos> select 1, (select null from tbe) from tbe order by ts;

taos> select 1, (select * from tbe) from tbe order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from tbe) from tbe order by ts;

taos> select 1, (select avg(f1) from tbe) from tbe order by ts;

taos> select 1, (select last(*) from tbe) from tbe order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from tbe partition by f1) from tbe order by ts;

taos> select 1, (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe order by ts;

taos> select 1, (select sum(f1) from tbe interval(1d)) from tbe order by ts;

taos> select 1, (select f1 from tbe union select f1 from tbe) from tbe order by ts;

taos> select 1, (select f1 from tbe union all select f1 from tbe) from tbe order by ts;

taos> select (select 1), * from tbe order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe), * from tbe order by ts, f1;

taos> select (select f1 from tbe order by ts, f1 limit 1), * from tbe order by ts, f1;

taos> select (select count(*) from tbe), * from tbe order by ts, f1;

taos> select (select null from tbe), * from tbe order by ts, f1;

taos> select (select * from tbe), * from tbe order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe), * from tbe order by ts, f1;

taos> select (select avg(f1) from tbe), * from tbe order by ts, f1;

taos> select (select last(*) from tbe), * from tbe order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1), * from tbe order by ts, f1;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts), * from tbe order by ts, f1;

taos> select (select sum(f1) from tbe interval(1d)), * from tbe order by ts, f1;

taos> select (select f1 from tbe union select f1 from tbe), * from tbe order by ts, f1;

taos> select (select f1 from tbe union all select f1 from tbe), * from tbe order by ts, f1;

taos> select (select 1) * (select 1), * from tbe order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) * (select f1 from tbe), * from tbe order by ts, f1;

taos> select (select f1 from tbe order by ts, f1 limit 1) * (select f1 from tbe order by ts, f1 limit 1), * from tbe order by ts, f1;

taos> select (select count(*) from tbe) * (select count(*) from tbe), * from tbe order by ts, f1;

taos> select (select null from tbe) * (select null from tbe), * from tbe order by ts, f1;

taos> select (select * from tbe) * (select * from tbe), * from tbe order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) * (select 2 from tbe), * from tbe order by ts, f1;

taos> select (select avg(f1) from tbe) * (select avg(f1) from tbe), * from tbe order by ts, f1;

taos> select (select last(*) from tbe) * (select last(*) from tbe), * from tbe order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) * (select max(f1) from tbe partition by f1), * from tbe order by ts, f1;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) * (select a.ts from tbe a join tbe b on a.ts = b.ts), * from tbe order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tbe interval(1d)) * (select sum(f1) from tbe interval(1d)), * from tbe order by ts, f1;

taos> select (select f1 from tbe union select f1 from tbe) * (select f1 from tbe union select f1 from tbe), * from tbe order by ts, f1;

taos> select (select f1 from tbe union all select f1 from tbe) * (select f1 from tbe union all select f1 from tbe), * from tbe order by ts, f1;

taos> select {funcName}((select 1)) from tbe;

DB error: unrecognized token: "{funcname}((select 1)) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts, f1 limit 1)) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts, f1 limit 1)) from tbe;" [0x80002600] 
taos> select {funcName}((select count(*) from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select count(*) from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select null from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select null from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select * from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select * from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select 2 from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select 2 from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select avg(f1) from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select last(*) from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select last(*) from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select max(f1) from tbe partition by f1)) from tbe;

DB error: unrecognized token: "{funcname}((select max(f1) from tbe partition by f1)) from tbe;" [0x80002600] 
taos> select {funcName}((select a.ts from tbe a join tbe b on a.ts = b.ts)) from tbe;

DB error: unrecognized token: "{funcname}((select a.ts from tbe a join tbe b on a.ts = b.ts)) from tbe;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbe interval(1d))) from tbe;

DB error: unrecognized token: "{funcname}((select sum(f1) from tbe interval(1d))) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe union select f1 from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe union select f1 from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe union all select f1 from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe union all select f1 from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts, f1 limit 1) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts, f1 limit 1) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select count(*) from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select count(*) from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select null from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select null from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select * from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select * from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select 2 from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select 2 from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select avg(f1) from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select last(*) from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select last(*) from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select max(f1) from tbe partition by f1) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select max(f1) from tbe partition by f1) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select a.ts from tbe a join tbe b on a.ts = b.ts) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select a.ts from tbe a join tbe b on a.ts = b.ts) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbe interval(1d)) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select sum(f1) from tbe interval(1d)) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe union select f1 from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe union select f1 from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe union all select f1 from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe union all select f1 from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts, f1 limit 1) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts, f1 limit 1) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select count(*) from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select count(*) from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select null from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select null from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select * from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select * from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select 2 from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select 2 from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select avg(f1) from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select last(*) from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select last(*) from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select max(f1) from tbe partition by f1) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select max(f1) from tbe partition by f1) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select a.ts from tbe a join tbe b on a.ts = b.ts) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select a.ts from tbe a join tbe b on a.ts = b.ts) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbe interval(1d)) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select sum(f1) from tbe interval(1d)) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe union select f1 from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe union select f1 from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe union all select f1 from tbe) + 1) + 2 from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe union all select f1 from tbe) + 1) + 2 from tbe;" [0x80002600] 
taos> select (select 1) + (select 1) from tbe partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) + (select f1 from tbe) from tbe partition by tbname;

taos> select (select f1 from tbe order by ts, f1 limit 1) + (select f1 from tbe order by ts, f1 limit 1) from tbe partition by tbname;

taos> select (select count(*) from tbe) + (select count(*) from tbe) from tbe partition by tbname;

taos> select (select null from tbe) + (select null from tbe) from tbe partition by tbname;

taos> select (select * from tbe) + (select * from tbe) from tbe partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) + (select 2 from tbe) from tbe partition by tbname;

taos> select (select avg(f1) from tbe) + (select avg(f1) from tbe) from tbe partition by tbname;

taos> select (select last(*) from tbe) + (select last(*) from tbe) from tbe partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) + (select max(f1) from tbe partition by f1) from tbe partition by tbname;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) + (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tbe interval(1d)) + (select sum(f1) from tbe interval(1d)) from tbe partition by tbname;

taos> select (select f1 from tbe union select f1 from tbe) + (select f1 from tbe union select f1 from tbe) from tbe partition by tbname;

taos> select (select f1 from tbe union all select f1 from tbe) + (select f1 from tbe union all select f1 from tbe) from tbe partition by tbname;

taos> select (select 1) + f1 from tbe partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) + f1 from tbe partition by f1;

taos> select (select f1 from tbe order by ts, f1 limit 1) + f1 from tbe partition by f1;

taos> select (select count(*) from tbe) + f1 from tbe partition by f1;

taos> select (select null from tbe) + f1 from tbe partition by f1;

taos> select (select * from tbe) + f1 from tbe partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) + f1 from tbe partition by f1;

taos> select (select avg(f1) from tbe) + f1 from tbe partition by f1;

taos> select (select last(*) from tbe) + f1 from tbe partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) + f1 from tbe partition by f1;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) + f1 from tbe partition by f1;

taos> select (select sum(f1) from tbe interval(1d)) + f1 from tbe partition by f1;

taos> select (select f1 from tbe union select f1 from tbe) + f1 from tbe partition by f1;

taos> select (select f1 from tbe union all select f1 from tbe) + f1 from tbe partition by f1;

taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select f1 from tbe order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select count(*) from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select null from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select * from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select avg(f1) from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select last(*) from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from tbe partition by f1) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select a.ts from tbe a join tbe b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select sum(f1) from tbe interval(1d)) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select f1 from tbe union select f1 from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when (select f1 from tbe union all select f1 from tbe) > 0 then 1 else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tbe group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select f1 from tbe order by ts, f1 limit 1) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select count(*) from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select null from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select * from tbe) else 2 end, sum(f1) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select avg(f1) from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select last(*) from tbe) else 2 end, sum(f1) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tbe partition by f1) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select a.ts from tbe a join tbe b on a.ts = b.ts) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select sum(f1) from tbe interval(1d)) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select f1 from tbe union select f1 from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 2 / (select f1 from tbe union all select f1 from tbe) else 2 end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tbe group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from tbe) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select f1 from tbe order by ts, f1 limit 1) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select count(*) from tbe) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select null from tbe) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select * from tbe) is null end, sum(f1) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from tbe) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select avg(f1) from tbe) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select last(*) from tbe) is null end, sum(f1) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tbe partition by f1) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select a.ts from tbe a join tbe b on a.ts = b.ts) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select sum(f1) from tbe interval(1d)) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select f1 from tbe union select f1 from tbe) is null end, sum(f1) from tbe group by f1;

taos> select case when f1 = 1 then 1 else (select f1 from tbe union all select f1 from tbe) is null end, sum(f1) from tbe group by f1;

taos> select _wstart, (select 1), avg(f1) from tbe interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select f1 from tbe order by ts, f1 limit 1), avg(f1) from tbe interval(1d);

taos> select _wstart, (select count(*) from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select null from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select * from tbe), avg(f1) from tbe interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select avg(f1) from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select last(*) from tbe), avg(f1) from tbe interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tbe partition by f1), avg(f1) from tbe interval(1d);

taos> select _wstart, (select a.ts from tbe a join tbe b on a.ts = b.ts), avg(f1) from tbe interval(1d);

taos> select _wstart, (select sum(f1) from tbe interval(1d)), avg(f1) from tbe interval(1d);

taos> select _wstart, (select f1 from tbe union select f1 from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select f1 from tbe union all select f1 from tbe), avg(f1) from tbe interval(1d);

taos> select (select 1) + 1, avg(f1) from tbe interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select f1 from tbe order by ts, f1 limit 1) + 1, avg(f1) from tbe interval(1d);

taos> select (select count(*) from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select null from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select * from tbe) + 1, avg(f1) from tbe interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select avg(f1) from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select last(*) from tbe) + 1, avg(f1) from tbe interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) + 1, avg(f1) from tbe interval(1d);

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1, avg(f1) from tbe interval(1d);

taos> select (select sum(f1) from tbe interval(1d)) + 1, avg(f1) from tbe interval(1d);

taos> select (select f1 from tbe union select f1 from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select f1 from tbe union all select f1 from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select {funcName}((select 1)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts, f1 limit 1)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts, f1 limit 1)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select * from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tbe partition by f1)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tbe partition by f1)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tbe a join tbe b on a.ts = b.ts)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tbe a join tbe b on a.ts = b.ts)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbe interval(1d))), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tbe interval(1d))), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe union select f1 from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe union select f1 from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe union all select f1 from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe union all select f1 from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts, f1 limit 1) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts, f1 limit 1) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select * from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tbe partition by f1) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tbe partition by f1) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tbe a join tbe b on a.ts = b.ts) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tbe a join tbe b on a.ts = b.ts) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tbe interval(1d)) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tbe interval(1d)) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe union select f1 from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe union select f1 from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe union all select f1 from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe union all select f1 from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select f1 from tbe order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select count(*) from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select null from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select * from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select avg(f1) from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select last(*) from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from tbe partition by f1) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select a.ts from tbe a join tbe b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select sum(f1) from tbe interval(1d)) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select f1 from tbe union select f1 from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select f1 from tbe union all select f1 from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select _wstart, (select 1), avg(f1) from tbe SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select f1 from tbe order by ts, f1 limit 1), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select count(*) from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select null from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select * from tbe), avg(f1) from tbe SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select avg(f1) from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select last(*) from tbe), avg(f1) from tbe SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from tbe partition by f1), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select a.ts from tbe a join tbe b on a.ts = b.ts), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select sum(f1) from tbe interval(1d)), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select f1 from tbe union select f1 from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select f1 from tbe union all select f1 from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select (select 1) + 1, avg(f1) from tbe SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select f1 from tbe order by ts, f1 limit 1) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select count(*) from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select null from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select * from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select avg(f1) from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select last(*) from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select sum(f1) from tbe interval(1d)) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select f1 from tbe union select f1 from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select f1 from tbe union all select f1 from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select 1) > 0 from tbe SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tbe order by ts, f1 limit 1) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tbe interval(1d)) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tbe union select f1 from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tbe union all select f1 from tbe) > 0 from tbe SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select f1 from tbe order by ts, f1 limit 1) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select count(*) from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select null from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select * from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select avg(f1) from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select last(*) from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from tbe partition by f1) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select a.ts from tbe a join tbe b on a.ts = b.ts) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select sum(f1) from tbe interval(1d)) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select f1 from tbe union select f1 from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when (select f1 from tbe union all select f1 from tbe) > 0 then 1 else 2 end) from tbe STATE_WINDOW(f1);

taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbe order by ts, f1 limit 1) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select null from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select * from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tbe partition by f1) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tbe a join tbe b on a.ts = b.ts) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tbe interval(1d)) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbe union select f1 from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tbe union all select f1 from tbe) as bigint) else 2 end) from tbe EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tbe COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select f1 from tbe order by ts, f1 limit 1) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select null from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select * from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tbe partition by f1) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select a.ts from tbe a join tbe b on a.ts = b.ts) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tbe interval(1d)) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select f1 from tbe union select f1 from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum(case when f1 = 1 then 1 else (select f1 from tbe union all select f1 from tbe) is null end + 1) from tbe COUNT_WINDOW(2);

taos> select sum((select 1)) from tbe partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from tbe)) from tbe partition by tbname interval(1d);

taos> select sum((select f1 from tbe order by ts, f1 limit 1)) from tbe partition by tbname interval(1d);

taos> select sum((select count(*) from tbe)) from tbe partition by tbname interval(1d);

taos> select sum((select null from tbe)) from tbe partition by tbname interval(1d);

taos> select sum((select * from tbe)) from tbe partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from tbe)) from tbe partition by tbname interval(1d);

taos> select sum((select avg(f1) from tbe)) from tbe partition by tbname interval(1d);

taos> select sum((select last(*) from tbe)) from tbe partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from tbe partition by f1)) from tbe partition by tbname interval(1d);

taos> select sum((select a.ts from tbe a join tbe b on a.ts = b.ts)) from tbe partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tbe interval(1d))) from tbe partition by tbname interval(1d);

taos> select sum((select f1 from tbe union select f1 from tbe)) from tbe partition by tbname interval(1d);

taos> select sum((select f1 from tbe union all select f1 from tbe)) from tbe partition by tbname interval(1d);

taos> select avg(abs((select 1) * -1)) from tbe partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select f1 from tbe order by ts, f1 limit 1) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select count(*) from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select null from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select * from tbe) * -1)) from tbe partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select avg(f1) from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select last(*) from tbe) * -1)) from tbe partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from tbe partition by f1) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select a.ts from tbe a join tbe b on a.ts = b.ts) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select sum(f1) from tbe interval(1d)) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select f1 from tbe union select f1 from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select avg(abs((select f1 from tbe union all select f1 from tbe) * -1)) from tbe partition by f1 interval(1d);

taos> select f1, (select 1) from tbe group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbe) from tbe group by f1;

taos> select f1, (select f1 from tbe order by ts, f1 limit 1) from tbe group by f1;

taos> select f1, (select count(*) from tbe) from tbe group by f1;

taos> select f1, (select null from tbe) from tbe group by f1;

taos> select f1, (select * from tbe) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbe) from tbe group by f1;

taos> select f1, (select avg(f1) from tbe) from tbe group by f1;

taos> select f1, (select last(*) from tbe) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbe partition by f1) from tbe group by f1;

taos> select f1, (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe group by f1;

taos> select f1, (select sum(f1) from tbe interval(1d)) from tbe group by f1;

taos> select f1, (select f1 from tbe union select f1 from tbe) from tbe group by f1;

taos> select f1, (select f1 from tbe union all select f1 from tbe) from tbe group by f1;

taos> select f1, (select 1), avg((select 1)) from tbe group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbe), avg((select f1 from tbe)) from tbe group by f1;

taos> select f1, (select f1 from tbe order by ts, f1 limit 1), avg((select f1 from tbe order by ts, f1 limit 1)) from tbe group by f1;

taos> select f1, (select count(*) from tbe), avg((select count(*) from tbe)) from tbe group by f1;

taos> select f1, (select null from tbe), avg((select null from tbe)) from tbe group by f1;

taos> select f1, (select * from tbe), avg((select * from tbe)) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbe), avg((select 2 from tbe)) from tbe group by f1;

taos> select f1, (select avg(f1) from tbe), avg((select avg(f1) from tbe)) from tbe group by f1;

taos> select f1, (select last(*) from tbe), avg((select last(*) from tbe)) from tbe group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbe partition by f1), avg((select max(f1) from tbe partition by f1)) from tbe group by f1;

taos> select f1, (select a.ts from tbe a join tbe b on a.ts = b.ts), avg((select a.ts from tbe a join tbe b on a.ts = b.ts)) from tbe group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from tbe interval(1d)), avg((select sum(f1) from tbe interval(1d))) from tbe group by f1;

taos> select f1, (select f1 from tbe union select f1 from tbe), avg((select f1 from tbe union select f1 from tbe)) from tbe group by f1;

taos> select f1, (select f1 from tbe union all select f1 from tbe), avg((select f1 from tbe union all select f1 from tbe)) from tbe group by f1;

taos> select b.f1, (select 1) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe) order by b.f1;

taos> select b.f1, (select f1 from tbe order by ts, f1 limit 1) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe order by ts, f1 limit 1) order by b.f1;

taos> select b.f1, (select count(*) from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select count(*) from tbe) order by b.f1;

taos> select b.f1, (select null from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select null from tbe) order by b.f1;

taos> select b.f1, (select * from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select * from tbe) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select 2 from tbe) order by b.f1;

taos> select b.f1, (select avg(f1) from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select avg(f1) from tbe) order by b.f1;

taos> select b.f1, (select last(*) from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select last(*) from tbe) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from tbe partition by f1) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select max(f1) from tbe partition by f1) order by b.f1;

taos> select b.f1, (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select a.ts from tbe a join tbe b on a.ts = b.ts) order by b.f1;

taos> select b.f1, (select sum(f1) from tbe interval(1d)) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select sum(f1) from tbe interval(1d)) order by b.f1;

taos> select b.f1, (select f1 from tbe union select f1 from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe union select f1 from tbe) order by b.f1;

taos> select b.f1, (select f1 from tbe union all select f1 from tbe) + 1 from tbe a join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe union all select f1 from tbe) order by b.f1;

taos> select (select 1) + 1, avg((select 1) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) + 1, avg((select f1 from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe);

taos> select (select f1 from tbe order by ts, f1 limit 1) + 1, avg((select f1 from tbe order by ts, f1 limit 1) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe order by ts, f1 limit 1);

taos> select (select count(*) from tbe) + 1, avg((select count(*) from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select count(*) from tbe);

taos> select (select null from tbe) + 1, avg((select null from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select null from tbe);

taos> select (select * from tbe) + 1, avg((select * from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select * from tbe);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) + 1, avg((select 2 from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select 2 from tbe);

taos> select (select avg(f1) from tbe) + 1, avg((select avg(f1) from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select avg(f1) from tbe);

taos> select (select last(*) from tbe) + 1, avg((select last(*) from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select last(*) from tbe);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) + 1, avg((select max(f1) from tbe partition by f1) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select max(f1) from tbe partition by f1);

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1, avg((select a.ts from tbe a join tbe b on a.ts = b.ts) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select a.ts from tbe a join tbe b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from tbe interval(1d)) + 1, avg((select sum(f1) from tbe interval(1d)) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select sum(f1) from tbe interval(1d));

taos> select (select f1 from tbe union select f1 from tbe) + 1, avg((select f1 from tbe union select f1 from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe union select f1 from tbe);

taos> select (select f1 from tbe union all select f1 from tbe) + 1, avg((select f1 from tbe union all select f1 from tbe) + 2) from tbe a left join tbe b on a.ts = b.ts and a.f1 = (select f1 from tbe union all select f1 from tbe);

taos> select a.*, (select 1), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select f1 from tbe) order by a.ts, a.f1;

taos> select a.*, (select f1 from tbe order by ts, f1 limit 1), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select f1 from tbe order by ts, f1 limit 1) order by a.ts, a.f1;

taos> select a.*, (select count(*) from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select count(*) from tbe) order by a.ts, a.f1;

taos> select a.*, (select null from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select null from tbe) order by a.ts, a.f1;

taos> select a.*, (select * from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select * from tbe) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select 2 from tbe) order by a.ts, a.f1;

taos> select a.*, (select avg(f1) from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select avg(f1) from tbe) order by a.ts, a.f1;

taos> select a.*, (select last(*) from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select last(*) from tbe) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from tbe partition by f1), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select max(f1) from tbe partition by f1) order by a.ts, a.f1;

taos> select a.*, (select a.ts from tbe a join tbe b on a.ts = b.ts), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select a.ts from tbe a join tbe b on a.ts = b.ts) order by a.ts, a.f1;

taos> select a.*, (select sum(f1) from tbe interval(1d)), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select sum(f1) from tbe interval(1d)) order by a.ts, a.f1;

taos> select a.*, (select f1 from tbe union select f1 from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select f1 from tbe union select f1 from tbe) order by a.ts, a.f1;

taos> select a.*, (select f1 from tbe union all select f1 from tbe), b.* from tbe a left join tbe b on a.ts = b.ts and b.f1 = (select f1 from tbe union all select f1 from tbe) order by a.ts, a.f1;

taos> select f1 from tbe where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from tbe where f1 != (select f1 from tbe) order by f1;

taos> select f1 from tbe where f1 != (select f1 from tbe order by ts, f1 limit 1) order by f1;

taos> select f1 from tbe where f1 != (select count(*) from tbe) order by f1;

taos> select f1 from tbe where f1 != (select null from tbe) order by f1;

taos> select f1 from tbe where f1 != (select * from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tbe where f1 != (select 2 from tbe) order by f1;

taos> select f1 from tbe where f1 != (select avg(f1) from tbe) order by f1;

taos> select f1 from tbe where f1 != (select last(*) from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from tbe where f1 != (select max(f1) from tbe partition by f1) order by f1;

taos> select f1 from tbe where f1 != (select a.ts from tbe a join tbe b on a.ts = b.ts) order by f1;

taos> select f1 from tbe where f1 != (select sum(f1) from tbe interval(1d)) order by f1;

taos> select f1 from tbe where f1 != (select f1 from tbe union select f1 from tbe) order by f1;

taos> select f1 from tbe where f1 != (select f1 from tbe union all select f1 from tbe) order by f1;

taos> select f1, (select 1) from tbe where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbe) from tbe where f1 = (select f1 from tbe) order by f1;

taos> select f1, (select f1 from tbe order by ts, f1 limit 1) from tbe where f1 = (select f1 from tbe order by ts, f1 limit 1) order by f1;

taos> select f1, (select count(*) from tbe) from tbe where f1 = (select count(*) from tbe) order by f1;

taos> select f1, (select null from tbe) from tbe where f1 = (select null from tbe) order by f1;

taos> select f1, (select * from tbe) from tbe where f1 = (select * from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbe) from tbe where f1 = (select 2 from tbe) order by f1;

taos> select f1, (select avg(f1) from tbe) from tbe where f1 = (select avg(f1) from tbe) order by f1;

taos> select f1, (select last(*) from tbe) from tbe where f1 = (select last(*) from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbe partition by f1) from tbe where f1 = (select max(f1) from tbe partition by f1) order by f1;

taos> select f1, (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe where f1 = (select a.ts from tbe a join tbe b on a.ts = b.ts) order by f1;

taos> select f1, (select sum(f1) from tbe interval(1d)) from tbe where f1 = (select sum(f1) from tbe interval(1d)) order by f1;

taos> select f1, (select f1 from tbe union select f1 from tbe) from tbe where f1 = (select f1 from tbe union select f1 from tbe) order by f1;

taos> select f1, (select f1 from tbe union all select f1 from tbe) from tbe where f1 = (select f1 from tbe union all select f1 from tbe) order by f1;

taos> select f1 from tbe where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select f1 from tbe));

DB error: syntax error near "(select f1 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select f1 from tbe order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tbe order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select count(*) from tbe));

DB error: syntax error near "(select count(*) from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select null from tbe));

DB error: syntax error near "(select null from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select * from tbe));

DB error: syntax error near "(select * from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select 2 from tbe));

DB error: syntax error near "(select 2 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select avg(f1) from tbe));

DB error: syntax error near "(select avg(f1) from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select last(*) from tbe));

DB error: syntax error near "(select last(*) from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select max(f1) from tbe partition by f1));

DB error: syntax error near "(select max(f1) from tbe partition by f1));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select a.ts from tbe a join tbe b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tbe a join tbe b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select sum(f1) from tbe interval(1d)));

DB error: syntax error near "(select sum(f1) from tbe interval(1d)));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select f1 from tbe union select f1 from tbe));

DB error: syntax error near "(select f1 from tbe union select f1 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 in ((select f1 from tbe union all select f1 from tbe));

DB error: syntax error near "(select f1 from tbe union all select f1 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select f1 from tbe));

DB error: syntax error near "(select f1 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select f1 from tbe order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from tbe order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select count(*) from tbe));

DB error: syntax error near "(select count(*) from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select null from tbe));

DB error: syntax error near "(select null from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select * from tbe));

DB error: syntax error near "(select * from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select 2 from tbe));

DB error: syntax error near "(select 2 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select avg(f1) from tbe));

DB error: syntax error near "(select avg(f1) from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select last(*) from tbe));

DB error: syntax error near "(select last(*) from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select max(f1) from tbe partition by f1));

DB error: syntax error near "(select max(f1) from tbe partition by f1));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select a.ts from tbe a join tbe b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from tbe a join tbe b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select sum(f1) from tbe interval(1d)));

DB error: syntax error near "(select sum(f1) from tbe interval(1d)));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select f1 from tbe union select f1 from tbe));

DB error: syntax error near "(select f1 from tbe union select f1 from tbe));" [0x80002600] 
taos> select f1 from tbe where f1 not in ((select f1 from tbe union all select f1 from tbe));

DB error: syntax error near "(select f1 from tbe union all select f1 from tbe));" [0x80002600] 
taos> select (select 1) from tbe where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) from tbe where (select f1 from tbe) is null order by f1;

taos> select (select f1 from tbe order by ts, f1 limit 1) from tbe where (select f1 from tbe order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from tbe) from tbe where (select count(*) from tbe) is null order by f1;

taos> select (select null from tbe) from tbe where (select null from tbe) is null order by f1;

taos> select (select * from tbe) from tbe where (select * from tbe) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) from tbe where (select 2 from tbe) is null order by f1;

taos> select (select avg(f1) from tbe) from tbe where (select avg(f1) from tbe) is null order by f1;

taos> select (select last(*) from tbe) from tbe where (select last(*) from tbe) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) from tbe where (select max(f1) from tbe partition by f1) is null order by f1;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe where (select a.ts from tbe a join tbe b on a.ts = b.ts) is null order by f1;

taos> select (select sum(f1) from tbe interval(1d)) from tbe where (select sum(f1) from tbe interval(1d)) is null order by f1;

taos> select (select f1 from tbe union select f1 from tbe) from tbe where (select f1 from tbe union select f1 from tbe) is null order by f1;

taos> select (select f1 from tbe union all select f1 from tbe) from tbe where (select f1 from tbe union all select f1 from tbe) is null order by f1;

taos> select (select 1) from tbe where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe) from tbe where (select f1 from tbe) is not null order by f1;

taos> select (select f1 from tbe order by ts, f1 limit 1) from tbe where (select f1 from tbe order by ts, f1 limit 1) is not null order by f1;

taos> select (select count(*) from tbe) from tbe where (select count(*) from tbe) is not null order by f1;

taos> select (select null from tbe) from tbe where (select null from tbe) is not null order by f1;

taos> select (select * from tbe) from tbe where (select * from tbe) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe) from tbe where (select 2 from tbe) is not null order by f1;

taos> select (select avg(f1) from tbe) from tbe where (select avg(f1) from tbe) is not null order by f1;

taos> select (select last(*) from tbe) from tbe where (select last(*) from tbe) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1) from tbe where (select max(f1) from tbe partition by f1) is not null order by f1;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe where (select a.ts from tbe a join tbe b on a.ts = b.ts) is not null order by f1;

taos> select (select sum(f1) from tbe interval(1d)) from tbe where (select sum(f1) from tbe interval(1d)) is not null order by f1;

taos> select (select f1 from tbe union select f1 from tbe) from tbe where (select f1 from tbe union select f1 from tbe) is not null order by f1;

taos> select (select f1 from tbe union all select f1 from tbe) from tbe where (select f1 from tbe union all select f1 from tbe) is not null order by f1;

taos> select f1, cast((select 1) as varchar) from tbe where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from tbe) as varchar) from tbe where abs((select f1 from tbe)) > 0 order by f1;

taos> select f1, cast((select f1 from tbe order by ts, f1 limit 1) as varchar) from tbe where abs((select f1 from tbe order by ts, f1 limit 1)) > 0 order by f1;

taos> select f1, cast((select count(*) from tbe) as varchar) from tbe where abs((select count(*) from tbe)) > 0 order by f1;

taos> select f1, cast((select null from tbe) as varchar) from tbe where abs((select null from tbe)) > 0 order by f1;

taos> select f1, cast((select * from tbe) as varchar) from tbe where abs((select * from tbe)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from tbe) as varchar) from tbe where abs((select 2 from tbe)) > 0 order by f1;

taos> select f1, cast((select avg(f1) from tbe) as varchar) from tbe where abs((select avg(f1) from tbe)) > 0 order by f1;

taos> select f1, cast((select last(*) from tbe) as varchar) from tbe where abs((select last(*) from tbe)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from tbe partition by f1) as varchar) from tbe where abs((select max(f1) from tbe partition by f1)) > 0 order by f1;

taos> select f1, cast((select a.ts from tbe a join tbe b on a.ts = b.ts) as varchar) from tbe where abs((select a.ts from tbe a join tbe b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from tbe interval(1d)) as varchar) from tbe where abs((select sum(f1) from tbe interval(1d))) > 0 order by f1;

taos> select f1, cast((select f1 from tbe union select f1 from tbe) as varchar) from tbe where abs((select f1 from tbe union select f1 from tbe)) > 0 order by f1;

taos> select f1, cast((select f1 from tbe union all select f1 from tbe) as varchar) from tbe where abs((select f1 from tbe union all select f1 from tbe)) > 0 order by f1;

taos> select f1, (select 1) from tbe where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbe) from tbe where f1 > (select f1 from tbe) or f1 < (select f1 from tbe) order by f1;

taos> select f1, (select f1 from tbe order by ts, f1 limit 1) from tbe where f1 > (select f1 from tbe order by ts, f1 limit 1) or f1 < (select f1 from tbe order by ts, f1 limit 1) order by f1;

taos> select f1, (select count(*) from tbe) from tbe where f1 > (select count(*) from tbe) or f1 < (select count(*) from tbe) order by f1;

taos> select f1, (select null from tbe) from tbe where f1 > (select null from tbe) or f1 < (select null from tbe) order by f1;

taos> select f1, (select * from tbe) from tbe where f1 > (select * from tbe) or f1 < (select * from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbe) from tbe where f1 > (select 2 from tbe) or f1 < (select 2 from tbe) order by f1;

taos> select f1, (select avg(f1) from tbe) from tbe where f1 > (select avg(f1) from tbe) or f1 < (select avg(f1) from tbe) order by f1;

taos> select f1, (select last(*) from tbe) from tbe where f1 > (select last(*) from tbe) or f1 < (select last(*) from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbe partition by f1) from tbe where f1 > (select max(f1) from tbe partition by f1) or f1 < (select max(f1) from tbe partition by f1) order by f1;

taos> select f1, (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe where f1 > (select a.ts from tbe a join tbe b on a.ts = b.ts) or f1 < (select a.ts from tbe a join tbe b on a.ts = b.ts) order by f1;

taos> select f1, (select sum(f1) from tbe interval(1d)) from tbe where f1 > (select sum(f1) from tbe interval(1d)) or f1 < (select sum(f1) from tbe interval(1d)) order by f1;

taos> select f1, (select f1 from tbe union select f1 from tbe) from tbe where f1 > (select f1 from tbe union select f1 from tbe) or f1 < (select f1 from tbe union select f1 from tbe) order by f1;

taos> select f1, (select f1 from tbe union all select f1 from tbe) from tbe where f1 > (select f1 from tbe union all select f1 from tbe) or f1 < (select f1 from tbe union all select f1 from tbe) order by f1;

taos> select f1, (select 1) from tbe where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from tbe) from tbe where f1 between (select f1 from tbe) and (select f1 from tbe) + 1 order by f1;

taos> select f1, (select f1 from tbe order by ts, f1 limit 1) from tbe where f1 between (select f1 from tbe order by ts, f1 limit 1) and (select f1 from tbe order by ts, f1 limit 1) + 1 order by f1;

taos> select f1, (select count(*) from tbe) from tbe where f1 between (select count(*) from tbe) and (select count(*) from tbe) + 1 order by f1;

taos> select f1, (select null from tbe) from tbe where f1 between (select null from tbe) and (select null from tbe) + 1 order by f1;

taos> select f1, (select * from tbe) from tbe where f1 between (select * from tbe) and (select * from tbe) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from tbe) from tbe where f1 between (select 2 from tbe) and (select 2 from tbe) + 1 order by f1;

taos> select f1, (select avg(f1) from tbe) from tbe where f1 between (select avg(f1) from tbe) and (select avg(f1) from tbe) + 1 order by f1;

taos> select f1, (select last(*) from tbe) from tbe where f1 between (select last(*) from tbe) and (select last(*) from tbe) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from tbe partition by f1) from tbe where f1 between (select max(f1) from tbe partition by f1) and (select max(f1) from tbe partition by f1) + 1 order by f1;

taos> select f1, (select a.ts from tbe a join tbe b on a.ts = b.ts) from tbe where f1 between (select a.ts from tbe a join tbe b on a.ts = b.ts) and (select a.ts from tbe a join tbe b on a.ts = b.ts) + 1 order by f1;

taos> select f1, (select sum(f1) from tbe interval(1d)) from tbe where f1 between (select sum(f1) from tbe interval(1d)) and (select sum(f1) from tbe interval(1d)) + 1 order by f1;

taos> select f1, (select f1 from tbe union select f1 from tbe) from tbe where f1 between (select f1 from tbe union select f1 from tbe) and (select f1 from tbe union select f1 from tbe) + 1 order by f1;

taos> select f1, (select f1 from tbe union all select f1 from tbe) from tbe where f1 between (select f1 from tbe union all select f1 from tbe) and (select f1 from tbe union all select f1 from tbe) + 1 order by f1;

taos> select (select 1), (select 1) > 0 from tbe where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from tbe), (select f1 from tbe) > 0 from tbe where (select f1 from tbe) > 0 and f1 > (select f1 from tbe) order by f1;

taos> select (select f1 from tbe order by ts, f1 limit 1), (select f1 from tbe order by ts, f1 limit 1) > 0 from tbe where (select f1 from tbe order by ts, f1 limit 1) > 0 and f1 > (select f1 from tbe order by ts, f1 limit 1) order by f1;

taos> select (select count(*) from tbe), (select count(*) from tbe) > 0 from tbe where (select count(*) from tbe) > 0 and f1 > (select count(*) from tbe) order by f1;

taos> select (select null from tbe), (select null from tbe) > 0 from tbe where (select null from tbe) > 0 and f1 > (select null from tbe) order by f1;

taos> select (select * from tbe), (select * from tbe) > 0 from tbe where (select * from tbe) > 0 and f1 > (select * from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from tbe), (select 2 from tbe) > 0 from tbe where (select 2 from tbe) > 0 and f1 > (select 2 from tbe) order by f1;

taos> select (select avg(f1) from tbe), (select avg(f1) from tbe) > 0 from tbe where (select avg(f1) from tbe) > 0 and f1 > (select avg(f1) from tbe) order by f1;

taos> select (select last(*) from tbe), (select last(*) from tbe) > 0 from tbe where (select last(*) from tbe) > 0 and f1 > (select last(*) from tbe) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from tbe partition by f1), (select max(f1) from tbe partition by f1) > 0 from tbe where (select max(f1) from tbe partition by f1) > 0 and f1 > (select max(f1) from tbe partition by f1) order by f1;

taos> select (select a.ts from tbe a join tbe b on a.ts = b.ts), (select a.ts from tbe a join tbe b on a.ts = b.ts) > 0 from tbe where (select a.ts from tbe a join tbe b on a.ts = b.ts) > 0 and f1 > (select a.ts from tbe a join tbe b on a.ts = b.ts) order by f1;

taos> select (select sum(f1) from tbe interval(1d)), (select sum(f1) from tbe interval(1d)) > 0 from tbe where (select sum(f1) from tbe interval(1d)) > 0 and f1 > (select sum(f1) from tbe interval(1d)) order by f1;

taos> select (select f1 from tbe union select f1 from tbe), (select f1 from tbe union select f1 from tbe) > 0 from tbe where (select f1 from tbe union select f1 from tbe) > 0 and f1 > (select f1 from tbe union select f1 from tbe) order by f1;

taos> select (select f1 from tbe union all select f1 from tbe), (select f1 from tbe union all select f1 from tbe) > 0 from tbe where (select f1 from tbe union all select f1 from tbe) > 0 and f1 > (select f1 from tbe union all select f1 from tbe) order by f1;

taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from st1 order by ts, f1 limit 1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select count(*) from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select null from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select * from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 2 from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select avg(f1) from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select last(*) from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select max(f1) from st1 partition by f1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select sum(f1) from st1 interval(1d));

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from st1 union select f1 from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select f1 from st1 union all select f1 from st1);

DB error: Current sql does not support subquery as expr [0x800026A7] 
taos> select (select 1) from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) from st1;
 (select f1 from st1 order by ts, f1 limit 1) |
===============================================
                                            1 |
                                            1 |
                                            1 |
                                            1 |
                                            1 |
                                            1 |

taos> select (select count(*) from st1) from st1;
 (select count(*) from st1) |
=============================
                          6 |
                          6 |
                          6 |
                          6 |
                          6 |
                          6 |

taos> select (select null from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) from st1;
 (select avg(f1) from st1) |
============================
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |

taos> select (select last(*) from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) a from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) a from st1;
      a      |
==============
           1 |
           1 |
           1 |
           1 |
           1 |
           1 |

taos> select (select count(*) from st1) a from st1;
           a           |
========================
                     6 |
                     6 |
                     6 |
                     6 |
                     6 |
                     6 |

taos> select (select null from st1) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) a from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) a from st1;
             a             |
============================
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |

taos> select (select last(*) from st1) a from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) a from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select 1) from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select tags (select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from st1 order by ts, f1 limit 1) from st1;
 (select f1 from st1 order by ts, f1 limit 1) |
===============================================
                                            1 |
                                            1 |
                                            1 |

taos> select tags (select count(*) from st1) from st1;
 (select count(*) from st1) |
=============================
                          6 |
                          6 |
                          6 |

taos> select tags (select null from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select * from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select 2 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select avg(f1) from st1) from st1;
 (select avg(f1) from st1) |
============================
                       3.5 |
                       3.5 |
                       3.5 |

taos> select tags (select last(*) from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select tags (select max(f1) from st1 partition by f1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select sum(f1) from st1 interval(1d)) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from st1 union select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select tags (select f1 from st1 union all select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1) from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from st1 order by ts, f1 limit 1) from st1;
 (select f1 from st1 order by ts, f1 limit 1) |
===============================================
                                            1 |

taos> select distinct (select count(*) from st1) from st1;
 (select count(*) from st1) |
=============================
                          6 |

taos> select distinct (select null from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select * from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select avg(f1) from st1) from st1;
 (select avg(f1) from st1) |
============================
                       3.5 |

taos> select distinct (select last(*) from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from st1 partition by f1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select sum(f1) from st1 interval(1d)) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from st1 union select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from st1 union all select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select 1), f1 from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct (select f1 from st1), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from st1 order by ts, f1 limit 1), f1 from st1;
 (select f1 from st1 order by ts, f1 limit 1) |     f1      |
=============================================================
                                            1 |           4 |
                                            1 |           3 |
                                            1 |           5 |
                                            1 |           1 |
                                            1 |           6 |
                                            1 |           2 |

taos> select distinct (select count(*) from st1), f1 from st1;
 (select count(*) from st1) |     f1      |
===========================================
                          6 |           6 |
                          6 |           5 |
                          6 |           4 |
                          6 |           3 |
                          6 |           1 |
                          6 |           2 |

taos> select distinct (select null from st1), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select * from st1), f1 from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select 2 from st1), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select avg(f1) from st1), f1 from st1;
 (select avg(f1) from st1) |     f1      |
==========================================
                       3.5 |           6 |
                       3.5 |           2 |
                       3.5 |           3 |
                       3.5 |           1 |
                       3.5 |           4 |
                       3.5 |           5 |

taos> select distinct (select last(*) from st1), f1 from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct (select max(f1) from st1 partition by f1), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select a.ts from st1 a join st1 b on a.ts = b.ts), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select sum(f1) from st1 interval(1d)), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from st1 union select f1 from st1), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct (select f1 from st1 union all select f1 from st1), f1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select 1) + 1 from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select distinct tags (select f1 from st1) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from st1 order by ts, f1 limit 1) + 1 from st1;
 (select f1 from st1 order by ts, f1 limit 1) + 1 |
===================================================
                                                2 |

taos> select distinct tags (select count(*) from st1) + 1 from st1;
 (select count(*) from st1) + 1 |
=================================
                              7 |

taos> select distinct tags (select null from st1) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select * from st1) + 1 from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select 2 from st1) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select avg(f1) from st1) + 1 from st1;
 (select avg(f1) from st1) + 1 |
================================
                           4.5 |

taos> select distinct tags (select last(*) from st1) + 1 from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select distinct tags (select max(f1) from st1 partition by f1) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select a.ts from st1 a join st1 b on a.ts = b.ts) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select sum(f1) from st1 interval(1d)) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from st1 union select f1 from st1) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select distinct tags (select f1 from st1 union all select f1 from st1) + 1 from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) from st1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1), (select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1), (select f1 from st1 order by ts, f1 limit 1) from st1;
 (select f1 from st1 order by ts, f1 limit 1) | (select f1 from st1 order by ts, f1 limit 1) |
==============================================================================================
                                            1 |                                            1 |
                                            1 |                                            1 |
                                            1 |                                            1 |
                                            1 |                                            1 |
                                            1 |                                            1 |
                                            1 |                                            1 |

taos> select (select count(*) from st1), (select count(*) from st1) from st1;
 (select count(*) from st1) | (select count(*) from st1) |
==========================================================
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |

taos> select (select null from st1), (select null from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1), (select * from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1), (select 2 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1), (select avg(f1) from st1) from st1;
 (select avg(f1) from st1) | (select avg(f1) from st1) |
========================================================
                       3.5 |                       3.5 |
                       3.5 |                       3.5 |
                       3.5 |                       3.5 |
                       3.5 |                       3.5 |
                       3.5 |                       3.5 |
                       3.5 |                       3.5 |

taos> select (select last(*) from st1), (select last(*) from st1) from st1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1), (select max(f1) from st1 partition by f1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts), (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)), (select sum(f1) from st1 interval(1d)) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1), (select f1 from st1 union select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1), (select f1 from st1 union all select f1 from st1) from st1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select 1) from st1 order by ts;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select 1, (select f1 from st1) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from st1 order by ts, f1 limit 1) from st1 order by ts;
           1           | (select f1 from st1 order by ts, f1 limit 1) |
=======================================================================
                     1 |                                            1 |
                     1 |                                            1 |
                     1 |                                            1 |
                     1 |                                            1 |
                     1 |                                            1 |
                     1 |                                            1 |

taos> select 1, (select count(*) from st1) from st1 order by ts;
           1           | (select count(*) from st1) |
=====================================================
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |

taos> select 1, (select null from st1) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select * from st1) from st1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select 2 from st1) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select avg(f1) from st1) from st1 order by ts;
           1           | (select avg(f1) from st1) |
====================================================
                     1 |                       3.5 |
                     1 |                       3.5 |
                     1 |                       3.5 |
                     1 |                       3.5 |
                     1 |                       3.5 |
                     1 |                       3.5 |

taos> select 1, (select last(*) from st1) from st1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select 1, (select max(f1) from st1 partition by f1) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select sum(f1) from st1 interval(1d)) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from st1 union select f1 from st1) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select 1, (select f1 from st1 union all select f1 from st1) from st1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), * from st1 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1), * from st1 order by ts, f1;
 (select f1 from st1 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |     tg1     |
===================================================================================================================
                                            1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                            1 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
                                            1 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
                                            1 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
                                            1 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
                                            1 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select (select count(*) from st1), * from st1 order by ts, f1;
 (select count(*) from st1) |           ts            |     f1      |     f2      |     tg1     |
=================================================================================================
                          6 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                          6 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
                          6 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
                          6 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
                          6 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
                          6 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select (select null from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1), * from st1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1), * from st1 order by ts, f1;
 (select avg(f1) from st1) |           ts            |     f1      |     f2      |     tg1     |
================================================================================================
                       3.5 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                       3.5 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
                       3.5 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
                       3.5 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
                       3.5 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
                       3.5 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select (select last(*) from st1), * from st1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) * (select 1), * from st1 order by ts, f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) * (select f1 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) * (select f1 from st1 order by ts, f1 limit 1), * from st1 order by ts, f1;
 (select f1 from st1 order by ts, f1 limit 1) * (select f1 from s |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                                               1 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
                                                               1 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
                                                               1 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
                                                               1 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
                                                               1 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select (select count(*) from st1) * (select count(*) from st1), * from st1 order by ts, f1;
 (select count(*) from st1) * (select count(*) from st1) |           ts            |     f1      |     f2      |     tg1     |
==============================================================================================================================
                                                      36 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                                      36 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
                                                      36 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
                                                      36 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
                                                      36 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
                                                      36 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select (select null from st1) * (select null from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) * (select * from st1), * from st1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) * (select 2 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) * (select avg(f1) from st1), * from st1 order by ts, f1;
 (select avg(f1) from st1) * (select avg(f1) from st1) |           ts            |     f1      |     f2      |     tg1     |
============================================================================================================================
                                                 12.25 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                                 12.25 | 2025-12-01 00:00:00.000 |           2 |          21 |           2 |
                                                 12.25 | 2025-12-01 00:00:00.000 |           4 |          31 |           3 |
                                                 12.25 | 2025-12-02 00:00:00.000 |           3 |          23 |           2 |
                                                 12.25 | 2025-12-02 00:00:00.000 |           5 |          32 |           3 |
                                                 12.25 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select (select last(*) from st1) * (select last(*) from st1), * from st1 order by ts, f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) * (select max(f1) from st1 partition by f1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) * (select a.ts from st1 a join st1 b on a.ts = b.ts), * from st1 order by ts, f1;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from st1 interval(1d)) * (select sum(f1) from st1 interval(1d)), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) * (select f1 from st1 union select f1 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) * (select f1 from st1 union all select f1 from st1), * from st1 order by ts, f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)) from st1;

DB error: unrecognized token: "{funcname}((select 1)) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1)) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts, f1 limit 1)) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts, f1 limit 1)) from st1;" [0x80002600] 
taos> select {funcName}((select count(*) from st1)) from st1;

DB error: unrecognized token: "{funcname}((select count(*) from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select null from st1)) from st1;

DB error: unrecognized token: "{funcname}((select null from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select * from st1)) from st1;

DB error: unrecognized token: "{funcname}((select * from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select 2 from st1)) from st1;

DB error: unrecognized token: "{funcname}((select 2 from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from st1)) from st1;

DB error: unrecognized token: "{funcname}((select avg(f1) from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select last(*) from st1)) from st1;

DB error: unrecognized token: "{funcname}((select last(*) from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select max(f1) from st1 partition by f1)) from st1;

DB error: unrecognized token: "{funcname}((select max(f1) from st1 partition by f1)) from st1;" [0x80002600] 
taos> select {funcName}((select a.ts from st1 a join st1 b on a.ts = b.ts)) from st1;

DB error: unrecognized token: "{funcname}((select a.ts from st1 a join st1 b on a.ts = b.ts)) from st1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from st1 interval(1d))) from st1;

DB error: unrecognized token: "{funcname}((select sum(f1) from st1 interval(1d))) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 union select f1 from st1)) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 union select f1 from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 union all select f1 from st1)) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 union all select f1 from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select 1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts, f1 limit 1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts, f1 limit 1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select count(*) from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select count(*) from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select null from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select null from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select * from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select * from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select 2 from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select 2 from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select avg(f1) from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select last(*) from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select last(*) from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select max(f1) from st1 partition by f1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select max(f1) from st1 partition by f1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select a.ts from st1 a join st1 b on a.ts = b.ts) + 1) from st1;

DB error: unrecognized token: "{funcname}((select a.ts from st1 a join st1 b on a.ts = b.ts) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from st1 interval(1d)) + 1) from st1;

DB error: unrecognized token: "{funcname}((select sum(f1) from st1 interval(1d)) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 union select f1 from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 union select f1 from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 union all select f1 from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 union all select f1 from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts, f1 limit 1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts, f1 limit 1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select count(*) from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select count(*) from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select null from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select null from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select * from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select * from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select 2 from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select 2 from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select avg(f1) from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select last(*) from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select last(*) from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select max(f1) from st1 partition by f1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select max(f1) from st1 partition by f1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select a.ts from st1 a join st1 b on a.ts = b.ts) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select a.ts from st1 a join st1 b on a.ts = b.ts) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from st1 interval(1d)) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select sum(f1) from st1 interval(1d)) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 union select f1 from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 union select f1 from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 union all select f1 from st1) + 1) + 2 from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 union all select f1 from st1) + 1) + 2 from st1;" [0x80002600] 
taos> select (select 1) + (select 1) from st1 partition by tbname;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) + (select f1 from st1) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) + (select f1 from st1 order by ts, f1 limit 1) from st1 partition by tbname;
 (select f1 from st1 order by ts, f1 limit 1) + (select f1 from s |
===================================================================
                                                               2 |
                                                               2 |
                                                               2 |
                                                               2 |
                                                               2 |
                                                               2 |

taos> select (select count(*) from st1) + (select count(*) from st1) from st1 partition by tbname;
 (select count(*) from st1) + (select count(*) from st1) |
==========================================================
                                                      12 |
                                                      12 |
                                                      12 |
                                                      12 |
                                                      12 |
                                                      12 |

taos> select (select null from st1) + (select null from st1) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) + (select * from st1) from st1 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) + (select 2 from st1) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) + (select avg(f1) from st1) from st1 partition by tbname;
 (select avg(f1) from st1) + (select avg(f1) from st1) |
========================================================
                                                     7 |
                                                     7 |
                                                     7 |
                                                     7 |
                                                     7 |
                                                     7 |

taos> select (select last(*) from st1) + (select last(*) from st1) from st1 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) + (select max(f1) from st1 partition by f1) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) + (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from st1 interval(1d)) + (select sum(f1) from st1 interval(1d)) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) + (select f1 from st1 union select f1 from st1) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) + (select f1 from st1 union all select f1 from st1) from st1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + f1 from st1 partition by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) + f1 from st1 partition by f1;
 (select f1 from st1 order by ts, f1 limit 1) + f1 |
====================================================
                                                 6 |
                                                 7 |
                                                 3 |
                                                 4 |
                                                 2 |
                                                 5 |

taos> select (select count(*) from st1) + f1 from st1 partition by f1;
 (select count(*) from st1) + f1 |
==================================
                              11 |
                              12 |
                               8 |
                               9 |
                               7 |
                              10 |

taos> select (select null from st1) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) + f1 from st1 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) + f1 from st1 partition by f1;
 (select avg(f1) from st1) + f1 |
=================================
                            8.5 |
                            9.5 |
                            5.5 |
                            6.5 |
                            4.5 |
                            7.5 |

taos> select (select last(*) from st1) + f1 from st1 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) + f1 from st1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when (select f1 from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from st1 order by ts, f1 limit 1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;
 case when (select f1 from st1 order by ts, f1 limit 1) > 0 then  |        sum(f1)        |
===========================================================================================
                                                                1 |                     5 |
                                                                1 |                     1 |
                                                                1 |                     3 |
                                                                1 |                     4 |
                                                                1 |                     6 |
                                                                1 |                     2 |

taos> select case when (select count(*) from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;
 case when (select count(*) from st1) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     5 |
                                                          1 |                     1 |
                                                          1 |                     3 |
                                                          1 |                     4 |
                                                          1 |                     6 |
                                                          1 |                     2 |

taos> select case when (select null from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select * from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select 2 from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select avg(f1) from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;
 case when (select avg(f1) from st1) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     5 |
                                                         1 |                     1 |
                                                         1 |                     3 |
                                                         1 |                     4 |
                                                         1 |                     6 |
                                                         1 |                     2 |

taos> select case when (select last(*) from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when (select max(f1) from st1 partition by f1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select a.ts from st1 a join st1 b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select sum(f1) from st1 interval(1d)) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from st1 union select f1 from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when (select f1 from st1 union all select f1 from st1) > 0 then 1 else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from st1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 2 / (select f1 from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from st1 order by ts, f1 limit 1) else 2 end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 2 / (select f1 from st1 order by ts, f1 li |        sum(f1)        |
===========================================================================================
 2                                                                |                     5 |
 2                                                                |                     1 |
 2                                                                |                     3 |
 2                                                                |                     4 |
 2                                                                |                     6 |
 2                                                                |                     2 |

taos> select case when f1 = 1 then 2 / (select count(*) from st1) else 2 end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 2 / (select count(*) from st1) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     5 |
 0.333333333333333                                               |                     1 |
 2                                                               |                     3 |
 2                                                               |                     4 |
 2                                                               |                     6 |
 2                                                               |                     2 |

taos> select case when f1 = 1 then 2 / (select null from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select * from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select 2 from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select avg(f1) from st1) else 2 end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from st1) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     5 |
 0.571428571428571                                              |                     1 |
 2                                                              |                     3 |
 2                                                              |                     4 |
 2                                                              |                     6 |
 2                                                              |                     2 |

taos> select case when f1 = 1 then 2 / (select last(*) from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 2 / (select max(f1) from st1 partition by f1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select a.ts from st1 a join st1 b on a.ts = b.ts) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select sum(f1) from st1 interval(1d)) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from st1 union select f1 from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 2 / (select f1 from st1 union all select f1 from st1) else 2 end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from st1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case when f1 = 1 then 1 else (select f1 from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from st1 order by ts, f1 limit 1) is null end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else (select f1 from st1 order by ts, f1 |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     4 |
                                                                0 |                     6 |
                                                                0 |                     2 |

taos> select case when f1 = 1 then 1 else (select count(*) from st1) is null end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else (select count(*) from st1) is null  |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     4 |
                                                                0 |                     6 |
                                                                0 |                     2 |

taos> select case when f1 = 1 then 1 else (select null from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select * from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select 2 from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select avg(f1) from st1) is null end, sum(f1) from st1 group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from st1) is null e |        sum(f1)        |
===========================================================================================
                                                                0 |                     5 |
                                                                1 |                     1 |
                                                                0 |                     3 |
                                                                0 |                     4 |
                                                                0 |                     6 |
                                                                0 |                     2 |

taos> select case when f1 = 1 then 1 else (select last(*) from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case when f1 = 1 then 1 else (select max(f1) from st1 partition by f1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select a.ts from st1 a join st1 b on a.ts = b.ts) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select sum(f1) from st1 interval(1d)) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from st1 union select f1 from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case when f1 = 1 then 1 else (select f1 from st1 union all select f1 from st1) is null end, sum(f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from st1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from st1 order by ts, f1 limit 1), avg(f1) from st1 interval(1d);
         _wstart         | (select f1 from st1 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            1 |          2.33333333333333 |
 2025-12-02 00:00:00.000 |                                            1 |                         4 |
 2025-12-03 00:00:00.000 |                                            1 |                         6 |

taos> select _wstart, (select count(*) from st1), avg(f1) from st1 interval(1d);
         _wstart         | (select count(*) from st1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          6 |          2.33333333333333 |
 2025-12-02 00:00:00.000 |                          6 |                         4 |
 2025-12-03 00:00:00.000 |                          6 |                         6 |

taos> select _wstart, (select null from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select * from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select avg(f1) from st1), avg(f1) from st1 interval(1d);
         _wstart         | (select avg(f1) from st1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                       3.5 |          2.33333333333333 |
 2025-12-02 00:00:00.000 |                       3.5 |                         4 |
 2025-12-03 00:00:00.000 |                       3.5 |                         6 |

taos> select _wstart, (select last(*) from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from st1 partition by f1), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select a.ts from st1 a join st1 b on a.ts = b.ts), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select sum(f1) from st1 interval(1d)), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from st1 union select f1 from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from st1 union all select f1 from st1), avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from st1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) + 1, avg(f1) from st1 interval(1d);
 (select f1 from st1 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                2 |          2.33333333333333 |
                                                2 |                         4 |
                                                2 |                         6 |

taos> select (select count(*) from st1) + 1, avg(f1) from st1 interval(1d);
 (select count(*) from st1) + 1 |          avg(f1)          |
=============================================================
                              7 |          2.33333333333333 |
                              7 |                         4 |
                              7 |                         6 |

taos> select (select null from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) + 1, avg(f1) from st1 interval(1d);
 (select avg(f1) from st1) + 1 |          avg(f1)          |
============================================================
                           4.5 |          2.33333333333333 |
                           4.5 |                         4 |
                           4.5 |                         6 |

taos> select (select last(*) from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) + 1, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select {funcName}((select 1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts, f1 limit 1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts, f1 limit 1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select * from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from st1 partition by f1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from st1 partition by f1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from st1 a join st1 b on a.ts = b.ts)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from st1 a join st1 b on a.ts = b.ts)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from st1 interval(1d))), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from st1 interval(1d))), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 union select f1 from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 union select f1 from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 union all select f1 from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 union all select f1 from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts, f1 limit 1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts, f1 limit 1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select * from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from st1 partition by f1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from st1 partition by f1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from st1 a join st1 b on a.ts = b.ts) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from st1 a join st1 b on a.ts = b.ts) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from st1 interval(1d)) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from st1 interval(1d)) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 union select f1 from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 union select f1 from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 union all select f1 from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 union all select f1 from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select case (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from st1 order by ts, f1 limit 1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case (select f1 from st1 order by ts, f1 limit 1) when 1 then 1  |          avg(f1)          |
===============================================================================================
                                                                1 |          2.33333333333333 |
                                                                1 |                         4 |
                                                                1 |                         6 |

taos> select case (select count(*) from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case (select count(*) from st1) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        2 |          2.33333333333333 |
                                                        2 |                         4 |
                                                        2 |                         6 |

taos> select case (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select * from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select 2 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select avg(f1) from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case (select avg(f1) from st1) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       2 |          2.33333333333333 |
                                                       2 |                         4 |
                                                       2 |                         6 |

taos> select case (select last(*) from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select case (select max(f1) from st1 partition by f1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select a.ts from st1 a join st1 b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select sum(f1) from st1 interval(1d)) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from st1 union select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select case (select f1 from st1 union all select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select 1), avg(f1) from st1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select _wstart, (select f1 from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from st1 order by ts, f1 limit 1), avg(f1) from st1 SESSION(ts, 1d);
         _wstart         | (select f1 from st1 order by ts, f1 limit 1) |          avg(f1)          |
=====================================================================================================
 2025-12-01 00:00:00.000 |                                            1 |                       3.5 |

taos> select _wstart, (select count(*) from st1), avg(f1) from st1 SESSION(ts, 1d);
         _wstart         | (select count(*) from st1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          6 |                       3.5 |

taos> select _wstart, (select null from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select * from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select 2 from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select avg(f1) from st1), avg(f1) from st1 SESSION(ts, 1d);
         _wstart         | (select avg(f1) from st1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                       3.5 |                       3.5 |

taos> select _wstart, (select last(*) from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select _wstart, (select max(f1) from st1 partition by f1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select a.ts from st1 a join st1 b on a.ts = b.ts), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select sum(f1) from st1 interval(1d)), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from st1 union select f1 from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select _wstart, (select f1 from st1 union all select f1 from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) + 1, avg(f1) from st1 SESSION(ts, 1d);
 (select f1 from st1 order by ts, f1 limit 1) + 1 |          avg(f1)          |
===============================================================================
                                                2 |                       3.5 |

taos> select (select count(*) from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);
 (select count(*) from st1) + 1 |          avg(f1)          |
=============================================================
                              7 |                       3.5 |

taos> select (select null from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);
 (select avg(f1) from st1) + 1 |          avg(f1)          |
============================================================
                           4.5 |                       3.5 |

taos> select (select last(*) from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) > 0 from st1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from st1 order by ts, f1 limit 1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from st1) > 0 from st1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from st1) > 0 from st1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from st1 interval(1d)) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from st1 union select f1 from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from st1 union all select f1 from st1) > 0 from st1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when (select f1 from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from st1 order by ts, f1 limit 1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when (select count(*) from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when (select null from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select * from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select 2 from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select avg(f1) from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when (select last(*) from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when (select max(f1) from st1 partition by f1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select a.ts from st1 a join st1 b on a.ts = b.ts) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select sum(f1) from st1 interval(1d)) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from st1 union select f1 from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when (select f1 from st1 union all select f1 from st1) > 0 then 1 else 2 end) from st1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from st1 order by ts, f1 limit 1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 = 1 then cast(2 / (select null from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select * from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from st1 partition by f1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from st1 a join st1 b on a.ts = b.ts) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from st1 interval(1d)) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from st1 union select f1 from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from st1 union all select f1 from st1) as bigint) else 2 end) from st1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from st1 order by ts, f1 limit 1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 = 1 then 1 else (select count(*) from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 = 1 then 1 else (select null from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select * from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select sum(case when f1 = 1 then 1 else (select last(*) from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from st1 partition by f1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select a.ts from st1 a join st1 b on a.ts = b.ts) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from st1 interval(1d)) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from st1 union select f1 from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from st1 union all select f1 from st1) is null end + 1) from st1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select 1)) from st1 partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select sum((select f1 from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from st1 order by ts, f1 limit 1)) from st1 partition by tbname interval(1d);
 sum((select f1 from st1 order by ts, f1 limit 1)) |
====================================================
                                                 1 |
                                                 1 |
                                                 1 |
                                                 1 |
                                                 1 |
                                                 1 |

taos> select sum((select count(*) from st1)) from st1 partition by tbname interval(1d);
 sum((select count(*) from st1)) |
==================================
                               6 |
                               6 |
                               6 |
                               6 |
                               6 |
                               6 |

taos> select sum((select null from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select * from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select 2 from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select avg(f1) from st1)) from st1 partition by tbname interval(1d);
 sum((select avg(f1) from st1)) |
=================================
                            3.5 |
                            3.5 |
                            3.5 |
                            3.5 |
                            3.5 |
                            3.5 |

taos> select sum((select last(*) from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select sum((select max(f1) from st1 partition by f1)) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select a.ts from st1 a join st1 b on a.ts = b.ts)) from st1 partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from st1 interval(1d))) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from st1 union select f1 from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select sum((select f1 from st1 union all select f1 from st1)) from st1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select 1) * -1)) from st1 partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select avg(abs((select f1 from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from st1 order by ts, f1 limit 1) * -1)) from st1 partition by f1 interval(1d);
 avg(abs((select f1 from st1 order by ts, f1 limit 1) * -1)) |
==============================================================
                                                           1 |
                                                           1 |
                                                           1 |
                                                           1 |
                                                           1 |
                                                           1 |

taos> select avg(abs((select count(*) from st1) * -1)) from st1 partition by f1 interval(1d);
 avg(abs((select count(*) from st1) * -1)) |
============================================
                                         6 |
                                         6 |
                                         6 |
                                         6 |
                                         6 |
                                         6 |

taos> select avg(abs((select null from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select * from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select 2 from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select avg(f1) from st1) * -1)) from st1 partition by f1 interval(1d);
 avg(abs((select avg(f1) from st1) * -1)) |
===========================================
                                      3.5 |
                                      3.5 |
                                      3.5 |
                                      3.5 |
                                      3.5 |
                                      3.5 |

taos> select avg(abs((select last(*) from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select avg(abs((select max(f1) from st1 partition by f1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select a.ts from st1 a join st1 b on a.ts = b.ts) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select sum(f1) from st1 interval(1d)) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from st1 union select f1 from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select avg(abs((select f1 from st1 union all select f1 from st1) * -1)) from st1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from st1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from st1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 order by ts, f1 limit 1) from st1 group by f1;
     f1      | (select f1 from st1 order by ts, f1 limit 1) |
=============================================================
           5 |                                            1 |
           1 |                                            1 |
           3 |                                            1 |
           4 |                                            1 |
           6 |                                            1 |
           2 |                                            1 |

taos> select f1, (select count(*) from st1) from st1 group by f1;
     f1      | (select count(*) from st1) |
===========================================
           5 |                          6 |
           1 |                          6 |
           3 |                          6 |
           4 |                          6 |
           6 |                          6 |
           2 |                          6 |

taos> select f1, (select null from st1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from st1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from st1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from st1) from st1 group by f1;
     f1      | (select avg(f1) from st1) |
==========================================
           5 |                       3.5 |
           1 |                       3.5 |
           3 |                       3.5 |
           4 |                       3.5 |
           6 |                       3.5 |
           2 |                       3.5 |

taos> select f1, (select last(*) from st1) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from st1 partition by f1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from st1 interval(1d)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union select f1 from st1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union all select f1 from st1) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1), avg((select 1)) from st1 group by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from st1), avg((select f1 from st1)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 order by ts, f1 limit 1), avg((select f1 from st1 order by ts, f1 limit 1)) from st1 group by f1;
     f1      | (select f1 from st1 order by ts, f1 limit 1) | avg((select f1 from st1 order by ts, f1 limit 1)) |
=================================================================================================================
           5 |                                            1 |                                                 1 |
           1 |                                            1 |                                                 1 |
           3 |                                            1 |                                                 1 |
           4 |                                            1 |                                                 1 |
           6 |                                            1 |                                                 1 |
           2 |                                            1 |                                                 1 |

taos> select f1, (select count(*) from st1), avg((select count(*) from st1)) from st1 group by f1;
     f1      | (select count(*) from st1) | avg((select count(*) from st1)) |
=============================================================================
           5 |                          6 |                               6 |
           1 |                          6 |                               6 |
           3 |                          6 |                               6 |
           4 |                          6 |                               6 |
           6 |                          6 |                               6 |
           2 |                          6 |                               6 |

taos> select f1, (select null from st1), avg((select null from st1)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from st1), avg((select * from st1)) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from st1), avg((select 2 from st1)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from st1), avg((select avg(f1) from st1)) from st1 group by f1;
     f1      | (select avg(f1) from st1) | avg((select avg(f1) from st1)) |
===========================================================================
           5 |                       3.5 |                            3.5 |
           1 |                       3.5 |                            3.5 |
           3 |                       3.5 |                            3.5 |
           4 |                       3.5 |                            3.5 |
           6 |                       3.5 |                            3.5 |
           2 |                       3.5 |                            3.5 |

taos> select f1, (select last(*) from st1), avg((select last(*) from st1)) from st1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from st1 partition by f1), avg((select max(f1) from st1 partition by f1)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from st1 a join st1 b on a.ts = b.ts), avg((select a.ts from st1 a join st1 b on a.ts = b.ts)) from st1 group by f1;

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select f1, (select sum(f1) from st1 interval(1d)), avg((select sum(f1) from st1 interval(1d))) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union select f1 from st1), avg((select f1 from st1 union select f1 from st1)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union all select f1 from st1), avg((select f1 from st1 union all select f1 from st1)) from st1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select 1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select 1) order by b.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select b.f1, (select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 order by ts, f1 limit 1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1 order by ts, f1 limit 1) order by b.f1;
     f1      | (select f1 from st1 order by ts, f1 limit 1) + 1 |
=================================================================
           1 |                                                2 |
           2 |                                                2 |
           4 |                                                2 |

taos> select b.f1, (select count(*) from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select count(*) from st1) order by b.f1;
     f1      | (select count(*) from st1) + 1 |
===============================================
           6 |                              7 |

taos> select b.f1, (select null from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select null from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select * from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select * from st1) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select 2 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select 2 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select avg(f1) from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select avg(f1) from st1) order by b.f1;

taos> select b.f1, (select last(*) from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select last(*) from st1) order by b.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select b.f1, (select max(f1) from st1 partition by f1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select max(f1) from st1 partition by f1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select a.ts from st1 a join st1 b on a.ts = b.ts) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select a.ts from st1 a join st1 b on a.ts = b.ts) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select sum(f1) from st1 interval(1d)) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select sum(f1) from st1 interval(1d)) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 union select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1 union select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select b.f1, (select f1 from st1 union all select f1 from st1) + 1 from st1 a join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1 union all select f1 from st1) order by b.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) + 1, avg((select 1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select 1);

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) + 1, avg((select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) + 1, avg((select f1 from st1 order by ts, f1 limit 1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1 order by ts, f1 limit 1);
 (select f1 from st1 order by ts, f1 limit 1) + 1 | avg((select f1 from st1 order by ts, f1 limit 1) + 2) |
===========================================================================================================
                                                2 |                                                     3 |

taos> select (select count(*) from st1) + 1, avg((select count(*) from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select count(*) from st1);
 (select count(*) from st1) + 1 | avg((select count(*) from st1) + 2) |
=======================================================================
                              7 |                                   8 |

taos> select (select null from st1) + 1, avg((select null from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select null from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) + 1, avg((select * from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select * from st1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) + 1, avg((select 2 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select 2 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) + 1, avg((select avg(f1) from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select avg(f1) from st1);
 (select avg(f1) from st1) + 1 | avg((select avg(f1) from st1) + 2) |
=====================================================================
                           4.5 |                                5.5 |

taos> select (select last(*) from st1) + 1, avg((select last(*) from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select last(*) from st1);

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) + 1, avg((select max(f1) from st1 partition by f1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select max(f1) from st1 partition by f1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) + 1, avg((select a.ts from st1 a join st1 b on a.ts = b.ts) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select a.ts from st1 a join st1 b on a.ts = b.ts);

DB error: Invalid parameter data type : avg [0x80002802] 
taos> select (select sum(f1) from st1 interval(1d)) + 1, avg((select sum(f1) from st1 interval(1d)) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select sum(f1) from st1 interval(1d));

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) + 1, avg((select f1 from st1 union select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1 union select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) + 1, avg((select f1 from st1 union all select f1 from st1) + 2) from st1 a left join st1 b on a.ts = b.ts and a.f1 = (select f1 from st1 union all select f1 from st1);

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select 1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select 1) order by a.ts, a.f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select a.*, (select f1 from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select f1 from st1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from st1 order by ts, f1 limit 1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select f1 from st1 order by ts, f1 limit 1) order by a.ts, a.f1;
           ts            |     f1      |     f2      |     tg1     | (select f1 from st1 order by ts, f1 limit 1) |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |           1 |                                            1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 2025-12-01 00:00:00.000 |           2 |          21 |           2 |                                            1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 2025-12-01 00:00:00.000 |           4 |          31 |           3 |                                            1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
 2025-12-02 00:00:00.000 |           3 |          23 |           2 |                                            1 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           5 |          32 |           3 |                                            1 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-03 00:00:00.000 |           6 |          33 |           3 |                                            1 | NULL                    | NULL        | NULL        | NULL        |

taos> select a.*, (select count(*) from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select count(*) from st1) order by a.ts, a.f1;
           ts            |     f1      |     f2      |     tg1     | (select count(*) from st1) |           ts            |     f1      |     f2      |     tg1     |
=====================================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |           1 |                          6 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-01 00:00:00.000 |           2 |          21 |           2 |                          6 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-01 00:00:00.000 |           4 |          31 |           3 |                          6 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           3 |          23 |           2 |                          6 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           5 |          32 |           3 |                          6 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-03 00:00:00.000 |           6 |          33 |           3 |                          6 | 2025-12-03 00:00:00.000 |           6 |          33 |           3 |

taos> select a.*, (select null from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select null from st1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select * from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select * from st1) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select 2 from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select 2 from st1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select avg(f1) from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select avg(f1) from st1) order by a.ts, a.f1;
           ts            |     f1      |     f2      |     tg1     | (select avg(f1) from st1) |           ts            |     f1      |     f2      |     tg1     |
====================================================================================================================================================================
 2025-12-01 00:00:00.000 |           1 |          11 |           1 |                       3.5 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-01 00:00:00.000 |           2 |          21 |           2 |                       3.5 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-01 00:00:00.000 |           4 |          31 |           3 |                       3.5 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           3 |          23 |           2 |                       3.5 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-02 00:00:00.000 |           5 |          32 |           3 |                       3.5 | NULL                    | NULL        | NULL        | NULL        |
 2025-12-03 00:00:00.000 |           6 |          33 |           3 |                       3.5 | NULL                    | NULL        | NULL        | NULL        |

taos> select a.*, (select last(*) from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select last(*) from st1) order by a.ts, a.f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select a.*, (select max(f1) from st1 partition by f1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select max(f1) from st1 partition by f1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select a.ts from st1 a join st1 b on a.ts = b.ts), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select a.ts from st1 a join st1 b on a.ts = b.ts) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select sum(f1) from st1 interval(1d)), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select sum(f1) from st1 interval(1d)) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from st1 union select f1 from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select f1 from st1 union select f1 from st1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select a.*, (select f1 from st1 union all select f1 from st1), b.* from st1 a left join st1 b on a.ts = b.ts and b.f1 = (select f1 from st1 union all select f1 from st1) order by a.ts, a.f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1 from st1 where f1 != (select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select f1 from st1 order by ts, f1 limit 1) order by f1;
     f1      |
==============
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 != (select count(*) from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |

taos> select f1 from st1 where f1 != (select null from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select * from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from st1 where f1 != (select 2 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select avg(f1) from st1) order by f1;
     f1      |
==============
           1 |
           2 |
           3 |
           4 |
           5 |
           6 |

taos> select f1 from st1 where f1 != (select last(*) from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1 from st1 where f1 != (select max(f1) from st1 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select a.ts from st1 a join st1 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select sum(f1) from st1 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select f1 from st1 union select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 != (select f1 from st1 union all select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from st1 where f1 = (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from st1) from st1 where f1 = (select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 order by ts, f1 limit 1) from st1 where f1 = (select f1 from st1 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from st1 order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |

taos> select f1, (select count(*) from st1) from st1 where f1 = (select count(*) from st1) order by f1;
     f1      | (select count(*) from st1) |
===========================================
           6 |                          6 |

taos> select f1, (select null from st1) from st1 where f1 = (select null from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from st1) from st1 where f1 = (select * from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from st1) from st1 where f1 = (select 2 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from st1) from st1 where f1 = (select avg(f1) from st1) order by f1;

taos> select f1, (select last(*) from st1) from st1 where f1 = (select last(*) from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from st1 partition by f1) from st1 where f1 = (select max(f1) from st1 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 where f1 = (select a.ts from st1 a join st1 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from st1 interval(1d)) from st1 where f1 = (select sum(f1) from st1 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union select f1 from st1) from st1 where f1 = (select f1 from st1 union select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union all select f1 from st1) from st1 where f1 = (select f1 from st1 union all select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1 from st1 where f1 in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select f1 from st1));

DB error: syntax error near "(select f1 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select f1 from st1 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from st1 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select count(*) from st1));

DB error: syntax error near "(select count(*) from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select null from st1));

DB error: syntax error near "(select null from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select * from st1));

DB error: syntax error near "(select * from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select 2 from st1));

DB error: syntax error near "(select 2 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select avg(f1) from st1));

DB error: syntax error near "(select avg(f1) from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select last(*) from st1));

DB error: syntax error near "(select last(*) from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select max(f1) from st1 partition by f1));

DB error: syntax error near "(select max(f1) from st1 partition by f1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select a.ts from st1 a join st1 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from st1 a join st1 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select sum(f1) from st1 interval(1d)));

DB error: syntax error near "(select sum(f1) from st1 interval(1d)));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select f1 from st1 union select f1 from st1));

DB error: syntax error near "(select f1 from st1 union select f1 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 in ((select f1 from st1 union all select f1 from st1));

DB error: syntax error near "(select f1 from st1 union all select f1 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select 1));

DB error: syntax error near "(select 1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select f1 from st1));

DB error: syntax error near "(select f1 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select f1 from st1 order by ts, f1 limit 1));

DB error: syntax error near "(select f1 from st1 order by ts, f1 limit 1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select count(*) from st1));

DB error: syntax error near "(select count(*) from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select null from st1));

DB error: syntax error near "(select null from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select * from st1));

DB error: syntax error near "(select * from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select 2 from st1));

DB error: syntax error near "(select 2 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select avg(f1) from st1));

DB error: syntax error near "(select avg(f1) from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select last(*) from st1));

DB error: syntax error near "(select last(*) from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select max(f1) from st1 partition by f1));

DB error: syntax error near "(select max(f1) from st1 partition by f1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select a.ts from st1 a join st1 b on a.ts = b.ts));

DB error: syntax error near "(select a.ts from st1 a join st1 b on a.ts = b.ts));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select sum(f1) from st1 interval(1d)));

DB error: syntax error near "(select sum(f1) from st1 interval(1d)));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select f1 from st1 union select f1 from st1));

DB error: syntax error near "(select f1 from st1 union select f1 from st1));" [0x80002600] 
taos> select f1 from st1 where f1 not in ((select f1 from st1 union all select f1 from st1));

DB error: syntax error near "(select f1 from st1 union all select f1 from st1));" [0x80002600] 
taos> select (select 1) from st1 where (select 1) is null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) from st1 where (select f1 from st1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) from st1 where (select f1 from st1 order by ts, f1 limit 1) is null order by f1;

taos> select (select count(*) from st1) from st1 where (select count(*) from st1) is null order by f1;

taos> select (select null from st1) from st1 where (select null from st1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) from st1 where (select * from st1) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) from st1 where (select 2 from st1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) from st1 where (select avg(f1) from st1) is null order by f1;

taos> select (select last(*) from st1) from st1 where (select last(*) from st1) is null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) from st1 where (select max(f1) from st1 partition by f1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 where (select a.ts from st1 a join st1 b on a.ts = b.ts) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) from st1 where (select sum(f1) from st1 interval(1d)) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) from st1 where (select f1 from st1 union select f1 from st1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) from st1 where (select f1 from st1 union all select f1 from st1) is null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1) from st1 where (select 1) is not null order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1) from st1 where (select f1 from st1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1) from st1 where (select f1 from st1 order by ts, f1 limit 1) is not null order by f1;
 (select f1 from st1 order by ts, f1 limit 1) |
===============================================
                                            1 |
                                            1 |
                                            1 |
                                            1 |
                                            1 |
                                            1 |

taos> select (select count(*) from st1) from st1 where (select count(*) from st1) is not null order by f1;
 (select count(*) from st1) |
=============================
                          6 |
                          6 |
                          6 |
                          6 |
                          6 |
                          6 |

taos> select (select null from st1) from st1 where (select null from st1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1) from st1 where (select * from st1) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1) from st1 where (select 2 from st1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1) from st1 where (select avg(f1) from st1) is not null order by f1;
 (select avg(f1) from st1) |
============================
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |
                       3.5 |

taos> select (select last(*) from st1) from st1 where (select last(*) from st1) is not null order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1) from st1 where (select max(f1) from st1 partition by f1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 where (select a.ts from st1 a join st1 b on a.ts = b.ts) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)) from st1 where (select sum(f1) from st1 interval(1d)) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1) from st1 where (select f1 from st1 union select f1 from st1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1) from st1 where (select f1 from st1 union all select f1 from st1) is not null order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select 1) as varchar) from st1 where abs((select 1)) > 0 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, cast((select f1 from st1) as varchar) from st1 where abs((select f1 from st1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from st1 order by ts, f1 limit 1) as varchar) from st1 where abs((select f1 from st1 order by ts, f1 limit 1)) > 0 order by f1;
     f1      | cast((select f1 from st1 order by ts, f1 limit 1) as varchar) |
==============================================================================
           1 | 1                                                             |
           2 | 1                                                             |
           3 | 1                                                             |
           4 | 1                                                             |
           5 | 1                                                             |
           6 | 1                                                             |

taos> select f1, cast((select count(*) from st1) as varchar) from st1 where abs((select count(*) from st1)) > 0 order by f1;
     f1      | cast((select count(*) from st1) as varchar) |
============================================================
           1 | 6                                           |
           2 | 6                                           |
           3 | 6                                           |
           4 | 6                                           |
           5 | 6                                           |
           6 | 6                                           |

taos> select f1, cast((select null from st1) as varchar) from st1 where abs((select null from st1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select * from st1) as varchar) from st1 where abs((select * from st1)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select 2 from st1) as varchar) from st1 where abs((select 2 from st1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select avg(f1) from st1) as varchar) from st1 where abs((select avg(f1) from st1)) > 0 order by f1;
     f1      | cast((select avg(f1) from st1) as varchar) |
===========================================================
           1 | 3.5                                        |
           2 | 3.5                                        |
           3 | 3.5                                        |
           4 | 3.5                                        |
           5 | 3.5                                        |
           6 | 3.5                                        |

taos> select f1, cast((select last(*) from st1) as varchar) from st1 where abs((select last(*) from st1)) > 0 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, cast((select max(f1) from st1 partition by f1) as varchar) from st1 where abs((select max(f1) from st1 partition by f1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select a.ts from st1 a join st1 b on a.ts = b.ts) as varchar) from st1 where abs((select a.ts from st1 a join st1 b on a.ts = b.ts)) > 0 order by f1;

DB error: Invalid parameter data type : abs [0x80002802] 
taos> select f1, cast((select sum(f1) from st1 interval(1d)) as varchar) from st1 where abs((select sum(f1) from st1 interval(1d))) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from st1 union select f1 from st1) as varchar) from st1 where abs((select f1 from st1 union select f1 from st1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, cast((select f1 from st1 union all select f1 from st1) as varchar) from st1 where abs((select f1 from st1 union all select f1 from st1)) > 0 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from st1 where f1 > (select 1) or f1 < (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from st1) from st1 where f1 > (select f1 from st1) or f1 < (select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 order by ts, f1 limit 1) from st1 where f1 > (select f1 from st1 order by ts, f1 limit 1) or f1 < (select f1 from st1 order by ts, f1 limit 1) order by f1;
     f1      | (select f1 from st1 order by ts, f1 limit 1) |
=============================================================
           2 |                                            1 |
           3 |                                            1 |
           4 |                                            1 |
           5 |                                            1 |
           6 |                                            1 |

taos> select f1, (select count(*) from st1) from st1 where f1 > (select count(*) from st1) or f1 < (select count(*) from st1) order by f1;
     f1      | (select count(*) from st1) |
===========================================
           1 |                          6 |
           2 |                          6 |
           3 |                          6 |
           4 |                          6 |
           5 |                          6 |

taos> select f1, (select null from st1) from st1 where f1 > (select null from st1) or f1 < (select null from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from st1) from st1 where f1 > (select * from st1) or f1 < (select * from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from st1) from st1 where f1 > (select 2 from st1) or f1 < (select 2 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from st1) from st1 where f1 > (select avg(f1) from st1) or f1 < (select avg(f1) from st1) order by f1;
     f1      | (select avg(f1) from st1) |
==========================================
           1 |                       3.5 |
           2 |                       3.5 |
           3 |                       3.5 |
           4 |                       3.5 |
           5 |                       3.5 |
           6 |                       3.5 |

taos> select f1, (select last(*) from st1) from st1 where f1 > (select last(*) from st1) or f1 < (select last(*) from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from st1 partition by f1) from st1 where f1 > (select max(f1) from st1 partition by f1) or f1 < (select max(f1) from st1 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 where f1 > (select a.ts from st1 a join st1 b on a.ts = b.ts) or f1 < (select a.ts from st1 a join st1 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from st1 interval(1d)) from st1 where f1 > (select sum(f1) from st1 interval(1d)) or f1 < (select sum(f1) from st1 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union select f1 from st1) from st1 where f1 > (select f1 from st1 union select f1 from st1) or f1 < (select f1 from st1 union select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union all select f1 from st1) from st1 where f1 > (select f1 from st1 union all select f1 from st1) or f1 < (select f1 from st1 union all select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select 1) from st1 where f1 between (select 1) and (select 1) + 1 order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select f1, (select f1 from st1) from st1 where f1 between (select f1 from st1) and (select f1 from st1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 order by ts, f1 limit 1) from st1 where f1 between (select f1 from st1 order by ts, f1 limit 1) and (select f1 from st1 order by ts, f1 limit 1) + 1 order by f1;
     f1      | (select f1 from st1 order by ts, f1 limit 1) |
=============================================================
           1 |                                            1 |
           2 |                                            1 |

taos> select f1, (select count(*) from st1) from st1 where f1 between (select count(*) from st1) and (select count(*) from st1) + 1 order by f1;
     f1      | (select count(*) from st1) |
===========================================
           6 |                          6 |

taos> select f1, (select null from st1) from st1 where f1 between (select null from st1) and (select null from st1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select * from st1) from st1 where f1 between (select * from st1) and (select * from st1) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select 2 from st1) from st1 where f1 between (select 2 from st1) and (select 2 from st1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select avg(f1) from st1) from st1 where f1 between (select avg(f1) from st1) and (select avg(f1) from st1) + 1 order by f1;
     f1      | (select avg(f1) from st1) |
==========================================
           4 |                       3.5 |

taos> select f1, (select last(*) from st1) from st1 where f1 between (select last(*) from st1) and (select last(*) from st1) + 1 order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select f1, (select max(f1) from st1 partition by f1) from st1 where f1 between (select max(f1) from st1 partition by f1) and (select max(f1) from st1 partition by f1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select a.ts from st1 a join st1 b on a.ts = b.ts) from st1 where f1 between (select a.ts from st1 a join st1 b on a.ts = b.ts) and (select a.ts from st1 a join st1 b on a.ts = b.ts) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select sum(f1) from st1 interval(1d)) from st1 where f1 between (select sum(f1) from st1 interval(1d)) and (select sum(f1) from st1 interval(1d)) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union select f1 from st1) from st1 where f1 between (select f1 from st1 union select f1 from st1) and (select f1 from st1 union select f1 from st1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select f1, (select f1 from st1 union all select f1 from st1) from st1 where f1 between (select f1 from st1 union all select f1 from st1) and (select f1 from st1 union all select f1 from st1) + 1 order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select 1), (select 1) > 0 from st1 where (select 1) > 0 and f1 > (select 1) order by f1;

DB error: Not supported subquery as expr [0x800026A6] 
taos> select (select f1 from st1), (select f1 from st1) > 0 from st1 where (select f1 from st1) > 0 and f1 > (select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 order by ts, f1 limit 1), (select f1 from st1 order by ts, f1 limit 1) > 0 from st1 where (select f1 from st1 order by ts, f1 limit 1) > 0 and f1 > (select f1 from st1 order by ts, f1 limit 1) order by f1;
 (select f1 from st1 order by ts, f1 limit 1) | (select f1 from st1 order by ts, f1 limit 1) > 0 |
==================================================================================================
                                            1 | true                                             |
                                            1 | true                                             |
                                            1 | true                                             |
                                            1 | true                                             |
                                            1 | true                                             |

taos> select (select count(*) from st1), (select count(*) from st1) > 0 from st1 where (select count(*) from st1) > 0 and f1 > (select count(*) from st1) order by f1;

taos> select (select null from st1), (select null from st1) > 0 from st1 where (select null from st1) > 0 and f1 > (select null from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select * from st1), (select * from st1) > 0 from st1 where (select * from st1) > 0 and f1 > (select * from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select 2 from st1), (select 2 from st1) > 0 from st1 where (select 2 from st1) > 0 and f1 > (select 2 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select avg(f1) from st1), (select avg(f1) from st1) > 0 from st1 where (select avg(f1) from st1) > 0 and f1 > (select avg(f1) from st1) order by f1;
 (select avg(f1) from st1) | (select avg(f1) from st1) > 0 |
============================================================
                       3.5 | true                          |
                       3.5 | true                          |
                       3.5 | true                          |

taos> select (select last(*) from st1), (select last(*) from st1) > 0 from st1 where (select last(*) from st1) > 0 and f1 > (select last(*) from st1) order by f1;

DB error: More than 1 column returned in subquery as expr [0x800026A4] 
taos> select (select max(f1) from st1 partition by f1), (select max(f1) from st1 partition by f1) > 0 from st1 where (select max(f1) from st1 partition by f1) > 0 and f1 > (select max(f1) from st1 partition by f1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select a.ts from st1 a join st1 b on a.ts = b.ts), (select a.ts from st1 a join st1 b on a.ts = b.ts) > 0 from st1 where (select a.ts from st1 a join st1 b on a.ts = b.ts) > 0 and f1 > (select a.ts from st1 a join st1 b on a.ts = b.ts) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select sum(f1) from st1 interval(1d)), (select sum(f1) from st1 interval(1d)) > 0 from st1 where (select sum(f1) from st1 interval(1d)) > 0 and f1 > (select sum(f1) from st1 interval(1d)) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union select f1 from st1), (select f1 from st1 union select f1 from st1) > 0 from st1 where (select f1 from st1 union select f1 from st1) > 0 and f1 > (select f1 from st1 union select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
taos> select (select f1 from st1 union all select f1 from st1), (select f1 from st1 union all select f1 from st1) > 0 from st1 where (select f1 from st1 union all select f1 from st1) > 0 and f1 > (select f1 from st1 union all select f1 from st1) order by f1;

DB error: More than 1 row returned in subquery as expr [0x800026A5] 
