
taos> use db1;
Database changed.

taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb1 order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select * from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 2 from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select avg(f1) from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select last(*) from tb1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select max(f1) from tb1 partition by f1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select sum(f1) from tb1 interval(1d));

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb1 union select f1 from tb2);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb1 union all select f1 from tb2);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from tb1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) from tb1;
 (select f1 from tb1) |
=======================
                    1 |

taos> select (select f1 from tb1 order by ts limit 1) from tb1;
 (select f1 from tb1 order by ts limit 1) |
===========================================
                                        1 |

taos> select (select count(*) from tb1) from tb1;
 (select count(*) from tb1) |
=============================
                          1 |

taos> select (select null from tb1) from tb1;
 (select null from tb1) |
=========================
 NULL                   |

taos> select (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) from tb1;
  (select 2 from tb1)  |
========================
                     2 |

taos> select (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) |
============================
                         1 |

taos> select (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) |
============================================
                                         1 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) |
=========================================
                                      1 |

taos> select (select f1 from tb1 union select f1 from tb2) from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1) a from tb1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) a from tb1;
      a      |
==============
           1 |

taos> select (select f1 from tb1 order by ts limit 1) a from tb1;
      a      |
==============
           1 |

taos> select (select count(*) from tb1) a from tb1;
           a           |
========================
                     1 |

taos> select (select null from tb1) a from tb1;
 a  |
=====
 N. |

taos> select (select * from tb1) a from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) a from tb1;
           a           |
========================
                     2 |

taos> select (select avg(f1) from tb1) a from tb1;
             a             |
============================
                         1 |

taos> select (select last(*) from tb1) a from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) a from tb1;
      a      |
==============
           1 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) a from tb1;
            a            |
==========================
 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)) a from tb1;
           a           |
========================
                     1 |

taos> select (select f1 from tb1 union select f1 from tb2) a from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) a from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1) from tb1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tb1) from tb1;
 (select f1 from tb1) |
=======================
                    1 |

taos> select distinct (select f1 from tb1 order by ts limit 1) from tb1;
 (select f1 from tb1 order by ts limit 1) |
===========================================
                                        1 |

taos> select distinct (select count(*) from tb1) from tb1;
 (select count(*) from tb1) |
=============================
                          1 |

taos> select distinct (select null from tb1) from tb1;
 (select null from tb1) |
=========================
 NULL                   |

taos> select distinct (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select distinct (select 2 from tb1) from tb1;
  (select 2 from tb1)  |
========================
                     2 |

taos> select distinct (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) |
============================
                         1 |

taos> select distinct (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select distinct (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) |
============================================
                                         1 |

taos> select distinct (select a.ts from tb1 a join tb2 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |
=====================================================
 2025-12-01 00:00:00.000 |

taos> select distinct (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) |
=========================================
                                      1 |

taos> select distinct (select f1 from tb1 union select f1 from tb2) from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from tb1 union all select f1 from tb2) from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1), f1 from tb1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tb1), f1 from tb1;
 (select f1 from tb1) |     f1      |
=====================================
                    1 |           1 |

taos> select distinct (select f1 from tb1 order by ts limit 1), f1 from tb1;
 (select f1 from tb1 order by ts limit 1) |     f1      |
=========================================================
                                        1 |           1 |

taos> select distinct (select count(*) from tb1), f1 from tb1;
 (select count(*) from tb1) |     f1      |
===========================================
                          1 |           1 |

taos> select distinct (select null from tb1), f1 from tb1;
 (select null from tb1) |     f1      |
=======================================
 NULL                   |           1 |

taos> select distinct (select * from tb1), f1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select distinct (select 2 from tb1), f1 from tb1;
  (select 2 from tb1)  |     f1      |
======================================
                     2 |           1 |

taos> select distinct (select avg(f1) from tb1), f1 from tb1;
 (select avg(f1) from tb1) |     f1      |
==========================================
                         1 |           1 |

taos> select distinct (select last(*) from tb1), f1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select distinct (select max(f1) from tb1 partition by f1), f1 from tb1;
 (select max(f1) from tb1 partition by f1) |     f1      |
==========================================================
                                         1 |           1 |

taos> select distinct (select a.ts from tb1 a join tb2 b on a.ts = b.ts), f1 from tb1;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |     f1      |
===================================================================
 2025-12-01 00:00:00.000 |           1 |

taos> select distinct (select sum(f1) from tb1 interval(1d)), f1 from tb1;
 (select sum(f1) from tb1 interval(1d)) |     f1      |
=======================================================
                                      1 |           1 |

taos> select distinct (select f1 from tb1 union select f1 from tb2), f1 from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from tb1 union all select f1 from tb2), f1 from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select 1) + 1 from tb1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from tb1) + 1 from tb1;
 (select f1 from tb1) + 1  |
============================
                         2 |

taos> select distinct tags (select f1 from tb1 order by ts limit 1) + 1 from tb1;
 (select f1 from tb1 order by ts limit 1) + 1 |
===============================================
                                            2 |

taos> select distinct tags (select count(*) from tb1) + 1 from tb1;
 (select count(*) from tb1) + 1 |
=================================
                              2 |

taos> select distinct tags (select null from tb1) + 1 from tb1;
 (select null from tb1) + 1 |
=============================
 NULL                       |

taos> select distinct tags (select * from tb1) + 1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select distinct tags (select 2 from tb1) + 1 from tb1;
  (select 2 from tb1) + 1  |
============================
                         3 |

taos> select distinct tags (select avg(f1) from tb1) + 1 from tb1;
 (select avg(f1) from tb1) + 1 |
================================
                             2 |

taos> select distinct tags (select last(*) from tb1) + 1 from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select distinct tags (select max(f1) from tb1 partition by f1) + 1 from tb1;
 (select max(f1) from tb1 partition by f1) + 1 |
================================================
                                             2 |

taos> select distinct tags (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1 from tb1;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1 |
=========================================================
 2025-12-01 00:00:00.001 |

taos> select distinct tags (select sum(f1) from tb1 interval(1d)) + 1 from tb1;
 (select sum(f1) from tb1 interval(1d)) + 1 |
=============================================
                                          2 |

taos> select distinct tags (select f1 from tb1 union select f1 from tb2) + 1 from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select f1 from tb1 union all select f1 from tb2) + 1 from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1), (select 1) from tb1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1), (select f1 from tb1) from tb1;
 (select f1 from tb1) | (select f1 from tb1) |
==============================================
                    1 |                    1 |

taos> select (select f1 from tb1 order by ts limit 1), (select f1 from tb1 order by ts limit 1) from tb1;
 (select f1 from tb1 order by ts limit 1) | (select f1 from tb1 order by ts limit 1) |
======================================================================================
                                        1 |                                        1 |

taos> select (select count(*) from tb1), (select count(*) from tb1) from tb1;
 (select count(*) from tb1) | (select count(*) from tb1) |
==========================================================
                          1 |                          1 |

taos> select (select null from tb1), (select null from tb1) from tb1;
 (select null from tb1) | (select null from tb1) |
==================================================
 NULL                   | NULL                   |

taos> select (select * from tb1), (select * from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1), (select 2 from tb1) from tb1;
  (select 2 from tb1)  |  (select 2 from tb1)  |
================================================
                     2 |                     2 |

taos> select (select avg(f1) from tb1), (select avg(f1) from tb1) from tb1;
 (select avg(f1) from tb1) | (select avg(f1) from tb1) |
========================================================
                         1 |                         1 |

taos> select (select last(*) from tb1), (select last(*) from tb1) from tb1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1), (select max(f1) from tb1 partition by f1) from tb1;
 (select max(f1) from tb1 partition by f1) | (select max(f1) from tb1 partition by f1) |
========================================================================================
                                         1 |                                         1 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts), (select a.ts from tb1 a join tb2 b on a.ts = b.ts) from tb1;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) | (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |
==========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |

taos> select (select sum(f1) from tb1 interval(1d)), (select sum(f1) from tb1 interval(1d)) from tb1;
 (select sum(f1) from tb1 interval(1d)) | (select sum(f1) from tb1 interval(1d)) |
==================================================================================
                                      1 |                                      1 |

taos> select (select f1 from tb1 union select f1 from tb2), (select f1 from tb1 union select f1 from tb2) from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2), (select f1 from tb1 union all select f1 from tb2) from tb1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select 1, (select 1) from tb1 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from tb1) from tb1 order by ts;
           1           | (select f1 from tb1) |
===============================================
                     1 |                    1 |

taos> select 1, (select f1 from tb1 order by ts limit 1) from tb1 order by ts;
           1           | (select f1 from tb1 order by ts limit 1) |
===================================================================
                     1 |                                        1 |

taos> select 1, (select count(*) from tb1) from tb1 order by ts;
           1           | (select count(*) from tb1) |
=====================================================
                     1 |                          1 |

taos> select 1, (select null from tb1) from tb1 order by ts;
           1           | (select null from tb1) |
=================================================
                     1 | NULL                   |

taos> select 1, (select * from tb1) from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select 1, (select 2 from tb1) from tb1 order by ts;
           1           |  (select 2 from tb1)  |
================================================
                     1 |                     2 |

taos> select 1, (select avg(f1) from tb1) from tb1 order by ts;
           1           | (select avg(f1) from tb1) |
====================================================
                     1 |                         1 |

taos> select 1, (select last(*) from tb1) from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select 1, (select max(f1) from tb1 partition by f1) from tb1 order by ts;
           1           | (select max(f1) from tb1 partition by f1) |
====================================================================
                     1 |                                         1 |

taos> select 1, (select a.ts from tb1 a join tb2 b on a.ts = b.ts) from tb1 order by ts;
           1           | (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |
=============================================================================
                     1 | 2025-12-01 00:00:00.000 |

taos> select 1, (select sum(f1) from tb1 interval(1d)) from tb1 order by ts;
           1           | (select sum(f1) from tb1 interval(1d)) |
=================================================================
                     1 |                                      1 |

taos> select 1, (select f1 from tb1 union select f1 from tb2) from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select 1, (select f1 from tb1 union all select f1 from tb2) from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1), * from tb1 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1), * from tb1 order by ts;
 (select f1 from tb1) |           ts            |     f1      |     f2      |
=============================================================================
                    1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 order by ts limit 1), * from tb1 order by ts;
 (select f1 from tb1 order by ts limit 1) |           ts            |     f1      |     f2      |
=================================================================================================
                                        1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select count(*) from tb1), * from tb1 order by ts;
 (select count(*) from tb1) |           ts            |     f1      |     f2      |
===================================================================================
                          1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select null from tb1), * from tb1 order by ts;
 (select null from tb1) |           ts            |     f1      |     f2      |
===============================================================================
 NULL                   | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select * from tb1), * from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1), * from tb1 order by ts;
  (select 2 from tb1)  |           ts            |     f1      |     f2      |
==============================================================================
                     2 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select avg(f1) from tb1), * from tb1 order by ts;
 (select avg(f1) from tb1) |           ts            |     f1      |     f2      |
==================================================================================
                         1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select last(*) from tb1), * from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1), * from tb1 order by ts;
 (select max(f1) from tb1 partition by f1) |           ts            |     f1      |     f2      |
==================================================================================================
                                         1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts), * from tb1 order by ts;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |           ts            |     f1      |     f2      |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select sum(f1) from tb1 interval(1d)), * from tb1 order by ts;
 (select sum(f1) from tb1 interval(1d)) |           ts            |     f1      |     f2      |
===============================================================================================
                                      1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 union select f1 from tb2), * from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2), * from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1) * (select 1), * from tb1 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) * (select f1 from tb1), * from tb1 order by ts;
 (select f1 from tb1) * (select f1 from tb1) |           ts            |     f1      |     f2      |
====================================================================================================
                                           1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 order by ts limit 1) * (select f1 from tb1 order by ts limit 1), * from tb1 order by ts;
 (select f1 from tb1 order by ts limit 1) * (select f1 from tb1 o |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select count(*) from tb1) * (select count(*) from tb1), * from tb1 order by ts;
 (select count(*) from tb1) * (select count(*) from tb1) |           ts            |     f1      |     f2      |
================================================================================================================
                                                       1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select null from tb1) * (select null from tb1), * from tb1 order by ts;
 (select null from tb1) * (select null from tb1) |           ts            |     f1      |     f2      |
========================================================================================================
 NULL                                            | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select * from tb1) * (select * from tb1), * from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) * (select 2 from tb1), * from tb1 order by ts;
 (select 2 from tb1) * (select 2 from tb1) |           ts            |     f1      |     f2      |
==================================================================================================
                                         4 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select avg(f1) from tb1) * (select avg(f1) from tb1), * from tb1 order by ts;
 (select avg(f1) from tb1) * (select avg(f1) from tb1) |           ts            |     f1      |     f2      |
==============================================================================================================
                                                     1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select last(*) from tb1) * (select last(*) from tb1), * from tb1 order by ts;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) * (select max(f1) from tb1 partition by f1), * from tb1 order by ts;
 (select max(f1) from tb1 partition by f1) * (select max(f1) from |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) * (select a.ts from tb1 a join tb2 b on a.ts = b.ts), * from tb1 order by ts;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb1 interval(1d)) * (select sum(f1) from tb1 interval(1d)), * from tb1 order by ts;
 (select sum(f1) from tb1 interval(1d)) * (select sum(f1) from tb |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |

taos> select (select f1 from tb1 union select f1 from tb2) * (select f1 from tb1 union select f1 from tb2), * from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) * (select f1 from tb1 union all select f1 from tb2), * from tb1 order by ts;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)) from tb1;

DB error: unrecognized token: "{funcname}((select 1)) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts limit 1)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts limit 1)) from tb1;" [0x80002600] 
taos> select {funcName}((select count(*) from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select count(*) from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select null from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select null from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select * from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select * from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select 2 from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select 2 from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select last(*) from tb1)) from tb1;

DB error: unrecognized token: "{funcname}((select last(*) from tb1)) from tb1;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1)) from tb1;

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1)) from tb1;" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb2 b on a.ts = b.ts)) from tb1;

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb2 b on a.ts = b.ts)) from tb1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d))) from tb1;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d))) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb2)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb2)) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb2)) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb2)) from tb1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts limit 1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts limit 1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select count(*) from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select count(*) from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select null from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select null from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select * from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select * from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select 2 from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select 2 from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select last(*) from tb1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select last(*) from tb1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d)) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d)) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb2) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb2) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb2) + 1) from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb2) + 1) from tb1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select 1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts limit 1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts limit 1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select count(*) from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select count(*) from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select null from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select null from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select * from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select * from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select 2 from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select 2 from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select last(*) from tb1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select last(*) from tb1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d)) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d)) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb2) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb2) + 1) + 2 from tb1;" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb2) + 1) + 2 from tb1;

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb2) + 1) + 2 from tb1;" [0x80002600] 
taos> select (select 1) + (select 1) from tb1 partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) + (select f1 from tb1) from tb1 partition by tbname;
 (select f1 from tb1) + (select f1 from tb1) |
==============================================
                                           2 |

taos> select (select f1 from tb1 order by ts limit 1) + (select f1 from tb1 order by ts limit 1) from tb1 partition by tbname;
 (select f1 from tb1 order by ts limit 1) + (select f1 from tb1 o |
===================================================================
                                                               2 |

taos> select (select count(*) from tb1) + (select count(*) from tb1) from tb1 partition by tbname;
 (select count(*) from tb1) + (select count(*) from tb1) |
==========================================================
                                                       2 |

taos> select (select null from tb1) + (select null from tb1) from tb1 partition by tbname;
 (select null from tb1) + (select null from tb1) |
==================================================
 NULL                                            |

taos> select (select * from tb1) + (select * from tb1) from tb1 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) + (select 2 from tb1) from tb1 partition by tbname;
 (select 2 from tb1) + (select 2 from tb1) |
============================================
                                         4 |

taos> select (select avg(f1) from tb1) + (select avg(f1) from tb1) from tb1 partition by tbname;
 (select avg(f1) from tb1) + (select avg(f1) from tb1) |
========================================================
                                                     2 |

taos> select (select last(*) from tb1) + (select last(*) from tb1) from tb1 partition by tbname;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) + (select max(f1) from tb1 partition by f1) from tb1 partition by tbname;
 (select max(f1) from tb1 partition by f1) + (select max(f1) from |
===================================================================
                                                               2 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + (select a.ts from tb1 a join tb2 b on a.ts = b.ts) from tb1 partition by tbname;

DB error: Invalid operation [0x80000200] 
taos> select (select sum(f1) from tb1 interval(1d)) + (select sum(f1) from tb1 interval(1d)) from tb1 partition by tbname;
 (select sum(f1) from tb1 interval(1d)) + (select sum(f1) from tb |
===================================================================
                                                               2 |

taos> select (select f1 from tb1 union select f1 from tb2) + (select f1 from tb1 union select f1 from tb2) from tb1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) + (select f1 from tb1 union all select f1 from tb2) from tb1 partition by tbname;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + f1 from tb1 partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) + f1 from tb1 partition by f1;
 (select f1 from tb1) + f1 |
============================
                         2 |

taos> select (select f1 from tb1 order by ts limit 1) + f1 from tb1 partition by f1;
 (select f1 from tb1 order by ts limit 1) + f1 |
================================================
                                             2 |

taos> select (select count(*) from tb1) + f1 from tb1 partition by f1;
 (select count(*) from tb1) + f1 |
==================================
                               2 |

taos> select (select null from tb1) + f1 from tb1 partition by f1;
 (select null from tb1) + f1 |
==============================
 NULL                        |

taos> select (select * from tb1) + f1 from tb1 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) + f1 from tb1 partition by f1;
 (select 2 from tb1) + f1  |
============================
                         3 |

taos> select (select avg(f1) from tb1) + f1 from tb1 partition by f1;
 (select avg(f1) from tb1) + f1 |
=================================
                              2 |

taos> select (select last(*) from tb1) + f1 from tb1 partition by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) + f1 from tb1 partition by f1;
 (select max(f1) from tb1 partition by f1) + f1 |
=================================================
                                              2 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + f1 from tb1 partition by f1;
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + f1 |
==========================================================
 2025-12-01 00:00:00.001 |

taos> select (select sum(f1) from tb1 interval(1d)) + f1 from tb1 partition by f1;
 (select sum(f1) from tb1 interval(1d)) + f1 |
==============================================
                                           2 |

taos> select (select f1 from tb1 union select f1 from tb2) + f1 from tb1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) + f1 from tb1 partition by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when (select 1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case when (select f1 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select f1 from tb1) > 0 then 1 else 2 end |        sum(f1)        |
===============================================================================
                                                    1 |                     1 |

taos> select case when (select f1 from tb1 order by ts limit 1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select f1 from tb1 order by ts limit 1) > 0 then 1 el |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select count(*) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select count(*) from tb1) > 0 then 1 else 2 end |        sum(f1)        |
=====================================================================================
                                                          1 |                     1 |

taos> select case when (select null from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select null from tb1) > 0 then 1 else 2 end |        sum(f1)        |
=================================================================================
                                                      2 |                     1 |

taos> select case when (select * from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when (select 2 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select 2 from tb1) > 0 then 1 else 2 end |        sum(f1)        |
==============================================================================
                                                   1 |                     1 |

taos> select case when (select avg(f1) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select avg(f1) from tb1) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     1 |

taos> select case when (select last(*) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when (select max(f1) from tb1 partition by f1) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select max(f1) from tb1 partition by f1) > 0 then 1 e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select a.ts from tb1 a join tb2 b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select a.ts from tb1 a join tb2 b on a.ts = b.ts) > 0 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;
 case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select f1 from tb1 union select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when (select f1 from tb1 union all select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb1) else 2 end |        sum(f1)        |
====================================================================================
 2                                                         |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tb1 order by ts limit 1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select f1 from tb1 order by ts limit  |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select count(*) from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select count(*) from tb1) else 2 end |        sum(f1)        |
==========================================================================================
 2                                                               |                     1 |

taos> select case when f1 = 1 then 2 / (select null from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select null from tb1) else 2 end |        sum(f1)        |
======================================================================================
 NULL                                                        |                     1 |

taos> select case when f1 = 1 then 2 / (select * from tb1) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 2 / (select 2 from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select 2 from tb1) else 2 end |        sum(f1)        |
===================================================================================
 1                                                        |                     1 |

taos> select case when f1 = 1 then 2 / (select avg(f1) from tb1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select avg(f1) from tb1) else 2 end |        sum(f1)        |
=========================================================================================
 2                                                              |                     1 |

taos> select case when f1 = 1 then 2 / (select last(*) from tb1) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tb1 partition by f1) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select max(f1) from tb1 partition by  |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select a.ts from tb1 a join tb2 b on a.ts = b.ts) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select a.ts from tb1 a join tb2 b on  |        sum(f1)        |
===========================================================================================
 1.13345375145989e-12                                             |                     1 |

taos> select case when f1 = 1 then 2 / (select sum(f1) from tb1 interval(1d)) else 2 end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 2 / (select sum(f1) from tb1 interval(1d)) |        sum(f1)        |
===========================================================================================
 2                                                                |                     1 |

taos> select case when f1 = 1 then 2 / (select f1 from tb1 union select f1 from tb2) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1 union all select f1 from tb2) else 2 end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case when f1 = 1 then 1 else (select f1 from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb1) is null end |        sum(f1)        |
========================================================================================
                                                             1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tb1 order by ts limit 1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select f1 from tb1 order by ts lim |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select count(*) from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select count(*) from tb1) is null  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select null from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select null from tb1) is null end |        sum(f1)        |
==========================================================================================
                                                               1 |                     1 |

taos> select case when f1 = 1 then 1 else (select * from tb1) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 1 else (select 2 from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select 2 from tb1) is null end |        sum(f1)        |
=======================================================================================
                                                            1 |                     1 |

taos> select case when f1 = 1 then 1 else (select avg(f1) from tb1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select avg(f1) from tb1) is null e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select last(*) from tb1) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tb1 partition by f1) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select max(f1) from tb1 partition  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select a.ts from tb1 a join tb2 b on a.ts = b.ts) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select a.ts from tb1 a join tb2 b  |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1d)) is null end, sum(f1) from tb1 group by f1;
 case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when f1 = 1 then 1 else (select f1 from tb1 union select f1 from tb2) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when f1 = 1 then 1 else (select f1 from tb1 union all select f1 from tb2) is null end, sum(f1) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from tb1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select f1 from tb1) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tb1 order by ts limit 1), avg(f1) from tb1 interval(1d);
         _wstart         | (select f1 from tb1 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 |                                        1 |                         1 |

taos> select _wstart, (select count(*) from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select count(*) from tb1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select null from tb1) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         1 |

taos> select _wstart, (select * from tb1), avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select _wstart, (select 2 from tb1), avg(f1) from tb1 interval(1d);
         _wstart         |  (select 2 from tb1)  |          avg(f1)          |
==============================================================================
 2025-12-01 00:00:00.000 |                     2 |                         1 |

taos> select _wstart, (select avg(f1) from tb1), avg(f1) from tb1 interval(1d);
         _wstart         | (select avg(f1) from tb1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         1 |                         1 |

taos> select _wstart, (select last(*) from tb1), avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select _wstart, (select max(f1) from tb1 partition by f1), avg(f1) from tb1 interval(1d);
         _wstart         | (select max(f1) from tb1 partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-01 00:00:00.000 |                                         1 |                         1 |

taos> select _wstart, (select a.ts from tb1 a join tb2 b on a.ts = b.ts), avg(f1) from tb1 interval(1d);
         _wstart         | (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |                         1 |

taos> select _wstart, (select sum(f1) from tb1 interval(1d)), avg(f1) from tb1 interval(1d);
         _wstart         | (select sum(f1) from tb1 interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 |                                      1 |                         1 |

taos> select _wstart, (select f1 from tb1 union select f1 from tb2), avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from tb1 union all select f1 from tb2), avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from tb1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select f1 from tb1) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tb1 order by ts limit 1) + 1, avg(f1) from tb1 interval(1d);
 (select f1 from tb1 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            2 |                         1 |

taos> select (select count(*) from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select count(*) from tb1) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select null from tb1) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select * from tb1) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) + 1, avg(f1) from tb1 interval(1d);
  (select 2 from tb1) + 1  |          avg(f1)          |
========================================================
                         3 |                         1 |

taos> select (select avg(f1) from tb1) + 1, avg(f1) from tb1 interval(1d);
 (select avg(f1) from tb1) + 1 |          avg(f1)          |
============================================================
                             2 |                         1 |

taos> select (select last(*) from tb1) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) + 1, avg(f1) from tb1 interval(1d);
 (select max(f1) from tb1 partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             2 |                         1 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1, avg(f1) from tb1 interval(1d);
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.001 |                         1 |

taos> select (select sum(f1) from tb1 interval(1d)) + 1, avg(f1) from tb1 interval(1d);
 (select sum(f1) from tb1 interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          2 |                         1 |

taos> select (select f1 from tb1 union select f1 from tb2) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) + 1, avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts limit 1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts limit 1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb2 b on a.ts = b.ts)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb2 b on a.ts = b.ts)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d))), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d))), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb2)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb2)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb2)), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb2)), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 order by ts limit 1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 order by ts limit 1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select * from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select * from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 2 from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select 2 from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select avg(f1) from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select avg(f1) from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select last(*) from tb1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select last(*) from tb1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select max(f1) from tb1 partition by f1) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select max(f1) from tb1 partition by f1) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select sum(f1) from tb1 interval(1d)) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select sum(f1) from tb1 interval(1d)) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union select f1 from tb2) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union select f1 from tb2) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb1 union all select f1 from tb2) + 1), avg(f1) from tb1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb1 union all select f1 from tb2) + 1), avg(f1) from tb1 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select f1 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=================================================================================
                                                  1 |                         1 |

taos> select case (select f1 from tb1 order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select f1 from tb1 order by ts limit 1) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select count(*) from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select count(*) from tb1) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        1 |                         1 |

taos> select case (select null from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select null from tb1) when 1 then 1 else 2 end |          avg(f1)          |
===================================================================================
                                                    2 |                         1 |

taos> select case (select * from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case (select 2 from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select 2 from tb1) when 1 then 1 else 2 end |          avg(f1)          |
================================================================================
                                                 2 |                         1 |

taos> select case (select avg(f1) from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select avg(f1) from tb1) when 1 then 1 else 2 end |          avg(f1)          |
======================================================================================
                                                       1 |                         1 |

taos> select case (select last(*) from tb1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case (select max(f1) from tb1 partition by f1) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select max(f1) from tb1 partition by f1) when 1 then 1 els |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select a.ts from tb1 a join tb2 b on a.ts = b.ts) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select a.ts from tb1 a join tb2 b on a.ts = b.ts) when 1 t |          avg(f1)          |
===============================================================================================
                                                                2 |                         1 |

taos> select case (select sum(f1) from tb1 interval(1d)) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);
 case (select sum(f1) from tb1 interval(1d)) when 1 then 1 else 2 |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select f1 from tb1 union select f1 from tb2) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case (select f1 from tb1 union all select f1 from tb2) when 1 then 1 else 2 end, avg(f1) from tb1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select f1 from tb1) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tb1 order by ts limit 1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select f1 from tb1 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 |                                        1 |                         1 |

taos> select _wstart, (select count(*) from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select count(*) from tb1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select null from tb1) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         1 |

taos> select _wstart, (select * from tb1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select _wstart, (select 2 from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         |  (select 2 from tb1)  |          avg(f1)          |
==============================================================================
 2025-12-01 00:00:00.000 |                     2 |                         1 |

taos> select _wstart, (select avg(f1) from tb1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select avg(f1) from tb1) |          avg(f1)          |
==================================================================================
 2025-12-01 00:00:00.000 |                         1 |                         1 |

taos> select _wstart, (select last(*) from tb1), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select _wstart, (select max(f1) from tb1 partition by f1), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select max(f1) from tb1 partition by f1) |          avg(f1)          |
==================================================================================================
 2025-12-01 00:00:00.000 |                                         1 |                         1 |

taos> select _wstart, (select a.ts from tb1 a join tb2 b on a.ts = b.ts), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |          avg(f1)          |
===========================================================================================================
 2025-12-01 00:00:00.000 | 2025-12-01 00:00:00.000 |                         1 |

taos> select _wstart, (select sum(f1) from tb1 interval(1d)), avg(f1) from tb1 SESSION(ts, 1d);
         _wstart         | (select sum(f1) from tb1 interval(1d)) |          avg(f1)          |
===============================================================================================
 2025-12-01 00:00:00.000 |                                      1 |                         1 |

taos> select _wstart, (select f1 from tb1 union select f1 from tb2), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from tb1 union all select f1 from tb2), avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select f1 from tb1) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tb1 order by ts limit 1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select f1 from tb1 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            2 |                         1 |

taos> select (select count(*) from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select count(*) from tb1) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select null from tb1) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select * from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
  (select 2 from tb1) + 1  |          avg(f1)          |
========================================================
                         3 |                         1 |

taos> select (select avg(f1) from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select avg(f1) from tb1) + 1 |          avg(f1)          |
============================================================
                             2 |                         1 |

taos> select (select last(*) from tb1) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select max(f1) from tb1 partition by f1) + 1 |          avg(f1)          |
============================================================================
                                             2 |                         1 |

taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select a.ts from tb1 a join tb2 b on a.ts = b.ts) + 1 |          avg(f1)          |
=====================================================================================
 2025-12-01 00:00:00.001 |                         1 |

taos> select (select sum(f1) from tb1 interval(1d)) + 1, avg(f1) from tb1 SESSION(ts, 1d);
 (select sum(f1) from tb1 interval(1d)) + 1 |          avg(f1)          |
=========================================================================
                                          2 |                         1 |

taos> select (select f1 from tb1 union select f1 from tb2) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb1 union all select f1 from tb2) + 1, avg(f1) from tb1 SESSION(ts, 1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select (select 1) > 0 from tb1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb1 order by ts limit 1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select count(*) from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select null from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select * from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select 2 from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select avg(f1) from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select last(*) from tb1) > 0 from tb1 SESSION(ts, 1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select (select max(f1) from tb1 partition by f1) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select a.ts from tb1 a join tb2 b on a.ts = b.ts) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select sum(f1) from tb1 interval(1d)) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb1 union select f1 from tb2) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select (select f1 from tb1 union all select f1 from tb2) > 0 from tb1 SESSION(ts, 1d);

DB error: No valid function in window query [0x8000265E] 
taos> select sum(case when (select 1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select sum(case when (select f1 from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select f1 from tb1) > 0 then 1 else 2 end) |
============================================================
                                                         1 |

taos> select sum(case when (select f1 from tb1 order by ts limit 1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select f1 from tb1 order by ts limit 1) > 0 then  |
===================================================================
                                                                1 |

taos> select sum(case when (select count(*) from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select count(*) from tb1) > 0 then 1 else 2 end) |
==================================================================
                                                               1 |

taos> select sum(case when (select null from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select null from tb1) > 0 then 1 else 2 end) |
==============================================================
                                                           2 |

taos> select sum(case when (select * from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum(case when (select 2 from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select 2 from tb1) > 0 then 1 else 2 end) |
===========================================================
                                                        1 |

taos> select sum(case when (select avg(f1) from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select avg(f1) from tb1) > 0 then 1 else 2 end) |
=================================================================
                                                              1 |

taos> select sum(case when (select last(*) from tb1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum(case when (select max(f1) from tb1 partition by f1) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select max(f1) from tb1 partition by f1) > 0 then |
===================================================================
                                                                1 |

taos> select sum(case when (select a.ts from tb1 a join tb2 b on a.ts = b.ts) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |
===================================================================
                                                                1 |

taos> select sum(case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);
 sum(case when (select sum(f1) from tb1 interval(1d)) > 0 then 1  |
===================================================================
                                                                1 |

taos> select sum(case when (select f1 from tb1 union select f1 from tb2) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum(case when (select f1 from tb1 union all select f1 from tb2) > 0 then 1 else 2 end) from tb1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum(case when f1 = 1 then cast(2 / (select 1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tb1) as bigin |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1 order by ts limit 1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select f1 from tb1 order by  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select count(*) from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select count(*) from tb1) as |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select null from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select null from tb1) as big |
===================================================================
 NULL                                                             |

taos> select sum(case when f1 = 1 then cast(2 / (select * from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum(case when f1 = 1 then cast(2 / (select 2 from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select 2 from tb1) as bigint |
===================================================================
                                                                1 |

taos> select sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select avg(f1) from tb1) as  |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select last(*) from tb1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum(case when f1 = 1 then cast(2 / (select max(f1) from tb1 partition by f1) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select max(f1) from tb1 part |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select a.ts from tb1 a join tb2 b on a.ts = b.ts) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select a.ts from tb1 a join  |
===================================================================
                                                                0 |

taos> select sum(case when f1 = 1 then cast(2 / (select sum(f1) from tb1 interval(1d)) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;
 sum(case when f1 = 1 then cast(2 / (select sum(f1) from tb1 inte |
===================================================================
                                                                2 |

taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1 union select f1 from tb2) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum(case when f1 = 1 then cast(2 / (select f1 from tb1 union all select f1 from tb2) as bigint) else 2 end) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum(case when f1 = 1 then 1 else (select 1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb1) is null en |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1 order by ts limit 1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select f1 from tb1 order by ts |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select count(*) from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select count(*) from tb1) is n |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select null from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select null from tb1) is null  |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select * from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum(case when f1 = 1 then 1 else (select 2 from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select 2 from tb1) is null end |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select avg(f1) from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select avg(f1) from tb1) is nu |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select last(*) from tb1) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum(case when f1 = 1 then 1 else (select max(f1) from tb1 partition by f1) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select max(f1) from tb1 partit |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select a.ts from tb1 a join tb2 b on a.ts = b.ts) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select a.ts from tb1 a join tb |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1d)) is null end + 1) from tb1 COUNT_WINDOW(2);
 sum(case when f1 = 1 then 1 else (select sum(f1) from tb1 interv |
===================================================================
                                                               2 |

taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1 union select f1 from tb2) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum(case when f1 = 1 then 1 else (select f1 from tb1 union all select f1 from tb2) is null end + 1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum((select 1)) from tb1 partition by tbname interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select sum((select f1 from tb1)) from tb1 partition by tbname interval(1d);
 sum((select f1 from tb1)) |
============================
                         1 |

taos> select sum((select f1 from tb1 order by ts limit 1)) from tb1 partition by tbname interval(1d);
 sum((select f1 from tb1 order by ts limit 1)) |
================================================
                                             1 |

taos> select sum((select count(*) from tb1)) from tb1 partition by tbname interval(1d);
 sum((select count(*) from tb1)) |
==================================
                               1 |

taos> select sum((select null from tb1)) from tb1 partition by tbname interval(1d);
 sum((select null from tb1)) |
==============================
 NULL                        |

taos> select sum((select * from tb1)) from tb1 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum((select 2 from tb1)) from tb1 partition by tbname interval(1d);
 sum((select 2 from tb1)) |
===========================
                        2 |

taos> select sum((select avg(f1) from tb1)) from tb1 partition by tbname interval(1d);
 sum((select avg(f1) from tb1)) |
=================================
                              1 |

taos> select sum((select last(*) from tb1)) from tb1 partition by tbname interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select sum((select max(f1) from tb1 partition by f1)) from tb1 partition by tbname interval(1d);
 sum((select max(f1) from tb1 partition by f1)) |
=================================================
                                              1 |

taos> select sum((select a.ts from tb1 a join tb2 b on a.ts = b.ts)) from tb1 partition by tbname interval(1d);

DB error: Invalid parameter data type : sum [0x80002802] 
taos> select sum((select sum(f1) from tb1 interval(1d))) from tb1 partition by tbname interval(1d);
 sum((select sum(f1) from tb1 interval(1d))) |
==============================================
                                           1 |

taos> select sum((select f1 from tb1 union select f1 from tb2)) from tb1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select sum((select f1 from tb1 union all select f1 from tb2)) from tb1 partition by tbname interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select avg(abs((select 1) * -1)) from tb1 partition by f1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select avg(abs((select f1 from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select f1 from tb1) * -1)) |
======================================
                                   1 |

taos> select avg(abs((select f1 from tb1 order by ts limit 1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select f1 from tb1 order by ts limit 1) * -1)) |
==========================================================
                                                       1 |

taos> select avg(abs((select count(*) from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select count(*) from tb1) * -1)) |
============================================
                                         1 |

taos> select avg(abs((select null from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select null from tb1) * -1)) |
========================================
 NULL                                  |

taos> select avg(abs((select * from tb1) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select avg(abs((select 2 from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select 2 from tb1) * -1)) |
=====================================
                                  2 |

taos> select avg(abs((select avg(f1) from tb1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select avg(f1) from tb1) * -1)) |
===========================================
                                        1 |

taos> select avg(abs((select last(*) from tb1) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select avg(abs((select max(f1) from tb1 partition by f1) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select max(f1) from tb1 partition by f1) * -1)) |
===========================================================
                                                        1 |

taos> select avg(abs((select a.ts from tb1 a join tb2 b on a.ts = b.ts) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select a.ts from tb1 a join tb2 b on a.ts = b.ts) * -1) |
===================================================================
                                                   1764518400000 |

taos> select avg(abs((select sum(f1) from tb1 interval(1d)) * -1)) from tb1 partition by f1 interval(1d);
 avg(abs((select sum(f1) from tb1 interval(1d)) * -1)) |
========================================================
                                                     1 |

taos> select avg(abs((select f1 from tb1 union select f1 from tb2) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select avg(abs((select f1 from tb1 union all select f1 from tb2) * -1)) from tb1 partition by f1 interval(1d);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select f1, (select 1) from tb1 group by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select f1, (select f1 from tb1) from tb1 group by f1;
     f1      | (select f1 from tb1) |
=====================================
           1 |                    1 |

taos> select f1, (select f1 from tb1 order by ts limit 1) from tb1 group by f1;
     f1      | (select f1 from tb1 order by ts limit 1) |
=========================================================
           1 |                                        1 |

taos> select f1, (select count(*) from tb1) from tb1 group by f1;
     f1      | (select count(*) from tb1) |
===========================================
           1 |                          1 |

taos> select f1, (select null from tb1) from tb1 group by f1;
     f1      | (select null from tb1) |
=======================================
           1 | NULL                   |

taos> select f1, (select * from tb1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select f1, (select 2 from tb1) from tb1 group by f1;
     f1      |  (select 2 from tb1)  |
======================================
           1 |                     2 |

taos> select f1, (select avg(f1) from tb1) from tb1 group by f1;
     f1      | (select avg(f1) from tb1) |
==========================================
           1 |                         1 |

taos> select f1, (select last(*) from tb1) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select f1, (select max(f1) from tb1 partition by f1) from tb1 group by f1;
     f1      | (select max(f1) from tb1 partition by f1) |
==========================================================
           1 |                                         1 |

taos> select f1, (select a.ts from tb1 a join tb2 b on a.ts = b.ts) from tb1 group by f1;
     f1      | (select a.ts from tb1 a join tb2 b on a.ts = b.ts) |
===================================================================
           1 | 2025-12-01 00:00:00.000 |

taos> select f1, (select sum(f1) from tb1 interval(1d)) from tb1 group by f1;
     f1      | (select sum(f1) from tb1 interval(1d)) |
=======================================================
           1 |                                      1 |

taos> select f1, (select f1 from tb1 union select f1 from tb2) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select f1, (select f1 from tb1 union all select f1 from tb2) from tb1 group by f1;

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select f1, (select 1), avg((select 1)) from tb1 group by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select f1, (select f1 from tb1), avg((select f1 from tb1)) from tb1 group by f1;
     f1      | (select f1 from tb1) | avg((select f1 from tb1)) |
=================================================================
           1 |                    1 |                         1 |

taos> select f1, (select f1 from tb1 order by ts limit 1), avg((select f1 from tb1 order by ts limit 1)) from tb1 group by f1;
     f1      | (select f1 from tb1 order by ts limit 1) | avg((select f1 from tb1 order by ts limit 1)) |
=========================================================================================================
           1 |                                        1 |                                             1 |

taos> select f1, (select count(*) from tb1), avg((select count(*) from tb1)) from tb1 group by f1;
     f1      | (select count(*) from tb1) | avg((select count(*) from tb1)) |
=============================================================================
           1 |                          1 |                               1 |

taos> select f1, (select null from tb1), avg((select null from tb1)) from tb1 group by f1;
     f1      | (select null from tb1) | avg((select null from tb1)) |
=====================================================================
           1 | NULL                   | NULL                        |

taos> select f1, (select * from tb1), avg((select * from tb1)) from tb1 group by f1;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select f1, (select 2 from tb1), avg((select 2 from tb1)) from tb1 group by f1;
     f1      |  (select 2 from tb1)  | avg((select 2 from tb1))  |
==================================================================
           1 |                     2 |                         2 |

taos> select case when (select * from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when (select 2 from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);
 case when (select 2 from tb1) > 0 then 1 else 2 end |        sum(f1)        |
==============================================================================
                                                   1 |                     1 |

taos> select case when (select avg(f1) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);
 case when (select avg(f1) from tb1) > 0 then 1 else 2 end |        sum(f1)        |
====================================================================================
                                                         1 |                     1 |

taos> select case when (select last(*) from tb1) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when (select max(f1) from tb1 partition by f1) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);
 case when (select max(f1) from tb1 partition by f1) > 0 then 1 e |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select a.ts from tb1 a join tb2 b on a.ts = b.ts) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);
 case when (select a.ts from tb1 a join tb2 b on a.ts = b.ts) > 0 |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);
 case when (select sum(f1) from tb1 interval(1d)) > 0 then 1 else |        sum(f1)        |
===========================================================================================
                                                                1 |                     1 |

taos> select case when (select f1 from tb1 union select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when (select f1 from tb1 union all select f1 from tb2) > 0 then 1 else 2 end, sum(f1) from tb1 STATE_WINDOW(f1);

DB error: More than 1 row returned in subquery as expr [0x8000269A] 
taos> select case when f1 = 1 then 2 / (select 1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1 order by ts limit 1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select count(*) from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select null from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select * from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 2 / (select 2 from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select avg(f1) from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select last(*) from tb1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 2 / (select max(f1) from tb1 partition by f1) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select a.ts from tb1 a join tb2 b on a.ts = b.ts) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select sum(f1) from tb1 interval(1d)) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1 union select f1 from tb2) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 2 / (select f1 from tb1 union all select f1 from tb2) else 2 end, sum(f1) from tb1 EVENT_WINDOW START WITH f1 >= 1 END WITH f1 <= 2;

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select 1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case when f1 = 1 then 1 else (select f1 from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select f1 from tb1 order by ts limit 1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select count(*) from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select null from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select * from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 1 else (select 2 from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select avg(f1) from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select last(*) from tb1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: More than 1 column returned in subquery as expr [0x80002699] 
taos> select case when f1 = 1 then 1 else (select max(f1) from tb1 partition by f1) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select a.ts from tb1 a join tb2 b on a.ts = b.ts) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select sum(f1) from tb1 interval(1d)) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select case when f1 = 1 then 1 else (select f1 from tb1 union select f1 from tb2) is null end, sum(f1) from tb1 COUNT_WINDOW(2);

DB error: Invalid usage of expr: f1 [0x80002667] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb2);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb2 order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from tb2);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from tb2);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from tb2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) from tb2;
 (select f1 from tb2 order by ts limit 1) |
===========================================
                                        2 |
                                        2 |

taos> select (select count(*) from tb2) from tb2;
 (select count(*) from tb2) |
=============================
                          2 |
                          2 |

taos> select (select null from tb2) from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) a from tb2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) a from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) a from tb2;
      a      |
==============
           2 |
           2 |

taos> select (select count(*) from tb2) a from tb2;
           a           |
========================
                     2 |
                     2 |

taos> select (select null from tb2) a from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1) from tb2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tb2) from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from tb2 order by ts limit 1) from tb2;
 (select f1 from tb2 order by ts limit 1) |
===========================================
                                        2 |

taos> select distinct (select count(*) from tb2) from tb2;
 (select count(*) from tb2) |
=============================
                          2 |

taos> select distinct (select null from tb2) from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1), f1 from tb2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tb2), f1 from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from tb2 order by ts limit 1), f1 from tb2;
 (select f1 from tb2 order by ts limit 1) |     f1      |
=========================================================
                                        2 |           3 |
                                        2 |           2 |

taos> select distinct (select count(*) from tb2), f1 from tb2;
 (select count(*) from tb2) |     f1      |
===========================================
                          2 |           2 |
                          2 |           3 |

taos> select distinct (select null from tb2), f1 from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select 1) + 1 from tb2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from tb2) + 1 from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select f1 from tb2 order by ts limit 1) + 1 from tb2;
 (select f1 from tb2 order by ts limit 1) + 1 |
===============================================
                                            3 |

taos> select distinct tags (select count(*) from tb2) + 1 from tb2;
 (select count(*) from tb2) + 1 |
=================================
                              3 |

taos> select distinct tags (select null from tb2) + 1 from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1), (select 1) from tb2;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2), (select f1 from tb2) from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1), (select f1 from tb2 order by ts limit 1) from tb2;
 (select f1 from tb2 order by ts limit 1) | (select f1 from tb2 order by ts limit 1) |
======================================================================================
                                        2 |                                        2 |
                                        2 |                                        2 |

taos> select (select count(*) from tb2), (select count(*) from tb2) from tb2;
 (select count(*) from tb2) | (select count(*) from tb2) |
==========================================================
                          2 |                          2 |
                          2 |                          2 |

taos> select (select null from tb2), (select null from tb2) from tb2;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select 1, (select 1) from tb2 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from tb2) from tb2 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select 1, (select f1 from tb2 order by ts limit 1) from tb2 order by ts;
           1           | (select f1 from tb2 order by ts limit 1) |
===================================================================
                     1 |                                        2 |
                     1 |                                        2 |

taos> select 1, (select count(*) from tb2) from tb2 order by ts;
           1           | (select count(*) from tb2) |
=====================================================
                     1 |                          2 |
                     1 |                          2 |

taos> select 1, (select null from tb2) from tb2 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1), * from tb2 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2), * from tb2 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1), * from tb2 order by ts;
 (select f1 from tb2 order by ts limit 1) |           ts            |     f1      |     f2      |
=================================================================================================
                                        2 | 2025-12-02 00:00:00.000 |           2 |          21 |
                                        2 | 2025-12-03 00:00:00.000 |           3 |          23 |

taos> select (select count(*) from tb2), * from tb2 order by ts;
 (select count(*) from tb2) |           ts            |     f1      |     f2      |
===================================================================================
                          2 | 2025-12-02 00:00:00.000 |           2 |          21 |
                          2 | 2025-12-03 00:00:00.000 |           3 |          23 |

taos> select (select null from tb2), * from tb2 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) * (select 1), * from tb2 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) * (select f1 from tb2), * from tb2 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) * (select f1 from tb2 order by ts limit 1), * from tb2 order by ts;
 (select f1 from tb2 order by ts limit 1) * (select f1 from tb2 o |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                               4 | 2025-12-02 00:00:00.000 |           2 |          21 |
                                                               4 | 2025-12-03 00:00:00.000 |           3 |          23 |

taos> select (select count(*) from tb2) * (select count(*) from tb2), * from tb2 order by ts;
 (select count(*) from tb2) * (select count(*) from tb2) |           ts            |     f1      |     f2      |
================================================================================================================
                                                       4 | 2025-12-02 00:00:00.000 |           2 |          21 |
                                                       4 | 2025-12-03 00:00:00.000 |           3 |          23 |

taos> select (select null from tb2) * (select null from tb2), * from tb2 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)) from tb2;

DB error: unrecognized token: "{funcname}((select 1)) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts limit 1)) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts limit 1)) from tb2;" [0x80002600] 
taos> select {funcName}((select count(*) from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select count(*) from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select null from tb2)) from tb2;

DB error: unrecognized token: "{funcname}((select null from tb2)) from tb2;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts limit 1) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts limit 1) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select count(*) from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select count(*) from tb2) + 1) from tb2;" [0x80002600] 
taos> select {funcName}((select null from tb2) + 1) from tb2;

DB error: unrecognized token: "{funcname}((select null from tb2) + 1) from tb2;" [0x80002600] 
taos> select (select 1) + (select 1) from tb2 partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) + (select f1 from tb2) from tb2 partition by tbname;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) + (select f1 from tb2 order by ts limit 1) from tb2 partition by tbname;
 (select f1 from tb2 order by ts limit 1) + (select f1 from tb2 o |
===================================================================
                                                               4 |
                                                               4 |

taos> select (select count(*) from tb2) + (select count(*) from tb2) from tb2 partition by tbname;
 (select count(*) from tb2) + (select count(*) from tb2) |
==========================================================
                                                       4 |
                                                       4 |

taos> select (select null from tb2) + (select null from tb2) from tb2 partition by tbname;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + f1 from tb2 partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) + f1 from tb2 partition by f1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) + f1 from tb2 partition by f1;
 (select f1 from tb2 order by ts limit 1) + f1 |
================================================
                                             4 |
                                             5 |

taos> select (select count(*) from tb2) + f1 from tb2 partition by f1;
 (select count(*) from tb2) + f1 |
==================================
                               4 |
                               5 |

taos> select (select null from tb2) + f1 from tb2 partition by f1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from tb2 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tb2), avg(f1) from tb2 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from tb2 order by ts limit 1), avg(f1) from tb2 interval(1d);
         _wstart         | (select f1 from tb2 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-02 00:00:00.000 |                                        2 |                         2 |
 2025-12-03 00:00:00.000 |                                        2 |                         3 |

taos> select _wstart, (select count(*) from tb2), avg(f1) from tb2 interval(1d);
         _wstart         | (select count(*) from tb2) |          avg(f1)          |
===================================================================================
 2025-12-02 00:00:00.000 |                          2 |                         2 |
 2025-12-03 00:00:00.000 |                          2 |                         3 |

taos> select _wstart, (select null from tb2), avg(f1) from tb2 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from tb2 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) + 1, avg(f1) from tb2 interval(1d);
 (select f1 from tb2 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            3 |                         2 |
                                            3 |                         3 |

taos> select (select count(*) from tb2) + 1, avg(f1) from tb2 interval(1d);
 (select count(*) from tb2) + 1 |          avg(f1)          |
=============================================================
                              3 |                         2 |
                              3 |                         3 |

taos> select (select null from tb2) + 1, avg(f1) from tb2 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts limit 1)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts limit 1)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb2)), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb2)), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb2 order by ts limit 1) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb2 order by ts limit 1) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb2) + 1), avg(f1) from tb2 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb2) + 1), avg(f1) from tb2 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select case (select f1 from tb2 order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);
 case (select f1 from tb2 order by ts limit 1) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                2 |                         2 |
                                                                2 |                         3 |

taos> select case (select count(*) from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);
 case (select count(*) from tb2) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        2 |                         2 |
                                                        2 |                         3 |

taos> select case (select null from tb2) when 1 then 1 else 2 end, avg(f1) from tb2 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from tb2 order by ts limit 1), avg(f1) from tb2 SESSION(ts, 1d);
         _wstart         | (select f1 from tb2 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-02 00:00:00.000 |                                        2 |                       2.5 |

taos> select _wstart, (select count(*) from tb2), avg(f1) from tb2 SESSION(ts, 1d);
         _wstart         | (select count(*) from tb2) |          avg(f1)          |
===================================================================================
 2025-12-02 00:00:00.000 |                          2 |                       2.5 |

taos> select _wstart, (select null from tb2), avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb2 order by ts limit 1) + 1, avg(f1) from tb2 SESSION(ts, 1d);
 (select f1 from tb2 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            3 |                       2.5 |

taos> select (select count(*) from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);
 (select count(*) from tb2) + 1 |          avg(f1)          |
=============================================================
                              3 |                       2.5 |

taos> select (select null from tb2) + 1, avg(f1) from tb2 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb3);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tb3 order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from tb3);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from tb3);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from tb3;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) from tb3;
 (select f1 from tb3 order by ts limit 1) |
===========================================
                                        4 |
                                        4 |
                                        4 |

taos> select (select count(*) from tb3) from tb3;
 (select count(*) from tb3) |
=============================
                          3 |
                          3 |
                          3 |

taos> select (select null from tb3) from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) a from tb3;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) a from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) a from tb3;
      a      |
==============
           4 |
           4 |
           4 |

taos> select (select count(*) from tb3) a from tb3;
           a           |
========================
                     3 |
                     3 |
                     3 |

taos> select (select null from tb3) a from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1) from tb3;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tb3) from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from tb3 order by ts limit 1) from tb3;
 (select f1 from tb3 order by ts limit 1) |
===========================================
                                        4 |

taos> select distinct (select count(*) from tb3) from tb3;
 (select count(*) from tb3) |
=============================
                          3 |

taos> select distinct (select null from tb3) from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1), f1 from tb3;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tb3), f1 from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from tb3 order by ts limit 1), f1 from tb3;
 (select f1 from tb3 order by ts limit 1) |     f1      |
=========================================================
                                        4 |           6 |
                                        4 |           4 |
                                        4 |           5 |

taos> select distinct (select count(*) from tb3), f1 from tb3;
 (select count(*) from tb3) |     f1      |
===========================================
                          3 |           5 |
                          3 |           4 |
                          3 |           6 |

taos> select distinct (select null from tb3), f1 from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select 1) + 1 from tb3;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from tb3) + 1 from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select f1 from tb3 order by ts limit 1) + 1 from tb3;
 (select f1 from tb3 order by ts limit 1) + 1 |
===============================================
                                            5 |

taos> select distinct tags (select count(*) from tb3) + 1 from tb3;
 (select count(*) from tb3) + 1 |
=================================
                              4 |

taos> select distinct tags (select null from tb3) + 1 from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1), (select 1) from tb3;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3), (select f1 from tb3) from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1), (select f1 from tb3 order by ts limit 1) from tb3;
 (select f1 from tb3 order by ts limit 1) | (select f1 from tb3 order by ts limit 1) |
======================================================================================
                                        4 |                                        4 |
                                        4 |                                        4 |
                                        4 |                                        4 |

taos> select (select count(*) from tb3), (select count(*) from tb3) from tb3;
 (select count(*) from tb3) | (select count(*) from tb3) |
==========================================================
                          3 |                          3 |
                          3 |                          3 |
                          3 |                          3 |

taos> select (select null from tb3), (select null from tb3) from tb3;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select 1, (select 1) from tb3 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from tb3) from tb3 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select 1, (select f1 from tb3 order by ts limit 1) from tb3 order by ts;
           1           | (select f1 from tb3 order by ts limit 1) |
===================================================================
                     1 |                                        4 |
                     1 |                                        4 |
                     1 |                                        4 |

taos> select 1, (select count(*) from tb3) from tb3 order by ts;
           1           | (select count(*) from tb3) |
=====================================================
                     1 |                          3 |
                     1 |                          3 |
                     1 |                          3 |

taos> select 1, (select null from tb3) from tb3 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1), * from tb3 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3), * from tb3 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1), * from tb3 order by ts;
 (select f1 from tb3 order by ts limit 1) |           ts            |     f1      |     f2      |
=================================================================================================
                                        4 | 2025-12-04 00:00:00.000 |           4 |          31 |
                                        4 | 2025-12-05 00:00:00.000 |           5 |          32 |
                                        4 | 2025-12-06 00:00:00.000 |           6 |          33 |

taos> select (select count(*) from tb3), * from tb3 order by ts;
 (select count(*) from tb3) |           ts            |     f1      |     f2      |
===================================================================================
                          3 | 2025-12-04 00:00:00.000 |           4 |          31 |
                          3 | 2025-12-05 00:00:00.000 |           5 |          32 |
                          3 | 2025-12-06 00:00:00.000 |           6 |          33 |

taos> select (select null from tb3), * from tb3 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) * (select 1), * from tb3 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) * (select f1 from tb3), * from tb3 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) * (select f1 from tb3 order by ts limit 1), * from tb3 order by ts;
 (select f1 from tb3 order by ts limit 1) * (select f1 from tb3 o |           ts            |     f1      |     f2      |
=========================================================================================================================
                                                              16 | 2025-12-04 00:00:00.000 |           4 |          31 |
                                                              16 | 2025-12-05 00:00:00.000 |           5 |          32 |
                                                              16 | 2025-12-06 00:00:00.000 |           6 |          33 |

taos> select (select count(*) from tb3) * (select count(*) from tb3), * from tb3 order by ts;
 (select count(*) from tb3) * (select count(*) from tb3) |           ts            |     f1      |     f2      |
================================================================================================================
                                                       9 | 2025-12-04 00:00:00.000 |           4 |          31 |
                                                       9 | 2025-12-05 00:00:00.000 |           5 |          32 |
                                                       9 | 2025-12-06 00:00:00.000 |           6 |          33 |

taos> select (select null from tb3) * (select null from tb3), * from tb3 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)) from tb3;

DB error: unrecognized token: "{funcname}((select 1)) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts limit 1)) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts limit 1)) from tb3;" [0x80002600] 
taos> select {funcName}((select count(*) from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select count(*) from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select null from tb3)) from tb3;

DB error: unrecognized token: "{funcname}((select null from tb3)) from tb3;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts limit 1) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts limit 1) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select count(*) from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select count(*) from tb3) + 1) from tb3;" [0x80002600] 
taos> select {funcName}((select null from tb3) + 1) from tb3;

DB error: unrecognized token: "{funcname}((select null from tb3) + 1) from tb3;" [0x80002600] 
taos> select (select 1) + (select 1) from tb3 partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) + (select f1 from tb3) from tb3 partition by tbname;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) + (select f1 from tb3 order by ts limit 1) from tb3 partition by tbname;
 (select f1 from tb3 order by ts limit 1) + (select f1 from tb3 o |
===================================================================
                                                               8 |
                                                               8 |
                                                               8 |

taos> select (select count(*) from tb3) + (select count(*) from tb3) from tb3 partition by tbname;
 (select count(*) from tb3) + (select count(*) from tb3) |
==========================================================
                                                       6 |
                                                       6 |
                                                       6 |

taos> select (select null from tb3) + (select null from tb3) from tb3 partition by tbname;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + f1 from tb3 partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) + f1 from tb3 partition by f1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) + f1 from tb3 partition by f1;
 (select f1 from tb3 order by ts limit 1) + f1 |
================================================
                                             9 |
                                            10 |
                                             8 |

taos> select (select count(*) from tb3) + f1 from tb3 partition by f1;
 (select count(*) from tb3) + f1 |
==================================
                               8 |
                               9 |
                               7 |

taos> select (select null from tb3) + f1 from tb3 partition by f1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from tb3 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tb3), avg(f1) from tb3 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from tb3 order by ts limit 1), avg(f1) from tb3 interval(1d);
         _wstart         | (select f1 from tb3 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-04 00:00:00.000 |                                        4 |                         4 |
 2025-12-05 00:00:00.000 |                                        4 |                         5 |
 2025-12-06 00:00:00.000 |                                        4 |                         6 |

taos> select _wstart, (select count(*) from tb3), avg(f1) from tb3 interval(1d);
         _wstart         | (select count(*) from tb3) |          avg(f1)          |
===================================================================================
 2025-12-04 00:00:00.000 |                          3 |                         4 |
 2025-12-05 00:00:00.000 |                          3 |                         5 |
 2025-12-06 00:00:00.000 |                          3 |                         6 |

taos> select _wstart, (select null from tb3), avg(f1) from tb3 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from tb3 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) + 1, avg(f1) from tb3 interval(1d);
 (select f1 from tb3 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            5 |                         4 |
                                            5 |                         5 |
                                            5 |                         6 |

taos> select (select count(*) from tb3) + 1, avg(f1) from tb3 interval(1d);
 (select count(*) from tb3) + 1 |          avg(f1)          |
=============================================================
                              4 |                         4 |
                              4 |                         5 |
                              4 |                         6 |

taos> select (select null from tb3) + 1, avg(f1) from tb3 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts limit 1)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts limit 1)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb3)), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb3)), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tb3 order by ts limit 1) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tb3 order by ts limit 1) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tb3) + 1), avg(f1) from tb3 interval(1d);

DB error: unrecognized token: "{funcname}((select null from tb3) + 1), avg(f1) from tb3 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select case (select f1 from tb3 order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);
 case (select f1 from tb3 order by ts limit 1) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                2 |                         4 |
                                                                2 |                         5 |
                                                                2 |                         6 |

taos> select case (select count(*) from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);
 case (select count(*) from tb3) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        2 |                         4 |
                                                        2 |                         5 |
                                                        2 |                         6 |

taos> select case (select null from tb3) when 1 then 1 else 2 end, avg(f1) from tb3 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from tb3 order by ts limit 1), avg(f1) from tb3 SESSION(ts, 1d);
         _wstart         | (select f1 from tb3 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-04 00:00:00.000 |                                        4 |                         5 |

taos> select _wstart, (select count(*) from tb3), avg(f1) from tb3 SESSION(ts, 1d);
         _wstart         | (select count(*) from tb3) |          avg(f1)          |
===================================================================================
 2025-12-04 00:00:00.000 |                          3 |                         5 |

taos> select _wstart, (select null from tb3), avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from tb3 order by ts limit 1) + 1, avg(f1) from tb3 SESSION(ts, 1d);
 (select f1 from tb3 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            5 |                         5 |

taos> select (select count(*) from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);
 (select count(*) from tb3) + 1 |          avg(f1)          |
=============================================================
                              4 |                         5 |

taos> select (select null from tb3) + 1, avg(f1) from tb3 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tba);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tba order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from tba);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from tba);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from tba;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) from tba;
 (select f1 from tba) |
=======================
                    0 |

taos> select (select f1 from tba order by ts limit 1) from tba;
 (select f1 from tba order by ts limit 1) |
===========================================
                                        0 |

taos> select (select count(*) from tba) from tba;
 (select count(*) from tba) |
=============================
                          1 |

taos> select (select null from tba) from tba;
 (select null from tba) |
=========================
 NULL                   |

taos> select (select 1) a from tba;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) a from tba;
      a      |
==============
           0 |

taos> select (select f1 from tba order by ts limit 1) a from tba;
      a      |
==============
           0 |

taos> select (select count(*) from tba) a from tba;
           a           |
========================
                     1 |

taos> select (select null from tba) a from tba;
 a  |
=====
 N. |

taos> select distinct (select 1) from tba;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tba) from tba;
 (select f1 from tba) |
=======================
                    0 |

taos> select distinct (select f1 from tba order by ts limit 1) from tba;
 (select f1 from tba order by ts limit 1) |
===========================================
                                        0 |

taos> select distinct (select count(*) from tba) from tba;
 (select count(*) from tba) |
=============================
                          1 |

taos> select distinct (select null from tba) from tba;
 (select null from tba) |
=========================
 NULL                   |

taos> select distinct (select 1), f1 from tba;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tba), f1 from tba;
 (select f1 from tba) |     f1      |
=====================================
                    0 |           0 |

taos> select distinct (select f1 from tba order by ts limit 1), f1 from tba;
 (select f1 from tba order by ts limit 1) |     f1      |
=========================================================
                                        0 |           0 |

taos> select distinct (select count(*) from tba), f1 from tba;
 (select count(*) from tba) |     f1      |
===========================================
                          1 |           0 |

taos> select distinct (select null from tba), f1 from tba;
 (select null from tba) |     f1      |
=======================================
 NULL                   |           0 |

taos> select distinct tags (select 1) + 1 from tba;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from tba) + 1 from tba;
 (select f1 from tba) + 1  |
============================
                         1 |

taos> select distinct tags (select f1 from tba order by ts limit 1) + 1 from tba;
 (select f1 from tba order by ts limit 1) + 1 |
===============================================
                                            1 |

taos> select distinct tags (select count(*) from tba) + 1 from tba;
 (select count(*) from tba) + 1 |
=================================
                              2 |

taos> select distinct tags (select null from tba) + 1 from tba;
 (select null from tba) + 1 |
=============================
 NULL                       |

taos> select (select 1), (select 1) from tba;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba), (select f1 from tba) from tba;
 (select f1 from tba) | (select f1 from tba) |
==============================================
                    0 |                    0 |

taos> select (select f1 from tba order by ts limit 1), (select f1 from tba order by ts limit 1) from tba;
 (select f1 from tba order by ts limit 1) | (select f1 from tba order by ts limit 1) |
======================================================================================
                                        0 |                                        0 |

taos> select (select count(*) from tba), (select count(*) from tba) from tba;
 (select count(*) from tba) | (select count(*) from tba) |
==========================================================
                          1 |                          1 |

taos> select (select null from tba), (select null from tba) from tba;
 (select null from tba) | (select null from tba) |
==================================================
 NULL                   | NULL                   |

taos> select 1, (select 1) from tba order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from tba) from tba order by ts;
           1           | (select f1 from tba) |
===============================================
                     1 |                    0 |

taos> select 1, (select f1 from tba order by ts limit 1) from tba order by ts;
           1           | (select f1 from tba order by ts limit 1) |
===================================================================
                     1 |                                        0 |

taos> select 1, (select count(*) from tba) from tba order by ts;
           1           | (select count(*) from tba) |
=====================================================
                     1 |                          1 |

taos> select 1, (select null from tba) from tba order by ts;
           1           | (select null from tba) |
=================================================
                     1 | NULL                   |

taos> select (select 1), * from tba order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba), * from tba order by ts;
 (select f1 from tba) |           ts            |     f1      |
===============================================================
                    0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba order by ts limit 1), * from tba order by ts;
 (select f1 from tba order by ts limit 1) |           ts            |     f1      |
===================================================================================
                                        0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select count(*) from tba), * from tba order by ts;
 (select count(*) from tba) |           ts            |     f1      |
=====================================================================
                          1 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select null from tba), * from tba order by ts;
 (select null from tba) |           ts            |     f1      |
=================================================================
 NULL                   | 2025-12-01 00:00:00.000 |           0 |

taos> select (select 1) * (select 1), * from tba order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) * (select f1 from tba), * from tba order by ts;
 (select f1 from tba) * (select f1 from tba) |           ts            |     f1      |
======================================================================================
                                           0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select f1 from tba order by ts limit 1) * (select f1 from tba order by ts limit 1), * from tba order by ts;
 (select f1 from tba order by ts limit 1) * (select f1 from tba o |           ts            |     f1      |
===========================================================================================================
                                                               0 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select count(*) from tba) * (select count(*) from tba), * from tba order by ts;
 (select count(*) from tba) * (select count(*) from tba) |           ts            |     f1      |
==================================================================================================
                                                       1 | 2025-12-01 00:00:00.000 |           0 |

taos> select (select null from tba) * (select null from tba), * from tba order by ts;
 (select null from tba) * (select null from tba) |           ts            |     f1      |
==========================================================================================
 NULL                                            | 2025-12-01 00:00:00.000 |           0 |

taos> select {funcName}((select 1)) from tba;

DB error: unrecognized token: "{funcname}((select 1)) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba)) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts limit 1)) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts limit 1)) from tba;" [0x80002600] 
taos> select {funcName}((select count(*) from tba)) from tba;

DB error: unrecognized token: "{funcname}((select count(*) from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select null from tba)) from tba;

DB error: unrecognized token: "{funcname}((select null from tba)) from tba;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tba;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts limit 1) + 1) from tba;

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts limit 1) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select count(*) from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select count(*) from tba) + 1) from tba;" [0x80002600] 
taos> select {funcName}((select null from tba) + 1) from tba;

DB error: unrecognized token: "{funcname}((select null from tba) + 1) from tba;" [0x80002600] 
taos> select (select 1) + (select 1) from tba partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) + (select f1 from tba) from tba partition by tbname;
 (select f1 from tba) + (select f1 from tba) |
==============================================
                                           0 |

taos> select (select f1 from tba order by ts limit 1) + (select f1 from tba order by ts limit 1) from tba partition by tbname;
 (select f1 from tba order by ts limit 1) + (select f1 from tba o |
===================================================================
                                                               0 |

taos> select (select count(*) from tba) + (select count(*) from tba) from tba partition by tbname;
 (select count(*) from tba) + (select count(*) from tba) |
==========================================================
                                                       2 |

taos> select (select null from tba) + (select null from tba) from tba partition by tbname;
 (select null from tba) + (select null from tba) |
==================================================
 NULL                                            |

taos> select (select 1) + f1 from tba partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) + f1 from tba partition by f1;
 (select f1 from tba) + f1 |
============================
                         0 |

taos> select (select f1 from tba order by ts limit 1) + f1 from tba partition by f1;
 (select f1 from tba order by ts limit 1) + f1 |
================================================
                                             0 |

taos> select (select count(*) from tba) + f1 from tba partition by f1;
 (select count(*) from tba) + f1 |
==================================
                               1 |

taos> select (select null from tba) + f1 from tba partition by f1;
 (select null from tba) + f1 |
==============================
 NULL                        |

taos> select _wstart, (select 1), avg(f1) from tba interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tba), avg(f1) from tba interval(1d);
         _wstart         | (select f1 from tba) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    0 |                         0 |

taos> select _wstart, (select f1 from tba order by ts limit 1), avg(f1) from tba interval(1d);
         _wstart         | (select f1 from tba order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 |                                        0 |                         0 |

taos> select _wstart, (select count(*) from tba), avg(f1) from tba interval(1d);
         _wstart         | (select count(*) from tba) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         0 |

taos> select _wstart, (select null from tba), avg(f1) from tba interval(1d);
         _wstart         | (select null from tba) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         0 |

taos> select (select 1) + 1, avg(f1) from tba interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) + 1, avg(f1) from tba interval(1d);
 (select f1 from tba) + 1  |          avg(f1)          |
========================================================
                         1 |                         0 |

taos> select (select f1 from tba order by ts limit 1) + 1, avg(f1) from tba interval(1d);
 (select f1 from tba order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            1 |                         0 |

taos> select (select count(*) from tba) + 1, avg(f1) from tba interval(1d);
 (select count(*) from tba) + 1 |          avg(f1)          |
=============================================================
                              2 |                         0 |

taos> select (select null from tba) + 1, avg(f1) from tba interval(1d);
 (select null from tba) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         0 |

taos> select {funcName}((select 1)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts limit 1)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts limit 1)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tba)), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select null from tba)), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tba order by ts limit 1) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tba order by ts limit 1) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tba) + 1), avg(f1) from tba interval(1d);

DB error: unrecognized token: "{funcname}((select null from tba) + 1), avg(f1) from tba interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select f1 from tba) when 1 then 1 else 2 end |          avg(f1)          |
=================================================================================
                                                  2 |                         0 |

taos> select case (select f1 from tba order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select f1 from tba order by ts limit 1) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                2 |                         0 |

taos> select case (select count(*) from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select count(*) from tba) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        1 |                         0 |

taos> select case (select null from tba) when 1 then 1 else 2 end, avg(f1) from tba interval(1d);
 case (select null from tba) when 1 then 1 else 2 end |          avg(f1)          |
===================================================================================
                                                    2 |                         0 |

taos> select _wstart, (select 1), avg(f1) from tba SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select f1 from tba) |          avg(f1)          |
=============================================================================
 2025-12-01 00:00:00.000 |                    0 |                         0 |

taos> select _wstart, (select f1 from tba order by ts limit 1), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select f1 from tba order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 |                                        0 |                         0 |

taos> select _wstart, (select count(*) from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select count(*) from tba) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          1 |                         0 |

taos> select _wstart, (select null from tba), avg(f1) from tba SESSION(ts, 1d);
         _wstart         | (select null from tba) |          avg(f1)          |
===============================================================================
 2025-12-01 00:00:00.000 | NULL                   |                         0 |

taos> select (select 1) + 1, avg(f1) from tba SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select f1 from tba) + 1  |          avg(f1)          |
========================================================
                         1 |                         0 |

taos> select (select f1 from tba order by ts limit 1) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select f1 from tba order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            1 |                         0 |

taos> select (select count(*) from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select count(*) from tba) + 1 |          avg(f1)          |
=============================================================
                              2 |                         0 |

taos> select (select null from tba) + 1, avg(f1) from tba SESSION(ts, 1d);
 (select null from tba) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         0 |

taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tbb);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tbb order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from tbb);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from tbb);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from tbb;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) from tbb;
 (select f1 from tbb) |
=======================
                    1 |

taos> select (select f1 from tbb order by ts limit 1) from tbb;
 (select f1 from tbb order by ts limit 1) |
===========================================
                                        1 |

taos> select (select count(*) from tbb) from tbb;
 (select count(*) from tbb) |
=============================
                          1 |

taos> select (select null from tbb) from tbb;
 (select null from tbb) |
=========================
 NULL                   |

taos> select (select 1) a from tbb;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) a from tbb;
      a      |
==============
           1 |

taos> select (select f1 from tbb order by ts limit 1) a from tbb;
      a      |
==============
           1 |

taos> select (select count(*) from tbb) a from tbb;
           a           |
========================
                     1 |

taos> select (select null from tbb) a from tbb;
 a  |
=====
 N. |

taos> select distinct (select 1) from tbb;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tbb) from tbb;
 (select f1 from tbb) |
=======================
                    1 |

taos> select distinct (select f1 from tbb order by ts limit 1) from tbb;
 (select f1 from tbb order by ts limit 1) |
===========================================
                                        1 |

taos> select distinct (select count(*) from tbb) from tbb;
 (select count(*) from tbb) |
=============================
                          1 |

taos> select distinct (select null from tbb) from tbb;
 (select null from tbb) |
=========================
 NULL                   |

taos> select distinct (select 1), f1 from tbb;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tbb), f1 from tbb;
 (select f1 from tbb) |     f1      |
=====================================
                    1 |           1 |

taos> select distinct (select f1 from tbb order by ts limit 1), f1 from tbb;
 (select f1 from tbb order by ts limit 1) |     f1      |
=========================================================
                                        1 |           1 |

taos> select distinct (select count(*) from tbb), f1 from tbb;
 (select count(*) from tbb) |     f1      |
===========================================
                          1 |           1 |

taos> select distinct (select null from tbb), f1 from tbb;
 (select null from tbb) |     f1      |
=======================================
 NULL                   |           1 |

taos> select distinct tags (select 1) + 1 from tbb;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from tbb) + 1 from tbb;
 (select f1 from tbb) + 1  |
============================
                         2 |

taos> select distinct tags (select f1 from tbb order by ts limit 1) + 1 from tbb;
 (select f1 from tbb order by ts limit 1) + 1 |
===============================================
                                            2 |

taos> select distinct tags (select count(*) from tbb) + 1 from tbb;
 (select count(*) from tbb) + 1 |
=================================
                              2 |

taos> select distinct tags (select null from tbb) + 1 from tbb;
 (select null from tbb) + 1 |
=============================
 NULL                       |

taos> select (select 1), (select 1) from tbb;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb), (select f1 from tbb) from tbb;
 (select f1 from tbb) | (select f1 from tbb) |
==============================================
                    1 |                    1 |

taos> select (select f1 from tbb order by ts limit 1), (select f1 from tbb order by ts limit 1) from tbb;
 (select f1 from tbb order by ts limit 1) | (select f1 from tbb order by ts limit 1) |
======================================================================================
                                        1 |                                        1 |

taos> select (select count(*) from tbb), (select count(*) from tbb) from tbb;
 (select count(*) from tbb) | (select count(*) from tbb) |
==========================================================
                          1 |                          1 |

taos> select (select null from tbb), (select null from tbb) from tbb;
 (select null from tbb) | (select null from tbb) |
==================================================
 NULL                   | NULL                   |

taos> select 1, (select 1) from tbb order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from tbb) from tbb order by ts;
           1           | (select f1 from tbb) |
===============================================
                     1 |                    1 |

taos> select 1, (select f1 from tbb order by ts limit 1) from tbb order by ts;
           1           | (select f1 from tbb order by ts limit 1) |
===================================================================
                     1 |                                        1 |

taos> select 1, (select count(*) from tbb) from tbb order by ts;
           1           | (select count(*) from tbb) |
=====================================================
                     1 |                          1 |

taos> select 1, (select null from tbb) from tbb order by ts;
           1           | (select null from tbb) |
=================================================
                     1 | NULL                   |

taos> select (select 1), * from tbb order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb), * from tbb order by ts;
 (select f1 from tbb) |           ts            |     f1      |
===============================================================
                    1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb order by ts limit 1), * from tbb order by ts;
 (select f1 from tbb order by ts limit 1) |           ts            |     f1      |
===================================================================================
                                        1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select count(*) from tbb), * from tbb order by ts;
 (select count(*) from tbb) |           ts            |     f1      |
=====================================================================
                          1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select null from tbb), * from tbb order by ts;
 (select null from tbb) |           ts            |     f1      |
=================================================================
 NULL                   | 2025-12-02 00:00:00.000 |           1 |

taos> select (select 1) * (select 1), * from tbb order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) * (select f1 from tbb), * from tbb order by ts;
 (select f1 from tbb) * (select f1 from tbb) |           ts            |     f1      |
======================================================================================
                                           1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select f1 from tbb order by ts limit 1) * (select f1 from tbb order by ts limit 1), * from tbb order by ts;
 (select f1 from tbb order by ts limit 1) * (select f1 from tbb o |           ts            |     f1      |
===========================================================================================================
                                                               1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select count(*) from tbb) * (select count(*) from tbb), * from tbb order by ts;
 (select count(*) from tbb) * (select count(*) from tbb) |           ts            |     f1      |
==================================================================================================
                                                       1 | 2025-12-02 00:00:00.000 |           1 |

taos> select (select null from tbb) * (select null from tbb), * from tbb order by ts;
 (select null from tbb) * (select null from tbb) |           ts            |     f1      |
==========================================================================================
 NULL                                            | 2025-12-02 00:00:00.000 |           1 |

taos> select {funcName}((select 1)) from tbb;

DB error: unrecognized token: "{funcname}((select 1)) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts limit 1)) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts limit 1)) from tbb;" [0x80002600] 
taos> select {funcName}((select count(*) from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select count(*) from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select null from tbb)) from tbb;

DB error: unrecognized token: "{funcname}((select null from tbb)) from tbb;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts limit 1) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts limit 1) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select count(*) from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select count(*) from tbb) + 1) from tbb;" [0x80002600] 
taos> select {funcName}((select null from tbb) + 1) from tbb;

DB error: unrecognized token: "{funcname}((select null from tbb) + 1) from tbb;" [0x80002600] 
taos> select (select 1) + (select 1) from tbb partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) + (select f1 from tbb) from tbb partition by tbname;
 (select f1 from tbb) + (select f1 from tbb) |
==============================================
                                           2 |

taos> select (select f1 from tbb order by ts limit 1) + (select f1 from tbb order by ts limit 1) from tbb partition by tbname;
 (select f1 from tbb order by ts limit 1) + (select f1 from tbb o |
===================================================================
                                                               2 |

taos> select (select count(*) from tbb) + (select count(*) from tbb) from tbb partition by tbname;
 (select count(*) from tbb) + (select count(*) from tbb) |
==========================================================
                                                       2 |

taos> select (select null from tbb) + (select null from tbb) from tbb partition by tbname;
 (select null from tbb) + (select null from tbb) |
==================================================
 NULL                                            |

taos> select (select 1) + f1 from tbb partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) + f1 from tbb partition by f1;
 (select f1 from tbb) + f1 |
============================
                         2 |

taos> select (select f1 from tbb order by ts limit 1) + f1 from tbb partition by f1;
 (select f1 from tbb order by ts limit 1) + f1 |
================================================
                                             2 |

taos> select (select count(*) from tbb) + f1 from tbb partition by f1;
 (select count(*) from tbb) + f1 |
==================================
                               2 |

taos> select (select null from tbb) + f1 from tbb partition by f1;
 (select null from tbb) + f1 |
==============================
 NULL                        |

taos> select _wstart, (select 1), avg(f1) from tbb interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select f1 from tbb) |          avg(f1)          |
=============================================================================
 2025-12-02 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tbb order by ts limit 1), avg(f1) from tbb interval(1d);
         _wstart         | (select f1 from tbb order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-02 00:00:00.000 |                                        1 |                         1 |

taos> select _wstart, (select count(*) from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select count(*) from tbb) |          avg(f1)          |
===================================================================================
 2025-12-02 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tbb), avg(f1) from tbb interval(1d);
         _wstart         | (select null from tbb) |          avg(f1)          |
===============================================================================
 2025-12-02 00:00:00.000 | NULL                   |                         1 |

taos> select (select 1) + 1, avg(f1) from tbb interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) + 1, avg(f1) from tbb interval(1d);
 (select f1 from tbb) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tbb order by ts limit 1) + 1, avg(f1) from tbb interval(1d);
 (select f1 from tbb order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            2 |                         1 |

taos> select (select count(*) from tbb) + 1, avg(f1) from tbb interval(1d);
 (select count(*) from tbb) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tbb) + 1, avg(f1) from tbb interval(1d);
 (select null from tbb) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select {funcName}((select 1)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts limit 1)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts limit 1)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbb)), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbb)), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbb order by ts limit 1) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbb order by ts limit 1) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbb) + 1), avg(f1) from tbb interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbb) + 1), avg(f1) from tbb interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select f1 from tbb) when 1 then 1 else 2 end |          avg(f1)          |
=================================================================================
                                                  1 |                         1 |

taos> select case (select f1 from tbb order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select f1 from tbb order by ts limit 1) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |

taos> select case (select count(*) from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select count(*) from tbb) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        1 |                         1 |

taos> select case (select null from tbb) when 1 then 1 else 2 end, avg(f1) from tbb interval(1d);
 case (select null from tbb) when 1 then 1 else 2 end |          avg(f1)          |
===================================================================================
                                                    2 |                         1 |

taos> select _wstart, (select 1), avg(f1) from tbb SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select f1 from tbb) |          avg(f1)          |
=============================================================================
 2025-12-02 00:00:00.000 |                    1 |                         1 |

taos> select _wstart, (select f1 from tbb order by ts limit 1), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select f1 from tbb order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-02 00:00:00.000 |                                        1 |                         1 |

taos> select _wstart, (select count(*) from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select count(*) from tbb) |          avg(f1)          |
===================================================================================
 2025-12-02 00:00:00.000 |                          1 |                         1 |

taos> select _wstart, (select null from tbb), avg(f1) from tbb SESSION(ts, 1d);
         _wstart         | (select null from tbb) |          avg(f1)          |
===============================================================================
 2025-12-02 00:00:00.000 | NULL                   |                         1 |

taos> select (select 1) + 1, avg(f1) from tbb SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select f1 from tbb) + 1  |          avg(f1)          |
========================================================
                         2 |                         1 |

taos> select (select f1 from tbb order by ts limit 1) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select f1 from tbb order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            2 |                         1 |

taos> select (select count(*) from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select count(*) from tbb) + 1 |          avg(f1)          |
=============================================================
                              2 |                         1 |

taos> select (select null from tbb) + 1, avg(f1) from tbb SESSION(ts, 1d);
 (select null from tbb) + 1 |          avg(f1)          |
=========================================================
 NULL                       |                         1 |

taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tbe);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from tbe order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from tbe);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from tbe);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from tbe;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) from tbe;

taos> select (select f1 from tbe order by ts limit 1) from tbe;

taos> select (select count(*) from tbe) from tbe;

taos> select (select null from tbe) from tbe;

taos> select (select 1) a from tbe;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) a from tbe;

taos> select (select f1 from tbe order by ts limit 1) a from tbe;

taos> select (select count(*) from tbe) a from tbe;

taos> select (select null from tbe) a from tbe;

taos> select distinct (select 1) from tbe;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tbe) from tbe;

taos> select distinct (select f1 from tbe order by ts limit 1) from tbe;

taos> select distinct (select count(*) from tbe) from tbe;

taos> select distinct (select null from tbe) from tbe;

taos> select distinct (select 1), f1 from tbe;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from tbe), f1 from tbe;

taos> select distinct (select f1 from tbe order by ts limit 1), f1 from tbe;

taos> select distinct (select count(*) from tbe), f1 from tbe;

taos> select distinct (select null from tbe), f1 from tbe;

taos> select distinct tags (select 1) + 1 from tbe;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from tbe) + 1 from tbe;
 (select f1 from tbe) + 1  |
============================
 NULL                      |

taos> select distinct tags (select f1 from tbe order by ts limit 1) + 1 from tbe;
 (select f1 from tbe order by ts limit 1) + 1 |
===============================================
 NULL                                         |

taos> select distinct tags (select count(*) from tbe) + 1 from tbe;
 (select count(*) from tbe) + 1 |
=================================
                              1 |

taos> select distinct tags (select null from tbe) + 1 from tbe;
 (select null from tbe) + 1 |
=============================
 NULL                       |

taos> select (select 1), (select 1) from tbe;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe), (select f1 from tbe) from tbe;

taos> select (select f1 from tbe order by ts limit 1), (select f1 from tbe order by ts limit 1) from tbe;

taos> select (select count(*) from tbe), (select count(*) from tbe) from tbe;

taos> select (select null from tbe), (select null from tbe) from tbe;

taos> select 1, (select 1) from tbe order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from tbe) from tbe order by ts;

taos> select 1, (select f1 from tbe order by ts limit 1) from tbe order by ts;

taos> select 1, (select count(*) from tbe) from tbe order by ts;

taos> select 1, (select null from tbe) from tbe order by ts;

taos> select (select 1), * from tbe order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe), * from tbe order by ts;

taos> select (select f1 from tbe order by ts limit 1), * from tbe order by ts;

taos> select (select count(*) from tbe), * from tbe order by ts;

taos> select (select null from tbe), * from tbe order by ts;

taos> select (select 1) * (select 1), * from tbe order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) * (select f1 from tbe), * from tbe order by ts;

taos> select (select f1 from tbe order by ts limit 1) * (select f1 from tbe order by ts limit 1), * from tbe order by ts;

taos> select (select count(*) from tbe) * (select count(*) from tbe), * from tbe order by ts;

taos> select (select null from tbe) * (select null from tbe), * from tbe order by ts;

taos> select {funcName}((select 1)) from tbe;

DB error: unrecognized token: "{funcname}((select 1)) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts limit 1)) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts limit 1)) from tbe;" [0x80002600] 
taos> select {funcName}((select count(*) from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select count(*) from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select null from tbe)) from tbe;

DB error: unrecognized token: "{funcname}((select null from tbe)) from tbe;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select 1) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts limit 1) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts limit 1) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select count(*) from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select count(*) from tbe) + 1) from tbe;" [0x80002600] 
taos> select {funcName}((select null from tbe) + 1) from tbe;

DB error: unrecognized token: "{funcname}((select null from tbe) + 1) from tbe;" [0x80002600] 
taos> select (select 1) + (select 1) from tbe partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) + (select f1 from tbe) from tbe partition by tbname;

taos> select (select f1 from tbe order by ts limit 1) + (select f1 from tbe order by ts limit 1) from tbe partition by tbname;

taos> select (select count(*) from tbe) + (select count(*) from tbe) from tbe partition by tbname;

taos> select (select null from tbe) + (select null from tbe) from tbe partition by tbname;

taos> select (select 1) + f1 from tbe partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) + f1 from tbe partition by f1;

taos> select (select f1 from tbe order by ts limit 1) + f1 from tbe partition by f1;

taos> select (select count(*) from tbe) + f1 from tbe partition by f1;

taos> select (select null from tbe) + f1 from tbe partition by f1;

taos> select _wstart, (select 1), avg(f1) from tbe interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select f1 from tbe order by ts limit 1), avg(f1) from tbe interval(1d);

taos> select _wstart, (select count(*) from tbe), avg(f1) from tbe interval(1d);

taos> select _wstart, (select null from tbe), avg(f1) from tbe interval(1d);

taos> select (select 1) + 1, avg(f1) from tbe interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select f1 from tbe order by ts limit 1) + 1, avg(f1) from tbe interval(1d);

taos> select (select count(*) from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select (select null from tbe) + 1, avg(f1) from tbe interval(1d);

taos> select {funcName}((select 1)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts limit 1)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts limit 1)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbe)), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbe)), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from tbe order by ts limit 1) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from tbe order by ts limit 1) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select {funcName}((select null from tbe) + 1), avg(f1) from tbe interval(1d);

DB error: unrecognized token: "{funcname}((select null from tbe) + 1), avg(f1) from tbe interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select f1 from tbe order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select count(*) from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select case (select null from tbe) when 1 then 1 else 2 end, avg(f1) from tbe interval(1d);

taos> select _wstart, (select 1), avg(f1) from tbe SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select f1 from tbe order by ts limit 1), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select count(*) from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select _wstart, (select null from tbe), avg(f1) from tbe SESSION(ts, 1d);

taos> select (select 1) + 1, avg(f1) from tbe SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select f1 from tbe order by ts limit 1) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select count(*) from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select null from tbe) + 1, avg(f1) from tbe SESSION(ts, 1d);

taos> select (select 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from st1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select f1 from st1 order by ts limit 1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select count(*) from st1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select null from st1);

DB error: Current sql does not support subquery as expr [0x8000269C] 
taos> select (select 1) from st1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) from st1;
 (select f1 from st1 order by ts limit 1) |
===========================================
                                        1 |
                                        1 |
                                        1 |
                                        1 |
                                        1 |
                                        1 |

taos> select (select count(*) from st1) from st1;
 (select count(*) from st1) |
=============================
                          6 |
                          6 |
                          6 |
                          6 |
                          6 |
                          6 |

taos> select (select null from st1) from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) a from st1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) a from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) a from st1;
      a      |
==============
           1 |
           1 |
           1 |
           1 |
           1 |
           1 |

taos> select (select count(*) from st1) a from st1;
           a           |
========================
                     6 |
                     6 |
                     6 |
                     6 |
                     6 |
                     6 |

taos> select (select null from st1) a from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1) from st1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from st1) from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from st1 order by ts limit 1) from st1;
 (select f1 from st1 order by ts limit 1) |
===========================================
                                        1 |

taos> select distinct (select count(*) from st1) from st1;
 (select count(*) from st1) |
=============================
                          6 |

taos> select distinct (select null from st1) from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select 1), f1 from st1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct (select f1 from st1), f1 from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct (select f1 from st1 order by ts limit 1), f1 from st1;
 (select f1 from st1 order by ts limit 1) |     f1      |
=========================================================
                                        1 |           4 |
                                        1 |           3 |
                                        1 |           5 |
                                        1 |           1 |
                                        1 |           6 |
                                        1 |           2 |

taos> select distinct (select count(*) from st1), f1 from st1;
 (select count(*) from st1) |     f1      |
===========================================
                          6 |           6 |
                          6 |           5 |
                          6 |           4 |
                          6 |           3 |
                          6 |           1 |
                          6 |           2 |

taos> select distinct (select null from st1), f1 from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select 1) + 1 from st1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select distinct tags (select f1 from st1) + 1 from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select distinct tags (select f1 from st1 order by ts limit 1) + 1 from st1;
 (select f1 from st1 order by ts limit 1) + 1 |
===============================================
                                            2 |

taos> select distinct tags (select count(*) from st1) + 1 from st1;
 (select count(*) from st1) + 1 |
=================================
                              7 |

taos> select distinct tags (select null from st1) + 1 from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1), (select 1) from st1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1), (select f1 from st1) from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1), (select f1 from st1 order by ts limit 1) from st1;
 (select f1 from st1 order by ts limit 1) | (select f1 from st1 order by ts limit 1) |
======================================================================================
                                        1 |                                        1 |
                                        1 |                                        1 |
                                        1 |                                        1 |
                                        1 |                                        1 |
                                        1 |                                        1 |
                                        1 |                                        1 |

taos> select (select count(*) from st1), (select count(*) from st1) from st1;
 (select count(*) from st1) | (select count(*) from st1) |
==========================================================
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |
                          6 |                          6 |

taos> select (select null from st1), (select null from st1) from st1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select 1, (select 1) from st1 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select 1, (select f1 from st1) from st1 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select 1, (select f1 from st1 order by ts limit 1) from st1 order by ts;
           1           | (select f1 from st1 order by ts limit 1) |
===================================================================
                     1 |                                        1 |
                     1 |                                        1 |
                     1 |                                        1 |
                     1 |                                        1 |
                     1 |                                        1 |
                     1 |                                        1 |

taos> select 1, (select count(*) from st1) from st1 order by ts;
           1           | (select count(*) from st1) |
=====================================================
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |
                     1 |                          6 |

taos> select 1, (select null from st1) from st1 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1), * from st1 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1), * from st1 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1), * from st1 order by ts;
 (select f1 from st1 order by ts limit 1) |           ts            |     f1      |     f2      |     tg1     |
===============================================================================================================
                                        1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                        1 | 2025-12-02 00:00:00.000 |           2 |          21 |           2 |
                                        1 | 2025-12-03 00:00:00.000 |           3 |          23 |           2 |
                                        1 | 2025-12-04 00:00:00.000 |           4 |          31 |           3 |
                                        1 | 2025-12-05 00:00:00.000 |           5 |          32 |           3 |
                                        1 | 2025-12-06 00:00:00.000 |           6 |          33 |           3 |

taos> select (select count(*) from st1), * from st1 order by ts;
 (select count(*) from st1) |           ts            |     f1      |     f2      |     tg1     |
=================================================================================================
                          6 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                          6 | 2025-12-02 00:00:00.000 |           2 |          21 |           2 |
                          6 | 2025-12-03 00:00:00.000 |           3 |          23 |           2 |
                          6 | 2025-12-04 00:00:00.000 |           4 |          31 |           3 |
                          6 | 2025-12-05 00:00:00.000 |           5 |          32 |           3 |
                          6 | 2025-12-06 00:00:00.000 |           6 |          33 |           3 |

taos> select (select null from st1), * from st1 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) * (select 1), * from st1 order by ts;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) * (select f1 from st1), * from st1 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) * (select f1 from st1 order by ts limit 1), * from st1 order by ts;
 (select f1 from st1 order by ts limit 1) * (select f1 from st1 o |           ts            |     f1      |     f2      |     tg1     |
=======================================================================================================================================
                                                               1 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                                               1 | 2025-12-02 00:00:00.000 |           2 |          21 |           2 |
                                                               1 | 2025-12-03 00:00:00.000 |           3 |          23 |           2 |
                                                               1 | 2025-12-04 00:00:00.000 |           4 |          31 |           3 |
                                                               1 | 2025-12-05 00:00:00.000 |           5 |          32 |           3 |
                                                               1 | 2025-12-06 00:00:00.000 |           6 |          33 |           3 |

taos> select (select count(*) from st1) * (select count(*) from st1), * from st1 order by ts;
 (select count(*) from st1) * (select count(*) from st1) |           ts            |     f1      |     f2      |     tg1     |
==============================================================================================================================
                                                      36 | 2025-12-01 00:00:00.000 |           1 |          11 |           1 |
                                                      36 | 2025-12-02 00:00:00.000 |           2 |          21 |           2 |
                                                      36 | 2025-12-03 00:00:00.000 |           3 |          23 |           2 |
                                                      36 | 2025-12-04 00:00:00.000 |           4 |          31 |           3 |
                                                      36 | 2025-12-05 00:00:00.000 |           5 |          32 |           3 |
                                                      36 | 2025-12-06 00:00:00.000 |           6 |          33 |           3 |

taos> select (select null from st1) * (select null from st1), * from st1 order by ts;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)) from st1;

DB error: unrecognized token: "{funcname}((select 1)) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1)) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts limit 1)) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts limit 1)) from st1;" [0x80002600] 
taos> select {funcName}((select count(*) from st1)) from st1;

DB error: unrecognized token: "{funcname}((select count(*) from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select null from st1)) from st1;

DB error: unrecognized token: "{funcname}((select null from st1)) from st1;" [0x80002600] 
taos> select {funcName}((select 1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select 1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts limit 1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts limit 1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select count(*) from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select count(*) from st1) + 1) from st1;" [0x80002600] 
taos> select {funcName}((select null from st1) + 1) from st1;

DB error: unrecognized token: "{funcname}((select null from st1) + 1) from st1;" [0x80002600] 
taos> select (select 1) + (select 1) from st1 partition by tbname;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) + (select f1 from st1) from st1 partition by tbname;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) + (select f1 from st1 order by ts limit 1) from st1 partition by tbname;
 (select f1 from st1 order by ts limit 1) + (select f1 from st1 o |
===================================================================
                                                               2 |
                                                               2 |
                                                               2 |
                                                               2 |
                                                               2 |
                                                               2 |

taos> select (select count(*) from st1) + (select count(*) from st1) from st1 partition by tbname;
 (select count(*) from st1) + (select count(*) from st1) |
==========================================================
                                                      12 |
                                                      12 |
                                                      12 |
                                                      12 |
                                                      12 |
                                                      12 |

taos> select (select null from st1) + (select null from st1) from st1 partition by tbname;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + f1 from st1 partition by f1;

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) + f1 from st1 partition by f1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) + f1 from st1 partition by f1;
 (select f1 from st1 order by ts limit 1) + f1 |
================================================
                                             6 |
                                             7 |
                                             3 |
                                             4 |
                                             2 |
                                             5 |

taos> select (select count(*) from st1) + f1 from st1 partition by f1;
 (select count(*) from st1) + f1 |
==================================
                              11 |
                              12 |
                               8 |
                               9 |
                               7 |
                              10 |

taos> select (select null from st1) + f1 from st1 partition by f1;

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from st1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from st1), avg(f1) from st1 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from st1 order by ts limit 1), avg(f1) from st1 interval(1d);
         _wstart         | (select f1 from st1 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 |                                        1 |                         1 |
 2025-12-02 00:00:00.000 |                                        1 |                         2 |
 2025-12-03 00:00:00.000 |                                        1 |                         3 |
 2025-12-04 00:00:00.000 |                                        1 |                         4 |
 2025-12-05 00:00:00.000 |                                        1 |                         5 |
 2025-12-06 00:00:00.000 |                                        1 |                         6 |

taos> select _wstart, (select count(*) from st1), avg(f1) from st1 interval(1d);
         _wstart         | (select count(*) from st1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          6 |                         1 |
 2025-12-02 00:00:00.000 |                          6 |                         2 |
 2025-12-03 00:00:00.000 |                          6 |                         3 |
 2025-12-04 00:00:00.000 |                          6 |                         4 |
 2025-12-05 00:00:00.000 |                          6 |                         5 |
 2025-12-06 00:00:00.000 |                          6 |                         6 |

taos> select _wstart, (select null from st1), avg(f1) from st1 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from st1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) + 1, avg(f1) from st1 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) + 1, avg(f1) from st1 interval(1d);
 (select f1 from st1 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            2 |                         1 |
                                            2 |                         2 |
                                            2 |                         3 |
                                            2 |                         4 |
                                            2 |                         5 |
                                            2 |                         6 |

taos> select (select count(*) from st1) + 1, avg(f1) from st1 interval(1d);
 (select count(*) from st1) + 1 |          avg(f1)          |
=============================================================
                              7 |                         1 |
                              7 |                         2 |
                              7 |                         3 |
                              7 |                         4 |
                              7 |                         5 |
                              7 |                         6 |

taos> select (select null from st1) + 1, avg(f1) from st1 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select {funcName}((select 1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts limit 1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts limit 1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from st1)), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from st1)), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select 1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select 1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select f1 from st1 order by ts limit 1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select f1 from st1 order by ts limit 1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select count(*) from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select count(*) from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select {funcName}((select null from st1) + 1), avg(f1) from st1 interval(1d);

DB error: unrecognized token: "{funcname}((select null from st1) + 1), avg(f1) from st1 interval(1d);" [0x80002600] 
taos> select case (select 1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select case (select f1 from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select case (select f1 from st1 order by ts limit 1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case (select f1 from st1 order by ts limit 1) when 1 then 1 else |          avg(f1)          |
===============================================================================================
                                                                1 |                         1 |
                                                                1 |                         2 |
                                                                1 |                         3 |
                                                                1 |                         4 |
                                                                1 |                         5 |
                                                                1 |                         6 |

taos> select case (select count(*) from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);
 case (select count(*) from st1) when 1 then 1 else 2 end |          avg(f1)          |
=======================================================================================
                                                        2 |                         1 |
                                                        2 |                         2 |
                                                        2 |                         3 |
                                                        2 |                         4 |
                                                        2 |                         5 |
                                                        2 |                         6 |

taos> select case (select null from st1) when 1 then 1 else 2 end, avg(f1) from st1 interval(1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select 1), avg(f1) from st1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select _wstart, (select f1 from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select _wstart, (select f1 from st1 order by ts limit 1), avg(f1) from st1 SESSION(ts, 1d);
         _wstart         | (select f1 from st1 order by ts limit 1) |          avg(f1)          |
=================================================================================================
 2025-12-01 00:00:00.000 |                                        1 |                       3.5 |

taos> select _wstart, (select count(*) from st1), avg(f1) from st1 SESSION(ts, 1d);
         _wstart         | (select count(*) from st1) |          avg(f1)          |
===================================================================================
 2025-12-01 00:00:00.000 |                          6 |                       3.5 |

taos> select _wstart, (select null from st1), avg(f1) from st1 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select 1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: Not supported subquery as expr [0x8000269B] 
taos> select (select f1 from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
taos> select (select f1 from st1 order by ts limit 1) + 1, avg(f1) from st1 SESSION(ts, 1d);
 (select f1 from st1 order by ts limit 1) + 1 |          avg(f1)          |
===========================================================================
                                            2 |                       3.5 |

taos> select (select count(*) from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);
 (select count(*) from st1) + 1 |          avg(f1)          |
=============================================================
                              7 |                       3.5 |

taos> select (select null from st1) + 1, avg(f1) from st1 SESSION(ts, 1d);

DB error: Not single row returned in subquery as expr [0x8000269A] 
