
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 1s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:34.230 |                  9000 |                   100 |
 2025-03-12 13:31:36.230 | 2025-03-12 13:31:54.230 |                 18000 |                   190 |
 2025-03-12 13:31:57.230 | 2025-03-12 13:32:14.230 |                 17000 |                   180 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                   270 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                   360 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                   450 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                   540 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                   630 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                   720 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                   810 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 3s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:14.230 |                 49000 |                   470 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                   270 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                   360 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                   450 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                   540 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                   630 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                   720 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                   810 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 4s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:44.230 |                 79000 |                   740 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                   360 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                   450 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                   540 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                   630 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                   720 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                   810 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 5s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:33:24.230 |                119000 |                  1100 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                   450 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                   540 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                   630 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                   720 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                   810 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 7s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:35:14.230 |                229000 |                  2090 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                   630 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                   720 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                   810 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 9s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:44.230 |                379000 |                  3440 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                   810 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 10s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:39:14.230 |                469000 |                  4250 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                   900 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 11s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:40:54.230 |                569000 |                  5150 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                   990 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                    80 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 13s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                  6220 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                  6220 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 1s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:34.230 |                  9000 |                    9 |
 2025-03-12 13:31:36.230 | 2025-03-12 13:31:54.230 |                 18000 |                   29 |
 2025-03-12 13:31:57.230 | 2025-03-12 13:32:14.230 |                 17000 |                   49 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                   79 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                  119 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                  169 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                  229 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                  299 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                  379 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 3s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:14.230 |                 49000 |                   49 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                   79 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                  119 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                  169 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                  229 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                  299 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                  379 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 4s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:44.230 |                 79000 |                   79 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                  119 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                  169 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                  229 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                  299 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                  379 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 5s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:33:24.230 |                119000 |                  119 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                  169 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                  229 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                  299 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                  379 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 7s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:35:14.230 |                229000 |                  229 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                  299 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                  379 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 9s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:44.230 |                379000 |                  379 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 10s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:39:14.230 |                469000 |                  469 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 11s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:40:54.230 |                569000 |                  569 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                  679 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 13s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                  699 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 1s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:34.230 |                  9000 |          215 |
 2025-03-12 13:31:36.230 | 2025-03-12 13:31:54.230 |                 18000 |          216 |
 2025-03-12 13:31:57.230 | 2025-03-12 13:32:14.230 |                 17000 |          217 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |          219 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |          221 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |          223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |          227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |          231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |          236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |          241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 3s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:14.230 |                 49000 |          215 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |          219 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |          221 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |          223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |          227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |          231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |          236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |          241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 4s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:44.230 |                 79000 |          215 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |          221 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |          223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |          227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |          231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |          236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |          241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 5s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:33:24.230 |                119000 |          215 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |          223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |          227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |          231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |          236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |          241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 7s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:35:14.230 |                229000 |          215 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |          231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |          236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |          241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 9s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:44.230 |                379000 |          215 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |          241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 10s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:39:14.230 |                469000 |          215 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |          247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 11s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:40:54.230 |                569000 |          215 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |          254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |          261 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 13s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |          215 |

taos> select _wstart, _wend, _wduration, min(voltage) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       | min(voltage) |
===========================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |          215 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 1s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:34.230 |                  9000 |             216 |
 2025-03-12 13:31:36.230 | 2025-03-12 13:31:54.230 |                 18000 |             217 |
 2025-03-12 13:31:57.230 | 2025-03-12 13:32:14.230 |                 17000 |             218 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |             220 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |             223 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |             226 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |             230 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |             235 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |             240 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 3s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:14.230 |                 49000 |             218 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |             220 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |             223 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |             226 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |             230 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |             235 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |             240 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 4s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:44.230 |                 79000 |             220 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |             223 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |             226 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |             230 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |             235 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |             240 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 5s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:33:24.230 |                119000 |             223 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |             226 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |             230 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |             235 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |             240 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 7s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:35:14.230 |                229000 |             230 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |             235 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |             240 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 9s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:44.230 |                379000 |             240 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 10s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:39:14.230 |                469000 |             246 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 11s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:40:54.230 |                569000 |             253 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |             260 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 13s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 10) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       | top(voltage, 10) |
===============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |              262 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 1s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:34.230 |                  9000 |                215 |
 2025-03-12 13:31:36.230 | 2025-03-12 13:31:54.230 |                 18000 |                216 |
 2025-03-12 13:31:57.230 | 2025-03-12 13:32:14.230 |                 17000 |                217 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                219 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                221 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 3s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:14.230 |                 49000 |                215 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                219 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                221 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 4s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:44.230 |                 79000 |                215 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                221 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 5s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:33:24.230 |                119000 |                215 |
 2025-03-12 13:33:30.230 | 2025-03-12 13:34:14.230 |                 44000 |                223 |
 2025-03-12 13:34:21.230 | 2025-03-12 13:35:14.230 |                 53000 |                227 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 7s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:35:14.230 |                229000 |                215 |
 2025-03-12 13:35:22.230 | 2025-03-12 13:36:24.230 |                 62000 |                231 |
 2025-03-12 13:36:33.230 | 2025-03-12 13:37:44.230 |                 71000 |                236 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 9s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:44.230 |                379000 |                215 |
 2025-03-12 13:37:54.230 | 2025-03-12 13:39:14.230 |                 80000 |                241 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 10s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:39:14.230 |                469000 |                215 |
 2025-03-12 13:39:25.230 | 2025-03-12 13:40:54.230 |                 89000 |                247 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 11s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:40:54.230 |                569000 |                215 |
 2025-03-12 13:41:06.230 | 2025-03-12 13:42:44.230 |                 98000 |                254 |
 2025-03-12 13:42:57.230 | 2025-03-12 13:43:04.230 |                  7000 |                261 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 13s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                215 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                215 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 10) from keeporderdb.meters session(ts, 14s);
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 10) |
==================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:43:04.230 |                699000 |                 215 |

taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.meters session(ts, 1s);

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.meters session(ts, 1s);

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mavg(voltage, 4) from keeporderdb.meters session(ts, 1s);

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, tail(voltage, 1) from keeporderdb.meters session(ts, 1s);

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                   300 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                   300 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                    22 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  335 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  665 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  699 |

taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |     min(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |

taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       |     min(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                    0 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  336 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  666 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 2) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, top(voltage, 2) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | top(voltage, 2) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |

taos> select _wstart, _wend, _wduration, top(voltage, 2) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       | top(voltage, 2) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |             237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |             259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |             262 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 2) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, bottom(voltage, 2) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 2) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 2) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 2) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                215 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                237 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                259 |

taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.meters count_window(3);

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.meters count_window(3);

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mavg(voltage, 4) from keeporderdb.meters count_window(3);

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mavg(voltage, 4) from keeporderdb.meters partition by tbname count_window(300) order by tbname;

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mavg(voltage, 4) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, tail(voltage, 1) from keeporderdb.meters count_window(3);

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, tail(voltage, 1) from keeporderdb.meters partition by tbname count_window(300) order by tbname;

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, tail(voltage, 1) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters state_window(voltage);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                     8 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                    13 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters state_window(voltage);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    7 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   22 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   37 |

taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |     min(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |

taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       |     min(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    0 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                    8 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   23 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |

taos> select _wstart, _wend, _wduration, top(voltage, 2) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | top(voltage, 2) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |

taos> select _wstart, _wend, _wduration, top(voltage, 2) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       | top(voltage, 2) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |             215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |             216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |             217 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 2) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 2) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 2) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 2) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                215 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                216 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                217 |

taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mavg(voltage, 4) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mavg(voltage, 4) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, tail(voltage, 1) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, tail(voltage, 1) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters event_window start with voltage > 240 end with voltage < 239

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |

taos> select _wstart, _wend, _wduration, max(current) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       |     max(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   23 |

taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |     min(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |

taos> select _wstart, _wend, _wduration, min(current) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       |     min(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    0 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |

taos> select _wstart, _wend, _wduration, count(*) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       |       count(*)        |
====================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                    23 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |

taos> select _wstart, _wend, _wduration, top(voltage, 1) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       | top(voltage, 1) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |

taos> select _wstart, _wend, _wduration, top(voltage, 3) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       | top(voltage, 3) |
==============================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             216 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             217 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |             216 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 1) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 1) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 2) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 2) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |

taos> select _wstart, _wend, _wduration, bottom(voltage, 3) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       | bottom(voltage, 3) |
=================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                215 |

taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, statecount(voltage, 'LE', 223) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;

DB error: Function 'statecount' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, stateduration(voltage, 'LE', 223) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;

DB error: Function 'stateduration' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration,  mavg(voltage, 4) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname;

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration,  mavg(voltage, 4) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;

DB error: Function 'mavg' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration,  tail(voltage, 1) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname;

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration,  tail(voltage, 1) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;

DB error: Function 'tail' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters session(ts, 1s) order by _wstart limit 2;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters session(ts, 3s) order by _wstart limit 2;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters session(ts, 4s) order by _wstart limit 2;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters count_window(3);

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters state_window(voltage);

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, unique(current) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;

DB error: Function 'unique' is not supported in window query or group query [0x8000264F] 
taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters session(ts, 1s) order by _wstart limit 2;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:34.230 |                  9000 |                    2 |
 2025-03-12 13:31:36.230 | 2025-03-12 13:31:54.230 |                 18000 |                   14 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters session(ts, 3s) order by _wstart limit 2;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:14.230 |                 49000 |                   14 |
 2025-03-12 13:32:18.230 | 2025-03-12 13:32:44.230 |                 26000 |                   60 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters session(ts, 4s) order by _wstart limit 2;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:32:44.230 |                 79000 |                   14 |
 2025-03-12 13:32:49.230 | 2025-03-12 13:33:24.230 |                 35000 |                   90 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters count_window(3);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters partition by tbname count_window(300) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.t1 partition by tbname count_window(300) order by tbname;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:37:00.230 |                335000 |                  168 |
 2025-03-12 13:37:01.230 | 2025-03-12 13:42:30.230 |                329000 |                  438 |
 2025-03-12 13:42:31.230 | 2025-03-12 13:43:04.230 |                 33000 |                  670 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters state_window(voltage);

DB error: Duplicate timestamp not allowed in count/event/state window [0x8000073E] 
taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.t1 where ts > "2025-03-12 13:30:18.230" and ts < "2025-03-12 13:32:03.230" partition by tbname state_window(voltage) order by tbname;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:32.230 |                  7000 |                    2 |
 2025-03-12 13:31:33.230 | 2025-03-12 13:31:47.230 |                 14000 |                   14 |
 2025-03-12 13:31:48.230 | 2025-03-12 13:32:02.230 |                 14000 |                   28 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.meters partition by tbname  event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217 order by tbname, _wstart;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |

taos> select _wstart, _wend, _wduration, mode(current) from keeporderdb.t1 event_window start with (voltage >= 215 and voltage < 217) end with voltage >= 217;
         _wstart         |          _wend          |      _wduration       |    mode(current)     |
===================================================================================================
 2025-03-12 13:31:25.230 | 2025-03-12 13:31:48.230 |                 23000 |                   14 |

