
taos> select last(ts), tag1 from test_last_tag.stb group by tbname order by tbname
        last(ts)         |    tag1     |
========================================
 2024-10-10 10:00:04.000 |           1 |
 2024-10-10 10:00:05.000 |           2 |

taos> explain select last(ts), tag1 from test_last_tag.stb group by tbname\G
*************************** 1.row ***************************
QUERY_PLAN: -> Data Exchange 2:1 (width=12)
*************************** 2.row ***************************
QUERY_PLAN:    -> Aggregate (functions=2 width=12 input_order=desc )
*************************** 3.row ***************************
QUERY_PLAN:       -> Last Row Scan on stb (columns=1 pseudo_columns=2 width=284 )

taos> select last(c1), tag2 from test_last_tag.stb group by tbname order by tbname
  last(c1)   |         tag2         |
=====================================
           4 |                  1.1 |
           3 |                  2.2 |

taos> explain select last(c1), tag2 from test_last_tag.stb group by tbname\G
*************************** 1.row ***************************
QUERY_PLAN: -> Data Exchange 2:1 (width=8)
*************************** 2.row ***************************
QUERY_PLAN:    -> Aggregate (functions=2 width=8 input_order=desc )
*************************** 3.row ***************************
QUERY_PLAN:       -> Last Row Scan on stb (columns=2 pseudo_columns=2 width=288 )

taos> select last(ts), tag1, tag2 from test_last_tag.stb order by tbname
        last(ts)         |    tag1     |         tag2         |
===============================================================
 2024-10-10 10:00:05.000 |           2 |                  2.2 |

taos> explain select last(ts), tag1, tag2 from test_last_tag.stb\G
*************************** 1.row ***************************
QUERY_PLAN: -> Aggregate (functions=3 width=16 input_order=desc )
*************************** 2.row ***************************
QUERY_PLAN:    -> Data Exchange 2:1 (width=16)
*************************** 3.row ***************************
QUERY_PLAN:       -> Last Row Scan on stb (columns=1 pseudo_columns=2 width=16 )

taos> select last(ts), last(c1), tag1, tag2 from test_last_tag.stb group by tbname order by tbname
        last(ts)         |  last(c1)   |    tag1     |         tag2         |
=============================================================================
 2024-10-10 10:00:04.000 |           4 |           1 |                  1.1 |
 2024-10-10 10:00:05.000 |           3 |           2 |                  2.2 |

taos> explain select last(ts), last(c1), tag1, tag2 from test_last_tag.stb group by tbname\G
*************************** 1.row ***************************
QUERY_PLAN: -> Data Exchange 2:1 (width=20)
*************************** 2.row ***************************
QUERY_PLAN:    -> Aggregate (functions=4 width=20 input_order=desc )
*************************** 3.row ***************************
QUERY_PLAN:       -> Last Row Scan on stb (columns=2 pseudo_columns=3 width=292 )

taos> select last(ts), last_row(c1), tag1, tag2 from test_last_tag.stb group by tbname order by tbname
        last(ts)         | last_row(c1) |    tag1     |         tag2         |
==============================================================================
 2024-10-10 10:00:04.000 |            4 |           1 |                  1.1 |
 2024-10-10 10:00:05.000 | NULL         |           2 |                  2.2 |

taos> explain select last(ts), last_row(c1), tag1, tag2 from test_last_tag.stb group by tbname\G
*************************** 1.row ***************************
QUERY_PLAN: -> Data Exchange 2:1 (width=20)
*************************** 2.row ***************************
QUERY_PLAN:    -> Aggregate (functions=4 width=20 input_order=desc )
*************************** 3.row ***************************
QUERY_PLAN:       -> Last Row Scan on stb (columns=2 pseudo_columns=3 width=292 )

taos> select last_row(ts), c1, tag1, tag2 from test_last_tag.stb group by tbname order by tbname
      last_row(ts)       |     c1      |    tag1     |         tag2         |
=============================================================================
 2024-10-10 10:00:04.000 |           4 |           1 |                  1.1 |
 2024-10-10 10:00:05.000 | NULL        |           2 |                  2.2 |

taos> explain select last_row(ts), c1, tag1, tag2 from test_last_tag.stb group by tbname order by tbname\G
*************************** 1.row ***************************
QUERY_PLAN: -> Sort input_order=unknown output_order=unknown  (columns=4 width=20)
*************************** 2.row ***************************
QUERY_PLAN:    -> Data Exchange 2:1 (width=292)
*************************** 3.row ***************************
QUERY_PLAN:       -> Aggregate (functions=5 width=292 input_order=desc )
*************************** 4.row ***************************
QUERY_PLAN:          -> Last Row Scan on stb (columns=2 pseudo_columns=3 width=292 )

taos> select last(ts), tag1 from test_last_tag.tb1;
        last(ts)         |    tag1     |
========================================
 2024-10-10 10:00:04.000 |           1 |

taos> explain select last(ts), tag1 from test_last_tag.tb1\G;
*************************** 1.row ***************************
QUERY_PLAN: -> Aggregate (functions=2 width=12 input_order=desc )
*************************** 2.row ***************************
QUERY_PLAN:    -> Last Row Scan on tb1 (columns=1 pseudo_columns=1 width=12 )

taos> select last(ts), first(c1), cols(max(c1), ts), tag1, tag2 from test_last_tag.tb1;
        last(ts)         |  first(c1)  |           ts            |    tag1     |         tag2         |
=======================================================================================================
 2024-10-10 10:00:04.000 |           0 | 2024-10-10 10:00:04.000 |           1 |                  1.1 |

taos> explain select last(ts), first(c1), cols(max(c1), ts), tag1, tag2 from test_last_tag.tb1\G;
*************************** 1.row ***************************
QUERY_PLAN: -> Merge (columns=5 width=28 input_order=unknown output_order=unknown mode=column)
*************************** 2.row ***************************
QUERY_PLAN:    -> Aggregate (functions=3 width=16 input_order=asc )
*************************** 3.row ***************************
QUERY_PLAN:       -> Data Exchange 1:1 (width=12)
*************************** 4.row ***************************
QUERY_PLAN:          -> Table Scan on tb1 (columns=2 width=12 order=[asc|1 desc|0] mode=ts_order data_load=data)
*************************** 5.row ***************************
QUERY_PLAN:    -> Aggregate (functions=3 width=16 input_order=desc )
*************************** 6.row ***************************
QUERY_PLAN:       -> Data Exchange 1:1 (width=20)
*************************** 7.row ***************************
QUERY_PLAN:          -> Last Row Scan on tb1 (columns=2 pseudo_columns=2 width=20 )

