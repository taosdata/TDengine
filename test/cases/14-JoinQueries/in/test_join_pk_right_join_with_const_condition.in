select b.*, a.ats from (select _rowts ats, first(f) from test1.sst) as a right join test1.sst b on timetruncate(cast(1768465717000 as timestamp)+1a, 1s) = timetruncate(b.ts, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a
select b.*, a.ats from (select cast(1768465717000 as timestamp) ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(b.ts, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a
select b.*, a.ats from (select ts ats, mode(f) from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(cast(1768465717000 as timestamp)+1s, 1s) = timetruncate(b.ts, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a
select b.*, a.ats from (select ts ats, unique(f) from test1.sst) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(cast(1768465717000 as timestamp)+1a, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a    
select b.*, a.ats from (select ts ats, unique(f) from test1.sst) as a right join test1.sst b on timetruncate(cast(1768465717000 as timestamp)+1a, 1s) = timetruncate(b.ts, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a
select b.*, a.ts from (select * from test1.sst) as a right join ((select ts, unique(f) from test1.sst)) b on timetruncate(a.ts, 1s) = timetruncate(cast(1768465717000 as timestamp)+1a, 1s) and b.ts > a.ts-5a and b.ts < a.ts + 5a
select b.*, a.ats from (select _rowts ats, first(f) from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(cast(1768465717000 as timestamp)+1a, 1s) = timetruncate(b.ts, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst limit 1) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(1691386257000, 1s)   
select b.*, a.ats from (select cast(1768465717000 as timestamp) ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select cast(1768465717000 as timestamp) ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(1691386256000, 1s) = timetruncate(1691386257000, 1s)
select b.*, a.ats from (select ts ats, mode(f) from test1.sst order by ats desc) as a right join (select * from test1.sst order by ts desc) b on timetruncate(1691386258000, 1s) = timetruncate(b.ts, 1s)
select b.*, a.ats from (select ts ats, mode(f) from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(1691386258000, 1s) = timetruncate(b.ts, 1s)      
select b.*, a.ats from (select ts ats, f from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(1691386258000, 1s) = timetruncate(b.ts, 1s)
select b.*, a.ats from (select ts ats, mode(f) from test1.sst order by ats desc) as a right join (select * from test1.sst order by ts desc) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select ts ats, mode(f) from test1.sst order by ats) as a right join (select * from test1.sst order by ts desc) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select ts ats, mode(f) from test1.sst order by ats) as a right join (select * from test1.sst order by ts) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select ts ats, mode(f) from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select ts ats, f from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst limit 1) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s)
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(1691386256000, 1s) = timetruncate(1691386256000, 1s)      
select b.*, a.ats from (select cast(1768465717000 as timestamp) ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(1691386256000, 1s) = timetruncate(1691386256001, 1s)
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst order by ts desc) as a right join test1.sst b     
select b.*, a.ats from (select ts ats, mode(f) from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(1691386258000, 1s) = timetruncate(b.ts, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a      
select b.*, a.ats from (select ts ats, f from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s) and b.ts > a.ats+1s
select b.*, a.ats from (select ts ats, f from test1.sst) as a right join (select * from test1.sst order by ts desc) b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s) and b.ts > a.ats+1s
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s) and b.ts > a.ats+1s
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst limit 1) as a right join test1.sst b on timetruncate(a.ats, 1s) = timetruncate(1691386256000, 1s) and b.ts > a.ats+1s
select b.*, a.ats from (select 1691386256000 ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(1691386256000, 1s) = timetruncate(1691386256000, 1s) and b.ts > a.ats+1
select b.*, a.ats from (select cast(1768465717000 as timestamp) ats, 2 from test1.sst order by ts desc) as a right join test1.sst b on timetruncate(1691386256000, 1s) = timetruncate(1691386256001, 1s) and b.ts > a.ats-5a and b.ts < a.ats + 5a
